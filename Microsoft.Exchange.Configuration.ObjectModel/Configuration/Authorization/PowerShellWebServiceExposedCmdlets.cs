using System;
using System.Collections.Generic;
using Microsoft.Exchange.Diagnostics;

namespace Microsoft.Exchange.Configuration.Authorization
{
	[ClassAccessLevel(AccessLevel.Implementation)]
	internal static class PowerShellWebServiceExposedCmdlets
	{
		internal static bool IsCmdletExposedToPSWS(ExchangeRunspaceConfiguration runspaceConfiguration, string cmdletName)
		{
			return runspaceConfiguration.ConfigurationSettings.IsProxy || PowerShellWebServiceExposedCmdlets.cmdletsExposedToPSWS.Contains(cmdletName);
		}

		private static HashSet<string> cmdletsExposedToPSWS = new HashSet<string>(StringComparer.OrdinalIgnoreCase)
		{
			"Add-DistributionGroupMember",
			"Add-MailboxFolderPermission",
			"Add-MailboxPermission",
			"Add-RecipientPermission",
			"Add-RoleGroupMember",
			"Clear-ActiveSyncDevice",
			"Clear-MobileDevice",
			"Connect-Mailbox",
			"ConvertTo-ExchangeXml",
			"Disable-App",
			"Disable-DistributionGroup",
			"Disable-InboxRule",
			"Disable-JournalRule",
			"Disable-Mailbox",
			"Disable-MailContact",
			"Disable-MailUser",
			"Disable-TransportRule",
			"Disable-UMMailbox",
			"Enable-App",
			"Enable-DistributionGroup",
			"Enable-InboxRule",
			"Enable-JournalRule",
			"Enable-Mailbox",
			"Enable-MailContact",
			"Enable-MailUser",
			"Enable-OrganizationCustomization",
			"Enable-TransportRule",
			"Enable-UMMailbox",
			"Get-AcceptedDomain",
			"Get-ActiveSyncDevice",
			"Get-ActiveSyncDeviceAccessRule",
			"Get-ActiveSyncDeviceClass",
			"Get-ActiveSyncDevicePolicy",
			"Get-ActiveSyncDeviceStatistics",
			"Get-ActiveSyncMailboxPolicy",
			"Get-ActiveSyncOrganizationSettings",
			"Get-App",
			"Get-CalendarProcessing",
			"Get-CASMailbox",
			"Get-CompliancePolicySyncNotification",
			"Get-Contact",
			"Get-DistributionGroup",
			"Get-DistributionGroupMember",
			"Get-DlpPolicy",
			"Get-DynamicDistributionGroup",
			"Get-FederatedOrganizationIdentifier",
			"Get-Group",
			"Get-GroupMailbox",
			"Get-InboxRule",
			"Get-IRMConfiguration",
			"Get-JournalRule",
			"Get-Mailbox",
			"Get-MailboxAutoReplyConfiguration",
			"Get-MailboxCalendarConfiguration",
			"Get-MailboxFolderPermission",
			"Get-MailboxFolderStatistics",
			"Get-MailboxJunkEmailConfiguration",
			"Get-MailboxMessageConfiguration",
			"Get-MailboxPermission",
			"Get-MailboxRegionalConfiguration",
			"Get-MailboxStatistics",
			"Get-MailContact",
			"Get-MailTrafficPolicyReport",
			"Get-MailUser",
			"Get-ManagementEndPoint",
			"Get-ManagementRoleAssignment",
			"Get-MessageTrace",
			"Get-MessageTraceDetail",
			"Get-MobileDevice",
			"Get-MobileDeviceMailboxPolicy",
			"Get-MobileDeviceStatistics",
			"Get-MoveRequest",
			"Get-MoveRequestStatistics",
			"Get-Organization",
			"Get-OrganizationalUnit",
			"Get-OrganizationConfig",
			"Get-OrganizationRelationship",
			"Get-OwaMailboxPolicy",
			"Get-Recipient",
			"Get-RecipientPermission",
			"Get-RetentionPolicy",
			"Get-RetentionPolicyTag",
			"Get-RoleGroup",
			"Get-RoleGroupMember",
			"Get-SharingPolicy",
			"Get-SyncRequest",
			"Get-TransportRule",
			"Get-ClientAccessRule",
			"Get-UMMailbox",
			"Get-UMMailboxPolicy",
			"Get-User",
			"Install-IRMConfiguration",
			"Install-OrganizationalUnit",
			"Move-ManagementRoleAssignment",
			"New-AcceptedDomain",
			"New-ActiveSyncDeviceAccessRule",
			"New-ActiveSyncMailboxPolicy",
			"New-ActiveSyncOrganizationSettings",
			"New-App",
			"New-CompliancePolicySyncNotification",
			"New-DistributionGroup",
			"New-DynamicDistributionGroup",
			"New-GroupMailbox",
			"New-InboxRule",
			"New-JournalRule",
			"New-Mailbox",
			"New-MailContact",
			"New-MailUser",
			"New-ManagementRoleAssignment",
			"New-MobileDeviceMailboxPolicy",
			"New-MoveRequest",
			"New-OrganizationRelationship",
			"New-RoleGroup",
			"New-SharingPolicy",
			"New-SyncRequest",
			"New-TransportRule",
			"New-ClientAccessRule",
			"New-UMMailboxPolicy",
			"Remove-AcceptedDomain",
			"Remove-ActiveSyncDevice",
			"Remove-ActiveSyncDeviceAccessRule",
			"Remove-ActiveSyncDeviceClass",
			"Remove-ActiveSyncMailboxPolicy",
			"Remove-App",
			"Remove-CompliancePolicySyncNotification",
			"Remove-DistributionGroup",
			"Remove-DistributionGroupMember",
			"Remove-DlpPolicy",
			"Remove-DynamicDistributionGroup",
			"Remove-GroupMailbox",
			"Remove-InboxRule",
			"Remove-JournalRule",
			"Remove-Mailbox",
			"Remove-MailboxFolderPermission",
			"Remove-MailboxPermission",
			"Remove-MailContact",
			"Remove-MailUser",
			"Remove-ManagementRoleAssignment",
			"Remove-MobileDevice",
			"Remove-MobileDeviceMailboxPolicy",
			"Remove-MoveRequest",
			"Remove-OrganizationRelationship",
			"Remove-RecipientPermission",
			"Remove-RoleGroup",
			"Remove-RoleGroupMember",
			"Remove-SharingPolicy",
			"Remove-SyncRequest",
			"Remove-TransportRule",
			"Remove-ClientAccessRule",
			"Remove-UMMailboxPolicy",
			"Resume-MoveRequest",
			"Search-AdminAuditLog",
			"Search-Mailbox",
			"Search-MailboxAuditLog",
			"Set-AcceptedDomain",
			"Set-ActiveSyncDeviceAccessRule",
			"Set-ActiveSyncDevicePolicy",
			"Set-ActiveSyncMailboxPolicy",
			"Set-ActiveSyncOrganizationSettings",
			"Set-AdminAuditLogConfig",
			"Set-App",
			"Set-CalendarProcessing",
			"Set-CASMailbox",
			"Set-Contact",
			"Set-DistributionGroup",
			"Set-DynamicDistributionGroup",
			"Set-FederatedOrganizationIdentifier",
			"Set-Group",
			"Set-GroupMailbox",
			"Set-InboxRule",
			"Set-IRMConfiguration",
			"Set-JournalRule",
			"Set-Mailbox",
			"Set-MailboxAutoReplyConfiguration",
			"Set-MailboxCalendarConfiguration",
			"Set-MailboxFolderPermission",
			"Set-MailboxJunkEmailConfiguration",
			"Set-MailboxMessageConfiguration",
			"Set-MailboxRegionalConfiguration",
			"Set-MailContact",
			"Set-MailUser",
			"Set-ManagementRoleAssignment",
			"Set-MobileDeviceMailboxPolicy",
			"Set-MoveRequest",
			"Set-OrganizationalUnit",
			"Set-OrganizationConfig",
			"Set-OrganizationRelationship",
			"Set-OwaMailboxPolicy",
			"Set-RoleGroup",
			"Set-SharingPolicy",
			"Set-SyncRequest",
			"Set-TransportRule",
			"Set-ClientAccessRule",
			"Set-UMMailbox",
			"Set-UMMailboxPolicy",
			"Set-User",
			"Start-ManagedFolderAssistant",
			"Stop-ManagedFolderAssistant",
			"Suspend-MoveRequest",
			"Uninstall-OrganizationalUnit",
			"Update-DistributionGroupMember",
			"Update-Recipient",
			"Update-RoleGroupMember",
			"Write-AdminAuditLog"
		};
	}
}
