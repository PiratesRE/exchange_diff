<?xml version="1.0" encoding="utf-8" ?>
<!--This file contains the definition of the internal agents in transport.
    The schema for this xml can be found in InternalMExRuntimeConfig.xsd
    If you change this file, you need to update the unit tests in RuntimeBVT.cs
    as well to incorporate the changes.
    -->
<internalConfiguration>
    <internalMexRuntime>
        <enterpriseBridgehead>
            <!-- Agents to be run before all other regular agents in enterprise bridgehead role. -->
            <preExecution>

                <agent name="Inbound Trust Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.TrustedMail.InboundTrustAgentFactory"
                    assemblyPath="transportRoles\agents\TrustedMail\Microsoft.Exchange.Transport.agent.TrustedMailAgents.dll"
                    enabled="true" />

                <agent name="RMS Protocol Decryption Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.RmsProtocolDecryptionAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

                <agent name="RMS Decryption Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.RmsDecryptionAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

                <agent name="Prioritization Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.Prioritization.PrioritizationAgentFactory"
                    assemblyPath="TransportRoles\agents\Prioritization\Microsoft.Exchange.Transport.Agent.Prioritization.dll"
                    enabled="true" />
              
                <agent name="Shared Mailbox Sent Item Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.SharedMailboxSentItemsRoutingAgent.SharedMailboxSentItemsRoutingFactory"
                    assemblyPath="transportRoles\agents\SharedMailbox\Microsoft.Exchange.Transport.Agent.SharedMailboxSentItemsRoutingAgent.dll"
                    enabled="true" />

            </preExecution>
            <!-- Agents to be run after all other regular agents in enterprise bridgehead role. -->
            <postExecution>

                <agent name="Journal Report Decryption Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.JournalReportDecryptionAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

                <agent name="RMS Encryption Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.AutomaticProtectionAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

                <agent name="Prelicense Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.PrelicenseAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

                <agent name="Journal Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.Journaling.JournalAgentFactory"
                    assemblyPath="transportRoles\agents\Journaling\Microsoft.Exchange.MessagingPolicies.JournalAgent.dll"
                    enabled="true" />

                <agent name="Redirection Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.Redirection.RedirectionAgentFactory"
                    assemblyPath="transportRoles\agents\Redirection\Microsoft.Exchange.MessagingPolicies.RedirectionAgent.dll"
                    enabled="true" />

                <agent name="Outbound Trust Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.TrustedMail.OutboundTrustAgentFactory"
                    assemblyPath="transportRoles\agents\TrustedMail\Microsoft.Exchange.Transport.agent.TrustedMailAgents.dll"
                    enabled="true" />

                <agent name="Index Routing Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.Search.IndexRoutingAgentFactory"
                    assemblyPath="transportRoles\agents\Search\Microsoft.Exchange.Transport.Agent.Search.dll"
                    enabled="true" />

            </postExecution>
        </enterpriseBridgehead>
        <enterpriseGateway>
            <!-- Agents to be run before all other regular agents in enterprise gateway role. -->
            <preExecution>

                <agent name="Inbound Trust Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.TrustedMail.InboundTrustAgentFactory"
                    assemblyPath="transportRoles\agents\TrustedMail\Microsoft.Exchange.Transport.agent.TrustedMailAgents.dll"
                    enabled="true" />

            </preExecution>
            <!-- Agents to be run after all other regular agents in enterprise gateway role. -->
            <postExecution>

                <agent name="Centralized Mail Flow Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.TrustedMail.CentralizedMailFlowAgentFactory"
                    assemblyPath="transportRoles\agents\TrustedMail\Microsoft.Exchange.Transport.agent.TrustedMailAgents.dll"
                    enabled="true" />

                <agent name="Outbound Trust Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.TrustedMail.OutboundTrustAgentFactory"
                    assemblyPath="transportRoles\agents\TrustedMail\Microsoft.Exchange.Transport.agent.TrustedMailAgents.dll"
                    enabled="true" />

            </postExecution>
        </enterpriseGateway>
        <enterpriseFrontend>
            <!-- Agents to be run before all other regular agents in exchange datacenter frontend role. -->
            <preExecution>
                <agent name="Inbound Trust Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.TrustedMail.InboundTrustAgentFactory"
                    assemblyPath="transportRoles\agents\TrustedMail\Microsoft.Exchange.Transport.agent.TrustedMailAgents.dll"
                    enabled="true" />
            </preExecution>
            <!-- Agents to be run after all other regular agents in exchange datacenter frontend role. -->
            <postExecution>
                <agent name="FrontendProxyAgent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.FrontendProxyRoutingAgent.FrontendProxyAgentFactory"
                    assemblyPath="transportRoles\agents\FrontendProxyAgent\Microsoft.Exchange.Transport.Agent.FrontendProxyAgent.dll"
                    enabled="true" />
            </postExecution>
        </enterpriseFrontend>
        <exchangeDatacenterBridgehead>
            <!-- Agents to be run before all other regular agents in datacenter bridgehead role. -->
            <preExecution>

                <agent name="Interceptor Smtp Receive Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorSmtpAgentFactory"
                    assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                    enabled="true" />

                <agent name="Interceptor Routing Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorRoutingAgentFactory"
                    assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                    enabled="true" />

                <agent name="Interceptor Boot Scanner Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Storage.StorageAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorBootScannerAgentFactory"
                    assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                    enabled="true" />

                <agent name="Inbound Trust Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.TrustedMail.InboundTrustAgentFactory"
                    assemblyPath="transportRoles\agents\TrustedMail\Microsoft.Exchange.Transport.agent.TrustedMailAgents.dll"
                    enabled="true" />

                <agent name="RMS Protocol Decryption Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.RmsProtocolDecryptionAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

                <agent name="LiveId Authentication Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.LiveIdAuth.LiveIdAuthAgentFactory"
                    assemblyPath="transportRoles\agents\Auth\Microsoft.Exchange.Transport.Agent.LiveIdAuth.dll"
                    enabled="true" />

                <agent name="RMS Decryption Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.RmsDecryptionAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

              <agent name="Prioritization Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.Prioritization.PrioritizationAgentFactory"
                    assemblyPath="TransportRoles\agents\Prioritization\Microsoft.Exchange.Transport.Agent.Prioritization.dll"
                    enabled="true" />

              <agent name="Journal Filter Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.JournalFilter.JournalFilterAgentFactory"
                    assemblyPath="transportRoles\agents\Journaling\Microsoft.Exchange.MessagingPolicies.JournalAgent.dll"
                    enabled="true" />
              
              <agent name="SmtpMessageThrottling Agent"
                  baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                  classFactory="Microsoft.Exchange.Transport.Agent.SmtpMessageThrottling.SmtpMessageThrottlingAgentFactory"
                  assemblyPath="TransportRoles\agents\SmtpMessageThrottling\Microsoft.Exchange.Transport.Agent.SmtpMessageThrottling.dll"
                  enabled="true" />
              
              <agent name="Shared Mailbox Sent Item Agent"
                  baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                  classFactory="Microsoft.Exchange.Transport.Agent.SharedMailboxSentItemsRoutingAgent.SharedMailboxSentItemsRoutingFactory"
                  assemblyPath="transportRoles\agents\SharedMailbox\Microsoft.Exchange.Transport.Agent.SharedMailboxSentItemsRoutingAgent.dll"
                  enabled="true" />

            </preExecution>
            <!-- Agents to be run after all other regular agents in datacenter bridgehead role. -->
            <postExecution>

                <agent name="Journal Report Decryption Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.JournalReportDecryptionAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

                <agent name="RMS Encryption Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.AutomaticProtectionAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

                <agent name="Prelicense Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.RmSvcAgent.PrelicenseAgentFactory"
                    assemblyPath="transportRoles\agents\RmSvc\Microsoft.Exchange.MessagingPolicies.RmSvcAgent.dll"
                    enabled="true" />

              <agent name="UnJournal Agent"
                  baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                  classFactory="Microsoft.Exchange.MessagingPolicies.UnJournalAgent.UnwrapJournalAgentFactory"
                  assemblyPath="transportRoles\agents\Journaling\Microsoft.Exchange.MessagingPolicies.UnJournalAgent.dll"
                  enabled="true" />

                <agent name="Journal Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.Journaling.JournalAgentFactory"
                    assemblyPath="transportRoles\agents\Journaling\Microsoft.Exchange.MessagingPolicies.JournalAgent.dll"
                    enabled="true" />

                <agent name="Redirection Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.MessagingPolicies.Redirection.RedirectionAgentFactory"
                    assemblyPath="transportRoles\agents\Redirection\Microsoft.Exchange.MessagingPolicies.RedirectionAgent.dll"
                    enabled="true" />

                <agent name="Outbound Trust Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.TrustedMail.OutboundTrustAgentFactory"
                    assemblyPath="transportRoles\agents\TrustedMail\Microsoft.Exchange.Transport.agent.TrustedMailAgents.dll"
                    enabled="true" />

                <agent name="Index Routing Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.Search.IndexRoutingAgentFactory"
                    assemblyPath="transportRoles\agents\Search\Microsoft.Exchange.Transport.Agent.Search.dll"
                    enabled="true" />

            </postExecution>
        </exchangeDatacenterBridgehead>
        <partnerHostedBridgehead>
          <!-- Agents to be run before all other regular agents in partner hosted bridgehead role. -->
          <preExecution>

            <agent name="Journal Filter Agent"
                baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                classFactory="Microsoft.Exchange.Transport.Agent.JournalFilter.JournalFilterAgentFactory"
                assemblyPath="transportRoles\agents\Journaling\Microsoft.Exchange.MessagingPolicies.JournalAgent.dll"
                enabled="true" />

              <agent name="Shared Mailbox Sent Item Agent"
                  baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                  classFactory="Microsoft.Exchange.Transport.Agent.SharedMailboxSentItemsRoutingAgent.SharedMailboxSentItemsRoutingFactory"
                  assemblyPath="transportRoles\agents\SharedMailbox\Microsoft.Exchange.Transport.Agent.SharedMailboxSentItemsRoutingAgent.dll"
                  enabled="true" />
          </preExecution>
          <!-- Agents to be run after all other regular agents in partner hosted bridgehead role. -->
          <postExecution>

            <agent name="Journal Agent"
                baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                classFactory="Microsoft.Exchange.MessagingPolicies.Journaling.JournalAgentFactory"
                assemblyPath="transportRoles\agents\Journaling\Microsoft.Exchange.MessagingPolicies.JournalAgent.dll"
                enabled="true" />

            <agent name="Redirection Agent"
                  baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                  classFactory="Microsoft.Exchange.MessagingPolicies.Redirection.RedirectionAgentFactory"
                  assemblyPath="transportRoles\agents\Redirection\Microsoft.Exchange.MessagingPolicies.RedirectionAgent.dll"
                  enabled="true" />

            <agent name="Index Routing Agent"
                baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                classFactory="Microsoft.Exchange.Transport.Agent.Search.IndexRoutingAgentFactory"
                assemblyPath="transportRoles\agents\Search\Microsoft.Exchange.Transport.Agent.Search.dll"
                enabled="true" />

          </postExecution>
        </partnerHostedBridgehead>
        <partnerHostedGateway>
            <!-- Agents to be run before all other regular agents in partner hosted gateway role. -->
            <preExecution></preExecution>
            <!-- Agents to be run after all other regular agents in partner hosted gateway role. -->
            <postExecution></postExecution>
        </partnerHostedGateway>
        <forefrontForOfficeFrontend>
            <!-- Agents to be run before all other regular agents in ffo frontend role. -->
            <preExecution>
                <agent name="Interceptor Smtp Receive Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorSmtpAgentFactory"
                    assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                    enabled="true" />
            </preExecution>
            <!-- Agents to be run after all other regular agents in ffo frontend role. -->
            <postExecution>
              <!-- Inbound Trust Agent runs in the PostExecution in FFO is due to fact that Attribution Agent will run in EOH and could attribute more. So wait until it is done. -->
              <agent name="Inbound Trust Agent"
                   baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                   classFactory="Microsoft.Exchange.Transport.Agent.TrustedMail.InboundTrustAgentFactory"
                   assemblyPath="transportRoles\agents\TrustedMail\Microsoft.Exchange.Transport.agent.TrustedMailAgents.dll"
                   enabled="true" />
              <agent name="FfoFrontendProxyAgent"
                   baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                   classFactory="Microsoft.Exchange.Transport.FfoFrontendProxyAgentFactory"
                   assemblyPath="transportRoles\agents\FfoFrontendProxyAgent\Microsoft.Exchange.Transport.Agent.FfoFrontendProxyAgent.dll"
                   enabled="true" />
             </postExecution>
        </forefrontForOfficeFrontend>

        <forefrontForOfficeBridgehead>
            <!-- Agents to be run before all other regular agents in ffo bridgehead role. -->
            <preExecution>
                <agent name="Interceptor Smtp Receive Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorSmtpAgentFactory"
                    assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                    enabled="true" />

                <agent name="Interceptor Routing Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorRoutingAgentFactory"
                    assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                    enabled="true" />

              <agent name="SmtpMessageThrottling Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.SmtpMessageThrottling.SmtpMessageThrottlingAgentFactory"
                    assemblyPath="TransportRoles\agents\SmtpMessageThrottling\Microsoft.Exchange.Transport.Agent.SmtpMessageThrottling.dll"
                    enabled="true" />

            </preExecution>
            <!-- Agents to be run after all other regular agents in ffo bridgehead role. -->
            <postExecution>
                <agent name="Index Routing Agent"
                    baseType="Microsoft.Exchange.Data.Transport.Routing.RoutingAgent"
                    classFactory="Microsoft.Exchange.Transport.Agent.Search.IndexRoutingAgentFactory"
                    assemblyPath="transportRoles\agents\Search\Microsoft.Exchange.Transport.Agent.Search.dll"
                    enabled="true" />
             </postExecution>
        </forefrontForOfficeBridgehead>

      <exchangeDatacenterFrontend>
        <!-- Agents to be run before all other regular agents in exchange datacenter frontend role. -->
        <preExecution>
            <agent name="Interceptor Smtp Receive Agent"
                baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorSmtpAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                enabled="true" />
        </preExecution>
        <!-- Agents to be run after all other regular agents in exchange datacenter frontend role. -->
        <postExecution>
          <agent name="FrontendProxyAgent"
               baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
               classFactory="Microsoft.Exchange.Transport.FrontendProxyRoutingAgent.FrontendProxyAgentFactory"
               assemblyPath="transportRoles\agents\FrontendProxyAgent\Microsoft.Exchange.Transport.Agent.FrontendProxyAgent.dll"
               enabled="true" />

          <agent name="LiveId Authentication Agent"
               baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
               classFactory="Microsoft.Exchange.Transport.Agent.LiveIdAuth.LiveIdAuthAgentFactory"
               assemblyPath="transportRoles\agents\Auth\Microsoft.Exchange.Transport.Agent.LiveIdAuth.dll"
               enabled="true" />
        </postExecution>
      </exchangeDatacenterFrontend>

      <exchangeDatacenterMailboxSubmission>
        <!-- Agents to be run before all other regular agents in exchange mailbox role. -->
        <preExecution>
            <agent name="Interceptor Submission Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriver.StoreDriverAgent"
                classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorSubmissionAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                enabled="true" />
            <agent name="Meeting Forward Notification Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriver.StoreDriverAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.Agents.MfnSubmitterAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.dll"
                enabled="true" />
            <agent name="Approval Submit Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriver.StoreDriverAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.Agents.ApprovalSubmitterAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.dll"
                enabled="true" />
            <agent name="Parking Lot Submit Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriver.StoreDriverAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.Agents.ParkedItemSubmitterAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.dll"
                enabled="true" />
        </preExecution>
        <!-- Agents to be run after all other regular agents in exchange mailbox role. -->
        <postExecution></postExecution>
      </exchangeDatacenterMailboxSubmission>

      <partnerHostedMailboxSubmission>
        <!-- Agents to be run before all other regular agents in exchange mailbox role. -->
        <preExecution>
            <agent name="Meeting Forward Notification Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriver.StoreDriverAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.Agents.MfnSubmitterAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.dll"
                enabled="true" />
            <agent name="Approval Submit Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriver.StoreDriverAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.Agents.ApprovalSubmitterAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.dll"
                enabled="true" />
        </preExecution>
        <!-- Agents to be run after all other regular agents in exchange mailbox role. -->
        <postExecution></postExecution>
      </partnerHostedMailboxSubmission>

      <enterpriseMailboxSubmission>
        <!-- Agents to be run before all other regular agents in exchange mailbox role. -->
        <preExecution>
            <agent name="Meeting Forward Notification Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriver.StoreDriverAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.Agents.MfnSubmitterAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.dll"
                enabled="true" />
            <agent name="Approval Submit Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriver.StoreDriverAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.Agents.ApprovalSubmitterAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.dll"
                enabled="true" />
            <agent name="Parking Lot Submit Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriver.StoreDriverAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.Agents.ParkedItemSubmitterAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.Submission.StoreDriverSubmission.dll"
                enabled="true" />
        </preExecution>
        <!-- Agents to be run after all other regular agents in exchange mailbox role. -->
        <postExecution></postExecution>
      </enterpriseMailboxSubmission>

      <exchangeDatacenterMailboxDelivery>
        <!-- Agents to be run before all other regular agents in exchange mailbox role. -->
        <preExecution>
          <agent name="Interceptor Smtp Receive Agent"
                baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
                classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorSmtpAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                enabled="true" />
          <agent name="Interceptor Store Driver Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.Transport.Agent.InterceptorAgent.InterceptorStoreDriverDeliveryAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.Transport.Agent.InterceptorAgent.dll"
                enabled="true" />
          <agent name="Delivery Throttling Agent"
              baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.DeliveryThrottlingAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Meeting Series Message Ordering Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.MeetingSeriesMessageOrderingAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Group Escalation Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.GroupEscalationAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Shared Mailbox Sent Item Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.SharedMailboxSentitemsAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Mobile Message Receive Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.SmsDeliveryAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Conversations Processing Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ConversationsProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Message Records Management Delivery Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.RetentonPolicyTagProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="UM PlayOnPhone Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.UMPlayonPhoneAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="UM Partner Message Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.UMPartnerMessageAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Content Aggregation Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ContentAggregationAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Classification Application Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ClassificationApplicationAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="People I Know Classification Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.PeopleIKnowAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Mailbox Rules Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.MailboxRulesAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Working Set Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.WorkingSetAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Office Graph Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.OfficeGraphAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Meeting Message Processing Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.MeetingMessageProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Approval Processing Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ApprovalProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="UnJournal Delivery Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.UnJournalAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Mailbox Delivery Filter Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.Hygiene.MailboxDeliveryFilterAgent.MailboxDeliveryFilterAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.Hygiene.MailboxDeliveryFilterAgent.dll"
                enabled="false" />
        </preExecution>
        <!-- Agents to be run after all other regular agents in exchange mailbox role. -->
        <postExecution>
          <agent name="Index Delivery Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.IndexDeliveryAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Inference Classification Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.InferenceClassificationAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
        </postExecution>
      </exchangeDatacenterMailboxDelivery>

      <partnerHostedMailboxDelivery>
        <!-- Agents to be run before all other regular agents in exchange mailbox role. -->
        <preExecution>
          <agent name="Delivery Throttling Agent"
              baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.DeliveryThrottlingAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Mobile Message Receive Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.SmsDeliveryAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Conversations Processing Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ConversationsProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Message Records Management Delivery Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.RetentonPolicyTagProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Classification Application Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ClassificationApplicationAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Mailbox Rules Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.MailboxRulesAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Meeting Message Processing Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.MeetingMessageProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Approval Processing Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ApprovalProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
        </preExecution>
        <!-- Agents to be run after all other regular agents in exchange mailbox role. -->
        <postExecution>
          <agent name="Index Delivery Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.IndexDeliveryAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
        </postExecution>
      </partnerHostedMailboxDelivery>

      <enterpriseMailboxDelivery>
        <!-- Agents to be run before all other regular agents in exchange mailbox role. -->
        <preExecution>
          <agent name="Delivery Throttling Agent"
              baseType="Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.DeliveryThrottlingAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Meeting Series Message Ordering Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.MeetingSeriesMessageOrderingAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Mobile Message Receive Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.SmsDeliveryAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Conversations Processing Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ConversationsProcessingAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Message Records Management Delivery Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.RetentonPolicyTagProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Shared Mailbox Sent Item Agent" 
                 baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                 classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.SharedMailboxSentitemsAgentFactory"
                 assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                 enabled="true" />
          <agent name="UM PlayOnPhone Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.UMPlayonPhoneAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="UM Partner Message Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.UMPartnerMessageAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Classification Application Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ClassificationApplicationAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="People I Know Classification Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.PeopleIKnowAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
          <agent name="Mailbox Rules Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.MailboxRulesAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Meeting Message Processing Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.MeetingMessageProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Approval Processing Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.ApprovalProcessingAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
        </preExecution>
        <!-- Agents to be run after all other regular agents in exchange mailbox role. -->
        <postExecution>
          <agent name="Index Delivery Agent"
                baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
                classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.IndexDeliveryAgentFactory"
                assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
                enabled="true" />
          <agent name="Inference Classification Agent"
              baseType="Microsoft.Exchange.Data.Transport.StoreDriverDelivery.StoreDriverDeliveryAgent"
              classFactory="Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.Agents.InferenceClassificationAgentFactory"
              assemblyPath="bin\Microsoft.Exchange.MailboxTransport.StoreDriverDelivery.dll"
              enabled="true" />
        </postExecution>
      </enterpriseMailboxDelivery>
    </internalMexRuntime>
</internalConfiguration>
