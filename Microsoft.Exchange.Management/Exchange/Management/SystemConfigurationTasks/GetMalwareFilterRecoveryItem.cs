using System;
using System.Collections.Generic;
using System.Management.Automation;
using Microsoft.Exchange.Configuration.Tasks;

namespace Microsoft.Exchange.Management.SystemConfigurationTasks
{
	[Cmdlet("Get", "MalwareFilterRecoveryItem", DefaultParameterSetName = "Identity")]
	public sealed class GetMalwareFilterRecoveryItem : MalwareFilterRecoveryItemAccessTask
	{
		[Parameter(Mandatory = false, ParameterSetName = "Identity", ValueFromPipeline = true, ValueFromPipelineByPropertyName = true, Position = 0)]
		[ValidateNotNullOrEmpty]
		public string Identity { get; set; }

		protected override void InternalProcessRecord()
		{
			TaskLogger.LogEnter();
			if (string.IsNullOrEmpty(this.Identity))
			{
				List<MalwareFilterRecoveryItem> allItems = base.UndeliverableItems.GetAllItems();
				using (List<MalwareFilterRecoveryItem>.Enumerator enumerator = allItems.GetEnumerator())
				{
					while (enumerator.MoveNext())
					{
						MalwareFilterRecoveryItem sendToPipeline = enumerator.Current;
						base.WriteObject(sendToPipeline);
					}
					goto IL_66;
				}
			}
			base.WriteObject(base.UndeliverableItems.FindItem(this.Identity));
			IL_66:
			TaskLogger.LogExit();
		}
	}
}
