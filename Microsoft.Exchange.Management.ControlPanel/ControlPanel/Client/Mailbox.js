Type.registerNamespace("ECP");function EnableArchiveMailboxViewModel(){EnableArchiveMailboxViewModel.initializeBase(this)}EnableArchiveMailboxViewModel.prototype={get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.EnableArchive=!0;n.ArchiveDomain=this.get_AdhocValues().get_values().TargetDeliveryDomain;return n}};function EditArchiveMailboxViewModel(){EditArchiveMailboxViewModel.initializeBase(this)}EditArchiveMailboxViewModel.prototype={get_CanShowArchiveDomain:function(){return this.get_AdhocValues().get_values().RemoteArchive&&!EcpUtil.isNullOrEmpty(this.getValue("ArchiveDomain"))},get_CanShowArchiveDatabase:function(){return this.get_AdhocValues().get_values().EnterpriseRoles&&this.get_HasArchive()&&this.get_IsLocalArchive()},get_CanShowArchiveUsage:function(){return this.get_HasArchive()&&this.get_IsLocalArchive()},get_CanEditArchiveQuota:function(){return this.get_AdhocValues().get_values().EnterpriseRoles&&this.get_IsLocalArchive()},get_ArchiveQuotaOptions:function(){return this.get_MailboxQuotaUnlimited()?[ByteQuotaConverter.unlimited]:this.$O_5(this.$I_5(this.get_MailboxQuota()))},get_ArchiveWarningQuotaOptions:function(){return this.get_MailboxQuotaUnlimited()?[ByteQuotaConverter.unlimited]:this.$O_5(this.$S_5(this.$I_5(this.get_MailboxQuota())))},get_HasArchive:function(){return this.getValue("HasArchive")},get_IsLocalArchive:function(){return!this.getValue("RemoteArchive")},get_MailboxQuotaUnlimited:function(){return ByteQuotaConverter.isUnlimited(this.getValue("MailboxQuota"))},get_MailboxQuota:function(){return this.get_MailboxQuotaUnlimited()?0:ByteQuotaConverter.byteToUnit(parseInt(this.getValue("MailboxQuota")),"GB")},$O_5:function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t].toString();return i},$I_5:function(n){return[n*2,n*5,n*10,n*15]},$S_5:function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t]*.9;return i}};function ArchiveNameConverter(){}ArchiveNameConverter.prototype={$1_0:null,convert:function(n,t){this.$1_0=n;return _Object.isNullOrUndefined(this.$1_0)||!this.$1_0.length?"":this.$1_0[0]},convertBack:function(n,t){if(EcpUtil.isNullOrBlank(n))throw Error.create(Strings.get_RequiredFieldValidatorErrorMessage());var i;if(_Object.isNullOrUndefined(this.$1_0)||!this.$1_0.length){i=[];Array.add(i,n)}else{i=EcpUtil.cloneArray(this.$1_0);i[0]=n}return i}};function NewMailboxProperties(n){this.$$d_$U_5=Function.createDelegate(this,this.$U_5);NewMailboxProperties.initializeBase(this,[n])}NewMailboxProperties.prototype={$9_5:null,$8_5:null,$5_5:null,$D_5:null,$C_5:null,$L_5:!1,$K_5:!1,$6_5:null,get_SoftDeletedDataSection:function(){return this.$6_5},set_SoftDeletedDataSection:function(n){this.$6_5=n;return n},initialize:function(){PropertyPage.prototype.initialize.call(this);if(this.get_ObjectIdentity()){var t=this.get_Bindings().getBinding("IsPasswordRequired");var i=t?$get(t.get_elementId()):null;if(i){var r=i.checked;this.$5_5=$get("divPassword");if(this.$5_5){var n=this.$5_5.getElementsByTagName("INPUT");if(n&&n.length===2){this.$D_5=n[0];this.$C_5=n[1]}this.$P_5(r);if(!r){var u=this.get_Bindings().getBinding("UserName");var f=this.get_Bindings().getBinding("DomainName");if(u){this.$9_5=$get(u.get_elementId());$addHandler(this.$9_5,"change",this.$$d_$U_5);this.$L_5=!0}if(f){this.$8_5=$get(f.get_elementId());$addHandler(this.$8_5,"change",this.$$d_$U_5);this.$K_5=!0}}}}var e=$get("divRecoverMailboxDescription");e&&EcpUtil.showElement(e,!0);var o=$get("divRecoverMailboxNote");o&&EcpUtil.showElement(o,!0)}},dispose:function(){this.$9_5&&this.$L_5&&$removeHandler(this.$9_5,"change",this.$$d_$U_5);this.$8_5&&this.$K_5&&$removeHandler(this.$8_5,"change",this.$$d_$U_5);PropertyPage.prototype.dispose.call(this)},processErrors:function(){var n=this.get_Results().ErrorRecords;if(n.length>0&&this.$6_5)for(var t=0;t<n.length;t++)if(Array.contains(NewMailboxProperties.$H,n[t].Type)){Sys.UI.DomElement.removeCssClass(this.$6_5,CssClasses.hiddenCSS);Sys.UI.DomElement.addCssClass(this.$6_5,CssClasses.displayBlock);break}PropertyPage.prototype.processErrors.call(this)},$U_5:function(n){var t=this.get_Bindings().getBinding("UserName");var i=this.get_Bindings().getBinding("DomainName");t&&i&&this.$P_5(t.get_isDirty()||i.get_isDirty())},$P_5:function(n){this.$D_5&&this.$C_5&&(this.$D_5.value=this.$C_5.value=n?"":"sixdot");this.$5_5&&WizardPropertyUtil.toggleChildrenDisabled(this.$5_5,!n)}};function RecipientsGlobals(){}RecipientsGlobals.DownloadMigrationReport=function(n){var i=n.get_toolBar().get_OwnerControl();var t=DataBinder.getPropertyValue(i.get_selectedObjects()[0],"ReportUrl");t&&window.open(t,"_blank")};function EditMigrationBatchViewModel(){EditMigrationBatchViewModel.initializeBase(this);this.addPropertyMapping("CsvContent","UploadedCsv")}EditMigrationBatchViewModel.prototype={$0_4:null,$B_4:0,get_UploadedCsv:function(){return this.$0_4},set_UploadedCsv:function(n){if(this.$0_4!==n){this.$0_4=n;if(this.$0_4&&this.$0_4.MailboxCount){this.$B_4||(this.$B_4=this.getValue("TotalCount"));this.setValue("TotalCount",this.$0_4.MailboxCount);this.setValue("CsvContent",this.$0_4.FileContent)}else{this.setValue("TotalCount",this.$B_4);this.setValue("CsvContent",null)}this.raisePropertyChanged("UploadedCsv")}return n}};function EditMigrationEndpointViewModel(){EditMigrationEndpointViewModel.initializeBase(this)}EditMigrationEndpointViewModel.prototype={$A_4:!1,get_AdminEdited:function(){return this.$A_4},set_AdminEdited:function(n){if(n!==this.$A_4){this.$A_4=n;this.makeDirty("AdminUserName");this.makeDirty("AdminPassword");this.raisePropertyChanged("AdminEdited")}return n}};function MigrationBatchAutoDiscoverStepViewModel(){MigrationBatchAutoDiscoverStepViewModel.initializeBase(this)}MigrationBatchAutoDiscoverStepViewModel.prototype={handleResults:function(n){WebServiceWizardStepViewModel.prototype.handleResults.call(this,n);if(n&&_PowerShellResults.hasError(n)){this.setValue("_IsFailed",!0);this.setValue("_ErrorDetail",n.ErrorRecords[0].Message);n.ErrorRecords=new Array(0)}else if(n&&_PowerShellResults.hasOutput(n)){var t=n.Output[0];this.setValue("_IsFailed",t.IsFailed);if(t.IsFailed)this.setValue("_ErrorDetail",t.Message);else{this.setValue("_ExchangeServer",t.IncomingExchangeServer);this.setValue("_RpcProxyServer",t.IncomingRPCProxyServer);this.setValue("_Authentication",t.IncomingAuthentication);this.setValue("ExchangeServer",t.IncomingExchangeServer);this.setValue("RpcProxyServer",t.IncomingRPCProxyServer);this.setValue("Authentication",t.IncomingAuthentication);this.setValue("MailboxPermission",t.HasAdminPrivilege?"Admin":"FullAccess");this.setValue("RemoteServer",t.IncomingRPCProxyServer)}}else{this.setValue("_IsFailed",!0);this.setValue("_ErrorDetail",null)}}};function MigrationBatchImapConfigurationStepViewModel(){MigrationBatchImapConfigurationStepViewModel.initializeBase(this)}MigrationBatchImapConfigurationStepViewModel.prototype={onActive:function(){WizardStepViewModel.prototype.onActive.call(this);this.getValue("Authentication")||this.setValue("Authentication","Basic");this.get_Security()||this.set_Security("Ssl")},get_Security:function(){return this.getValue("Security")},set_Security:function(n){if(this.get_Security()!==n){this.setValue("Security",n);this.setValue("Port",n==="Ssl"?"993":"143")}return n}};function MigrationBatchSelectMailboxStepViewModel(){MigrationBatchSelectMailboxStepViewModel.initializeBase(this)}MigrationBatchSelectMailboxStepViewModel.prototype={onActive:function(){WizardStepViewModel.prototype.onActive.call(this);var n=this.get_parentViewModel();n.$0_5&&n.get_MigrationBatchType()!==this.getValue("_UploadedCsvType")&&n.set_UploadedCsv(null)}};function MigrationBatchServerConfigurationStepViewModel(){MigrationBatchServerConfigurationStepViewModel.initializeBase(this)}MigrationBatchServerConfigurationStepViewModel.prototype={onNext:function(){var n=this.$Q_5();this.setValue("UseAutoDiscover",n);var t=this.getValue("SkipVerification");if(n||t)this.onNextCompleted(new GoNextStepCompletedEventArgs(!1,this.get_NextViewModelID()));else WebServiceWizardStepViewModel.prototype.onNext.call(this)},$Q_5:function(){var n=!1;if(this.getValue("IsExchangeRemoteEndpoint")||this.getValue("IsOutlookAnywhereEndpoint")){var i=this.getValue("_ExchangeServer");var t=this.getValue("_RpcProxyServer");var r=this.getValue("_Authentication");n=this.getValue("ExchangeServer")===i&&this.getValue("RpcProxyServer")===t&&this.getValue("RemoteServer")===t&&this.getValue("Authentication")===r}return n},handleResults:function(n){if(n&&(!n.ErrorRecords||!n.ErrorRecords.length)&&n.Output&&n.Output.length>0){var t=n.Output[0];if(t.IsFailed){var i={};i.Message=t.Message;n.ErrorRecords=[i]}}WebServiceWizardStepViewModel.prototype.handleResults.call(this,n)}};function MigrationEndpointTypeStepViewModel(){MigrationEndpointTypeStepViewModel.initializeBase(this)}MigrationEndpointTypeStepViewModel.prototype={onNext:function(){this.set_NextViewModelID(this.getValue("IsIMAPEndpoint")?"IMAPConfiguration":"EnterWindowsCredential");WizardStepViewModel.prototype.onNext.call(this)}};function NewMigrationBatchViewModel(){this.$7_5=["UseAutoDiscover","EmailAddress","AdminUserName","AdminPassword","RemoteServer","ExchangeServer","RpcProxyServer","Port","MaxConcurrentMigrations","Authentication","MailboxPermission","Security"];this.$M_5=new RequiredFieldValidator(new ValidatorInfo);NewMigrationBatchViewModel.initializeBase(this);this.addPropertyMapping("UploadedCsv","CsvContent")}NewMigrationBatchViewModel.prototype={$3_5:!1,$0_5:null,$G_5:!0,$4_5:!1,get_CsvFileName:function(){return this.getValue("_CsvFileName")},set_CsvFileName:function(n){this.setValue("_CsvFileName",n);n&&this.$G_5&&this.setValue("Name",n.indexOf(".")>0?n.substring(0,n.lastIndexOf(".")):n);return n},get_Name:function(){return this.getValue("Name")},set_Name:function(n){if(this.get_Name()!==n){this.$G_5=!1;this.setValue("Name",n)}return n},get_AllowArchiveOption:function(){return EcpProfile.get_instance().get_AllowMailboxArchiveOnlyMigration()?this.get_IsLocalMoveOrOffboarding()||EcpProfile.get_instance().get_IsDataCenter()&&this.get_IsOnboarding()&&this.get_IsRemoteMove():!1},get_AllowTargetDatabase:function(){return!EcpProfile.get_instance().get_IsCrossPremiseMigration()||this.get_IsOffboarding()},get_AllowBatchMoreOption:function(){return this.get_IsRemoteMove()||this.get_IsLocalMove()||this.get_IsIMAP()},get_IsMove:function(){return this.get_IsRemoteMove()||this.get_IsLocalMove()},get_IsCrossForestMove:function(){return this.get_IsRemoteMove()&&!EcpProfile.get_instance().get_IsDataCenter()},get_NeedManualPrepareMailbox:function(){return this.get_IsCrossForestMove()&&this.get_UseCsv()},get_CanStartAfter:function(){return this.get_IsRemoteMove()||this.get_IsLocalMove()||this.getValue("IsOutlookAnywhereEndpoint")},get_CanAutoComplete:function(){return this.get_IsRemoteMove()||this.get_IsLocalMove()},get_IsLocalMoveOrOnboarding:function(){return this.get_IsLocalMove()||this.get_IsOnboarding()},get_IsLocalMoveOrOffboarding:function(){return this.get_IsLocalMove()||this.get_IsOffboarding()},get_IsLocalMove:function(){return this.getValue("IsLocalMove")},set_IsLocalMove:function(n){this.setValue("IsLocalMove",n);return n},get_IsOnboarding:function(){return this.getValue("IsOnboarding")},set_IsOnboarding:function(n){this.setValue("IsOnboarding",n);return n},get_IsOffboarding:function(){return this.getValue("IsOffboarding")},set_IsOffboarding:function(n){this.setValue("IsOffboarding",n);return n},get_UploadedCsv:function(){return this.$0_5},set_UploadedCsv:function(n){if(this.$0_5!==n){this.$0_5=n;if(this.$0_5&&this.$0_5.MailboxCount){this.setValue("CsvContent",this.$0_5.FileContent);this.setValue("_UploadedCsvType",this.get_MigrationBatchType())}else{this.setValue("CsvContent",null);this.setValue("_UploadedCsvType",null)}this.raisePropertyChanged("UploadedCsv");this.$E_5()}return n},get_SupportMailboxPicker:function(){return!this.$3_5&&(this.get_MigrationBatchType()==="RemoteMove"||this.get_MigrationBatchType()==="LocalMove")},get_IsNewEndpoint:function(){return this.getValue("IsNewEndpoint")},set_IsNewEndpoint:function(n){this.setValue("IsNewEndpoint",n);return n},get_IsIMAP:function(){return this.get_MigrationBatchType()==="IMAP"},get_IsRemoteMove:function(){return this.get_MigrationBatchType()==="RemoteMove"},get_ManualStart:function(){return this.getValue("ManualStart")},set_ManualStart:function(n){this.setValue("ManualStart",n);return n},get_ManualComplete:function(){return this.getValue("ManualComplete")},set_ManualComplete:function(n){this.setValue("ManualComplete",n);return n},get_ScheduledStart:function(){return this.getValue("ScheduledStart")},set_ScheduledStart:function(n){this.setValue("ScheduledStart",n);if(n&&this.getValue("ManualComplete")){this.setValue("ScheduledComplete",!0);this.setValue("ManualComplete",!1)}return n},get_ScheduledComplete:function(){return this.getValue("ScheduledComplete")},set_ScheduledComplete:function(n){this.setValue("ScheduledComplete",n);return n},get_MailboxPickerUrl:function(){return this.get_IsLocalMove()?EcpUrl.get_ecpVDir()+"/Pickers/ArbitrationMailboxPicker.aspx":this.get_IsOffboarding()?EcpUrl.get_ecpVDir()+"/Pickers/MailboxPicker.aspx":EcpUrl.get_ecpVDir()+"/Pickers/MailUserPicker.aspx"},get_Mailboxes:function(){return this.getValue("Mailboxes")},set_Mailboxes:function(n){this.setValue("Mailboxes",n);this.$E_5();this.$M_5.validate(n);return n},get_MigrationEndpoint:function(){return this.getValue("MigrationEndpoint")},set_MigrationEndpoint:function(n){if(this.get_MigrationEndpoint()!==n){this.setValue("MigrationEndpoint",n);this.setValue("Endpoint",n?n.Identity:null);if(n){this.set_IsNewEndpoint(!1);this.setValue("ExchangeServer",n.ExchangeServer);this.setValue("RpcProxyServer",n.RpcProxyServer);this.setValue("RemoteServer",n.RemoteServer);this.setValue("Port",n.Port);this.setValue("Authentication",n.Authentication);this.setValue("MailboxPermission",n.MailboxPermission);this.setValue("Security",n.Security);this.setValue("_IsFailed",!1)}else{this.set_IsNewEndpoint(!0);this.setValue("ExchangeServer",null);this.setValue("RpcProxyServer",null);this.setValue("RemoteServer",null);this.setValue("Port",null)}}return n},get_MigrationBatchType:function(){return this.getValue("MigrationBatchType")},set_MigrationBatchType:function(n){if(this.get_MigrationBatchType()!==n){this.setValue("MigrationBatchType",n);this.setValue("IsExchangeRemoteEndpoint",!1);this.setValue("IsOutlookAnywhereEndpoint",!1);this.setValue("IsIMAPEndpoint",!1);switch(n){case"LocalMove":break;case"RemoteMove":this.setValue("IsExchangeRemoteEndpoint",!0);break;case"Cutover":this.set_UploadedCsv(null);this.setValue("Mailboxes",null);this.setValue("IsOutlookAnywhereEndpoint",!0);break;case"Staged":this.setValue("IsOutlookAnywhereEndpoint",!0);break;case"IMAP":this.setValue("IsIMAPEndpoint",!0);break;default:break}this.setValue("_HideEmailAddress",n!=="Cutover");this.raisePropertyChanged("SupportMailboxPicker");this.raisePropertyChanged("MailboxPickerUrl");this.raisePropertyChanged("IsRemoteMove");this.raisePropertyChanged("IsMove");this.raisePropertyChanged("IsIMAP");this.raisePropertyChanged("IsCrossForestMove");this.raisePropertyChanged("AllowArchiveOption");this.raisePropertyChanged("AllowBatchMoreOption");this.raisePropertyChanged("CanStartAfter");this.raisePropertyChanged("CanAutoComplete");this.raisePropertyChanged("NeedManualPrepareMailbox");this.set_UseCsv(!this.get_SupportMailboxPicker()&&!this.$3_5);this.$T_5()}return n},get_valuesToSave:function(){for(var t=PropertyPageViewModel.prototype.get_valuesToSave.call(this),n=0;n<this.$7_5.length;n++)delete t[this.$7_5[n]];return t},get_UseCsv:function(){return this.getValue("UseCsv")},set_UseCsv:function(n){this.get_UseCsv()!==n&&this.setValue("UseCsv",n);this.$E_5();this.raisePropertyChanged("NeedManualPrepareMailbox");return n},get_$F_5:function(){var n=this.getValue("_AllMigrationEndpoints");if(!n){n=new Array(0);this.setValue("_AllMigrationEndpoints",n)}return n},initialize:function(){WizardViewModel.prototype.initialize.call(this);this.get_SaveCommand().get_webServiceMethod().set_ServiceUrl(EcpUrl.setUrlParameter(this.get_ServiceUrl(),"workflow",null));this.$3_5=EcpUrl.getUrlParameter(window.location.href,"mbxselected")==="1";this.set_UseCsv(!this.$3_5);if(this.$3_5){var n=this,t=this;PopupWindowManager.getPopupWindowArgumentsAsync(function(t){try{n.set_Mailboxes(Sys.Serialization.JavaScriptSerializer.deserialize(t,!0));n.resetIsDirty()}catch(i){n.$N_5()}},function(){t.$N_5()});this.$4_5=!0}this.$R_5()},$N_5:function(){var n=new Info;n.Message=EcpProfile.get_instance().get_IsDataCenter()?Strings.get_FailedToRetrieveMailboxOnboarding():Strings.get_FailedToRetrieveMailboxLocalMove();n.MessageType=MessageBoxType.error;var t=this;MessageBox.show(n,0,function(n,i){t.get_CancelCommand().execute()},null)},$R_5:function(){var n=EcpUrl.getUrlParameter(window.location.href,"migration");if(EcpProfile.get_instance().get_IsCrossPremiseMigration()){this.setValue("ManualComplete",!0);if(n==="offboarding"){this.setValue("IsOffboarding",!0);this.$4_5=!0;this.set_MigrationBatchType("RemoteMove");this.setValue("TargetDeliveryDomain",null)}else{this.setValue("IsOnboarding",!0);EcpProfile.get_instance().get_AllowRemoteOnboardingMovesOnly()&&(this.$4_5=!0);this.set_MigrationBatchType("RemoteMove")}}else if(n==="crossforest"){this.setValue("ManualComplete",!0);this.setValue("IsOnboarding",!0);this.$4_5=!0;this.set_MigrationBatchType("RemoteMove")}else{this.setValue("IsLocalMove",!0);this.$4_5=!0;this.set_MigrationBatchType("LocalMove")}this.raisePropertyChanged("IsLocalMoveOrOnboarding");this.raisePropertyChanged("IsLocalMoveOrOffboarding");this.raisePropertyChanged("AllowTargetDatabase")},saveConfirm:function(n,t){if(!this.get_IsLocalMove()&&this.get_IsNewEndpoint()){var i=this;var r=function(){i.set_ProgressText(Strings.get_SavingInformation());var r=new WebServiceMethod;r.set_ServiceUrl(EcpUrl.get_ecpFullUrl()+"DDI/DDIService.svc?schema=MigrationEndpoint");r.set_MethodName("NewObject");r.set_ParameterNames(3);r.add_Succeeded(function(n,t){var r=t.get_results();if(r.Output&&r.Output.length>0){i.set_MigrationEndpoint(r.Output[0]);var u=i.get_$F_5();Array.add(u,i.get_MigrationEndpoint());i.setValue("_AllMigrationEndpoints",u)}else r.ErrorRecords&&r.ErrorRecords.length>0&&ErrorHandling.showPowerShellErrors(r)});r.add_Completed(function(u,f){i.get_IsNewEndpoint()?t():n();r.dispose()});var u=i.getValues(i.$7_5);u.IsExchangeRemoteEndpoint=i.getValue("IsExchangeRemoteEndpoint");u.IsOutlookAnywhereEndpoint=i.getValue("IsOutlookAnywhereEndpoint");u.IsIMAPEndpoint=i.getValue("IsIMAPEndpoint");r.invokeWithArgs([u],null)};PropertyPageViewModel.prototype.saveConfirm.call(this,r,t)}else PropertyPageViewModel.prototype.saveConfirm.call(this,n,t)},$T_5:function(){this.$V_5();this.$W_5()},$J_5:function(){return this.getValue("IsExchangeRemoteEndpoint")?"ExchangeRemoteMove":this.getValue("IsOutlookAnywhereEndpoint")?"ExchangeOutlookAnywhere":this.getValue("IsIMAPEndpoint")?"IMAP":null},$V_5:function(){for(var r=this.$J_5(),i=this.get_$F_5(),n=[],t=0;t<i.length;t++)i[t].EndpointType===r&&Array.add(n,i[t]);this.setValue("_MigrationEndpoints",n);this.setValue("_IsFirstRun",!n.length);this.set_MigrationEndpoint(n.length>0?n[0]:null)},$W_5:function(){var n=this.$J_5()?this.getValue("IsIMAPEndpoint")?"IMAPConfiguration":this.get_MigrationEndpoint()?"ExchangeServerConfiguration":"EnterWindowsCredential":"MigrationConfiguration";if(!_Object.isNullOrUndefined(this.getValue("_MigrationEndpoints"))&&this.getValue("_MigrationEndpoints").length>1){this.findViewModelWithID("SelectMigrationEndpoint").set_NextViewModelID(n);n="SelectMigrationEndpoint"}if(this.$3_5||this.get_MigrationBatchType()==="Cutover")this.get_currentViewModel().set_NextViewModelID(n);else{this.get_currentViewModel().set_NextViewModelID("SelectTheMailboxes");this.findViewModelWithID("SelectTheMailboxes").set_NextViewModelID(n)}this.$4_5&&this.set_currentViewModel(this.findViewModelWithID(this.get_currentViewModel().get_NextViewModelID()))},$E_5:function(){if(this.get_UseCsv()){this.setValue("_MailboxCount",this.$0_5?this.$0_5.MailboxCount:0);this.setValue("EmailAddress",this.$0_5?this.$0_5.FirstSmtpAddress:null)}else{this.setValue("_MailboxCount",this.get_Mailboxes()?this.get_Mailboxes().length:0);this.setValue("EmailAddress",this.get_Mailboxes()&&this.get_Mailboxes().length>0?this.get_Mailboxes()[0]:null)}}};function NewMigrationEndpointViewModel(){NewMigrationEndpointViewModel.initializeBase(this)}NewMigrationEndpointViewModel.prototype={initialize:function(){WizardViewModel.prototype.initialize.call(this);this.setValue("IsNewEndpoint",!0);this.setValue("IsExchangeRemoteEndpoint",!0)}};function ViewMigrationBatchDetailsViewModel(){ViewMigrationBatchDetailsViewModel.initializeBase(this)}ViewMigrationBatchDetailsViewModel.prototype={get_SyncedMailboxText:function(){return Strings.SyncedMailboxText(this.getValue("SyncedCount"),this.getValue("TotalCount"))},get_FinalizedMailboxText:function(){return Strings.FinalizedMailboxText(this.getValue("FinalizedCount"),this.getValue("TotalCount"))}};EnableArchiveMailboxViewModel.registerClass("EnableArchiveMailboxViewModel",PopupFormViewModel);EditArchiveMailboxViewModel.registerClass("EditArchiveMailboxViewModel",PopupFormViewModel);ArchiveNameConverter.registerClass("ArchiveNameConverter",null,IValueConverter);NewMailboxProperties.registerClass("NewMailboxProperties",PropertyPage);RecipientsGlobals.registerClass("RecipientsGlobals");EditMigrationBatchViewModel.registerClass("EditMigrationBatchViewModel",PropertyPageViewModel);EditMigrationEndpointViewModel.registerClass("EditMigrationEndpointViewModel",PropertyPageViewModel);MigrationBatchAutoDiscoverStepViewModel.registerClass("MigrationBatchAutoDiscoverStepViewModel",WebServiceWizardStepViewModel);MigrationBatchAutoDiscoverStepViewModel.prototype.toString=WizardStepViewModel.prototype.toString;MigrationBatchServerConfigurationStepViewModel.registerClass("MigrationBatchServerConfigurationStepViewModel",WebServiceWizardStepViewModel);MigrationBatchServerConfigurationStepViewModel.prototype.toString=WizardStepViewModel.prototype.toString;MigrationBatchImapConfigurationStepViewModel.registerClass("MigrationBatchImapConfigurationStepViewModel",MigrationBatchServerConfigurationStepViewModel);MigrationBatchImapConfigurationStepViewModel.prototype.toString=WizardStepViewModel.prototype.toString;MigrationBatchSelectMailboxStepViewModel.registerClass("MigrationBatchSelectMailboxStepViewModel",WizardStepViewModel);MigrationBatchSelectMailboxStepViewModel.prototype.toString=WizardStepViewModel.prototype.toString;MigrationEndpointTypeStepViewModel.registerClass("MigrationEndpointTypeStepViewModel",WizardStepViewModel);MigrationEndpointTypeStepViewModel.prototype.toString=WizardStepViewModel.prototype.toString;NewMigrationBatchViewModel.registerClass("NewMigrationBatchViewModel",WizardViewModel);NewMigrationEndpointViewModel.registerClass("NewMigrationEndpointViewModel",WizardViewModel);ViewMigrationBatchDetailsViewModel.registerClass("ViewMigrationBatchDetailsViewModel",SDOViewModel);NewMailboxProperties.$H=["Microsoft.Exchange.Management.Tasks.NameNotAvailableException","Microsoft.Exchange.DatacenterStrings.IDSInternalException","Microsoft.Exchange.Management.Tasks.WLCDManagedMemberExistsException","Microsoft.Exchange.Configuration.ObjectModel.PropertyValueExistsException"];NewMigrationBatchViewModel.selectMailboxesStepId="SelectTheMailboxes";NewMigrationBatchViewModel.selectMigrationEndpointStepId="SelectMigrationEndpoint";NewMigrationBatchViewModel.enterWindowsCredentialStepId="EnterWindowsCredential";NewMigrationBatchViewModel.exchangeServerConfigurationStepId="ExchangeServerConfiguration";NewMigrationBatchViewModel.migrationConfigurationStepId="MigrationConfiguration";NewMigrationBatchViewModel.migrationTypeLocalMove="LocalMove";NewMigrationBatchViewModel.migrationTypeRemoteMove="RemoteMove";NewMigrationBatchViewModel.migrationTypeStaged="Staged";NewMigrationBatchViewModel.migrationTypeCutover="Cutover";NewMigrationBatchViewModel.migrationTypeImap="IMAP";NewMigrationBatchViewModel.imapConfigurationStepId="IMAPConfiguration"