Type.registerNamespace("ECP");function CheckDataLossContext(n,t,i,r){this.targetId=n;this.isLink=t;this.slabId=i;this.selectedItemId=r}var DualLogoutStep=function(){};DualLogoutStep.prototype={notStarted:0,logoutOnPremises:1,logoutCloud:2};DualLogoutStep.registerEnum("DualLogoutStep",!1);var OrganizationType=function(){};OrganizationType.prototype={onPremise:0,cloud:1};OrganizationType.registerEnum("OrganizationType",!1);var MessageType=function(){};MessageType.prototype={initialMessage:0,acknowledge:1,answer:2,reject:3,maxValueV1:3};MessageType.registerEnum("MessageType",!1);var ICrossWindowDataV1=function(){};ICrossWindowDataV1.registerInterface("ICrossWindowDataV1");var NavBarMainLinkID=function(){};NavBarMainLinkID.prototype={none:0,outlook:1,sharepoint:2,CRM:3,home:4,admin:5,partner:6};NavBarMainLinkID.registerEnum("NavBarMainLinkID",!1);function NavigationDialogContext(n,t,i,r){this.targetNode=n;this.targetID=t;this.source=i;this.additionalData=r}var INotificationAdapter=function(){};INotificationAdapter.registerInterface("INotificationAdapter");var INotificationIconCallback=function(){};INotificationIconCallback.registerInterface("INotificationIconCallback");var INotificationProviderCallback=function(){};INotificationProviderCallback.registerInterface("INotificationProviderCallback");var IWindowFactory=function(){};IWindowFactory.registerInterface("IWindowFactory");function CheckDataLossAnswer(n){this.userSelectContinue=n}CheckDataLossAnswer.prototype={userSelectContinue:!1};function CheckActionAvailableData(n,t,i){this.action=n;this.supported=t;this.enabled=i}CheckActionAvailableData.createCheckActionAvailableAnswerMessage=function(n,t){var i=n.dataV1.action;var r=new CheckActionAvailableData(i,i<=37,t);return new CrossWindowMessage(n.action,r,n.id,2)};CheckActionAvailableData.prototype={action:0,supported:!1,enabled:!1};function ClientRbac(){}ClientRbac.prototype={rbacDataOnCurrentPremise:null,rbacDataOnOtherPremise:null,$3S_0:!1,isInRole:function(n,t){var i=!1;var f=t?this.rbacDataOnCurrentPremise:this.rbacDataOnOtherPremise;if(f)for(var e=n.split(","),r=0;r<e.length;r++){for(var o=!0,s=e[r].split("+"),u=0;u<s.length;u++){var h=s[u];if(!f[h]){o=!1;break}}if(o){i=!0;break}}else i=!1;return i}};function CmdletLoggingNavHelper(){}CmdletLoggingNavHelper.OpenCmdletLoggingWindow=function(n,t){var i="cmdletlogging/cmdletlogging.aspx";t&&(i=EcpUrl.setUrlParameter(i,"cmdletloggingtitle",t));var r=BuildCenteredWindowFeatureString(700,550,GlobalVariables.FeaturesForPopups);PopupWindowManager.get_popupManager().showPopupWindow(i,n,r,null,!0,!1,"",null)};function HybridCmdletLoggingCommandHandler(){this.$$d_$2x_0=Function.createDelegate(this,this.$2x_0)}HybridCmdletLoggingCommandHandler.prototype={$2M_0:!1,$2L_0:!1,$1O_0:null,click:function(){var n=CrossPremise.get_instance();n.$O_1==="enterprise"?CrossPremise.NavTo("showEnterpriseCmdletLogging",!1):CrossPremise.NavTo("showOffice365CmdletLogging",!1)},initialize:function(n){this.$1O_0=n;n.set_visible(!1);var t=CrossPremise.get_instance();if(t){var i=this;CrossPremiseSyncer.get_instance().add_syncDataReceived(function(n,r){r.orgType?r.orgType===1&&(i.$2L_0=r.data.cmdletLoggingEnabled):i.$2M_0=_Object.isNullOrUndefined(r.data.cmdletLoggingEnabled)?!1:r.data.cmdletLoggingEnabled;i.$2x_0(t,null)});t.add_topNavSelectionChanged(this.$$d_$2x_0)}},$2x_0:function(n,t){var i=n;i.$O_1==="enterprise"&&this.$2M_0||i.$O_1==="office365"&&this.$2L_0?this.$1O_0.set_visible(!0):this.$1O_0.set_visible(!1)}};function CrossPremise(){this.$$d_$2X_1=Function.createDelegate(this,this.$2X_1);this.$$d_$3r_1=Function.createDelegate(this,this.$3r_1);this.$$d_$3s_1=Function.createDelegate(this,this.$3s_1);this.$X_1=0;CrossPremise.initializeBase(this);window.self.crossPremise=this;this.$1u_1=$get("topNavMask")}CrossPremise.get_instance=function(){CrossPremise.$2||(CrossPremise.$2=CrossPremise.$1W(window.self));return CrossPremise.$2};CrossPremise.$1W=function(n){var t=null;if(n)try{t=n.crossPremise;if(t)return t;t=CrossPremise.$1W(_Window.getOpener(n));if(t)return t;if(n.parent!==n){t=CrossPremise.$1W(n.parent);if(t)return t}if(window.dialogArguments){t=window.dialogArguments.crossPremise;if(t)return t}}catch(i){}return t};CrossPremise.NavTo=function(n,t,i,r){var u=CrossPremise.get_instance();return u?u.$2U_1(n,t,i,r):!0};CrossPremise.prototype={$x_1:null,$1A_1:null,$1i_1:null,$G_1:!1,$1j_1:null,$2G_1:!1,$1z_1:null,$1B_1:null,$g_1:null,$28_1:null,$1a_1:!1,$2F_1:!1,$O_1:null,$D_1:null,$1u_1:null,$0_1:null,$A_1:null,passCtrlF6ToCurrentIFrame:function(n){this.$0_1.postMessage(new CrossWindowMessage(n?29:28),this.$G_1?0:1)},$2U_1:function(n,t,i,r){if(n==="helpdesk"||n==="showOffice365Perfconsole"||n==="showEnterprisePerfconsole"||n==="showOffice365CmdletLogging"||n==="showEnterpriseCmdletLogging")return this.$1l_1(n,t,i,r);else{var u=this.$O_1!=="office365";var f=this,e=this;this.$6_1(new CrossWindowMessage(10),u?0:1,function(n,t){var r=n.dataV1;if(r.userSelectContinue){var i=t;f.$1l_1(i.targetId,i.isLink,i.slabId,i.selectedItemId)}},function(n,t){var i=t;e.$1l_1(i.targetId,i.isLink,i.slabId,i.selectedItemId)},null,new CheckDataLossContext(n,t,i,r))}return!1},$1l_1:function(n,t,i,r){var u=!1;var e=!1;var f=0;var o=null;switch(n){case"enterprise":case"office365":this.set_selectedTopNavId(n);e=u=n==="enterprise";f=3;break;case"helpdesk":if(this.$1a_1||this.$2F_1){u=this.$1a_1;e=this.$G_1;f=5;if(u){o=new CrossWindowNavigation;o.cloudHost=window.self.location.hostname}}break;case"showOffice365Perfconsole":case"showEnterprisePerfconsole":u=n==="showEnterprisePerfconsole";break;case"showOffice365CmdletLogging":case"showEnterpriseCmdletLogging":u=n==="showEnterpriseCmdletLogging";break}if(t)window.location.href=n;else if(n==="dualLogout")this.$3C_1();else if(n==="showEnterprisePerfconsole"||n==="showOffice365Perfconsole")this.$6_1(new CrossWindowMessage(12),u?0:1);else if(n==="showEnterpriseCmdletLogging"||n==="showOffice365CmdletLogging")this.$6_1(new CrossWindowMessage(37),u?0:1);else if(f){this.$49_1(e);this.$6_1(new CrossWindowMessage(f,o),u?0:1);if(i){var s=new CrossWindowSwitchSlabData;s.slabId=i;s.selectedItemId=r;this.$6_1(new CrossWindowMessage(25,s),u?0:1)}}return!1},$6_1:function(n,t,i,r,u,f){this.$0_1&&this.$0_1.postMessage(n,t,i,r,u,f)},$3C_1:function(){var n=new CrossPremise.LogoutDataContext;n.tryTime=0;n.acknowledged=!1;this.$1k_1(n)},$1k_1:function(n){this.$X_1=1;this.$0_1.postMessage(new CrossWindowMessage(11),0,this.$$d_$3s_1,this.$$d_$3r_1,null,n);this.$0_1.postMessage(new CrossWindowMessage(31),2)},$3s_1:function(n,t){t.acknowledged=!0;var i=this;window.setTimeout(function(){i.$1k_1(t)},300)},$3r_1:function(n,t){var i=t;if(!this.$2G_1&&i.acknowledged)this.$2Q_1();else if(i.tryTime<3){i.tryTime++;var u=this;window.setTimeout(function(){u.$1k_1(i)},0)}else if(this.$X_1===1){this.$0_1.postMessage(new CrossWindowMessage(32),2);this.$X_1=0;var r=new Info;r.MessageType=MessageBoxType.error;r.Message=Strings.get_EnterpriseLogoutFail();MessageBox.show(r,4,null,null)}},$2Q_1:function(){this.$X_1=2;window.location.href=EcpUrl.logoffLink},get_Feature:function(){return this.$28_1},set_Feature:function(n){this.$28_1=n;this.$3z_1(n);return n},get_OnPremiseFrameVisible:function(){return this.$G_1},set_OnPremiseFrameVisible:function(n){this.$G_1=n;return n},get_LogoutHelperPage:function(){return this.$1j_1},set_LogoutHelperPage:function(n){this.$1j_1=n;return n},$3z_1:function(n){if(n){var t=n.split("-");if(t.length===2){this.$1a_1=t[0].length>1&&t[0].charAt(1)==="1";this.$2F_1=t[1].length>1&&t[1].charAt(1)==="1"}}},initialize:function(){Sys.Component.prototype.initialize.call(this);this.$x_1=$get("cloud");this.$1A_1=$get("onprem");this.$1i_1=$get("logouthelper");this.$1z_1=UrlUtil.getParameter("xprs").toLowerCase();this.$1B_1="https://"+this.$1z_1;this.$g_1="https://"+window.self.location.hostname.toLowerCase();this.$0_1=new CrossWindowMessenger(window.self);this.$0_1.add_received(this.$$d_$2X_1);this.$0_1.set_crossDomainServer(this.$1z_1);this.$0_1.addTarget(new IFrameWindowFactory(this.$1A_1),this.$1B_1);this.$0_1.addTarget(new IFrameWindowFactory(this.$x_1),this.$g_1);this.$0_1.addTarget(new IFrameWindowFactory(this.$1i_1),this.$1B_1);var n=this;CrossPremiseSyncer.get_instance().add_syncDataReceived(function(t,i){n.$G_1===!i.orgType&&n.set_selectedTopNavId(n.$G_1?"enterprise":"office365")});this.$A_1=new TopPageNotificationAdapter(new CrossWindowNotificationCallback(this.$0_1));var t=this;window.setTimeout(function(){t.$6_1(new CrossWindowMessage(30),0);t.$6_1(new CrossWindowMessage(30),1)},0)},dispose:function(){window.self.crossPremise=null;this.$0_1.dispose();Sys.Component.prototype.dispose.call(this)},add_topNavSelectionChanged:function(n){this.get_events().addHandler("TopNavSelectionChanged",n)},remove_topNavSelectionChanged:function(n){this.get_events().removeHandler("TopNavSelectionChanged",n)},get_selectedTopNavId:function(){return this.$O_1},set_selectedTopNavId:function(n){if(this.$O_1!==n){this.$O_1=n;this.$1x_1()}return n},$1x_1:function(){if(!this.$D_1){this.$D_1=[];this.$29_1(this.$D_1,"enterprise");this.$29_1(this.$D_1,"office365")}for(var n=0;n<this.$D_1.length;n++){var t=this.$D_1[n];_DomElement.toggelCssClass(t,t.id===this.$O_1,"topNavSelected")}var i=this.get_events().getHandler("TopNavSelectionChanged");i&&i(this,Sys.EventArgs.Empty)},$29_1:function(n,t){var i=$get(t);i&&Array.add(n,i)},$49_1:function(n){if(n!==this.$G_1){if(n){this.$1A_1.style.display="";this.$x_1.style.display="none"}else{this.$1A_1.style.display="none";this.$x_1.style.display=""}this.$G_1=n;var t=this;window.setTimeout(function(){t.$6_1(new CrossWindowMessage(35,null),n?1:0);t.$6_1(new CrossWindowMessage(16,null),n?0:1)},0)}},$2X_1:function(n){var t=n.message;var i=n.origin.toLowerCase()===this.$1B_1;switch(t.action){case 1:var o=t.dataV1;CrossPremiseSyncer.get_instance().updateValue(o,i);n.set_replyMessage(CrossWindowMessage.createAnswerMessage(t,null));if(CrossPremiseSyncer.get_instance().get_bothSynced()){this.$6_1(new CrossWindowMessage(17,CrossPremiseSyncer.get_instance().get_cloudSyncData()),0);this.$6_1(new CrossWindowMessage(17,CrossPremiseSyncer.get_instance().get_onPremiseSyncData()),1);this.$1i_1.src=this.$1j_1}break;case 8:this.$G_1&&(this.$1u_1.style.display="block");break;case 9:this.$1u_1.style.display="none";break;case 13:var u="";var f="";var r=t.dataV1;i?u=r.pageId:f=r.pageId;this.$43_1(u,f,r.languageOverriden);break;case 15:if(i===this.$G_1){document.title=t.dataV1.pageTitle;NavigationNotification.notify(t.dataV1)}break;case 25:var e=t.dataV1;this.$2U_1(i?"office365":"enterprise",!1,e.slabId,e.selectedItemId);break;case 36:case 18:case 19:case 20:case 27:case 26:var s=this,h=this;this.$6_1(t,i?1:0,function(n,t){s.$6_1(n,i?0:1)},null,function(n,t){h.$6_1(n,i?0:1)},null);break;case 22:this.$A_1.showNotificationCount(t.dataV1.results,i);break;case 21:this.$A_1.showNotificationFlyout(t.dataV1.idToSelect);break;case 24:this.$A_1.showNotificationDetail(t.dataV1.results,i);break;case 28:AccUtil.handleCtrlF6Key(null,!1);break;case 29:AccUtil.handleCtrlF6Key(null,!0);break;case 33:this.$X_1===1&&this.$2Q_1();break;case 34:this.$2G_1=!0;break;default:break}},$43_1:function(n,t,i){var u=EcpUtil.isNullOrEmpty(n)?0:1;var r=new CrossPremiseUrl(window.location.href);r.set_isOnPremiseFrameVisible(this.$G_1);r.set_languageOverriden(i);r.set_onPremisePage(n);r.set_cloudPage(t);var f=this,e=this;this.$0_1.postMessage(new CrossWindowMessage(14),u,function(n,t){var i=n.dataV1;u?r.set_cloudPage(i.pageId):r.set_onPremisePage(i.pageId);window.location.href=r.toString()},function(n,t){window.location.href=r.toString()},null,null)}};CrossPremise.LogoutDataContext=function(){};function CrossPremiseUrl(n){this.$B_0={};if(EcpUtil.isNullOrEmpty(n))throw Error.argumentNull("baseUrl");this.$2c_0=UrlUtil.getUrlWithoutQueryString(n);this.$B_0=UrlUtil.getQueries(n)}CrossPremiseUrl.prototype={$2c_0:null,get_onPremisePage:function(){return this.$B_0[EcpUrl.onPremiseStartPageParam]},set_onPremisePage:function(n){this.$B_0[EcpUrl.onPremiseStartPageParam]=n;return n},get_cloudPage:function(){return this.$B_0[EcpUrl.cloudStartPageParam]},set_cloudPage:function(n){this.$B_0[EcpUrl.cloudStartPageParam]=n;return n},get_languageOverriden:function(){return this.$B_0[EcpUrl.languageOverridenParam]},set_languageOverriden:function(n){this.$B_0[EcpUrl.languageOverridenParam]=n;return n},get_languageOverridenCandidate:function(){return this.$B_0[EcpUrl.languageOverridenCandidateParam]},set_languageOverridenCandidate:function(n){this.$B_0[EcpUrl.languageOverridenCandidateParam]=n;return n},get_isOnPremiseFrameVisible:function(){return this.$B_0[EcpUrl.onPremiseVisibleParam]==="1"},set_isOnPremiseFrameVisible:function(n){this.$B_0[EcpUrl.onPremiseVisibleParam]=n?"1":"";return n},toString:function(){var n=new Sys.StringBuilder(this.$2c_0);var i=!0;var r=this.$B_0;for(var u in r){var t={key:u,value:r[u]};n.append(i?"?":"&");n.append(t.key);n.append("=");EcpUtil.isNullOrEmpty(t.value)||n.append(t.value);i=!1}return n.toString()}};function SyncDataReceivedEventArgs(){SyncDataReceivedEventArgs.initializeBase(this)}SyncDataReceivedEventArgs.prototype={data:null,orgType:0};function CrossPremiseSyncer(){this.$z_0=new Array(2);this.$1J_0=[!1,!1];this.$E_0=new Sys.EventHandlerList}CrossPremiseSyncer.get_instance=function(){CrossPremiseSyncer.$2||(CrossPremiseSyncer.$2=new CrossPremiseSyncer);return CrossPremiseSyncer.$2};CrossPremiseSyncer.prototype={get_bothSynced:function(){return this.$1J_0[0]&&this.$1J_0[1]},get_onPremiseSyncData:function(){return this.$z_0[0]},get_cloudSyncData:function(){return this.$z_0[1]},add_syncDataReceived:function(n){this.$E_0.addHandler("SyncDataReceived",n)},remove_syncDataReceived:function(n){this.$E_0.removeHandler("SyncDataReceived",n)},$3i_0:function(n){var t=this.$E_0.getHandler("SyncDataReceived");t&&t(this,n)},updateValue:function(n,t){var r=t?0:1;this.$z_0[r]=n;this.$1J_0[r]=!0;var i=new SyncDataReceivedEventArgs;i.orgType=t?0:1;i.data=n;this.$3i_0(i)}};function CrossWindowMessage(n,t,i,r){this.action=n;this.dataV1=t?t:null;this.id=++CrossWindowMessage.$1R;this.replyId=i?i:0;this.type=r?r:0}CrossWindowMessage.$3Q=function(n){CrossWindowMessage.$1R+=n};CrossWindowMessage.createAcknowledgeMessage=function(n,t){return new CrossWindowMessage(n.action,t,n.id,1)};CrossWindowMessage.createRejectMessage=function(n,t){return new CrossWindowMessage(n.action,t,n.id,3)};CrossWindowMessage.createAnswerMessage=function(n,t){return new CrossWindowMessage(n.action,t,n.id,2)};CrossWindowMessage.fromJsonString=function(n){var t=Sys.Serialization.JavaScriptSerializer.deserialize(n,!0);(_Object.isUndefined(t.action)||_Object.isUndefined(t.id))&&(t=null);return t};CrossWindowMessage.toJsonString=function(n){return Sys.Serialization.JavaScriptSerializer.serialize(n)};CrossWindowMessage.toString=function(n){return"["+n.id+"]["+CrossWindowMessage.$3I(n.type)+"]["+CrossWindowMessage.$3E(n.action)+"] "+CrossWindowMessage.toJsonString(n)};CrossWindowMessage.$3E=function(n){var t=null;n>=0&&n<=37&&(t=CrossWindowAction.toString(n));return t};CrossWindowMessage.$3I=function(n){var t=null;n>=0&&n<=3&&(t=MessageType.toString(n));return t};CrossWindowMessage.prototype={type:0,action:0,dataV1:null,id:0,replyId:0,retry:0};function CrossWindowMessenger(n){this.$$d_$40_0=Function.createDelegate(this,this.$40_0);this.$E_0=new Sys.EventHandlerList;this.$T_0=[];this.$1L_0=[];this.$v_0={};this.$1M_0={};this.$1D_0={};this.$W_0={};this.$F_0=[];this.$e_0=n;this.$n_0=this.$$d_$40_0;$addHandler(this.$e_0,"message",this.$n_0)}CrossWindowMessenger.prototype={$e_0:null,$n_0:null,$1P_0:0,$y_0:null,$23_0:null,$24_0:null,$1C_0:null,$1y_0:null,dispose:function(){if(this.$n_0){$removeHandler(this.$e_0,"message",this.$n_0);this.$n_0=null}},add_received:function(n){this.$E_0.addHandler("Received",n)},remove_received:function(n){this.$E_0.removeHandler("Received",n)},add_postMessageFailed:function(n){this.$E_0.addHandler("PostMessageFailed",n)},remove_postMessageFailed:function(n){this.$E_0.removeHandler("PostMessageFailed",n)},get_crossDomainServer:function(){return this.$y_0},set_crossDomainServer:function(n){n&&(n=n.toLowerCase());this.$y_0=n;this.$23_0="https://"+n;this.$24_0="."+n;var i=this.get_$4G_0();var t=0;switch(i){case"Hybrid":t=1e4;break;case"OnPrem":t=2e4;break;case"OnCloud":t=3e4;break;case"LogoutHelper":t=4e4;break}CrossWindowMessage.$3Q(t);return n},get_$4G_0:function(){this.$1y_0||(this.$1y_0=this.$e_0.location.pathname.toLowerCase().endsWith("hybrid.aspx")?"Hybrid":EcpProfile.get_instance().get_IsDataCenter()||this.$y_0===this.$e_0.location.hostname?"OnCloud":window.location.pathname.toLowerCase().endsWith("hybridlogouthelper.aspx")?"LogoutHelper":"OnPrem");return this.$1y_0},addTarget:function(n,t){Array.add(this.$1L_0,n);Array.add(this.$T_0,t)},postMessage:function(n,t,i,r,u,f){n.replyId||this.$4B_0(n,t,i,r,u,f);i&&(this.$v_0[n.id]=i);r&&(this.$1M_0[n.id]=r);u&&(this.$1D_0[n.id]=u);(i||r||u)&&(this.$W_0[n.id]=f);this.$T_0.length===1&&_Object.isUndefined(t)&&(t=0);if(t>=0&&t<this.$1L_0.length)this.$1L_0[t].getWindowInstance().postMessage(CrossWindowMessage.toJsonString(n),this.$T_0[t]);else throw Error.argumentOutOfRange("Index out of range: "+t+". Should be within [0, "+this.$T_0.length+").");},$4B_0:function(n,t,i,r,u,f){for(var o=!1,e=0;e<this.$F_0.length;e++)if(this.$F_0[e].message.id===n.id){o=!0;break}if(!o){var s=new MessageRecord(n,t,i,r,u,f);Array.enqueue(this.$F_0,s)}this.$2m_0()},$2m_0:function(){if(!this.$1P_0&&this.$F_0.length>0){var n=this;this.$1P_0=window.setTimeout(function(){n.$32_0()},113)}},$32_0:function(){for(var t=(new Date).getTime()-300;this.$F_0.length>0;){var n=this.$F_0[0];if(n.time<t){Array.dequeue(this.$F_0);if(n.message.retry<8){n.message.retry++;this.postMessage(n.message,n.targetIndex,n.answerCallback,n.timeoutCallback,n.rejectCallback,n.context)}else this.$3q_0(new PostMessageFailedEventArgs(n))}else break}this.$1P_0=0;this.$2m_0()},$3A_0:function(n){for(var t=0;t<this.$F_0.length;t++)if(this.$F_0[t].message.id===n){Array.removeAt(this.$F_0,t);break}},$3U_0:function(n){var t=!1;var i=n.rawEvent.origin;var r="https://"+this.$e_0.location.hostname;i===r?t=!0:this.$y_0&&(i===this.$23_0||i.endsWith(this.$24_0))&&(t=!0);t&&(t=this.$13_0(i)>=0);!t;return t},$40_0:function(n){if(this.$3U_0(n)){var t=CrossWindowMessage.fromJsonString(n.rawEvent.data);var i=n.rawEvent.origin;if(this.$3T_0(t,i))t.replyId||this.$2k_0(t,i);else{var s=new ReceiveMessageRecord(t.id);var h=this.$2D_0(i);Array.enqueue(h,s);if(t.replyId){var r=t.replyId;this.$3A_0(t.replyId);if(t.type===2){var e=this.$v_0[r];if(e){var c=this.$W_0[r];e(t,c);this.$1q_0(r)}}else if(t.type===3){var o=this.$1D_0[r];if(o){var l=this.$W_0[r];o(t,l);this.$1q_0(r)}}}else if(t.action<=37){this.$2k_0(t,i);var u=new ReceiveMessageEventArgs(t,i);this.$3t_0(u);var f=u.$1G_0;f&&this.postMessage(f,this.$13_0(i))}else this.$47_0(t,i)}}},$2k_0:function(n,t){var i=CrossWindowMessage.createAcknowledgeMessage(n,null);this.postMessage(i,this.$13_0(t))},$47_0:function(n,t){var i=CrossWindowMessage.createRejectMessage(n,null);this.postMessage(i,this.$13_0(t))},$2D_0:function(n){this.$1C_0||(this.$1C_0={});var t=this.$1C_0[n];if(!t){t=[];this.$1C_0[n]=t}return t},$3T_0:function(n,t){for(var f=(new Date).getTime()-9600,i=this.$2D_0(t);i.length>0;){var e=i[0];if(e.time<f)Array.dequeue(i);else break}for(var r=!1,u=0;u<i.length;u++)if(n.id===i[u].messageId){r=!0;break}r;return r},$13_0:function(n){n=n.toLowerCase();for(var i=-1,t=0;t<this.$T_0.length;t++)if(this.$T_0[t]===n){i=t;break}return i},$3t_0:function(n){var t=this.$E_0.getHandler("Received");t&&t(n)},$3q_0:function(n){var t=n.messageRecord.message.id;var i=this.$1M_0[t];if(i){var u=this.$W_0[t];i(n.messageRecord.message,u);this.$1q_0(t)}var r=this.$E_0.getHandler("PostMessageFailed");r&&r(n)},$1q_0:function(n){delete this.$v_0[n];delete this.$1M_0[n];delete this.$1D_0[n];delete this.$W_0[n]}};function CrossWindowNavigation(){}CrossWindowNavigation.prototype={cloudHost:null};function CrossWindowNotificationData(){}CrossWindowNotificationData.prototype={results:null};function CrossWindowPowerShellResults(){}CrossWindowPowerShellResults.create=function(n){var t=new CrossWindowPowerShellResults;t.results=n;return t};CrossWindowPowerShellResults.prototype={results:null};function CrossWindowShowFlyoutData(){}CrossWindowShowFlyoutData.prototype={idToSelect:null};function CrossWindowSwitchSlabData(){}CrossWindowSwitchSlabData.prototype={slabId:null,selectedItemId:null};function CrossWindowSync(){}CrossWindowSync.prototype={fvaHelpEnabled:!1,xPremVer:1,serverVer:null,showPerfConsole:!1,ecpFullUrl:null,rbacData:null,cmdletLoggingEnabled:!1};function CrossSiteAgent(n){this.$$d_$3Z_0=Function.createDelegate(this,this.$3Z_0);this.$9_0=n;this.$9_0.add_received(this.$$d_$3Z_0);this.$M_0={};this.$b_0={}}CrossSiteAgent.prototype={$9_0:null,$M_0:null,$b_0:null,$1Y_0:null,$L_0:null,get_GetTenantDomainInfoCommand:function(){if(!this.$1Y_0){var n=this,t=this;this.$1Y_0=new LoadCommandWrapper("DDI/DDIService.svc?schema=HybridConfigurationService","GetTenantDomainInfo",function(t){n.$2e_0(t)},function(n,i){var r=_PowerShellResults.create();r.ErrorRecords=[{}];r.ErrorRecords[0].Message=ErrorHandling.getWebServiceFriendlyErrorMsg(i.get_error());t.$2e_0(r)})}return this.$1Y_0},registerPopupWindow:function(n,t){this.$46_0();this.$M_0[t]=n},getPopupWindowArgs:function(n,t,i){var r=this,u=this;this.$9_0.postMessage(new CrossWindowMessage(18,new CrossSitePopupData(n)),0,function(n,i){t(n.dataV1.serializedArguments)},function(n,t){i()},null,null)},refreshPopupWindowOpener:function(n,t){this.$9_0.postMessage(new CrossWindowMessage(19,new CrossSitePopupData(n,null,t)))},registerPickerLauncher:function(n,t){this.$45_0();this.$b_0[t]=n},pickerObjectsSelected:function(n,t){this.$9_0.postMessage(new CrossWindowMessage(20,new CrossSitePopupData(n,null,t)))},$2e_0:function(n){this.$9_0.postMessage(new CrossWindowMessage(27,CrossWindowPowerShellResults.create(n)))},$3w_0:function(n){if(this.$L_0){var t=this.$L_0;for(var i in t){var r={key:i,value:t[i]};try{r.value(n)}catch(u){}}this.$L_0=null}},getTenantDomainInfo:function(n,t){var i=new CrossWindowMessage(26);var r=i.id.toString();this.$L_0||(this.$L_0={});this.$L_0[r]=n;var u=this;this.$9_0.postMessage(i,0,null,function(n,i){if(u.$L_0[i]){u.$L_0[i]=null;t()}},null,r)},$3Z_0:function(n){var t=n.message;switch(t.action){case 18:var i=n.message.dataV1;n.set_replyMessage(CrossWindowMessage.createAnswerMessage(t,new CrossSitePopupData(i.popupId,Sys.Serialization.JavaScriptSerializer.serialize(this.$3N_0(i)))));break;case 19:this.$41_0(n.message.dataV1);break;case 20:this.$3y_0(n.message.dataV1);break;case 27:var r=t.dataV1.results;this.$3w_0(Sys.Serialization.JavaScriptSerializer.serialize(r));break;case 26:this.get_GetTenantDomainInfoCommand().execute();break}},$3N_0:function(n){try{var t=this.$M_0[n.popupId];return t.getContext(null,n.popupId).arguments}catch(i){delete this.$M_0[n.popupId]}return null},$41_0:function(n){try{var t=this.$M_0[n.popupId];t.doRefresh(t.getContext(null,n.popupId).popupWindow,n.serializedResults)}catch(i){delete this.$M_0[n.popupId]}},$3y_0:function(n){try{var t=this.$b_0[n.popupId];if(_Object.isNullOrUndefined(n.serializedResults))t.onDialogClose();else t.onDialogOK(Sys.Serialization.JavaScriptSerializer.deserialize(n.serializedResults,!0))}catch(i){delete this.$b_0[n.popupId]}},$46_0:function(){var i=new Array(0);var r=this.$M_0;for(var u in r){var n={key:u,value:r[u]};var e=n.value;try{e.getContext(null,n.key)}catch(h){Array.add(i,n.key)}}for(var f=i,o=f.length,t=0;t<o;++t){var s=f[t];delete this.$M_0[s]}},$45_0:function(){var t=new Array(0);var i=this.$b_0;for(var r in i){var u={key:r,value:i[r]};var e=u.value;var o;try{o=e.get_ValueProperty()}catch(c){Array.add(t,u.key)}}for(var f=t,s=f.length,n=0;n<s;++n){var h=f[n];delete this.$b_0[h]}}};function CrossSitePopupData(n,t,i){this.popupId=n;this.serializedArguments=t;this.serializedResults=i}CrossSitePopupData.prototype={popupId:null,serializedArguments:null,serializedResults:null};function DropDownButton(n){DropDownButton.initializeBase(this,[n])}DropDownButton.prototype={$2t_4:null,get_ToolBar:function(){return this.$2t_4},set_ToolBar:function(n){this.$2t_4=n;n&&EcpUtil.isIE()&&Sys.UI.DomElement.addCssClass(n.get_element(),"IE");return n}};function EsoPickerLauncher(){this.$$d_$3v_0=Function.createDelegate(this,this.$3v_0);this.ecpApplication=EcpApplication.get_instance();$addHandler(window,"unload",this.$$d_$3v_0)}EsoPickerLauncher.prototype={$p_0:null,get_id:function(){return"EsoPicker"},get_pickerWindow:function(){return this.$p_0},set_pickerWindow:function(n){this.$p_0=n;return n},invokePicker:function(n){var t=EcpUrl.get_ecpVDir()+"Pickers/EsoPicker.aspx?mode=single";var i=GlobalVariables.defaultPickerDialogWidth;if(n){t+="&xprs="+n;i+=170}PickerLauncherHelper.openPicker(this,t,GlobalVariables.defaultPickerDialogHeight,i)},$3v_0:function(n){if(this.$p_0){this.$p_0.close();this.$p_0=null}$removeHandler(window,"unload",this.$$d_$3v_0)},onDialogOK:function(n){this.onDialogClose()},onDialogClose:function(){PickerLauncherHelper.unregisterLauncher(this)},getOriginalSelection:function(){return null},get_ValueProperty:function(){return null}};function FVAHelpEnabledToggleCommandHandler(){FVAHelpEnabledToggleCommandHandler.initializeBase(this)}FVAHelpEnabledToggleCommandHandler.toggleO365Link=function(){var n=!EcpProfile.get_fvaHelpEnabled();EcpProfile.set_fvaHelpEnabled(n);return n?Strings.get_DisableFVA():Strings.get_EnableFVA()};FVAHelpEnabledToggleCommandHandler.prototype={initialize:function(n){ToggleCommandHandler.prototype.initialize.call(this,n);this.set_Toggled(EcpProfile.get_fvaHelpEnabled());if(CrossPremise.get_instance()){var t=this;CrossPremiseSyncer.get_instance().add_syncDataReceived(function(n,i){if(!i.orgType){EcpProfile.set_fvaHelpEnabled(i.data.fvaHelpEnabled);t.set_Toggled(EcpProfile.get_fvaHelpEnabled())}})}},onToggledChanged:function(){ToggleCommandHandler.prototype.onToggledChanged.call(this);this.toolbarButton.set_text(this.get_Toggled()?Strings.get_DisableFVA():Strings.get_EnableFVA())},onClick:function(){EcpProfile.set_fvaHelpEnabled(this.get_Toggled());if(CrossPremise.get_instance()){var n=new CrossWindowSync;n.fvaHelpEnabled=EcpProfile.get_fvaHelpEnabled();CrossPremise.get_instance().$6_1(new CrossWindowMessage(7,n),0);CrossPremise.get_instance().$6_1(new CrossWindowMessage(7,n),1)}}};function HeartbeatDetector(n,t){this.$$d_$2d_0=Function.createDelegate(this,this.$2d_0);this.$$d_$3P_0=Function.createDelegate(this,this.$3P_0);this.$2H_0=new LoadCommandWrapper(EcpUrl.get_ecpVDir()+"DDI/DDIService.svc?ua=0&schema="+GlobalVariables.heartbeatSchemaName,"GetObject",this.$$d_$3P_0,t);this.$2I_0=_Object.isUndefined(n)?EcpApplication.get_instance().get_HeartbeatRefreshInterval():n}HeartbeatDetector.prototype={$2H_0:null,$U_0:0,$2I_0:0,$P_0:!1,start:function(){this.$P_0=!0;this.$2d_0()},stop:function(){this.$P_0=!1;window.clearTimeout(this.$U_0)},$2d_0:function(){this.$2H_0.execute()},$3P_0:function(n){this.$P_0&&(this.$U_0=window.setTimeout(this.$$d_$2d_0,this.$2I_0))}};function HybridLogoutHelper(n){this.$$d_$3m_3=Function.createDelegate(this,this.$3m_3);this.$$d_$38_3=Function.createDelegate(this,this.$38_3);HybridLogoutHelper.initializeBase(this,[n]);var t=EcpUrl.getUrlParameter(window.location.href,"xprs");if(!_String.isNullOrEmpty(t)){this.$0_3=new CrossWindowMessenger(window.self);this.$0_3.set_crossDomainServer(t);this.$0_3.addTarget(new ParentWindowFactory(window.self),"https://"+t);this.$0_3.add_received(this.$$d_$38_3)}this.$J_3=new HeartbeatDetector(1e3,this.$$d_$3m_3)}HybridLogoutHelper.prototype={$0_3:null,$J_3:null,initialize:function(){EcpControl.prototype.initialize.call(this);this.$0_3&&this.$0_3.postMessage(new CrossWindowMessage(34))},$38_3:function(n){switch(n.message.action){case 31:this.$J_3.start();break;case 32:this.$J_3.stop();break;default:break}},$3m_3:function(n,t){if(t.get_error().get_statusCode()===440){this.$J_3.stop();this.$0_3&&this.$0_3.postMessage(new CrossWindowMessage(33))}},dispose:function(){this.$0_3&&this.$0_3.dispose();EcpControl.prototype.dispose.call(this)}};function LoadCommandWrapper(n,t,i,r){this.$$d_$4F_0=Function.createDelegate(this,this.$4F_0);this.$$d_$3X_0=Function.createDelegate(this,this.$3X_0);this.$$d_$3G_0=Function.createDelegate(this,this.$3G_0);this.$1o_0=i;this.$1p_0=r;this.$8_0=new WebServiceCommand;this.$8_0.init(n,t,this.$$d_$3G_0);this.$8_0.get_webServiceMethod().set_ParameterNames(7);this.$8_0.add_completed(this.$$d_$3X_0);this.$8_0.get_webServiceMethod().add_Failed(this.$$d_$4F_0)}LoadCommandWrapper.prototype={$8_0:null,$1o_0:null,$1p_0:null,get_loadCommand:function(){return this.$8_0},dispose:function(){this.$8_0.remove_completed(this.$$d_$3X_0);this.$8_0.get_webServiceMethod()&&this.$8_0.get_webServiceMethod().remove_Failed(this.$$d_$4F_0)},execute:function(){!this.$8_0.get_webServiceMethod().get_isBusy()&&this.$8_0.get_CanExecute()&&this.$8_0.execute()},$3X_0:function(n,t){this.$1o_0&&this.$1o_0(this.$8_0.get_LastResults())},$4F_0:function(n,t){t.set_handled(!0);this.$1p_0&&this.$1p_0(n,t)},$3G_0:function(){return[null,null]}};function MessageRecord(n,t,i,r,u,f){this.message=n;this.targetIndex=t;this.answerCallback=i;this.timeoutCallback=r;this.rejectCallback=u;this.context=f;this.time=(new Date).getTime()}MessageRecord.prototype={message:null,answerCallback:null,timeoutCallback:null,rejectCallback:null,context:null,targetIndex:0,time:0};function NavBar(n){this.$$d_linkClicked=Function.createDelegate(this,this.linkClicked);this.$$d_onJsLoaded=Function.createDelegate(this,this.onJsLoaded);NavBar.initializeBase(this);this.$3_1=n}NavBar.Create=function(n){if(!n||!n.NavBarData)return null;NavBar.$2=n.IsGeminiShellEnabled?n.NavBarData.Dimensions.Top===30?new NavBarV15Parity(n):new NavBarGemini(n):new NavBarV15(n);NavBar.$2.render();return NavBar.$2};NavBar.get_instance=function(){return NavBar.$2};NavBar.prototype={$3_1:null,get_navBarPack:function(){return this.$3_1},set_navBarPack:function(n){this.$3_1=n;return n},get_height:function(){return this.$3_1.NavBarData.Dimensions.Top},add_preRender:function(n){this.get_events().addHandler("PreRender",n)},remove_preRender:function(n){this.get_events().removeHandler("PreRender",n)},add_postRender:function(n){this.get_events().addHandler("PostRender",n)},remove_postRender:function(n){this.get_events().removeHandler("PostRender",n)},render:function(){_File.loadCss(this.$3_1.SharedCSSUrl);_File.loadJs(this.$3_1.SharedJSUrl,this.$$d_onJsLoaded)},onJsLoaded:function(n){try{this.$2f_1("PreRender",Sys.EventArgs.Empty);this.internalRender();this.adjustNavigationLayout();this.$2f_1("PostRender",Sys.EventArgs.Empty)}catch(t){}},adjustNavigationLayout:function(){var n=this.get_height();var r=$(".o365MainNav")[0];r.style.top=n+65+"px";var t=$(".o365MiddleNav");t.length>0&&(t[0].style.top=n+30+"px");var i=$(".titleBar");i.length>0&&(i[0].style.top=n+13+"px")},linkClicked:function(n){var t=n.Id;var i=n.Url;if(t&&t.indexOf("_O365L")>0){n.Cancel=!0;t.indexOf("signout_O365L")>=0?JumpTo(EcpUrl.logoffLink,!0):t.indexOf("eso_O365L")>=0?JumpTo("helpdesk"):t.indexOf("owa_O365L")>=0?JumpTo(i,!0):t.indexOf("openHelp_O365L")>=0?PopupWindowManager.showContextualHelp(i,!1,this.$3_1.HelpParameters):t.indexOf("openOptionHelp_O365L")>=0?PopupWindowManager.showContextualHelp(i,!0,this.$3_1.HelpParameters):t.indexOf("toggleFVA_O365L")>=0?n.Text=FVAHelpEnabledToggleCommandHandler.toggleO365Link():t.indexOf("perfConsole_O365L")>=0?ShowPerfConsoleCommandHandler.showPerfConsole():t.indexOf("cmdletLogging_O365L")>=0?CmdletLoggingNavHelper.OpenCmdletLoggingWindow("CmdletLogging"):PopupWindowManager.showHelpClient(i)}else if(t==="ntfLink")EcpApplication.get_instance().get_Navigation().showNotification(null);else if(_String.isNullOrEmpty(n.Target)){n.Cancel=!0;JumpTo(i,!0,t)}},$2f_1:function(n,t){var i=this.get_events().getHandler(n);i&&i(this,t)}};function NavBarGemini(n){NavBarGemini.initializeBase(this,[n])}NavBarGemini.prototype={$1f_2:!1,get_isNotificationReady:function(){return this.$1f_2},internalRender:function(){this.$3_1.IsMock&&Sys.UI.DomElement.addCssClass($get("topNavZone"),"hideGear");O365Shell.SetData(this.$3_1.NavBarData);var n=this;O365Shell.Render({top:"topNavZone",bottom:"footerBar"},function(){n.$1f_2=!_Object.isUndefined(O365Shell)&&!!O365Shell.Notifications});O365Shell.Navigation.OnLinkClick(this.$$d_linkClicked)},adjustNavigationLayout:function(){NavBar.prototype.adjustNavigationLayout.call(this);var n=$(".o365MainNav")[0];n.style.bottom="0px";$(".footerBar").hide()},getNotificationIconContainer:function(){return null}};function NavBarV15(n){this.$$d_$3J_2=Function.createDelegate(this,this.$3J_2);this.$$d_$3K_2=Function.createDelegate(this,this.$3K_2);NavBarV15.initializeBase(this,[n])}NavBarV15.prototype={$1S_2:null,get_height:function(){return 30},render:function(){NavBar.prototype.render.call(this);if(!this.$3_1.IsFresh){var n=this;window.setTimeout(function(){n.$33_2()},0)}},getNotificationIconContainer:function(){var n=$get("O365_MainLink_Me");if(n){var t=document.createElement("SPAN");var i=n.parentNode;i.insertBefore(t,i.firstChild);return t}else return null},onJsLoaded:function(n){this.$1S_2&&_File.unloadCss(this.$1S_2);NavBar.prototype.onJsLoaded.call(this,n)},internalRender:function(){var n=this;O365_NavBar.RenderNavBarAndFooter("topNavZone","footerBar",this.$3_1.NavBarData,function(t){if(t){var r=EcpUtil.getInnerText(t);var i={};i.Cancel=!1;i.Id=t.id;i.Target=t.target;i.Text=r;i.Url=t.href;n.linkClicked(i);i.Text!==r&&EcpUtil.setInnerText(t,i.Text);return!i.Cancel}else return!0})},$33_2:function(){var n=new WebServiceMethod;n.set_MethodName("GetObject");n.set_ServiceUrl(NavBarV15.$2T);n.set_ParameterNames(5);n.add_Succeeded(this.$$d_$3K_2);n.add_Failed(this.$$d_$3J_2);var t=new Identity(this.$3_1.FeatureSet,this.$3_1.FeatureSet);n.invokeWithArgs([t],null)},$4E_2:function(n){if(this.$3_1){this.$3_1.SharedCSSUrl!==n.SharedCSSUrl&&(this.$1S_2=this.$3_1.SharedCSSUrl);this.$3_1.SharedJSUrl!==n.SharedJSUrl&&_File.unloadJs(this.$3_1.SharedJSUrl)}this.$3_1=n;this.render()},$3J_2:function(n,t){t.set_handled(!0)},$3K_2:function(n,t){var i=t.get_results();if(i&&(!i.ErrorRecords||!i.ErrorRecords.length)&&i.Output&&i.Output.length>0){var r=i.Output[0];r.IsFresh&&this.$4E_2(r)}}};function NavBarV15Parity(n){NavBarV15Parity.initializeBase(this,[n])}NavBarV15Parity.prototype={internalRender:function(){O365Shell.SetData(this.$3_1.NavBarData);O365Shell.Render({top:"topNavZone",bottom:"footerBar"},null);O365Shell.Navigation.OnLinkClick(this.$$d_linkClicked)},adjustNavigationLayout:function(){NavBar.prototype.adjustNavigationLayout.call(this);var n=$(".o365MainNav")[0];n.style.bottom="0px";$(".footerBar").hide()},getNotificationIconContainer:function(){var t=$(".o365cs-nav-headerRegion");if(t.length>0){var n=document.createElement("div");n.style.display="inline-block";t[0].appendChild(n);return n}else return null}};function NavBarPack(){}NavBarPack.prototype={NavBarData:null,SharedCSSUrl:null,SharedJSUrl:null,Version:null,FeatureSet:null,IsFresh:!1,IsMock:!1,HelpParameters:null,IsGeminiShellEnabled:!1};function NavBarData(){}NavBarData.prototype={AdminLink:null,ChangePasswordLink:null,CommunityLink:null,CurrentWorkloadHelpSubLinks:null,CurrentWorkloadSettingsLink:null,CurrentWorkloadSettingsSubLinks:null,CurrentWorkloadUserSubLinks:null,DownArrowImage:null,Dimensions:null,FeedbackImage:null,FeedbackLink:null,FlightName:null,HelpImage:null,HelpLink:null,HomeLink:null,ImageClusterUrl:null,LargeLogoImage:null,LegalLink:null,LogoImage:null,O365SettingsLink:null,PartnerLink:null,PrivacyLink:null,SettingsImage:null,SettingsSmallImage:null,SignOutLink:null,UpArrowImage:null,UserDisplayName:null,WorkloadLinks:null};function NavBarLinkData(){}NavBarLinkData.prototype={Id:null,TargetWindow:null,Text:null,Url:null};function NavBarImageData(){}NavBarImageData.prototype={AltText:null,ClipInfo:null,HoverClipInfo:null};function NavBarImageClipInfo(){}NavBarImageClipInfo.prototype={Height:0,Width:0,X:0,Y:0};function Navigation(){this.$$d_$3k_1=Function.createDelegate(this,this.$3k_1);this.$$d_$3u_1=Function.createDelegate(this,this.$3u_1);this.$$d_$2X_1=Function.createDelegate(this,this.$2X_1);this.$$d_$30_1=Function.createDelegate(this,this.$30_1);this.$$d_$3f_1=Function.createDelegate(this,this.$3f_1);this.$$d_$3p_1=Function.createDelegate(this,this.$3p_1);this.$V_1=[];this.$R_1=(new Date).getTime();this.$N_1=new ClientRbac;Navigation.initializeBase(this)}Navigation.ShowLoading=function(n){Navigation.$Z.getAttribute("stamp").toString()===n.toString()&&(Navigation.$Z.style.display="")};Navigation.SignOut=function(){if(Navigation.$w){var n=new Info;n.MessageType=MessageBoxType.warning;n.Message=Strings.get_CloseWindowOnLogout();MessageBox.show(n,4,null,null)}else JumpTo(Navigation.$3H(),!0)};Navigation.$3H=function(){if(Navigation.$14){var n=EcpUrl.getUrlParameter(window.location.href,"rfr")||"";var t=window.location.protocol+"//"+window.location.hostname+(_String.isNullOrEmpty(window.location.port)?"":":"+window.location.port)+(n==="owa"||n==="olk"?"/owa/":"/ecp/");return"logoff.aspx?src=exch&url="+encodeURIComponent(t)}else return EcpUrl.logoffLink};Navigation.prototype={$0_1:null,$1v_1:null,$D_1:null,$q_1:null,$1H_1:null,$j_1:null,$l_1:null,$1h_1:null,$1V_1:null,$4_1:null,$K_1:null,$f_1:null,$g_1:null,$1I_1:null,$1s_1:!1,$1Q_1:!1,$1T_1:!1,$1c_1:90,$k_1:!1,$10_1:!0,$2b_1:null,$25_1:null,$A_1:null,$J_1:null,$2R_1:!1,$1K_1:0,$1t_1:0,$1Z_1:!1,get_ShowPerfConsole:function(){return this.$1s_1},set_ShowPerfConsole:function(n){this.$1s_1=n;return n},get_CmdletLoggingEnabled:function(){return this.$1Q_1},set_CmdletLoggingEnabled:function(n){this.$1Q_1=n;return n},get_DisableHybridSyncCheck:function(){return this.$1T_1},set_DisableHybridSyncCheck:function(n){this.$1T_1=n;return n},get_HybridSyncTimeoutInSeconds:function(){return this.$1c_1},set_HybridSyncTimeoutInSeconds:function(n){this.$1c_1=n;return n},get_NavTree:function(){return this.$4_1},set_NavTree:function(n){this.$4_1=n;this.$3x_1(this.$4_1);return n},get_CloudServer:function(){return this.$g_1},set_CloudServer:function(n){this.$g_1=n;return n},get_ServerVersion:function(){return this.$1I_1},set_ServerVersion:function(n){this.$1I_1=n;return n},get_isHybridUI:function(){return this.$k_1},get_mainFrameVisible:function(){return this.$10_1},get_otherPremiseUrl:function(){return this.$2b_1},get_crossSiteAgent:function(){return this.$25_1},get_RbacData:function(){return this.$N_1.rbacDataOnCurrentPremise},set_RbacData:function(n){this.$N_1.rbacDataOnCurrentPremise=n;return n},get_CloseWindowOnLogout:function(){return Navigation.$w},set_CloseWindowOnLogout:function(n){Navigation.$w=n;return n},get_IsLegacyLogOff:function(){return Navigation.$14},set_IsLegacyLogOff:function(n){Navigation.$14=n;return n},initialize:function(){Sys.Component.prototype.initialize.call(this);var s=$get("priNavDropDownList");this.$1v_1=this.$11_1(0);this.$q_1=this.$11_1(1);this.$1H_1=this.$11_1(2);this.$K_1=[null,new NavigationLinksAccHandler(this.$q_1),new NavigationLinksAccHandler(this.$1H_1)];this.$j_1=$get("mainFrame");this.$l_1=$get("loadZone",this.$j_1);Navigation.$Z=$get("loadGif",this.$l_1);this.$1x_1(this.$4_1.Selected);this.$1w_1();$addHandler(this.$q_1,EventNames.click,this.$$d_$3p_1);$addHandler(this.$1H_1,EventNames.click,this.$$d_$3p_1);window.onbeforeunload=this.$$d_$3f_1;this.$f_1=this.$$d_$30_1;Sys.Application.add_load(this.$f_1);var n=UrlUtil.getParameter("xprs");if(n&&window.parent&&window.parent!==window.self){this.$0_1=new CrossWindowMessenger(window.self);this.$0_1.set_crossDomainServer(this.$g_1);this.$0_1.add_received(this.$$d_$2X_1);var i="https://"+(_Window.isAccessible(window.parent)?window.parent.location.hostname:n);this.$0_1.addTarget(new ParentWindowFactory(window.self),i);if(this.$1T_1)$get("HostDetectMask").style.display="none";else{var r=$find("HostDetectPopupExtender");r.show();var t=$get("HostDetectPopupPanel");t.style.left="40%";t.style.top="40%";var u=this;this.$1K_1=window.setTimeout(function(){u.$1K_1=0;$get("syncProgress").style.display=""},1e3);var h=this;this.$1t_1=window.setTimeout(function(){window.location.href="/ecp/error.aspx?cause=HybridSyncFail"},this.$1c_1*1e3)}var f=this;window.setTimeout(function(){f.$2s_1()},0);this.$25_1=new CrossSiteAgent(this.$0_1)}this.$A_1=this.$N_1.isInRole("Get-Notification",!0)?this.$0_1?new InnerPageNotificationAdapter(new CrossWindowNotificationCallback(this.$0_1)):new CombinedNotificationAdapter(NavBarGemini.isInstanceOfType(NavBar.$2)):new DummyNotificationAdapter;var e=this;window.setTimeout(function(){e.$2g_1()},0);if(!this.$A_1.get_enabled()){this.$J_1=new HeartbeatDetector;this.$J_1.start()}var o=this.$4_1.Children.length>0&&this.$4_1.Children[0].Children.length>0?this.$4_1.Children[0].Children[0].ID:"";this.$1Z_1=o==="AdminHome";DatapointManager.addDatapoint(String.format("{0}.{1}_{2}.{3}",EcpInstrumentationMarkers.navigation,"SessionStart",this.$Q_1().ID,this.$1Z_1?1:0))},dispose:function(){$removeHandler(this.$q_1,EventNames.click,this.$$d_$3p_1);$removeHandler(this.$1H_1,EventNames.click,this.$$d_$3p_1);window.onbeforeunload=null;if(!_Object.isNullOrUndefined(this.$f_1)){Sys.Application.remove_load(this.$f_1);this.$f_1=null}if(this.$0_1){this.$0_1.postMessage(new CrossWindowMessage(9));this.$0_1.dispose()}this.$J_1&&this.$J_1.stop();for(var n=0;n<this.$K_1.length;n++)this.$K_1[n]&&this.$K_1[n].$3B_0();Sys.Component.prototype.dispose.call(this)},$2X_1:function(n){var t=n.message;switch(t.action){case 2:this.jumpTo("myself",!1);break;case 3:this.jumpTo("myorg",!1);break;case 5:this.jumpTo("helpdesk",!1,t.dataV1.cloudHost);break;case 11:n.set_replyMessage(CrossWindowMessage.createAnswerMessage(t,null));if(!this.$2R_1){this.$2R_1=!0;var o=this;window.setTimeout(function(){Navigation.SignOut()},0)}break;case 6:case 7:var i=this.$4A_1(t);i&&n.set_replyMessage(i);break;case 17:this.$3n_1(t.dataV1);break;case 10:this.$2Y_1(new NavigationDialogContext(null,null,2,t));break;case 12:ShowPerfConsoleCommandHandler.showPerfConsole("PerfConsole"+(_Window.isAccessible(window.parent)?"OnCloud":"OnPremise"));break;case 37:var r=_Window.isAccessible(window.parent);CmdletLoggingNavHelper.OpenCmdletLoggingWindow("CmdletLogging"+(r?"O365":"Enterprise"),r?Strings.get_CmdLogTitleForHybridO365():Strings.get_CmdLogTitleForHybridEnterprise());break;case 14:n.set_replyMessage(CrossWindowMessage.createAnswerMessage(t,new ReloadWindowContext(this.$Q_1().ID)));break;case 16:this.$10_1=!0;if(DialogManager.hasVisibleModalDialog()){this.$0_1.postMessage(new CrossWindowMessage(8));DialogManager.relayoutCurrentDialog()}this.$1w_1();break;case 35:this.$10_1=!1;break;case 23:this.$A_1.getNotificationDetail();break;case 25:var u=t.dataV1;this.jumpTo(u.slabId,!1,u.selectedItemId);break;case 28:AccUtil.handleCtrlF6Key(null,!1);break;case 29:AccUtil.handleCtrlF6Key(null,!0);break;case 30:this.$2s_1();break;case 36:var f=t.dataV1;var e=f.action<=37;n.set_replyMessage(CheckActionAvailableData.createCheckActionAvailableAnswerMessage(t,e));break}},$30_1:function(n,t){if(document.body.offsetWidth>0){var i=ControlHelper.findControlById("firstFocus");i.get_element().setAttribute(AriaUtil.ariaLabel,Strings.get_FirstFocusTextForScreenReader());if(EcpUtil.isSafari()){i.set_text(Strings.get_FirstFocusTextForScreenReader());var r=this;window.setTimeout(function(){EcpUtil.safeFocus(i.get_element())},3e3)}else EcpUtil.safeFocus(i.get_element())}},$3n_1:function(n){this.$k_1=!0;this.$2b_1=n.ecpFullUrl;this.$N_1.rbacDataOnOtherPremise=n.rbacData;this.$N_1.$3S_0=EcpUtil.compareVersion(this.$1I_1,n.serverVer)<0;for(var t=1;t<=2;t++)this.$2v_1(t)},$2s_1:function(){var n=new CrossWindowSync;n.fvaHelpEnabled=EcpProfile.get_fvaHelpEnabled();n.showPerfConsole=this.$1s_1;n.cmdletLoggingEnabled=this.$1Q_1;n.serverVer=this.$1I_1;n.ecpFullUrl=EcpUrl.get_ecpFullUrl();n.rbacData=this.$N_1.rbacDataOnCurrentPremise;var i=new CrossWindowMessage(1,n);var t=this;this.$0_1.postMessage(i,0,function(n,i){$get("HostDetectMask").style.display="none";$find("HostDetectPopupExtender").hide();t.$1t_1&&window.clearTimeout(t.$1t_1);t.$1K_1&&window.clearTimeout(t.$1K_1)},null,null,null)},$4A_1:function(n){var t=null;switch(n.action){case 6:var i=new CrossWindowSync;i.fvaHelpEnabled=EcpProfile.get_fvaHelpEnabled();t=CrossWindowMessage.createAnswerMessage(n,i);break;case 7:EcpProfile.set_fvaHelpEnabled(n.dataV1.fvaHelpEnabled);break}return t},updateUserTile:function(n){},showNotification:function(n){this.$A_1.showNotificationFlyout(n)},jumpToCrossSite:function(n,t,i){if(this.$k_1){var r=new CrossWindowSwitchSlabData;r.slabId=n;r.selectedItemId=t;var u=this;this.$0_1.postMessage(new CrossWindowMessage(25,r),0,null,function(){MessageBox.showMessage(i,MessageBoxType.error)},null,null)}},jumpTo:function(n,t,i){var r=null;var f=!0;var u=0;if(t)u=1;else if(n==="office365"){u=1;n=this.$37_1(i)}else{r=this.$2A_1(n,this.$4_1);f=!!r}if(f){var e=new NavigationDialogContext(r,n,u,i);n==="helpdesk"?this.$a_1(ModalDialogResult.OK,e):this.$2Y_1(e);return!1}return!0},getReloadUrl:function(n){n||(n=this.$Q_1().ID);var t=EcpUrl.setUrlParameter(window.location.href,"p",n);t=EcpUrl.makeLiveIdUrl(t);return t},reload:function(){DataLossReporting.suspendWarning();window.location.href=this.getReloadUrl(null)},reloadWithPageIdAndLanguage:function(n,t,i){DataLossReporting.suspendWarning();EcpUtil.isNullOrEmpty(n)&&(n=this.$Q_1().ID);if(this.$0_1){var u=new ReloadWindowContext(n);u.languageOverriden=t;this.$0_1.postMessage(new CrossWindowMessage(13,u))}else{var r=this.getReloadUrl(n);i&&EcpUrl.getUrlParameter(r,EcpUrl.languageOverridenParam)&&(r=EcpUrl.setUrlParameter(r,EcpUrl.languageOverridenParam,""));var f=r.indexOf("#");f>0&&(r=r.substr(0,f));window.location.href=r}},onModalDialogOpen:function(){this.$0_1&&this.$10_1&&this.$0_1.postMessage(new CrossWindowMessage(8))},onModalDialogClose:function(){this.$0_1&&this.$0_1.postMessage(new CrossWindowMessage(9))},isInRole:function(n,t){return this.$N_1.isInRole(n,t)},checkActionAvailable:function(n,t){if(this.$0_1&&this.$k_1){var i=this;this.$0_1.postMessage(new CrossWindowMessage(36,new CheckActionAvailableData(n)),0,function(n,i){var r=n.dataV1;t(r.supported,r.enabled)},null,null,null)}},tryPassCtrlF6ToCrossPremise:function(n){var t=!1;if(this.$0_1){this.$0_1.postMessage(new CrossWindowMessage(n?29:28));t=!0}return t},$37_1:function(n){var i=UrlUtil.getParameter(EcpUrl.languageOverridenParam);var t=new CrossPremiseUrl(n);if(this.isInRole("MyBaseOptions",!0))t.set_languageOverriden(EcpUtil.isNullOrEmpty(i)?EcpProfile.get_instance().get_Language():i);else if(!EcpUtil.isNullOrEmpty(i)){t.set_languageOverriden("");t.set_languageOverridenCandidate(i)}t.set_onPremisePage(this.$Q_1().ID);return t.toString()},$2v_1:function(n){if(!(n<=0)){var w=this.$4_1;var c=Navigation.$2P[n];var l=Navigation.$1r[n];var a=Navigation.$1m[n];var v=this.$11_1(n);var e=!1;var s=!1;var i=this.$2E_1(n-1);var u="";if(i&&i.Children.length>0){var o=i.Children;e=n===2&&!o.length;if(!e){s=!0;this.$K_1[n].$2h_0();var f=i.Selected;u=Navigation.$2r[n];for(var r=0;r<o.length;r++){var t=o[r];if(!_String.isNullOrEmpty(t.HybridRole)){this.$k_1&&!t.canAccessHybridRole&&this.isInRole(t.HybridRole,!1)&&(t.canAccessHybridRole=!0);if(!t.canAccessHybridRole){r===f&&(f=this.$2z_1(i));continue}}var h=r===f;var y=h?l:a;var p=" "+(n===1?Strings.get_PrimaryNavigation():Strings.get_SecondaryNavigation());u+=String.format(c,t.ID,y,t.Title,h.toString(),t.Title+p)}u+=Navigation.$27[n];this.$K_1[n].$C_0=f}}else e=!0;v.innerHTML=u;s&&this.$K_1[n].$2K_0()}},$2z_1:function(n){for(var i=-1,t=0;t<n.Children.length;t++){var r=n.Children[t];(_String.isNullOrEmpty(r.HybridRole)||r.canAccessHybridRole)&&(i=t)}n.Selected=i;return i},$2E_1:function(n){for(var t=this.$4_1,i=0;i<=n;i++)t=t.Children[t.Selected];return t},$3F_1:function(n){while(n&&!n.id&&n.parentNode)n=n.parentNode;return n&&this.$3V_1(n.id)?n:null},$3V_1:function(n){return!!n&&n.startsWith("Menu_")},$4D_1:function(n,t,i){if(n>0){var r=this.$1X_1(n,t);$get(r).className=Navigation.$1m[n];$get(r).getElementsByTagName("A")[0].setAttribute(AriaUtil.ariaExpanded,!1);var u=this.$1X_1(n,i);$get(u).className=Navigation.$1r[n];$get(u).getElementsByTagName("A")[0].setAttribute(AriaUtil.ariaExpanded,!0);this.$K_1[n].$C_0=i}else this.$1x_1(i)},$1X_1:function(n,t){for(var i=this.$4_1;n>0;){i=i.Children[i.Selected];--n}return"Menu_"+i.Children[t].ID},$2l_1:function(n,t){var i=null;if(n){var r=this.$1X_1(n,t);i=$get(r).getElementsByTagName("A")[0]}else i=this.$1v_1;var u=this;window.setTimeout(function(){EcpUtil.safeFocus(i)},0)},$1x_1:function(n){if(!this.$D_1){this.$D_1=[];for(var i=this.$1v_1.childNodes,u=0;u<this.$4_1.Children.length;u++)for(var f=this.$4_1.Children[u],t=0;t<i.length;t++)if(i[t].nodeType===1&&f.ID===i[t].id){Array.add(this.$D_1,i[t]);break}}for(var e=this.$4_1.Children[this.$4_1.Selected].ID,r=0;r<this.$D_1.length;r++){var o=this.$D_1[r];_DomElement.toggelCssClass(this.$D_1[r],o.id===e,"topNavSelected")}},$3W_1:function(n){this.$1V_1||(this.$1V_1=new EsoPickerLauncher);this.$1V_1.invokePicker(n)},$2A_1:function(n,t){var i=null;if(t.ID===n)i=t;else for(var r=0;r<t.Children.length;r++){var u=this.$2A_1(n,t.Children[r]);if(u){i=u;break}}return i},$2Y_1:function(n){var t=DataLossReporting.needRaiseWarning(!1);if(t.get_hasChange()){var i=new Info;i.MessageType=MessageBoxType.warning;var r;var u;if(t.get_isSaving()){i.Message=t.get_warningMessage()||Strings.get_PleaseWaitWhileSaving();r=6;var f=this;u=function(n,t){f.$a_1(n,t)}}else{i.Message=t.get_warningMessage()||Strings.get_LossDataWarning();r=5;u=this.$$d_$3u_1;n.currentNodeIsDirty=t.get_hasChange();n.customSaveMethod=t.customSaveMethod}MessageBox.show(i,r,u,n)}else this.$a_1(ModalDialogResult.OK,n)},$3u_1:function(n,t){var i=t;if(n===ModalDialogResult.save){var c=this.$1h_1.CachedFrm;var r=c.contentWindow._isaves;if(r&&r.length>0){window._navTarget=i.targetID;for(var o=0,f=[],u=0;u<r.length;u++)if(r[u].get_IsSaveMethod()){++o;Array.add(f,r[u])}var s=o;i.timeStamp=this.$R_1;for(var e=0;e<f.length;e++){var h=this;f[e].invokeMethod(function(){--s;s||i.timeStamp!==h.$R_1||h.$a_1(ModalDialogResult.save,i)})}}else if(i.customSaveMethod){var l=this;i.customSaveMethod(function(){l.$a_1(ModalDialogResult.save,i)})}}else this.$a_1(n,i)},$a_1:function(n,t){window._navTarget=null;var u=n!==ModalDialogResult.cancel;n===ModalDialogResult.dontSave&&t.currentNodeIsDirty&&this.$2i_1(this.$Q_1());switch(t.source){case 1:u&&(window.location.href=t.targetID);break;case 2:var c=CrossWindowMessage.createAnswerMessage(t.additionalData,new CheckDataLossAnswer(u));this.$0_1.postMessage(c);break;case 0:if(t.targetID==="helpdesk")this.$3W_1(t.additionalData);else{var o=t.additionalData||"";this.$31_1(t);if(t.level>=0||o!==""){var r=this.$2E_1(t.level-1);var s=r.Selected;if(u){var f=t.level;var h=t.newIndex;var i=t.targetNode;i.selectedItemId=o;h=i.index;f=-1;while(i.parent){i.parent.Selected=i.index;i=i.parent;f++}this.$4D_1(t.level,s,t.newIndex);for(var e=t.level+1;e<=2;e++){this.$2v_1(e);r.Children.length>r.Selected&&(r=r.Children[r.Selected])}this.$3O_1();this.$2l_1(f,h);this.$1w_1()}else this.$2l_1(t.level,s)}this.$2g_1()}break}},$31_1:function(n){for(var i=[],t=n.targetNode;t.parent;){Array.insert(i,0,t.index);t=t.parent}n.level=-1;t=this.$4_1;for(var r=0;t.Children.length>0&&r<i.length;r++){if(t.Selected!==i[r]){n.level=r;break}t=t.Children[t.Selected]}n.newIndex=i[n.level]},$1w_1:function(){this.$3a_1();this.$R_1++;var t=this.$Q_1();var n=t.CachedFrm;if(n){!_Object.isNullOrUndefined(t.selectedItemId)&&t.selectedItemId.trim().length&&(n.contentWindow.location.hash=t.selectedItemId);n.style.display="";this.$l_1.style.display="none"}else{n=this.$3d_1(t);this.$l_1.style.display="";Navigation.$Z.style.display="none";Navigation.$Z.setAttribute("stamp",this.$R_1);window.setTimeout("Navigation.ShowLoading("+this.$R_1+");",1e3);this.$j_1.insertBefore(n,this.$j_1.firstChild)}t.selectedItemId=null;window._topRegions=null;this.$1h_1=t;n.setAttribute("cf","t");FrameShowHide.raiseShown();document.title=EcpUrl.get_isEso()?EcpProfile.get_instance().get_DisplayName()+" - "+n.title:n.title},$2g_1:function(){var n=new NavigatedEventArgs(document.title);NavigationNotification.notify(n);this.$0_1&&this.$0_1.postMessage(new CrossWindowMessage(15,n))},$3f_1:function(){var n=DataLossReporting.needRaiseWarning(!0);return n.get_hasChange()?n.get_warningMessage()||Strings.get_DataLossWarning():GlobalVariables.undefined},$3k_1:function(n){var t=n.target;if(!t){var i=this.$j_1.getElementsByTagName("IFRAME");if(i.length>0){t=i[0];t.style.display=""}}t&&(this.$l_1.style.display="none")},$3d_1:function(n){var t=document.createElement("IFRAME");t.className="abs0 hw100";t.frameBorder="0";t.scrolling="no";t.setAttribute("allowTransparency",!0);t.id="Ifrm"+this.$R_1;var i=EcpUrl.setUrlParameter(n.Url,"showhelp","false");EcpUrl.getUrlParameter(window.location.href,EcpUrl.singleSignOnParam)==="1"&&(i=EcpUrl.setUrlParameter(i,EcpUrl.singleSignOnParam,"1"));if(DatapointManager.get_isInstrumentationEnabled()){var r=DatapointManager.getNewRequestId();i=EcpUrl.setUrlParameter(i,EcpUrl.requestIdParam,r)}i=EcpUrl.setHash(i,n.selectedItemId);t.src=i;t.title=String.format(n.Format,n.Title);$addHandler(t,"load",this.$$d_$3k_1);t.setAttribute("ldHdlr","1");n.CachedFrm=t;PerfMonitor.iFrameNavigationStarted(t);return t},$3a_1:function(){var t=this.$1h_1;if(t){var n=t.CachedFrm;if(n){if(n.getAttribute("ldHdlr")){$removeHandler(n,"load",this.$$d_$3k_1);n.removeAttribute("ldHdlr")}if(!t.NoCache&&_Window.isAccessible(n.contentWindow)){FrameShowHide.raiseHiding();n.style.display="none";n.setAttribute("cf","f");Array.remove(this.$V_1,t);Array.add(this.$V_1,t);this.$V_1.length>10&&this.$2i_1(this.$V_1[0])}else this.$2j_1(t,n)}}},$2i_1:function(n){var t=n.CachedFrm;if(t){this.$2j_1(n,t);Array.remove(this.$V_1,n)}},$2j_1:function(n,t){_Window.isAccessible(t.contentWindow)&&(t.contentWindow._unload=!0);if(t.getAttribute("ldHdlr")){$removeHandler(t,"load",this.$$d_$3k_1);t.removeAttribute("ldHdlr")}t.parentNode.removeChild(t);n.CachedFrm=null},$Q_1:function(){for(var n=this.$4_1,t=0;t<=2;t++)n.Children&&n.Children.length>0&&n.Children.length>n.Selected&&(n=n.Children[n.Selected]);return n},$3O_1:function(){if(EcpUtil.isIE()){var n=this.$q_1;EcpUtil.safeFocus(n)}},$3p_1:function(n){var r=n.target;var t=this.$3F_1(r);if(t){var i=t.id.substr(5);DatapointManager.addDatapoint(String.format("{0}.{1}.{2}",EcpInstrumentationMarkers.navigation,i,this.$1Z_1?1:0));this.jumpTo(i,!1,null);n.preventDefault()}},$11_1:function(n){return $get(Navigation.$2V[n])},$3x_1:function(n){var i=[];i.push(n);var f="";n.parent=null;while(i.length>0){var t=i.pop();t.Selected||(t.Selected=0);t.NoCache||(t.NoCache=!1);t.Format?f=t.Format:t.Format=f;if(t.Children)for(var r=0;r<t.Children.length;r++){var u=t.Children[r];u.parent=t;u.index=r;i.push(u)}else t.Children=[]}}};function NavigationLinksAccHandler(n){this.$$d_$3j_0=Function.createDelegate(this,this.$3j_0);this.$$d_$3o_0=Function.createDelegate(this,this.$3o_0);this.$18_0=n;$(this.$18_0).keydown(this.$$d_$3o_0);this.$2K_0();this.$C_0=0}NavigationLinksAccHandler.prototype={$18_0:null,$I_0:null,$C_0:0,$3o_0:function(n){if(n.target.tagName==="A"&&!n.altKey&&!n.ctrlKey&&!n.shiftKey){var t=this.$C_0;switch(n.which){case 37:case 38:t=this.$C_0-1>=0?this.$C_0-1:0;break;case 39:case 40:t=this.$C_0+1<this.$I_0.length?this.$C_0+1:this.$I_0.length-1;break;case 36:t=0;break;case 35:t=this.$I_0.length-1;break}if(t!==this.$C_0){this.$I_0[t].focus();this.$C_0=t}}},$3j_0:function(n){var i=n.target;if(i.tagName==="A"){var r=i.getAttribute("index");var t=_String.isNullOrEmpty(r)?-1:Number.parseInvariant(r);t>=0&&this.$C_0!==t&&(this.$C_0=t)}},$2K_0:function(){this.$I_0=this.$18_0.getElementsByTagName("A");for(var n=0;n<this.$I_0.length;n++){var t=this.$I_0[n];t.setAttribute("index",n);$addHandler(t,EventNames.focus,this.$$d_$3j_0)}},$2h_0:function(){for(var n=0;n<this.$I_0.length;n++)$removeHandler(this.$I_0[n],EventNames.focus,this.$$d_$3j_0);this.$I_0=null},$3B_0:function(){EcpControl.freejQueryObject($(this.$18_0));this.$2h_0()}};function NavigatedEventArgs(n){NavigatedEventArgs.initializeBase(this);this.pageTitle=n}NavigatedEventArgs.prototype={pageTitle:null};function NavigationNotification(){NavigationNotification.initializeBase(this)}NavigationNotification.$$cctor=function(){CrossFrameReport.registerFactoryMethod("CFR_NNf",function(){return new NavigationNotification})};NavigationNotification.add_navigated=function(n){CrossFrameReport.addHandler("CFR_NNf","NNf",n)};NavigationNotification.remove_navigated=function(n){CrossFrameReport.removeHandler("CFR_NNf","NNf",n)};NavigationNotification.notify=function(n){CrossFrameReport.raiseReport("CFR_NNf","NNf",n)};function CombinedNotificationAdapter(n){this.$1N_0=n?new GeminiShellNotificationAdapter(this):new TopPageNotificationAdapter(this);this.$1d_0=new InnerPageNotificationAdapter(this)}CombinedNotificationAdapter.prototype={$1N_0:null,$1d_0:null,get_enabled:function(){return this.$1d_0.get_enabled()},getNotificationDetail:function(){this.onGetNotificationDetail()},showNotificationFlyout:function(n){this.onShowNotificationFlyout(n)},showNotificationCount:function(n,t){this.onShowNotificationCount(n)},showNotificationDetail:function(n,t){this.onShowNotificationDetail(n)},onGetNotificationDetail:function(){this.$1d_0.getNotificationDetail()},onShowNotificationFlyout:function(n){this.$1N_0.showNotificationFlyout(n)},onShowNotificationCount:function(n){this.$1N_0.showNotificationCount(n,!1)},onShowNotificationDetail:function(n){this.$1N_0.showNotificationDetail(n,!1)}};function CrossWindowNotificationCallback(n){this.$$d_$3l_0=Function.createDelegate(this,this.$3l_0);if(!n)throw Error.argumentNull("messenger");this.$9_0=n}CrossWindowNotificationCallback.prototype={$9_0:null,$A_0:null,get_topPageNotificationAdapter:function(){return this.$A_0},set_topPageNotificationAdapter:function(n){this.$A_0=n;return n},onGetNotificationDetail:function(){this.$9_0.postMessage(new CrossWindowMessage(23),0,null,this.$$d_$3l_0,null,!0);this.$9_0.postMessage(new CrossWindowMessage(23),1,null,this.$$d_$3l_0,null,!1)},onShowNotificationFlyout:function(n){var t=new CrossWindowShowFlyoutData;t.idToSelect=n;this.$9_0.postMessage(new CrossWindowMessage(21,t))},onShowNotificationCount:function(n){var t=new CrossWindowNotificationData;t.results=n;this.$9_0.postMessage(new CrossWindowMessage(22,t))},onShowNotificationDetail:function(n){var t=new CrossWindowNotificationData;t.results=n;this.$9_0.postMessage(new CrossWindowMessage(24,t))},$3l_0:function(n,t){this.$A_0&&this.$A_0.clearSingleResult(t)}};function DummyNotificationAdapter(){}DummyNotificationAdapter.prototype={get_enabled:function(){return!1},getNotificationDetail:function(){},showNotificationFlyout:function(n){},showNotificationCount:function(n,t){},showNotificationDetail:function(n,t){}};function GeminiShellNotificationAdapter(n){this.$1g_0={};if(!n)throw Error.argumentNull("callback");this.$H_0=n}GeminiShellNotificationAdapter.get_$2O=function(){return NavBar.$2.$1f_2};GeminiShellNotificationAdapter.prototype={$H_0:null,$26_0:0,$Y_0:!1,$2N_0:!1,get_enabled:function(){return!0},getNotificationDetail:function(){if(!this.$Y_0){this.$Y_0=!0;this.$H_0.onGetNotificationDetail()}},showNotificationFlyout:function(n){},showNotificationCount:function(n,t){if(n&&_PowerShellResults.hasOutput(n)){var i=n.Output[0].TotalCount;var r=i?Number.parseInvariant(i):0;if(this.$26_0!==r&&GeminiShellNotificationAdapter.get_$2O()){this.$42_0();this.getNotificationDetail()}}},showNotificationDetail:function(n,t){if(GeminiShellNotificationAdapter.get_$2O()&&n&&n.Output&&(!n.ErrorRecords||!n.ErrorRecords.length)){for(var u=0;u<n.Output.length;u++){var i=n.Output[u];var r=i.AlternativeId;var e=i.LastModified;if(this.$1g_0[r]!==e){this.$1g_0[r]=e;var o=i.ItemText;var s=i.StartedByText;var h=i.TypeText;var f=i.DetailPageId;O365Shell.Notifications.AddSystemNotification(h,String.format("{0} {1}",o,s),_String.isNullOrEmpty(f)?"":String.format("javascript:NotificationViewDetailLink.GoToPage('{0}','{1}',false);",f,r),_String.isNullOrEmpty(f)?"":Strings.get_ViewNotificationDetails(),"_self",r)}}this.$26_0=n.Output.length}this.$Y_0=!1},$42_0:function(){if(!this.$2N_0){this.$2N_0=!0;var n=this;O365Shell.Notifications.RegisterSystemNotificationsOpenedCallback(function(){n.getNotificationDetail()})}}};function InnerPageNotificationAdapter(n,t,i){this.$$d_showNotificationDetail=Function.createDelegate(this,this.showNotificationDetail);this.$$d_showNotificationCount=Function.createDelegate(this,this.showNotificationCount);if(!n)throw Error.argumentNull("callback");this.$H_0=n;if($get("ntfTemplate")||!_String.isNullOrEmpty(t)){_String.isNullOrEmpty(t)&&(t=EcpUrl.get_ecpVDir()+"DDI/DDIService.svc?schema=Notification&ua=0");_Object.isUndefined(i)&&(i=EcpApplication.get_instance().get_NotificationRefreshInterval());this.$o_0=new NotificationProvider(t,"GetCount","GetList",this.$$d_showNotificationCount,this.$$d_showNotificationDetail);this.$o_0.$r_0=i;this.$o_0.startGetNotificationCount();i>0&&(this.$P_0=!0)}}InnerPageNotificationAdapter.prototype={$o_0:null,$H_0:null,$P_0:!1,get_getNotificationDetailCommand:function(){return this.$o_0.get_getNotificationDetailCommand()},get_enabled:function(){return this.$P_0},getNotificationDetail:function(){this.$o_0.getNotificationDetail()},showNotificationFlyout:function(n){this.$H_0.onShowNotificationFlyout(n)},showNotificationCount:function(n,t){this.$H_0.onShowNotificationCount(n)},showNotificationDetail:function(n,t){this.$H_0.onShowNotificationDetail(n)}};function NotificationIcon(n){this.$$d_$3g_3=Function.createDelegate(this,this.$3g_3);NotificationIcon.initializeBase(this,[n]);n.innerHTML=String.format("<a id='ntfLink' href='#'><div class='ntfImgDiv'></div><span class='{0}' role='{1}'><span class='{2}'>{3}</span><span></span></span></a>","ntfIconText",AriaUtil.ariaStatus,CssClasses.hiddenForScreenReaderCSS,Strings.get_NotificationCount());var t=n.getElementsByTagName("DIV")[0];this.$19_3=SpriteImage.createSpriteImage(NavigationSprite.notificationNormal,Strings.get_Notification());t.appendChild(this.$19_3);this.$S_3=n.getElementsByTagName("A")[0];$addHandler(this.$S_3,EventNames.click,this.$$d_$3g_3);this.$2W_3=this.$S_3.getElementsByTagName("SPAN")[2];this.$2w_3()}NotificationIcon.prototype={$2W_3:null,$S_3:null,$19_3:null,$1b_3:!1,$d_3:0,$1U_3:null,add_click:function(n){this.get_events().addHandler(EventNames.click,n)},remove_click:function(n){this.get_events().removeHandler(EventNames.click,n)},get_linkElement:function(){return this.$S_3},get_TotalCount:function(){return this.$d_3},set_TotalCount:function(n){if(this.$d_3!==n){this.$d_3=n;this.$2w_3()}return n},get_HightLightMode:function(){return this.$1b_3},set_HightLightMode:function(n){if(this.$1b_3!==n){this.$1b_3=n;_DomElement.toggelCssClass(this.get_element(),n,"ntfHL");_DomElement.toggelCssClass(this.$19_3,!n,NavigationSprite.notificationNormalCssClass);_DomElement.toggelCssClass(this.$19_3,n,NavigationSprite.notificationHightlightCssClass)}return n},get_ErrorItems:function(){return this.$1U_3},set_ErrorItems:function(n){this.$1U_3!==n&&(this.$1U_3=n);return n},dispose:function(){$removeHandler(this.$S_3,EventNames.click,this.$$d_$3g_3);EcpControl.prototype.dispose.call(this)},$2w_3:function(){var n=this.$d_3>=2?this.$d_3.toString():"";this.$2W_3.innerHTML=n;this.set_visible(!!this.$d_3)},$3g_3:function(n){this.raiseEvent(EventNames.click,Sys.EventArgs.Empty)}};function NotificationFlyout(n){this.$$d_$3h_6=Function.createDelegate(this,this.$3h_6);NotificationFlyout.initializeBase(this,[n]);this.get_element().setAttribute(AriaUtil.ariaRole,AriaUtil.ariaAlert);$addHandler(this.get_element(),"click",this.$$d_$3h_6);this.set_textToReadWhenShow(Strings.get_Notification())}NotificationFlyout.prototype={add_postHide:function(n){this.get_events().addHandler("postHide",n)},remove_postHide:function(n){this.get_events().removeHandler("postHide",n)},hide:function(){Popup.prototype.hide.call(this);var n=this.get_element();this.raiseEvent("postHide",Sys.EventArgs.Empty);ControlHelper.disposeElement(n);_DomElement.remove(n)},dispose:function(){$removeHandler(this.get_element(),"click",this.$$d_$3h_6);Popup.prototype.dispose.call(this)},$3h_6:function(n){this.onElementClick(n.target)},getElementsToIterateByKeyboard:function(){var n=[];var t=this;$("."+CssClasses.popupButton,this.get_element()).each(function(t,i){i.style.display!=="none"&&Array.add(n,i)});return n},onElementFocused:function(n){Popup.prototype.onElementFocused.call(this,n);n.scrollIntoView(!1)},onElementClick:function(n){var t=n.getAttribute("DetailPageId");var i=n.getAttribute("ItemId");if(!_String.isNullOrEmpty(t)){var r=Boolean.parse(n.getAttribute("FromAnotherPremise"));NotificationViewDetailLink.GoToPage(t,i,r)}}};function NotificationProvider(n,t,i,r,u){this.$$d_$2C_0=Function.createDelegate(this,this.$2C_0);this.$$d_$3M_0=Function.createDelegate(this,this.$3M_0);this.$$d_$3L_0=Function.createDelegate(this,this.$3L_0);this.$2Z_0=r;this.$1n_0=u;this.$12_0=new LoadCommandWrapper(n,t,this.$$d_$3L_0,null);this.$i_0=new LoadCommandWrapper(n,i,this.$$d_$3M_0,null)}NotificationProvider.prototype={$u_0:!1,$r_0:0,$U_0:0,$12_0:null,$i_0:null,$2Z_0:null,$1n_0:null,dispose:function(){this.$12_0&&this.$12_0.dispose();this.$i_0&&this.$i_0.dispose()},get_getNotificationDetailCommand:function(){return this.$i_0.$8_0},get_refreshInterval:function(){return this.$r_0},set_refreshInterval:function(n){this.$r_0=n;return n},startGetNotificationCount:function(){this.set_$1e_0(!0)},stopGetNotificationCount:function(){this.set_$1e_0(!1)},getNotificationDetail:function(){this.$i_0.execute()},get_$1e_0:function(){return this.$u_0},set_$1e_0:function(n){if(this.$u_0!==n){this.$u_0=n;if(this.$u_0)this.$U_0||this.$2C_0();else if(this.$U_0){window.clearTimeout(this.$U_0);this.$U_0=0}}return n},$3L_0:function(n){this.$2Z_0(n,!1);this.$u_0&&(this.$r_0>0?this.$U_0=window.setTimeout(this.$$d_$2C_0,this.$r_0):this.set_$1e_0(!1))},$2C_0:function(){this.$12_0.execute()},$3M_0:function(n){this.$1n_0&&this.$1n_0(n,!1)}};function NotificationViewDetailLink(n){NotificationViewDetailLink.initializeBase(this,[n])}NotificationViewDetailLink.GoToPage=function(n,t,i){if(CrossPremise.get_instance())CrossPremise.NavTo(i?"enterprise":"office365",!1,n,t);else{var r=EcpApplication.get_instance();r&&r.get_Navigation()&&r.get_Navigation().jumpTo(n,!1,t)}};NotificationViewDetailLink.prototype={get_visible:function(){return EcpControl.prototype.get_visible.call(this)},set_visible:function(n){EcpControl.prototype.set_visible.call(this,n);EcpUtil.setInnerText(this.get_element(),n?Strings.get_ViewNotificationDetails():"");return n},get_detailPageId:function(){return this.get_element().getAttribute("DetailPageId")},set_detailPageId:function(n){if(n!==this.get_detailPageId()){this.get_element().setAttribute("DetailPageId",n);this.raisePropertyChanged("DetailPageId")}return n},get_itemId:function(){return this.get_element().getAttribute("ItemId")},set_itemId:function(n){if(n!==this.get_itemId()){this.get_element().setAttribute("ItemId",n);this.raisePropertyChanged("ItemId")}return n},get_fromAnotherPremise:function(){return this.get_element().getAttribute("FromAnotherPremise")},set_fromAnotherPremise:function(n){if(n!==this.get_fromAnotherPremise()){this.get_element().setAttribute("FromAnotherPremise",n);this.raisePropertyChanged("FromAnotherPremise")}return n}};function NotificationViewModel(){NotificationViewModel.initializeBase(this)}NotificationViewModel.$2S=function(n,t,i){var r=[];n&&Array.addRange(r,n);t&&Array.addRange(r,t);i&&r.sort(i);return r};NotificationViewModel.prototype={$t_3:null,$Y_3:!1,$c_3:0,$h_3:0,$15_3:0,$1E_3:0,$m_3:null,$s_3:null,$16_3:null,$1F_3:null,$2q_3:0,$2a_3:null,get_TotalCount:function(){return this.$15_3+this.$1E_3},get_LocalCount:function(){return this.$15_3},set_LocalCount:function(n){if(this.$15_3!==n){this.$15_3=n;this.raisePropertyChanged("LocalCount");this.raisePropertyChanged("TotalCount")}return n},get_RemoteCount:function(){return this.$1E_3},set_RemoteCount:function(n){if(this.$1E_3!==n){this.$1E_3=n;this.raisePropertyChanged("RemoteCount");this.raisePropertyChanged("TotalCount")}return n},get_HightLightMode:function(){return this.getValue("HightLightMode")},set_HightLightMode:function(n){this.setValue("HightLightMode",n);return n},get_ErrorItems:function(){return NotificationViewModel.$2S(this.$m_3,this.$s_3,null)},get_LocalErrorItems:function(){return this.$m_3},set_LocalErrorItems:function(n){if(this.$m_3!==n){this.$m_3=n;this.raisePropertyChanged("LocalErrorItems");this.raisePropertyChanged("ErrorItems")}return n},get_RemoteErrorItems:function(){return this.$s_3},set_RemoteErrorItems:function(n){if(this.$s_3!==n){this.$s_3=n;this.raisePropertyChanged("RemoteErrorItems");this.raisePropertyChanged("ErrorItems")}return n},get_selectedItemID:function(){return this.$t_3},set_selectedItemID:function(n){this.$t_3=n;return n},get_Items:function(){for(var i=this,t=NotificationViewModel.$2S(this.$16_3,this.$1F_3,function(n,t){var i=n;var r=t;return i.LastModified===r.LastModified?0:new Date(i.LastModified)>new Date(r.LastModified)?-1:1}),n=0;n<t.length;n++)t[n].IsFirst=!n;return t},get_LocalItems:function(){return this.$16_3},set_LocalItems:function(n){if(this.$16_3!==n){this.$16_3=n;this.raisePropertyChanged("LocalItems");this.raisePropertyChanged("Items")}return n},get_RemoteItems:function(){return this.$1F_3},set_RemoteItems:function(n){if(this.$1F_3!==n){this.$1F_3=n;this.raisePropertyChanged("RemoteItems");this.raisePropertyChanged("Items")}return n},get_onShowFlyout:function(){return this.$2a_3},set_onShowFlyout:function(n){this.$2a_3=n;return n},initialize:function(){this.setValue("ShowProgress",!1);Sys.Component.prototype.initialize.call(this)},dispose:function(){this.$34_3();this.$20_3();ViewModelBase.prototype.dispose.call(this)},reload:function(){if(!this.$Y_3){this.$Y_3=!0;this.$35_3();this.$48_3()}},$35_3:function(){this.setValue("ServiceCallFailed",!1);this.set_LocalItems(null);this.set_RemoteItems(null)},$4C_3:function(n,t){if(!n||!n.Output||n.ErrorRecords&&n.ErrorRecords.length>0)this.setValue("ServiceCallFailed",!0);else if(n.Output.length>0){for(var r=[],i=0;i<n.Output.length;i++){var u=n.Output[i][GlobalVariables.notificationItemIdPropertyName];this.$t_3&&this.$t_3===u&&(n.Output[i].Selected=!0);n.Output[i].ItemImg==="ErrorImg"&&Array.add(r,u);n.Output[i].FromAnotherPremise=t.toString()}if(t){this.set_RemoteCount(n.Output.length);this.set_RemoteErrorItems(r);this.set_RemoteItems(n.Output)}else{this.set_LocalCount(n.Output.length);this.set_LocalErrorItems(r);this.set_LocalItems(n.Output)}}TestHelper.raiseTestEvent(this,TestHelper.dataReady);this.$Y_3=!1},setNotificationDetail:function(n,t){var i=this;this.$36_3(function(){i.$4C_3(n,t)})},setNotificationCount:function(n,t){if(n&&_PowerShellResults.hasOutput(n)){for(var u=n.Output[0].TotalCount,f=u?Number.parseInvariant(u):0,e=t?this.$s_3:this.$m_3,i=n.Output[0].ErrorItems,o=!1,r=0;r<i.length;r++)if(!e||!Array.contains(e,i[r])){o=!0;break}if(t){this.set_RemoteCount(f);this.set_RemoteErrorItems(i)}else{this.set_LocalCount(f);this.set_LocalErrorItems(i)}o&&this.get_onShowFlyout()&&this.get_onShowFlyout()(null)}},$20_3:function(){if(this.$c_3){window.clearTimeout(this.$c_3);this.$c_3=0}},$34_3:function(){if(this.$h_3){window.clearTimeout(this.$h_3);this.$h_3=0}},$48_3:function(){var n=this;this.$c_3=window.setTimeout(function(){n.$c_3=0;n.setValue("ShowProgress",!0);n.$2q_3=(new Date).getTime()},1e3)},$21_3:function(n){this.$20_3();this.setValue("ShowProgress",!1);_Object.isNullOrUndefined(n)||n()},$36_3:function(n){var t=0;this.$c_3||(t=this.$2q_3+1e3-(new Date).getTime());if(t>0){var i=this;this.$h_3=window.setTimeout(function(){i.$21_3(n);i.$h_3=0},t)}else this.$21_3(n)}};function TopPageNotificationAdapter(n){this.$$d_$3e_0=Function.createDelegate(this,this.$3e_0);this.$$d_$3c_0=Function.createDelegate(this,this.$3c_0);this.$$d_$3b_0=Function.createDelegate(this,this.$3b_0);this.$$d_$3D_0=Function.createDelegate(this,this.$3D_0);this.$$d_showNotificationFlyout=Function.createDelegate(this,this.showNotificationFlyout);if(!n)throw Error.argumentNull("callback");this.$7_0=$create(NotificationViewModel);this.$7_0.set_onShowFlyout(this.$$d_showNotificationFlyout);this.$H_0=n;CrossWindowNotificationCallback.isInstanceOfType(this.$H_0)&&(this.$H_0.$A_0=this);if($get("ntfTemplate")){this.$3R_0();this.$P_0=!0}}TopPageNotificationAdapter.prototype={$17_0:0,$2B_0:null,$7_0:null,$H_0:null,$5_0:null,$P_0:!1,get_dataContext:function(){return this.$7_0},getNotificationDetail:function(){this.$H_0.onGetNotificationDetail()},get_enabled:function(){return this.$P_0},showNotificationFlyout:function(n){this.$5_0&&this.$39_0(n)},$39_0:function(n){this.$2B_0=n;if(!this.$17_0){var t=this;this.$17_0=window.setInterval(function(){if(!DialogManager.hasVisibleModalDialog()){window.clearInterval(t.$17_0);t.$17_0=0;t.$2n_0(t.$2B_0)}},500)}},$2n_0:function(n){var t=$get("flyout");if(!t){t=document.createElement("DIV");t.className="ntfFlyout";t.id="flyout";this.$5_0.get_element().appendChild(t);var i=$create(NotificationFlyout,null,null,null,t);i.set_templateId("NotificationFlyout");i.set_DataContext(this.$7_0);i.addBinding(new Binding("HightLightMode","isShown",4));i.add_postHide(this.$$d_$3D_0);i.show(0,0,0)}this.$7_0.$t_3=n;this.$7_0.reload();this.getNotificationDetail()},showNotificationCount:function(n,t){this.$7_0.setNotificationCount(n,t)},showNotificationDetail:function(n,t){this.$7_0.setNotificationDetail(n,t)},clearSingleResult:function(n){if(n){this.$7_0.set_RemoteCount(0);this.$7_0.set_RemoteErrorItems([]);this.$7_0.set_RemoteItems([])}else{this.$7_0.set_LocalCount(0);this.$7_0.set_LocalErrorItems([]);this.$7_0.set_LocalItems([])}},$3R_0:function(){var n=$get("ntfIcon");if(n)this.$22_0(n);else if(NavBar.$2){NavBar.$2.add_postRender(this.$$d_$3b_0);NavBar.$2.add_preRender(this.$$d_$3c_0);this.$2u_0()}},$2u_0:function(){var t=NavBar.$2.getNotificationIconContainer();if(t){var n=document.createElement("SPAN");n.id="ntfIcon";t.appendChild(n);this.$22_0(n)}},$3c_0:function(n,t){this.$44_0()},$3b_0:function(n,t){this.$2u_0()},$3D_0:function(n,t){DialogManager.hasVisibleModalDialog()?DialogManager.focusControlAfterClose(this.$5_0.$S_3,!0):this.$5_0&&this.$5_0.get_visible()&&EcpUtil.focusWithoutActivateWindow(this.$5_0.$S_3)},$44_0:function(){if(this.$5_0){this.$5_0.remove_click(this.$$d_$3e_0);var n=this.$5_0.get_element();ControlHelper.disposeElement(n);_DomElement.remove(n);this.$5_0=null}},$22_0:function(n){this.$5_0=$create(NotificationIcon,null,null,null,n);this.$5_0.set_DataContext(this.$7_0);this.$5_0.addBinding(new Binding("TotalCount","TotalCount",2));this.$5_0.addBinding(new Binding("ErrorItems","ErrorItems",2));this.$5_0.addBinding(new Binding("HightLightMode","HightLightMode",2));this.$5_0.add_click(this.$$d_$3e_0)},$3e_0:function(n,t){this.$2n_0(null)}};function PostMessageFailedEventArgs(n){this.messageRecord=n}PostMessageFailedEventArgs.prototype={messageRecord:null};function ReceiveMessageEventArgs(n,t){this.message=n;this.origin=t}ReceiveMessageEventArgs.prototype={message:null,origin:null,$1G_0:null,get_replyMessage:function(){return this.$1G_0},set_replyMessage:function(n){if(this.$1G_0)throw Error.invalidOperation("ReplyMessage already set.");else this.$1G_0=n;return n}};function ReceiveMessageRecord(n){this.messageId=n;this.time=(new Date).getTime()}ReceiveMessageRecord.prototype={messageId:0,time:0};function ReloadWindowContext(n){this.pageId=n}ReloadWindowContext.prototype={pageId:null,languageOverriden:null};function ShowPerfConsoleCommandHandler(){}ShowPerfConsoleCommandHandler.showPerfConsole=function(n){n||(n="PerfConsole");var t=BuildCenteredWindowFeatureString(600,800,GlobalVariables.FeaturesForPopups);PopupWindowManager.OpenWindow("Performance/PerfConsole.slab",n,t)};ShowPerfConsoleCommandHandler.prototype={$2p_0:!1,$2o_0:!1,click:function(){if(CrossPremise.get_instance()){this.$2p_0&&CrossPremise.NavTo("showEnterprisePerfconsole",!1);this.$2o_0&&CrossPremise.NavTo("showOffice365Perfconsole",!1)}else ShowPerfConsoleCommandHandler.showPerfConsole()},initialize:function(n){if(CrossPremise.get_instance()){n.set_visible(!1);var t=this;CrossPremiseSyncer.get_instance().add_syncDataReceived(function(i,r){r.data.showPerfConsole&&n.set_visible(!0);r.orgType?r.orgType===1&&(t.$2o_0=r.data.showPerfConsole):t.$2p_0=r.data.showPerfConsole})}}};function IFrameWindowFactory(n){this.$2J_0=n}IFrameWindowFactory.prototype={$2J_0:null,getWindowInstance:function(){return this.$2J_0.contentWindow}};function ParentWindowFactory(n){this.$2y_0=n}ParentWindowFactory.prototype={$2y_0:null,getWindowInstance:function(){return this.$2y_0.parent}};CheckDataLossContext.registerClass("CheckDataLossContext");NavigationDialogContext.registerClass("NavigationDialogContext");CheckDataLossAnswer.registerClass("CheckDataLossAnswer",null,ICrossWindowDataV1);CheckActionAvailableData.registerClass("CheckActionAvailableData",null,ICrossWindowDataV1);ClientRbac.registerClass("ClientRbac");CmdletLoggingNavHelper.registerClass("CmdletLoggingNavHelper");HybridCmdletLoggingCommandHandler.registerClass("HybridCmdletLoggingCommandHandler",null,IToolBarItemCommandHandler);CrossPremise.registerClass("CrossPremise",Sys.Component,ICrossPremise);CrossPremise.LogoutDataContext.registerClass("CrossPremise.LogoutDataContext");CrossPremiseUrl.registerClass("CrossPremiseUrl");SyncDataReceivedEventArgs.registerClass("SyncDataReceivedEventArgs",Sys.EventArgs);CrossPremiseSyncer.registerClass("CrossPremiseSyncer");CrossWindowMessage.registerClass("CrossWindowMessage");CrossWindowMessenger.registerClass("CrossWindowMessenger");CrossWindowNavigation.registerClass("CrossWindowNavigation",null,ICrossWindowDataV1);CrossWindowNotificationData.registerClass("CrossWindowNotificationData",null,ICrossWindowDataV1);CrossWindowPowerShellResults.registerClass("CrossWindowPowerShellResults",null,ICrossWindowDataV1);CrossWindowShowFlyoutData.registerClass("CrossWindowShowFlyoutData",null,ICrossWindowDataV1);CrossWindowSwitchSlabData.registerClass("CrossWindowSwitchSlabData",null,ICrossWindowDataV1);CrossWindowSync.registerClass("CrossWindowSync",null,ICrossWindowDataV1);CrossSiteAgent.registerClass("CrossSiteAgent",null,ICrossSiteAgent);CrossSitePopupData.registerClass("CrossSitePopupData",null,ICrossWindowDataV1);DropDownButton.registerClass("DropDownButton",ContainerControl);EsoPickerLauncher.registerClass("EsoPickerLauncher",null,IPickerLauncher);FVAHelpEnabledToggleCommandHandler.registerClass("FVAHelpEnabledToggleCommandHandler",ToggleCommandHandler);HeartbeatDetector.registerClass("HeartbeatDetector");HybridLogoutHelper.registerClass("HybridLogoutHelper",EcpControl);LoadCommandWrapper.registerClass("LoadCommandWrapper");MessageRecord.registerClass("MessageRecord");NavBar.registerClass("NavBar",Sys.Component);NavBarGemini.registerClass("NavBarGemini",NavBar);NavBarV15.registerClass("NavBarV15",NavBar);NavBarV15Parity.registerClass("NavBarV15Parity",NavBar);NavBarPack.registerClass("NavBarPack");NavBarData.registerClass("NavBarData");NavBarLinkData.registerClass("NavBarLinkData");NavBarImageData.registerClass("NavBarImageData");NavBarImageClipInfo.registerClass("NavBarImageClipInfo");Navigation.registerClass("Navigation",Sys.Component,INavigation);NavigationLinksAccHandler.registerClass("NavigationLinksAccHandler");NavigatedEventArgs.registerClass("NavigatedEventArgs",Sys.EventArgs,ICrossWindowDataV1);NavigationNotification.registerClass("NavigationNotification",CrossFrameReport);CombinedNotificationAdapter.registerClass("CombinedNotificationAdapter",null,INotificationAdapter,INotificationIconCallback,INotificationProviderCallback);CrossWindowNotificationCallback.registerClass("CrossWindowNotificationCallback",null,INotificationIconCallback,INotificationProviderCallback);DummyNotificationAdapter.registerClass("DummyNotificationAdapter",null,INotificationAdapter);GeminiShellNotificationAdapter.registerClass("GeminiShellNotificationAdapter",null,INotificationAdapter);InnerPageNotificationAdapter.registerClass("InnerPageNotificationAdapter",null,INotificationAdapter);NotificationIcon.registerClass("NotificationIcon",EcpControl);NotificationFlyout.registerClass("NotificationFlyout",Popup);NotificationProvider.registerClass("NotificationProvider");NotificationViewDetailLink.registerClass("NotificationViewDetailLink",HyperLink);NotificationViewModel.registerClass("NotificationViewModel",ViewModelBase);TopPageNotificationAdapter.registerClass("TopPageNotificationAdapter",null,INotificationAdapter);PostMessageFailedEventArgs.registerClass("PostMessageFailedEventArgs");ReceiveMessageEventArgs.registerClass("ReceiveMessageEventArgs");ReceiveMessageRecord.registerClass("ReceiveMessageRecord");ReloadWindowContext.registerClass("ReloadWindowContext",null,ICrossWindowDataV1);ShowPerfConsoleCommandHandler.registerClass("ShowPerfConsoleCommandHandler",null,IToolBarItemCommandHandler);IFrameWindowFactory.registerClass("IFrameWindowFactory",null,IWindowFactory);ParentWindowFactory.registerClass("ParentWindowFactory",null,IWindowFactory);CrossPremise.idEnterprise="enterprise";CrossPremise.idOffice365="office365";CrossPremise.$2=null;CrossPremiseSyncer.$2=null;CrossWindowMessage.$1R=0;NavBar.$2=null;NavBarV15.$2T=EcpUrl.get_ecpFullUrl()+"O365/NavBar.svc";Navigation.$2V=["topNavZone","priNav","secNav"];Navigation.$2r=[null,"<ul>",_String.empty];Navigation.$2P=[null,'<li id="Menu_{0}" class="{1}"><span><a class="priNavLnk" href="#" aria-expanded="{3}" aria-label="{4}">{2}</a></span></li>','<div id="Menu_{0}" class="{1}"><a class="secNavLnk" href="#" aria-expanded="{3}" aria-label="{4}">{2}</a></div>'];Navigation.$27=[null,"</ul>",_String.empty];Navigation.$1r=[null,"priSelected","secNavBtn secSelected"];Navigation.$1m=[_String.empty,_String.empty,"secNavBtn"];Navigation.$Z=null;Navigation.$w=!1;Navigation.$14=!1;NavigationNotification.$$cctor();NotificationIcon.linkID="ntfLink";TopPageNotificationAdapter.notificationTemplateID="ntfTemplate"