Type.registerNamespace("ECP");function ExtendedReportRequestSlab(n){this.$$d_$Y_4=Function.createDelegate(this,this.$Y_4);this.$$d_$Z_4=Function.createDelegate(this,this.$Z_4);this.$$d_$V_4=Function.createDelegate(this,this.$V_4);this.$$d_$e_4=Function.createDelegate(this,this.$e_4);this.$$d_$f_4=Function.createDelegate(this,this.$f_4);this.$$d_$Q_4=Function.createDelegate(this,this.$Q_4);this.$$d_$a_4=Function.createDelegate(this,this.$a_4);ExtendedReportRequestSlab.initializeBase(this,[n])}ExtendedReportRequestSlab.$E=function(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())};ExtendedReportRequestSlab.prototype={$3_4:null,$A_4:null,$4_4:null,$8_4:null,$C_4:null,$K_4:null,$D_4:null,$F_4:null,$G_4:null,$L_4:null,$0_4:null,$2_4:null,$R_4:null,$1_4:null,$J_4:null,$6_4:null,$H_4:null,$M_4:null,$N_4:null,$7_4:null,$I_4:null,get_ServerDate:function(){return this.$I_4},set_ServerDate:function(n){this.$I_4=n;return n},get_SubmitButton:function(){return this.$3_4},set_SubmitButton:function(n){this.$3_4=n;return n},get_CloseButton:function(){return this.$A_4},set_CloseButton:function(n){this.$A_4=n;return n},get_ServiceUrl:function(){return this.$J_4},set_ServiceUrl:function(n){this.$J_4=n;return n},get_FromEditor:function(){return this.$G_4},set_FromEditor:function(n){this.$G_4=n;return n},get_ToEditor:function(){return this.$L_4},set_ToEditor:function(n){this.$L_4=n;return n},get_MessageIDTextBox:function(){return this.$8_4},set_MessageIDTextBox:function(n){this.$8_4=n;return n},get_ClientIPTextBox:function(){return this.$C_4},set_ClientIPTextBox:function(n){this.$C_4=n;return n},get_ReportTitleTextBox:function(){return this.$6_4},set_ReportTitleTextBox:function(n){this.$6_4=n;return n},get_NotifyAddressTextBox:function(){return this.$H_4},set_NotifyAddressTextBox:function(n){this.$H_4=n;return n},get_DdDeliveryStatusEx:function(){return this.$4_4},set_DdDeliveryStatusEx:function(n){this.$4_4=n;return n},get_StartDate:function(){return this.$0_4},set_StartDate:function(n){this.$0_4=n;return n},get_EndDate:function(){return this.$2_4},set_EndDate:function(n){this.$2_4=n;return n},get_DockPanel:function(){return this.$N_4},set_DockPanel:function(n){this.$N_4=n;return n},get_ReportOptionsPanel:function(){return this.$R_4},set_ReportOptionsPanel:function(n){this.$R_4=n;return n},get_DateRangePanel:function(){return this.$M_4},set_DateRangePanel:function(n){this.$M_4=n;return n},initialize:function(){EcpControl.prototype.initialize.call(this);this.$K_4=this.$$d_$a_4;this.$D_4=this.$$d_$Q_4;$addHandler(this.$3_4,"click",this.$K_4);$addHandler(this.$A_4,"click",this.$D_4);this.$1_4=new WebServiceCommand;this.$1_4.set_serviceUrl(this.$J_4);this.$1_4.set_methodName("SubmitJob");this.$1_4.set_parameterNames(3);this.$1_4.get_webServiceMethod().add_Succeeded(this.$$d_$f_4);this.$1_4.get_webServiceMethod().add_Completed(this.$$d_$e_4);this.$0_4.set_enabled(!0);this.$2_4.set_enabled(!0);this.$4_4.style.display="inline";this.$4_4.selectedIndex=0;this.$0_4.add_selectedValueChanged(this.$$d_$V_4);this.$2_4.add_selectedValueChanged(this.$$d_$V_4);var e=$("a[class='helpLink']");var o=e[0];o.setAttribute("style","float:right");var n=window.location.toString();if(_String.isNullOrEmpty(n))MessageBox.showMessage(Strings.get_ExtendedReportsInsufficientData(),MessageBoxType.error);else{for(var t=0,i=n.length-1;i>=0;i--)if(n.charAt(i)==="=")t++;else break;t>0&&(n=n.substring(0,n.length-t));for(var r=UrlUtil.getParameterFromUrl(n,"data"),u=new Sys.StringBuilder(r),f=0;f<t;f++)u.append("=");r=u.toString();var s=Sys.Serialization.JavaScriptSerializer.deserialize(EcpUtil.decodeBase64(r));this.$7_4=new ExtendedReportRequestSettingsViewModel(s);this.$b_4(this.$7_4)}},dispose:function(){this.$1_4.get_webServiceMethod().remove_Completed(this.$$d_$e_4);this.$1_4.get_webServiceMethod().remove_Succeeded(this.$$d_$f_4);this.$0_4.remove_selectedValueChanged(this.$$d_$V_4);this.$2_4.remove_selectedValueChanged(this.$$d_$V_4);$removeHandler(this.$3_4,"click",this.$K_4);$removeHandler(this.$A_4,"click",this.$D_4);if(this.$F_4){FrameShowHide.remove_shown(this.$F_4);this.$F_4=null}EcpControl.prototype.dispose.call(this)},$b_4:function(n){var o=n.get_SelectedDate();var r=ExtendedReportRequestSlab.$E(o);var f=o;f.setDate(f.getDate()+1);var u=ExtendedReportRequestSlab.$E(f);r.setHours(0);r.setMinutes(0);r.setSeconds(0);u.setHours(0);u.setMinutes(0);u.setSeconds(0);this.$0_4.set_selectedValue(r);this.$2_4.set_selectedValue(u);var t=_String.empty;var i=_String.empty;switch(this.$7_4.get_typeOfReport()){case 3:t=Strings.get_RequestDLPDetail();i=Strings.get_RequestDLPDetailReportTitle();break;case 0:t=Strings.get_RequestMalwareDetail();i=Strings.get_RequestMalwareDetailReportTitle();break;case 1:t=Strings.get_RequestSpamDetail();i=Strings.get_RequestSpamDetailReportTitle();break;case 2:t=Strings.get_RequestRuleDetail();i=Strings.get_RequestRuleDetailReportTitle();break}document.title=t;this.$6_4.value=String.format(i,this.$I_4);var s=$("[id^=pendingQueries] > [id$=remainingQueries]");var e=s[0];if(e){var h=e.innerText;if(parseInt(n.get_RemainingQueryCount())>10){var c=$("#pendingQueries");c.hide()}else e.innerText=String.format(h,n.get_RemainingQueryCount())}},$V_4:function(n,t){this.$4_4.selectedIndex=0},$T_4:function(){return this.$0_4.get_selectedValue()},$S_4:function(){return this.$2_4.get_selectedValue()},$e_4:function(n,t){UpdateProgressPopUp.progressCompleted(null,!0)},$f_4:function(n,t){var i=t.get_results();_PowerShellResults.hasMessage(i)?ErrorHandling.showPowerShellErrorsWithCallback(i,this.$$d_$Z_4):this.$U_4();this.$3_4.disabled=!1},$U_4:function(){window.top.postMessage("saveExternalPagePopup","*");this.$Q_4(null)},$Z_4:function(n,t){this.$3_4.disabled=!1},$a_4:function(n){if(FieldValidationAssistant.get_instance().highlightFieldsInError())MessageBox.showMessageWithCallback(Strings.get_DeliveryReportSearchFieldsInError(),MessageBoxType.error,this.$$d_$Y_4);else{var u=this.$T_4();var i=this.$S_4();var r=new Date;r.setDate(r.getDate()+1);var t=ExtendedReportRequestSlab.$E(r);t.setHours(0);t.setMinutes(0);t.setSeconds(0);var f=(i.getTime()-u.getTime())/864e5;this.$8_4.value.indexOf(",")!==-1?this.$9_4(Strings.get_MessageTraceMessageIDCannotContainComma(),this.$8_4):f>90?this.$9_4(Strings.DateExceedsRange(90),this.$0_4.get_element()):u>=i?this.$9_4(Strings.get_MessageTraceInvalidStartDate(),this.$0_4.get_element()):i>t?this.$9_4(Strings.get_EndDateMustBeYesterday(),this.$2_4.get_element()):_String.isNullOrEmpty(this.$6_4.value)?this.$9_4(Strings.get_ReportTitleMissing(),this.$6_4):this.$X_4()}},$c_4:function(n,t){var i=this.$7_4.get_SelectedSeriesSlicers().join(",");t.ReportType=ExtendedReportRequestSettingsViewModel.ReportType.toString(n)},$X_4:function(){var n={};n.MessageId=this.$8_4.value;n.RecipientAddress=this.$L_4.get_value();n.SenderAddress=this.$G_4.get_value();n.TimeZone="UTC";n.DateRangeType="custom";n.Locale=Sys.CultureInfo.CurrentCulture.name;n.Direction=this.$7_4.get_SelectedDirection();n.ClientIP=this.$C_4.value;n.ReportTitle=this.$6_4.value;n.NotifyAddress=this.$H_4.value;n.StartDate=this.$0_4.get_value();n.EndDate=this.$2_4.get_value();n.StatusFilter=this.$4_4.value;this.$c_4(this.$7_4.get_typeOfReport(),n);UpdateProgressPopUp.showProgressImmediately(Strings.get_JobSubmissionWaitText());this.$3_4.disabled=!0;var t=this;this.$1_4.set_ParameterGetter(function(){return[n]});this.$1_4.execute()},$9_4:function(n,t){var i=new Info;i.Message=n;i.MessageType=MessageBoxType.error;MessageBox.show(i,4,this.$$d_$Y_4,t)},$Y_4:function(n,t){var i=FieldValidationAssistant.get_instance().get_firstTextboxInError();if(i){var r=this;window.setTimeout(function(){ActiveElementMoniter.setActive(i)},100)}if(t){i=t;var u=this;window.setTimeout(function(){ActiveElementMoniter.setActive(i)},100)}},$Q_4:function(n){window.top.postMessage("cancelExternalPagePopup","*")}};function ExtendedReportRequestSettingsViewModel(n){if(_Object.isNullOrUndefined(n))throw Error.argumentNull("rawData");this.$5_0=n}ExtendedReportRequestSettingsViewModel.$d=function(n){return n.toLowerCase().startsWith("/date(")?new Date(parseInt(n.substr(6))):Date.parseInvariant(n)};ExtendedReportRequestSettingsViewModel.$P=function(n,t){var i=n;for(var r in i){var u={key:r,value:i[r]};if(u.key.indexOf(t)>=0)return u.key}return _String.empty};ExtendedReportRequestSettingsViewModel.$O=function(n){var t=ExtendedReportRequestSettingsViewModel.$P(n,"Inbound");var u=ExtendedReportRequestSettingsViewModel.$P(n,"Outbound");if(!_String.isNullOrEmpty(t)&&!_String.isNullOrEmpty(t)){var i=!1;var r=!1;i=t in n&&n[t];r=u in n&&n[u];if(i&&r)return"All";else if(i)return"Received";else if(r)return"Sent"}return _String.empty};ExtendedReportRequestSettingsViewModel.prototype={$5_0:null,get_ReportIdentity:function(){return this.$5_0.r},get_Category:function(){return this.$5_0.c},get_Slicers:function(){return this.$5_0.s},get_SelectedDate:function(){return ExtendedReportRequestSettingsViewModel.$d(this.get_Category())},get_SelectedDirection:function(){var n=ExtendedReportRequestSettingsViewModel.$O(this.get_Slicers());if(!_String.isNullOrEmpty(n))return n;var t=ExtendedReportRequestSettingsViewModel.$O(this.get_MultiSelector());return _String.isNullOrEmpty(t)?_String.empty:t},get_MultiSelector:function(){return this.$5_0.m},get_RemainingQueryCount:function(){return this.$5_0.q},get_SelectedSeriesSlicers:function(){var u=this.get_Slicers();var n=[];var t=u;for(var i in t){var r={key:i,value:t[i]};r.value&&Array.add(n,r.key)}return n},get_typeOfReport:function(){return this.$W_0()},$W_0:function(){if(_String.isNullOrEmpty(this.get_ReportIdentity()))throw Error.argumentNull("reportIdentity","Report Identity was null or empty");var n=this.get_ReportIdentity().toLowerCase();switch(n){case"dlppolicymatchesformaildetails":case"dlppolicymatchesformailbyactiondetails":case"dlppolicymatchesformailbyruledetails":return 3;case"malwaredetectionsdetails":return 0;case"rulematchesformaildetails":case"rulematchesformailbyactiondetails":return 2;case"spamdetectionsdetails":return 1;default:return 4}}};ExtendedReportRequestSettingsViewModel.ReportType=function(){};ExtendedReportRequestSettingsViewModel.ReportType.prototype={malware:0,spam:1,transportRule:2,DLP:3,unsupported:4};ExtendedReportRequestSettingsViewModel.ReportType.registerEnum("ExtendedReportRequestSettingsViewModel.ReportType",!1);ExtendedReportRequestSlab.registerClass("ExtendedReportRequestSlab",ContainerControl);ExtendedReportRequestSettingsViewModel.registerClass("ExtendedReportRequestSettingsViewModel")