Type.registerNamespace("ECP");function AddUMExtensionProperties(n){this.$$d_$g_5=Function.createDelegate(this,this.$g_5);AddUMExtensionProperties.initializeBase(this,[n])}AddUMExtensionProperties.prototype={$0_5:null,$U_5:null,$E_5:null,$9_5:null,$N_5:null,initialize:function(){PropertyPage.prototype.initialize.call(this);this.$9_5.add_propertyChanged(this.$$d_$g_5)},get_ExtensionLabel:function(){return this.$N_5},set_ExtensionLabel:function(n){this.$N_5=n;return n},get_Extension:function(){return this.$0_5},set_Extension:function(n){this.$0_5=n;return n},get_PhoneContext:function(){return this.$U_5},set_PhoneContext:function(n){this.$U_5=n;return n},get_DialPlanName:function(){return this.$E_5},set_DialPlanName:function(n){this.$E_5=n;return n},get_DialPlanSelector:function(){return this.$9_5},set_DialPlanSelector:function(n){this.$9_5=n;return n},$g_5:function(n,t){if(t.get_propertyName()===EcpSingleSelect.fullValuePropertyName&&this.$9_5.get_fullValue()){var i=this.$9_5.get_fullValue();this.$E_5.value=i.DisplayName;this.$U_5.value=i.PhoneContext;var r=i.NumberOfDigitsInExtension;this.$N_5.innerHTML=EcpUtil.generateRequiredField(Strings.UMExtensionWithDigitLabel(r));this.$0_5.value="";this.$0_5.maxLength=r}},validate:function(n){var t=!1;EcpUtil.isNullOrBlank(this.$E_5.value)?MessageBox.showMessage(Strings.get_UMDialPlanRequiredField(),MessageBoxType.error):EcpUtil.isNullOrBlank(this.$0_5.value)||this.$0_5.value.length!==this.$0_5.maxLength?MessageBox.showMessage(Strings.UMExtensionValidationFailure(this.$0_5.maxLength),MessageBoxType.error):t=!0;return t},setControlInError:function(n,t){}};function EditUMMailboxPolicyViewModel(){EditUMMailboxPolicyViewModel.initializeBase(this)}function EditUMAutoAttendantViewModel(){EditUMAutoAttendantViewModel.initializeBase(this);this.addPropertyMapping("CallSomeoneEnabled","ContactConfigurationEnabled");this.addPropertyMapping("SendVoiceMsgEnabled","ContactConfigurationEnabled")}EditUMAutoAttendantViewModel.prototype={get_AutoAttendantPickerUrl:function(){return this.appendDialPlanIdentityToUrl(EcpUrl.get_ecpVDir()+"/Pickers/UMAutoAttendantPicker.aspx")},get_NewUMHolidaySchedulePickerUrl:function(){return this.appendIdentityToUrl(EcpUrl.get_ecpVDir()+"/UnifiedMessaging/UMHolidayScheduleForm.aspx?new=true")},get_EditUMHolidaySchedulePickerUrl:function(){return this.appendIdentityToUrl(EcpUrl.get_ecpVDir()+"/UnifiedMessaging/UMHolidayScheduleForm.aspx?new=false")},get_NewBusinessKeyValueMappingPickerUrl:function(){return this.appendBothIdToUrl(EcpUrl.get_ecpVDir()+"/UnifiedMessaging/UMKeyMappingForm.aspx?new=true")},get_EditBusinessKeyValueMappingPickerUrl:function(){return this.appendBothIdToUrl(EcpUrl.get_ecpVDir()+"/UnifiedMessaging/UMKeyMappingForm.aspx?new=false")},get_NewAfterHoursKeyValueMappingPickerUrl:function(){return this.appendBothIdToUrl(EcpUrl.get_ecpVDir()+"/UnifiedMessaging/UMKeyMappingForm.aspx?new=true")},get_EditAfterHoursKeyValueMappingPickerUrl:function(){return this.appendBothIdToUrl(EcpUrl.get_ecpVDir()+"/UnifiedMessaging/UMKeyMappingForm.aspx?new=false")},get_ContactConfigurationEnabled:function(){return this.getValue("CallSomeoneEnabled")||this.getValue("SendVoiceMsgEnabled")}};function EditUMDialPlanViewModel(){EditUMDialPlanViewModel.initializeBase(this)}EditUMDialPlanViewModel.prototype={get_AutoAttendantPickerUrl:function(){var n=EcpUrl.get_ecpVDir()+"/Pickers/UMAutoAttendantPicker.aspx";return UrlUtil.appendParameter(n,"DialPlanId",this.get_Identity().RawIdentity)}};function NewUMAutoAttendantViewModel(){NewUMAutoAttendantViewModel.initializeBase(this)}function UMBasePopupProperties(n){UMBasePopupProperties.initializeBase(this,[n])}UMBasePopupProperties.prototype={$b_5:!1,get_IsNewRequest:function(){return this.$b_5},set_IsNewRequest:function(n){this.$b_5=n;return n}};function UMCallDataRecord(n){this.$$d_$h_5=Function.createDelegate(this,this.$h_5);this.$$d_$n_5=Function.createDelegate(this,this.$n_5);this.$$d_$o_5=Function.createDelegate(this,this.$o_5);UMCallDataRecord.initializeBase(this,[n])}UMCallDataRecord.prototype={$2_5:null,$C_5:null,$a_5:!1,initialize:function(){UMReportBase.prototype.initialize.call(this);this.$2_5.add_propertyChanged(this.$$d_$o_5);this.$2_5.get_InlineSelector().add_clear(this.$$d_$n_5);this.$C_5.add_Invoking(this.$$d_$h_5)},dispose:function(){this.$C_5&&this.$C_5.remove_Invoking(this.$$d_$h_5);if(this.$2_5){this.$2_5.remove_propertyChanged(this.$$d_$o_5);this.$2_5.get_InlineSelector().remove_clear(this.$$d_$n_5)}UMReportBase.prototype.dispose.call(this)},get_ListViewRefreshMethod:function(){return this.$C_5},set_ListViewRefreshMethod:function(n){this.$C_5=n;return n},get_UMMailboxPicker:function(){return this.$2_5},set_UMMailboxPicker:function(n){this.$2_5=n;return n},$o_5:function(n,t){this.$2_5.get_value()&&this.$B_4.search()},$h_5:function(n,t){if(!this.$a_5){t.set_cancel(!0);this.$a_5=!0}},$n_5:function(n,t){this.$B_4.clear()}};function UMCallSummaryReport(n){this.$$d_$d_5=Function.createDelegate(this,this.$d_5);this.$$d_$i_5=Function.createDelegate(this,this.$i_5);UMCallSummaryReport.initializeBase(this,[n])}UMCallSummaryReport.NavigateCommandHandler=function(n){var i=DataBinder.getPropertyValue(n.get_toolBar().get_OwnerControl().get_selectedObjects()[0],"UMDialPlanID");var u=DataBinder.getPropertyValue(n.get_toolBar().get_OwnerControl().get_selectedObjects()[0],"Date");var r=DataBinder.getPropertyValue(n.get_toolBar().get_OwnerControl().get_selectedObjects()[0],"UMIPGatewayID");var t=n.navigateUrl;t=UrlUtil.appendParameter(t,"handlerClass","ExportUMCallDataRecordHandler");t=UrlUtil.appendParameter(t,"Date",u);EcpUtil.isNullOrBlank(i)||(t=UrlUtil.appendParameter(t,"UMDialPlanID",i));EcpUtil.isNullOrBlank(r)||(t=UrlUtil.appendParameter(t,"UMIPGatewayID",r));PopupWindowManager.OpenWindow(t,"_self","")};UMCallSummaryReport.prototype={$D_5:null,$8_5:null,$1_5:null,$K_5:null,initialize:function(){UMReportBase.prototype.initialize.call(this);$addHandler(this.$8_5,"change",this.$$d_$i_5);$addHandler(this.$D_5,"change",this.$$d_$d_5);$addHandler(this.$1_5,"change",this.$$d_$d_5)},dispose:function(){$removeHandler(this.$8_5,"change",this.$$d_$i_5);$removeHandler(this.$D_5,"change",this.$$d_$d_5);$removeHandler(this.$1_5,"change",this.$$d_$d_5);UMReportBase.prototype.dispose.call(this)},get_DialPlanToGatewaysMapping:function(){return this.$K_5},set_DialPlanToGatewaysMapping:function(n){this.$K_5=n;return n},get_GroupByDropDown:function(){return this.$D_5},set_GroupByDropDown:function(n){this.$D_5=n;return n},get_DialPlanDropDown:function(){return this.$8_5},set_DialPlanDropDown:function(n){this.$8_5=n;return n},get_IPGatewayDropDown:function(){return this.$1_5},set_IPGatewayDropDown:function(n){this.$1_5=n;return n},$d_5:function(n){this.$B_4.search()},$i_5:function(n){for(var r=this.$1_5.options.length-1;r>0;r--)this.$1_5.remove(r);var t=this.$K_5[this.$8_5.value];if(t){var f=this;t.GatewayInfo.sort(function(n,t){return n.DisplayName.localeCompare(t.DisplayName)});for(var i=0;i<t.GatewayInfo.length;i++){var u=document.createElement("option");u.text=t.GatewayInfo[i].DisplayName;u.value=t.GatewayInfo[i].RawIdentity;EcpUtil.appendOption(this.$1_5,u)}}this.$1_5.selectedIndex=0;this.$d_5(n)}};function GWDropDownItems(){}GWDropDownItems.prototype={GatewayInfo:null};function UMEnableExtensionStep(n){UMEnableExtensionStep.initializeBase(this,[n])}UMEnableExtensionStep.prototype={$V_6:null,get_PropertyPage:function(){return this.$V_6},set_PropertyPage:function(n){this.$V_6=n;return n},show:function(){EcpUtil.showElement(this.get_element(),!0);var n=this.$V_6;n.$4_5.get_pickerWindow()&&n.$4_5.get_pickerWindow().close();n.updateElements()}};function UMEnablePolicyStep(n){this.$$d_$j_7=Function.createDelegate(this,this.$j_7);UMEnablePolicyStep.initializeBase(this,[n])}UMEnablePolicyStep.prototype={getNextStep:function(n){var t=this.get_PropertyPage();if(t.$4_5.get_value())t.hasSelectedPolicyChanged()?WebServiceWizardStep.prototype.getNextStep.call(this,n):n(this.get_NextStepID());else{MessageBox.showMessageWithCallback(Strings.get_UMEnabledPolicyRequired(),MessageBoxType.error,this.$$d_$j_7);n(this.get_StepID())}},internalWebServiceMethodSucceeded:function(n,t){WebServiceWizardStep.prototype.internalWebServiceMethodSucceeded.call(this,n,t);if(this.get_hasOutput()&&!this.results.ErrorRecords.length){var i=this.get_PropertyPage();i.resetExtensionLength();i.set_Results(this.results)}},$j_7:function(n,t){var i=this;window.setTimeout(function(){i.get_Form().get_defaultButton().focus()},0)}};function UMEnableWizard(n){UMEnableWizard.initializeBase(this,[n]);this.$I_5=null}UMEnableWizard.prototype={$0_5:null,$5_5:null,$F_5:null,$3_5:null,$4_5:null,$f_5:null,$M_5:null,$6_5:null,$O_5:null,$L_5:null,$X_5:null,$T_5:null,$I_5:null,$7_5:null,$Q_5:!1,$P_5:!1,$A_5:0,$H_5:0,initialize:function(){PropertyPage.prototype.initialize.call(this);for(var t=document.getElementsByTagName("label"),n=0;n<t.length;n++){var i=t[n].getAttribute("for");if(i&&i===this.$T_5){this.$f_5=t[n];break}}},get_SipAutoLabel:function(){return this.$7_5},set_SipAutoLabel:function(n){this.$7_5=n;return n},get_ManualPin:function(){return this.$3_5},set_ManualPin:function(n){this.$3_5=n;return n},get_Extension:function(){return this.$0_5},set_Extension:function(n){this.$0_5=n;return n},get_SipResourceIdentifier:function(){return this.$5_5},set_SipResourceIdentifier:function(n){this.$5_5=n;return n},get_E164ResourceIdentifier:function(){return this.$F_5},set_E164ResourceIdentifier:function(n){this.$F_5=n;return n},get_PolicySelector:function(){return this.$4_5},set_PolicySelector:function(n){this.$4_5=n;return n},get_SipSection:function(){return this.$X_5},set_SipSection:function(n){this.$X_5=n;return n},get_E164Section:function(){return this.$L_5},set_E164Section:function(n){this.$L_5=n;return n},get_ManualPinForLabel:function(){return this.$T_5},set_ManualPinForLabel:function(n){this.$T_5=n;return n},get_ExtensionDigitsLabel:function(){return this.$M_5},set_ExtensionDigitsLabel:function(n){this.$M_5=n;return n},get_ExtensionDescriptionLabel:function(){return this.$6_5},set_ExtensionDescriptionLabel:function(n){this.$6_5=n;return n},get_ExtensionStepActionSummaryLabel:function(){return this.$O_5},set_ExtensionStepActionSummaryLabel:function(n){this.$O_5=n;return n},resetExtensionLength:function(){this.$0_5.maxLength=20},hasSelectedPolicyChanged:function(){return!this.$I_5||this.$4_5.get_value().RawIdentity!==this.$I_5.RawIdentity},updateElements:function(){if(this.hasSelectedPolicyChanged()){this.$p_5();this.$Q_5=this.get_Results().Output[0].IsSipDialPlan;this.$P_5=this.get_Results().Output[0].IsE164DialPlan;this.$A_5=this.get_Results().Output[0].ExtensionLength;this.$H_5=this.get_Results().Output[0].MinPinLength;this.$l_5();this.$k_5();this.$m_5();EcpUtil.showElement(this.$X_5,this.$Q_5);EcpUtil.showElement(this.$L_5,this.$P_5);this.$J_5(this.$0_5);this.$J_5(this.$5_5);this.$J_5(this.$F_5);WizardPropertyUtil.toggleChildrenDisabled(this.$3_5,!0);if(this.$Q_5){this.$W_5(Strings.get_UMEnableSipActionSummary());ActiveElementMoniter.setActive(this.$5_5)}else if(this.$P_5){this.$W_5(Strings.get_UMEnableE164ActionSummary());ActiveElementMoniter.setActive(this.$F_5)}else{this.$W_5(Strings.get_UMEnableTelexActionSummary());ActiveElementMoniter.setActive(this.$0_5)}}},$p_5:function(){this.$I_5=this.$4_5.get_value()},$m_5:function(){if(EcpUtil.isNullOrBlank(this.$5_5.value)){this.$5_5.readOnly=!1;this.$7_5.innerHTML="";EcpUtil.showElement(this.$7_5,!1)}else{this.$5_5.readOnly=!0;this.$7_5.innerHTML=EcpUtil.htmlEncode(Strings.get_UMEnableMailboxAutoSipDescription())+"<br/>";EcpUtil.showElement(this.$7_5,!0)}},$k_5:function(){if(EcpUtil.isNullOrBlank(this.$0_5.value)){this.$6_5.innerHTML="";EcpUtil.showElement(this.$6_5,!1)}else{this.$6_5.innerHTML=EcpUtil.htmlEncode(Strings.get_UMEnableExtensionAuto())+"<br/>";EcpUtil.showElement(this.$6_5,!0)}this.$M_5.innerHTML=EcpUtil.htmlEncode(EcpUtil.generateRequiredField(Strings.UMExtensionWithDigitLabel(this.$A_5)));this.$0_5.maxLength=this.$A_5},$W_5:function(n){this.$O_5.innerHTML=EcpUtil.htmlEncode(n)},$l_5:function(){this.$f_5.innerHTML=EcpUtil.htmlEncode(Strings.UMEnablePinDigitLabel(this.$H_5))},$J_5:function(n){FieldValidationAssistant.get_instance().setTextboxErrorProperties(n,null);FieldValidationAssistant.get_instance().clearTextboxValidatorsErrors(n)},validate:function(n){var t=!0;var i=this.get_Form();if(i.get_CurrentStepID()!==i.get_StartsWithStepID()){if(this.$0_5.value.length>0&&this.$0_5.value.length<this.$A_5){FieldValidationAssistant.get_instance().setTextboxErrorProperties(this.$0_5,Strings.UMEnableExtensionValidation(this.$A_5));t=!1}if(!this.$3_5.disabled&&this.$3_5.value.length>0&&this.$3_5.value.length<this.$H_5){FieldValidationAssistant.get_instance().setTextboxErrorProperties(this.$3_5,Strings.UMEnablePinValidation(this.$H_5));t=!1}}return t},setControlInError:function(n,t){}};function UMHolidayScheduleViewModel(){UMHolidayScheduleViewModel.initializeBase(this)}UMHolidayScheduleViewModel.prototype={initDefaultValue:function(){PropertyPageViewModel.prototype.initDefaultValue.call(this);if(this.get_IsForNew()){var n=(new Date).format("yyyy/MM/dd");this.setValue("StartDate",n);this.setValue("EndDate",n)}},validateSave:function(){var n=PropertyPageViewModel.prototype.validateSave.call(this);if(Date.parse(this.getValue("EndDate"))<Date.parse(this.getValue("StartDate"))){MessageBox.showMessage(Strings.get_UMHolidayScheduleHolidayStartEndDateValidationError(),MessageBoxType.error);n=!1}return n}};function UMKeyMappingViewModel(){UMKeyMappingViewModel.initializeBase(this)}UMKeyMappingViewModel.prototype={initDefaultValue:function(){PropertyPageViewModel.prototype.initDefaultValue.call(this);if(this.get_IsForNew()){this.setValue("ActionType",0);this.setValue("Key","1")}},get_Keys:function(){for(var n=new Array(0),t=1;t<10;t++)n[n.length]={Key:t,Text:t};n[n.length]={Key:"-",Text:Strings.get_UMKeyMappingTimeout()};return n},get_AutoAttendantPickerUrl:function(){return UrlUtil.appendParameter(EcpUrl.get_ecpVDir()+"/Pickers/UMAutoAttendantPicker.aspx","DialPlanId",UrlUtil.getParameter("DialPlanId"))},get_valuesToSave:function(){var t=PropertyPageViewModel.prototype.get_valuesToSave.call(this);var i=t.ActionType;if(!_String.isNullOrEmpty(i)){var n=_String.empty;switch(i){case"1":n=Strings.UMKeyMappingActionSummaryTransferToExtension(this.getValue("TransferToExtension"));break;case"2":n=Strings.UMKeyMappingActionSummaryTransferToAA(this.getValue("TransferToAutoAttendant").DisplayName);break;case"3":n=Strings.UMKeyMappingActionSummaryLeaveVM(this.getValue("LeaveVoicemailForUser").DisplayName);break;case"4":n=Strings.get_UMKeyMappingActionSummaryAnnounceBusinessLocation();break;case"5":n=Strings.get_UMKeyMappingActionSummaryAnnounceBusinessHours();break}t.ActionSummary=n}return t}};function UMMailboxEditProperties(n){UMMailboxEditProperties.initializeBase(this,[n])}UMMailboxEditProperties.prototype={$S_5:null,$G_5:null,get_LockedOutStatusLabel:function(){return this.$S_5},set_LockedOutStatusLabel:function(n){this.$S_5=n;return n},get_LockedOutStatusActionLabel:function(){return this.$G_5},set_LockedOutStatusActionLabel:function(n){this.$G_5=n;return n},refreshObject:function(n){if(n){var t=n;if(t.Output&&t.Output.length>0&&!t.ErrorRecords.length){this.$S_5.innerHTML=EcpUtil.htmlEncode(t.Output[0].AccountLockedOutStatus);this.$G_5&&(this.$G_5.innerHTML=EcpUtil.htmlEncode(t.Output[0].AccountLockedOutMessage))}}}};function UMPropertyViewModel(){UMPropertyViewModel.initializeBase(this)}UMPropertyViewModel.prototype={appendIdentityToUrl:function(n){return UrlUtil.appendParameter(n,"ID",this.get_Identity().RawIdentity)},appendDialPlanIdentityToUrl:function(n){return UrlUtil.appendParameter(n,"DialPlanId",this.getValue("DialPlanIdentity").RawIdentity)},appendBothIdToUrl:function(n){var t=UrlUtil.appendParameter(n,"ID",this.get_Identity().RawIdentity);return UrlUtil.appendParameter(t,"DialPlanId",this.getValue("DialPlanIdentity").RawIdentity)},get_CountryOrRegionGroupsPickerUrl:function(){return this.appendDialPlanIdentityToUrl(EcpUrl.get_ecpVDir()+"/Pickers/UMDialingRuleGroupPicker.aspx?International=false")},get_InternationalGroupsPickerUrl:function(){return this.appendDialPlanIdentityToUrl(EcpUrl.get_ecpVDir()+"/Pickers/UMDialingRuleGroupPicker.aspx?International=true")},get_ValidationExpression:function(){if(this.getValue("IsTelex")){var n=CommonRegex.numbersOfSpecificLength(this.getValue("ExtensionLength"),this.get_MaxLength());return n.$$d_test||(n.$$d_test=Function.createDelegate(n,n.test))}var t=CommonRegex.get_e164();return t.$$d_test||(t.$$d_test=Function.createDelegate(t,t.test))},get_ValidationErrorMessage:function(){return this.getValue("IsTelex")?Strings.SharedUMAutoAttendantPilotIdentifierListNumberError(this.getValue("ExtensionLength")):Strings.get_SharedUMAutoAttendantPilotIdentifierListE164Error()},get_MaxLength:function(){return this.getValue("IsTelex")?1123:16}};function UMReportBase(n){this.$$d_applyLayout=Function.createDelegate(this,this.applyLayout);this.$$d_$e_4=Function.createDelegate(this,this.$e_4);UMReportBase.initializeBase(this,[n])}UMReportBase.prototype={$B_4:null,$R_4:null,$Z_4:null,$c_4:null,initialize:function(){EcpControl.prototype.initialize.call(this);$addHandler(window,"resize",this.$$d_$e_4);this.$Z_4=$get("containerDiv");this.$c_4=$get(this.$R_4.get_id());EcpUtil.isIE()?this.$e_4(null):this.applyLayout()},dispose:function(){$removeHandler(window,"resize",this.$$d_$e_4);EcpControl.prototype.dispose.call(this)},$e_4:function(n){window.setTimeout(this.$$d_applyLayout,0)},applyLayout:function(){var n=this.get_element().scrollHeight;var t=20;var i=Math.max(200,n-this.$Z_4.scrollHeight-t);this.$c_4.style.height=i.toString()+"px"},get_ListView:function(){return this.$R_4},set_ListView:function(n){this.$R_4=n;return n},get_ListViewDataSource:function(){return this.$B_4},set_ListViewDataSource:function(n){this.$B_4=n;return n}};AddUMExtensionProperties.registerClass("AddUMExtensionProperties",PropertyPage,IValidatable);UMPropertyViewModel.registerClass("UMPropertyViewModel",PropertyPageViewModel);EditUMMailboxPolicyViewModel.registerClass("EditUMMailboxPolicyViewModel",UMPropertyViewModel);EditUMAutoAttendantViewModel.registerClass("EditUMAutoAttendantViewModel",UMPropertyViewModel);EditUMDialPlanViewModel.registerClass("EditUMDialPlanViewModel",PropertyPageViewModel);NewUMAutoAttendantViewModel.registerClass("NewUMAutoAttendantViewModel",UMPropertyViewModel);UMBasePopupProperties.registerClass("UMBasePopupProperties",PropertyPage);UMReportBase.registerClass("UMReportBase",ContainerControl);UMCallDataRecord.registerClass("UMCallDataRecord",UMReportBase);UMCallSummaryReport.registerClass("UMCallSummaryReport",UMReportBase);GWDropDownItems.registerClass("GWDropDownItems");UMEnableExtensionStep.registerClass("UMEnableExtensionStep",WizardStep);UMEnablePolicyStep.registerClass("UMEnablePolicyStep",WebServiceWizardStep);UMEnableWizard.registerClass("UMEnableWizard",PropertyPage,IValidatable);UMHolidayScheduleViewModel.registerClass("UMHolidayScheduleViewModel",PopupFormViewModel);UMKeyMappingViewModel.registerClass("UMKeyMappingViewModel",PopupFormViewModel);UMMailboxEditProperties.registerClass("UMMailboxEditProperties",PropertyPage)