Type.registerNamespace("ECP");var IEntryEditor=function(){};IEntryEditor.registerInterface("IEntryEditor");var IPopupForm=function(){};IPopupForm.registerInterface("IPopupForm");var IUploader=function(){};IUploader.registerInterface("IUploader");var UploadCompletedStatus=function(){};UploadCompletedStatus.prototype={cancelled:0,succeeded:1,failed:2};UploadCompletedStatus.registerEnum("UploadCompletedStatus",!1);var PickerCallerType=function(){};PickerCallerType.prototype={inBoxRuleFrom:0,inBoxRuleTo:1,deliveryReportTo:2,deliveryReportFrom:3,groupsOwners:4,groupsMembers:5,groupsGroupModerators:6,groupsSenders:7,groupsAllowedSenders:8,voiceMailOptionsAmong:9,voiceMailOptionsTo:10,teamMailbox:11};PickerCallerType.registerEnum("PickerCallerType",!1);var SchedulerMode=function(){};SchedulerMode.prototype={fifteenMinutes:0,twentyFourHours:1,readonly:2,max:3};SchedulerMode.registerEnum("SchedulerMode",!1);var StatisticsBarState=function(){};StatisticsBarState.prototype={normal:0,warning:1,exceeded:2};StatisticsBarState.registerEnum("StatisticsBarState",!1);var ITreeSource=function(){};ITreeSource.registerInterface("ITreeSource");function AjaxUploader(n){this.$$d_$AO_4=Function.createDelegate(this,this.$AO_4);this.$$d_$AK_4=Function.createDelegate(this,this.$AK_4);this.$$d_$AD_4=Function.createDelegate(this,this.$AD_4);this.$$d_$4Z_4=Function.createDelegate(this,this.$4Z_4);this.$$d_$8E_4=Function.createDelegate(this,this.$8E_4);AjaxUploader.initializeBase(this,[n])}AjaxUploader.$6i=function(n,t){n&&EcpUtil.showElement(n,t)};AjaxUploader.prototype={$40_4:null,$1k_4:null,$e_4:0,$7A_4:null,$7R_4:!0,initialize:function(){EcpControl.prototype.initialize.call(this);this.set_value("");this.$40_4=this.$$d_$8E_4;this.$1k_4=this.$$d_$4Z_4;this.$w_4.add_fileChanged(this.$40_4);this.$w_4.add_uploadCompleted(this.$1k_4);$addHandler(this.$1Y_4,"click",this.$$d_$AD_4);this.$L_4&&$addHandler(this.$L_4,"click",this.$$d_$AK_4);if(this.$P_4){$addHandler(this.$P_4,"click",this.$$d_$AO_4);this.$64_4&&this.$1x_4(2)}},dispose:function(){EcpControl.prototype.dispose.call(this);this.$w_4.remove_fileChanged(this.$40_4);this.$w_4.remove_uploadCompleted(this.$1k_4);$removeHandler(this.$1Y_4,"click",this.$$d_$AD_4);this.$L_4&&$removeHandler(this.$L_4,"click",this.$$d_$AK_4);this.$P_4&&$removeHandler(this.$P_4,"click",this.$$d_$AO_4);this.$40_4=null;this.$1k_4=null},addAriaAttribute:function(){var r=this.get_element().getElementsByTagName("IFRAME");var u=r[0].contentWindow.document;var t=u.getElementById(ClientUploadManager.uploadFileKey);var n=$get(this.get_element().id+AriaUtil.associatedLabelSuffix);AriaUtil.addAriaAttrToControlWithLab(t,n);AriaUtil.addAriaAttrToControlWithLabelID(t,AriaUtil.getFvaReaderSpanId(this.get_element()));var i=$get(this.$1Y_4+AriaUtil.associatedLabelSuffix);if(i){var f=n?EcpUtil.getInnerText(n):"";var e=Strings.CancelForAjaxUploader(f);EcpUtil.setInnerText(i,e)}},applyValidator:function(n){EcpControl.prototype.applyValidator.call(this,n);if(ValidatorInfo.isTypeOf(n,RequiredFieldValidator)){this.$7R_4=!1;this.$34_4()}},get_FileNameLbl:function(){return this.$41_4},set_FileNameLbl:function(n){this.$41_4=n;return n},$41_4:null,get_ProgressLbl:function(){return this.$24_4},set_ProgressLbl:function(n){this.$24_4=n;return n},$24_4:null,get_SeparatorDiv:function(){return this.$2i_4},set_SeparatorDiv:function(n){this.$2i_4=n;return n},$2i_4:null,get_CancelBtn:function(){return this.$1Y_4},set_CancelBtn:function(n){this.$1Y_4=n;return n},$1Y_4:null,get_DeleteBtn:function(){return this.$L_4},set_DeleteBtn:function(n){this.$L_4=n;return n},$L_4:null,get_EditFileBtn:function(){return this.$P_4},set_EditFileBtn:function(n){this.$P_4=n;return n},$P_4:null,get_DefaultText:function(){return this.$5Y_4},set_DefaultText:function(n){this.$5Y_4=n;return n},$5Y_4:null,get_HasDefaultValue:function(){return this.$47_4},set_HasDefaultValue:function(n){this.$47_4=n;return n},$47_4:!0,get_UploaderImplementation:function(){return this.$w_4},set_UploaderImplementation:function(n){this.$w_4=n;return n},$w_4:null,get_InitStateAsEditClicked:function(){return this.$64_4},set_InitStateAsEditClicked:function(n){this.$64_4=n;return n},$64_4:!1,get_value:function(){return this.$T_4},set_value:function(n){var t=this.$T_4;this.$T_4=n;if(this.$T_4!==t){this.$6a_4(new Sys.EventArgs);this.raisePropertyChanged("value")}this.$9v_4();return n},$T_4:null,get_uploadResult:function(){return this.$7B_4},set_uploadResult:function(n){if(this.$7B_4!==n){this.$7B_4=n;this.raisePropertyChanged("uploadResult");n||this.set_value(null)}return n},$7B_4:null,get_isUploading:function(){return this.$w_4.get_isUploading()},$AO_4:function(n){ClientUploadManager.get_instance().get_isUploading()?MessageBox.showMessage(Strings.get_CannotUploadMultipleFiles(),MessageBoxType.information):this.$1x_4(2)},$AD_4:function(n){this.$w_4.cancel()},$AK_4:function(n){if(!EcpUtil.domElementDisabled(this.$L_4)&&!this.customDeleteHandler()){this.set_value("");this.set_uploadResult(null)}},$8E_4:function(n){if(this.$w_4.tryUpload()){this.$7A_4=n.$6J_1;this.$1x_4(3)}},$4Z_4:function(n){switch(n.$6h_1){case 2:ErrorHandling.showPowerShellErrors(n.$2_1);this.$1x_4(2);break;case 1:this.set_value(this.$7A_4);n.$2_1.Output&&this.set_uploadResult(n.$2_1.Output[0]);break;case 0:EcpUtil.isNullOrBlank(this.$T_4)?this.$1x_4(this.$47_4?1:2):this.$1x_4(4);break}},handleSuccessfulUpload:function(){},customDeleteHandler:function(){return!1},forceValueToNull:function(){this.$e_4!==2&&(this.$e_4=4);this.$T_4=null;this.$2h_4();this.$4s_4()},$2h_4:function(){EcpUtil.isNullOrBlank(this.$T_4)?this.$6p_4(this.$5Y_4):this.$6p_4(this.$T_4)},$6p_4:function(n){var t=EcpUtil.htmlEncode(n||_String.empty);this.$41_4.innerHTML=t;if(this.$L_4){var i=$get(this.get_element().id+AriaUtil.associatedLabelSuffix);var r=i?EcpUtil.getInnerText(i):"";var u=Strings.ClearForAjaxUploader(t,r);var f=$get(this.$L_4.id+AriaUtil.associatedLabelSuffix);EcpUtil.setInnerText(f,u+" ")}},$1x_4:function(n){switch(this.$e_4){case 1:if(n===2){this.$6v_4();this.$e_4=n}break;case 2:if(n===3){EcpUtil.showElement(this.$24_4,!0);this.$B5_4();this.$3O_4(!1);this.$6p_4(this.$7A_4);this.$e_4=n}break;case 3:if(n===1){this.$3O_4(!0);EcpUtil.showElement(this.$24_4,!1);this.$34_4();this.$2h_4();this.$e_4=n}else if(n===4){this.$4s_4();EcpUtil.showElement(this.$24_4,!1);this.$3O_4(!0);this.$2h_4();this.handleSuccessfulUpload();this.$e_4=n}else if(n===2){EcpUtil.isNullOrBlank(this.$T_4)?this.$34_4():this.$4s_4();EcpUtil.showElement(this.$24_4,!1);this.$6v_4();this.$2h_4();this.$e_4=n}break;case 4:if(n===1){this.$34_4();this.$2h_4();this.$e_4=n}else if(n===2){this.$6v_4();this.$e_4=n}break}if(this.$e_4!==n)throw Error.invalidOperation("Current State: "+this.$e_4+", Next State: "+n);},$9v_4:function(){if(EcpUtil.isNullOrBlank(this.$T_4)){this.$34_4();this.$e_4=1;this.$47_4?this.$3O_4(!0):this.$1x_4(2)}else{this.$4s_4();this.$3O_4(!0);this.$e_4=4;this.handleSuccessfulUpload()}EcpUtil.showElement(this.$24_4,!1);this.$2h_4()},$6a_4:function(n){var t=this.get_events().getHandler("valueChanged");t&&t(this,n)},$4s_4:function(){EcpUtil.showElement(this.$1Y_4,!1);if(this.$7R_4&&this.$L_4){EcpUtil.showElement(this.$2i_4,!0);EcpUtil.showElement(this.$L_4,!0)}else EcpUtil.showElement(this.$2i_4,!1)},$B5_4:function(){AjaxUploader.$6i(this.$L_4,!1);EcpUtil.showElement(this.$2i_4,!0);EcpUtil.showElement(this.$1Y_4,!0)},$34_4:function(){AjaxUploader.$6i(this.$L_4,!1);EcpUtil.showElement(this.$2i_4,!1);EcpUtil.showElement(this.$1Y_4,!1)},$6v_4:function(){AjaxUploader.$6i(this.$P_4,!1);EcpUtil.showElement(this.$w_4.get_element(),!0);var n=this.$w_4;_Object.isNullOrUndefined(n)||n.focusFileChooser()},$3O_4:function(n){EcpUtil.showElement(this.$w_4.get_element(),!1);if(this.$P_4){EcpUtil.showElement(this.$P_4,!0);WizardPropertyUtil.toggleChildrenDisabled(this.$P_4,!n)}}};function BaseForm(n){this.$$d_$Ai_3=Function.createDelegate(this,this.$Ai_3);this.$$d_$AA_3=Function.createDelegate(this,this.$AA_3);this.$$d_$BA_3=Function.createDelegate(this,this.$BA_3);this.$$d_$4X_3=Function.createDelegate(this,this.$4X_3);this.$$d_onCancel=Function.createDelegate(this,this.onCancel);this.$$d_onCommit=Function.createDelegate(this,this.onCommit);BaseForm.initializeBase(this,[n])}BaseForm.getCurrentForm=function(n){while(n){var t=n.control;if(BaseForm.isInstanceOfType(t))return t;else n=n.parentNode}return null};BaseForm.prototype={$H_3:null,$1Z_3:null,$y_3:null,$2I_3:null,$5z_3:!1,$6q_3:!0,$4e_3:!1,$4B_3:!1,$5A_3:!1,$1z_3:null,$5l_3:"",get_CommitButton:function(){return this.$H_3},set_CommitButton:function(n){this.$H_3=n;return n},get_ContentPanel:function(){return this.$y_3},set_ContentPanel:function(n){this.$y_3=n;return n},get_CancelButton:function(){return this.$1Z_3},set_CancelButton:function(n){this.$1Z_3=n;return n},get_HideDefaultCancelAction:function(){return this.$4B_3},set_HideDefaultCancelAction:function(n){this.$4B_3=n;return n},get_AlwaysCheckDataLoss:function(){return this.$5A_3},set_AlwaysCheckDataLoss:function(n){this.$5A_3=n;return n},get_HideFieldValidationAssistant:function(){return this.$5z_3},set_HideFieldValidationAssistant:function(n){this.$5z_3=n;return n},get_FvaResource:function(){return this.$5l_3},set_FvaResource:function(n){this.$5l_3=n;return n},get_FvaEnabled:function(){return Sys.UI.DomElement.containsCssClass(this.$y_3,CssClasses.cttPaneWithFVA)},set_FvaEnabled:function(n){if(null===this.$2I_3){this.$2I_3=document.createElement("DIV");for(var t=0;t<this.$y_3.children.length;t++)this.$2I_3.appendChild(this.$y_3.children[t]);this.$y_3.appendChild(this.$2I_3)}if(!this.$5z_3&&this.get_FvaEnabled()!==n){_DomElement.toggelCssClass(this.$2I_3,n,CssClasses.reservedSpaceForFVA);_DomElement.toggelCssClass(this.$2I_3,n,CssClasses.cttPaneContainer);_DomElement.toggelCssClass(this.$y_3,n,CssClasses.cttPaneWithFVA)}return n},get_SetInitialFocus:function(){return this.$6q_3},set_SetInitialFocus:function(n){this.$6q_3=n;return n},get_PassingDataOnClient:function(){return this.$4e_3},set_PassingDataOnClient:function(n){this.$4e_3=n;return n},initialize:function(){EcpControl.prototype.initialize.call(this);this.$H_3&&$addHandler(this.$H_3,"click",this.$$d_onCommit);this.$1Z_3&&!this.$4B_3&&$addHandler(this.$1Z_3,"click",this.$$d_onCancel);$addHandler(document,"keydown",this.$$d_$4X_3);$addHandler(window,"unload",this.$$d_$BA_3);window.onbeforeunload=this.$$d_$AA_3;if(this.$6q_3){var n=this;window.setTimeout(function(){FocusUtil.setFirstFieldFocused(n.get_element(),!1)},0)}AriaUtil.addFvaReaderSpan(this.get_element(),this.$5l_3);var t=this;window.setTimeout(function(){AriaUtil.addAriaAttrFromPage(t.get_element())},0)},dispose:function(){this.$H_3&&$removeHandler(this.$H_3,"click",this.$$d_onCommit);this.$1Z_3&&!this.$4B_3&&$removeHandler(this.$1Z_3,"click",this.$$d_onCancel);$removeHandler(document,"keydown",this.$$d_$4X_3);$removeHandler(window,"unload",this.$$d_$BA_3);window.onbeforeunload=null;EcpControl.prototype.dispose.call(this)},addAriaAttribute:function(){if(this.$H_3){this.$1z_3=AriaUtil.findInfoLabels(this.get_element());for(var n=0;n<this.$1z_3.length;n++){var t=EcpControl.fromElement(this.$1z_3[n],!0);t&&t.add_propertyChanged(this.$$d_$Ai_3)}AriaUtil.addAriaAttrToControlWithLabs(this.$H_3,this.$1z_3)}},onCommit:function(n){},onCancel:function(n){DatapointManager.addDatapoint(EcpInstrumentationMarkers.cancel);DataLossReporting.suspendWarning();window.close()},$BA_3:function(n){AccUtil.setFoucsToPopupOpenerSourceElement(_Window.getOpener(window.self))},$4X_3:function(n){if(window.opener||window.dialogArguments){var t=n.keyCode===27||(EcpUtil.isSafari()||EcpUtil.isIE())&&n.ctrlKey&&n.keyCode===Strings.get_CtrlKeyCloseForm().charCodeAt(0);if(t){n.preventDefault();n.stopPropagation();window.close()}}},$AA_3:function(){return EcpUtil.isFirefox()?this.$9Z_3():this.$8C_3()},$8C_3:function(){if(window.opener||window.dialogArguments||this.$5A_3){var n=DataLossReporting.needRaiseWarning(!0);if(n.get_hasChange())return n.get_warningMessage()||Strings.get_DataLossWarning()}AccUtil.setFoucsToPopupOpenerSourceElement(_Window.getOpener(window.self));return GlobalVariables.undefined},$Ai_3:function(n,t){if(t.get_propertyName()==="visible"){n.get_visible()?Array.add(this.$1z_3,n.get_element()):Array.remove(this.$1z_3,n.get_element());AriaUtil.addAriaAttrToControlWithLabs(this.$H_3,this.$1z_3)}},$9Z_3:function(){if(!this.$6N_3){this.$6N_3=!0;var n=this;window.setTimeout(function(){n.$6N_3=!1},0);return this.$8C_3()}return GlobalVariables.undefined},scrollIntoView:function(n){n.clientHeight+n.offsetTop>this.$y_3.scrollTop+this.$y_3.clientHeight&&(this.$y_3.scrollTop=n.clientHeight+n.offsetTop-this.$y_3.clientHeight)},$6N_3:!1};function Bookmark(n){this.$$d_$4X_3=Function.createDelegate(this,this.$4X_3);this.$$d_$4W_3=Function.createDelegate(this,this.$4W_3);Bookmark.initializeBase(this,[n]);$addHandler(this.get_element(),"click",this.$$d_$4W_3);$addHandler(this.get_element(),"keydown",this.$$d_$4X_3);this.addBinding(new Binding("SelectedSection","SelectedSection",4))}Bookmark.select=function(n){var t=Bookmark.findBookMark();if(t){var i=t.get_tabs();if(i&&i.length>0){var u=i[n];var f=new SectionData;f.sectionName=u.getAttribute("name");f.workflow=u.attributes.getNamedItem("Workflow").value;t.set_SelectedSection(f);u.focus();t.$8Y_3=u;t.$4p_3=n;t.$3E_3||(t.$3E_3=$get("ptr"));for(var r=0;r<i.length;r++)if(r===n){i[r].setAttribute(AriaUtil.ariaSelected,"true");i[r].tabIndex=0;i[r].className="selectedBmk"}else{i[r].setAttribute(AriaUtil.ariaSelected,"false");i[r].tabIndex=-1;i[r].className=""}if(t.$3E_3){var e=u.offsetTop;t.$3E_3.style.top=e+"px";t.$3E_3.style.display=""}WizardPropertyUtil.showSectionByIndex(n)}}};Bookmark.findBookMark=function(){var t;var n=$("div[class=bookmark]");t=n&&n.length>0?EcpControl.fromElement(n.get(0)):null;return t};Bookmark.findSelectedIndex=function(n){var i=-1;var f="";var r=n.getAttribute("ecp_index");if(r&&r!=="")i=Number.parseInvariant(r);else{f=n.getAttribute("name");var u=$("div.section");if(u.length>0)for(var t=0;t<u.length;t++){var e=u[t].getElementsByTagName("A");if(e.length>0){var o=e[0].getAttribute("name");if(o===f){i=t;break}}}}return i};Bookmark.findIndexByName=function(n){var r=-1;n=n.toLowerCase();var i=$("div.section");if(i.length>0)for(var t=0;t<i.length;t++){var u=i[t].getElementsByTagName("A");if(u.length>0){var f=u[0].getAttribute("name");if(f.toLowerCase()===n){r=t;break}}}return r};Bookmark.prototype={$3T_3:null,$8Y_3:null,$3E_3:null,$3N_3:null,$4p_3:0,$84_3:0,initialize:function(){EcpControl.prototype.initialize.call(this);for(var n=0;n<this.get_length();n++)this.get_tabs()[n].setAttribute("href","#");var t=EcpUrl.GetCurrWindowQuery("JumpToSection");(_String.isNullOrEmpty(t)||!this.trySelectSectionByName(t))&&Bookmark.select(0)},addAriaAttribute:function(){var n=this;var t=$("div.section").each(function(t,i){i.setAttribute(AriaUtil.ariaLabelledby,n.get_tabs()[t].id);i.setAttribute(AriaUtil.ariaRole,AriaUtil.ariaTabPanel)});this.get_element().setAttribute(AriaUtil.ariaRole,AriaUtil.ariaTabList)},trySelectSectionByName:function(n){var i=!1;if(_Object.isNullOrUndefined(this.$3N_3)||this.$3N_3.sectionName!==n){var t=Bookmark.findIndexByName(n);var r=t!==-1&&this.$7z_3(t);if(r){Bookmark.select(t);i=!0}}return i},$7z_3:function(n){var t=!1;this.$3T_3&&(t=EcpControl.fromElement(this.$3T_3[n].parentNode).get_visible());return t},get_SelectedSection:function(){return this.$3N_3},set_SelectedSection:function(n){if(this.$3N_3!==n){this.$3N_3=n;this.raisePropertyChanged("SelectedSection")}return n},$4W_3:function(n){if(n.target.tagName==="A"){var t=Bookmark.findSelectedIndex(n.target);Bookmark.select(t);n.preventDefault()}},$4X_3:function(n){if(n.target.getAttribute("role")==="tab"){var u=!n.ctrlKey&&!n.shiftKey&&!n.altKey;var t=this.$4p_3;if(u){var f=RtlUtil.convertToLTLDirection(n.keyCode);var i=!1;var r=this.$4p_3;do{switch(f){case 37:case 38:t=t-1>=0?t-1:0;break;case 39:case 40:t=t+1<this.get_length()?t+1:this.get_length()-1;break;case 36:t=0;break;case 35:t=this.get_length()-1;break}if(t!==r){if(this.$7z_3(t)){Bookmark.select(t);i=!0;n.stopPropagation()}r=t}else i=!0}while(!i)}}},dispose:function(){$removeHandler(this.get_element(),EventNames.click,this.$$d_$4W_3);$removeHandler(this.get_element(),EventNames.keyDown,this.$$d_$4X_3);EcpControl.prototype.dispose.call(this)},get_tabs:function(){return this.$3T_3?this.$3T_3:this.$3T_3=this.get_element().getElementsByTagName("A")},get_selectedIndex:function(){return this.$4p_3},get_selectedTab:function(){return this.$8Y_3},get_length:function(){this.$84_3=this.get_tabs().length;return this.$84_3},getFirstFocusableField:function(){return this.get_tabs().length>0?this.get_tabs()[0]:null}};function BulkEditPopupForm(n){this.$$d_$96_4=Function.createDelegate(this,this.$96_4);BulkEditPopupForm.initializeBase(this,[n])}BulkEditPopupForm.prototype={initialize:function(){BaseForm.prototype.initialize.call(this);$addHandler(document,"keydown",this.$$d_$96_4)},dispose:function(){$removeHandler(document,"keydown",this.$$d_$96_4);BaseForm.prototype.dispose.call(this)},$96_4:function(n){if(n.keyCode===27||n.ctrlKey&&n.keyCode==="C".charCodeAt(0)){n.preventDefault();n.stopPropagation()}}};function CertDomainCollectionEditor(n){this.$$d_onItemUpdated=Function.createDelegate(this,this.onItemUpdated);CertDomainCollectionEditor.initializeBase(this,[n])}CertDomainCollectionEditor.prototype={initialize:function(){EcpCollectionEditor.prototype.initialize.call(this);this.$0_5.add_itemUpdated(this.$$d_onItemUpdated)},defaultCommand:function(){for(var t=this.$0_5.get_items(),n=0;n<t.length;n++)this.$4q_6(n,t[n].get_selected());this.$0_5.get_ToolBar().findItemByName("Default").set_enabled(!1);this.$0_5.get_ToolBar().findItemByName("Delete").set_enabled(!1)},onOK:function(n){for(var u=!1,e=this.getCurrentItemKeys(),f=[],i=0;i<n.length;i++){var o=DataBinder.getPropertyValue(n[i],this.$6_4);e[Identity.generateKeyForIdentity(o)]||Array.add(f,n[i])}f.length>0&&(u=!0);EcpCollectionEditor.prototype.onOK.call(this,n);if(u&&this.$A2_6(n))for(var r=this.$0_5.get_items(),t=0;t<r.length;t++){var s=r[t].get_dataObject();this.$9W_6(n,r[t].get_dataObject())?this.$4q_6(t,!0):this.$4q_6(t,!1)}},onEditDialogOK:function(n){var r=n[0];var u=DataBinder.getPropertyValue(n[0],this.$6_4);if(r.IsDefault)for(var i=this.$0_5.get_items(),t=0;t<i.length;t++){var f=i[t].get_dataObject();this.$4q_6(t,!1)}EcpCollectionEditor.prototype.onEditDialogOK.call(this,n)},onItemUpdated:function(n,t){var i=t.get_item();var r=i.get_element();var u=r.childNodes[0];var f=i.get_dataObject();u.style.fontWeight=f.IsDefault?"bold":"normal"},dispose:function(){EcpCollectionEditor.prototype.dispose.call(this);this.$0_5&&this.$0_5.remove_itemUpdated(this.$$d_onItemUpdated)},$A2_6:function(n){for(var t=0;t<n.length;t++){var i=n[t];if(i.IsDefault)return!0}return!1},$4q_6:function(n,t){var i=this.$0_5.get_DataSource().getAt(n);if(i.IsDefault!==t){i.IsDefault=t;this.$0_5.get_DataSource().setAt(n,i)}},$9W_6:function(n,t){for(var i=0;i<n.length;i++){var r=Identity.generateKeyForIdentity(DataBinder.getPropertyValue(n[i],this.$6_4));var u=Identity.generateKeyForIdentity(DataBinder.getPropertyValue(t,this.$6_4));if(r===u)return!0}return!1}};function ClientUploadManager(){this.$$d_$7r_1=Function.createDelegate(this,this.$7r_1);this.$$d_$4Z_1=Function.createDelegate(this,this.$4Z_1);ClientUploadManager.initializeBase(this);this.$2C_1={};this.set_id("ClientUploadManager")}ClientUploadManager.get_instance=function(){_Object.isNullOrUndefined(ClientUploadManager.$4F)&&(ClientUploadManager.$4F=$create(ClientUploadManager));return ClientUploadManager.$4F};ClientUploadManager.prototype={$2C_1:null,$1o_1:null,$1k_1:null,$1a_1:null,initialize:function(){Sys.Component.prototype.initialize.call(this);this.$1k_1=this.$$d_$4Z_1;this.$1a_1=this.$$d_$7r_1;DataLossReporting.add_report(this.$1a_1)},dispose:function(){Sys.Component.prototype.dispose.call(this);this.get_isUploading()&&this.$2C_1[this.$1o_1].cancel();var n=this.$2C_1;for(var t in n){var i={key:t,value:n[t]};i.value.remove_uploadCompleted(this.$1k_1)}DataLossReporting.remove_report(this.$1a_1);this.$1k_1=null;this.$1a_1=null},register:function(n,t){if(_Object.isNullOrUndefined(this.$2C_1[n])){this.$2C_1[n]=t;t.add_uploadCompleted(this.$1k_1)}},tryUpload:function(n){if(!_Object.isNullOrUndefined(this.$2C_1[n])){var t=this.$2C_1[n];if(EcpUtil.isNullOrBlank(this.$1o_1)){var i=this;window.setTimeout(function(){t.upload()},10);this.$1o_1=n;return!0}else MessageBox.showMessage(Strings.get_CannotUploadMultipleFiles(),MessageBoxType.information)}return!1},get_isUploading:function(){return!_Object.isNullOrUndefined(this.$1o_1)},isComponentUploading:function(n){return this.$1o_1===n},validate:function(n){this.get_isUploading()&&MessageBox.showMessage(Strings.get_FileStillUploading(),MessageBoxType.information);return!this.get_isUploading()},setControlInError:function(n,t){},$4Z_1:function(n){n.$3X_1.get_element().id===this.$1o_1&&(this.$1o_1=null)},$7r_1:function(n,t){this.get_isUploading()&&t.turnOnHasChange()}};function ContentPanelLayoutBehavior(n){this.$$d_$8H_2=Function.createDelegate(this,this.$8H_2);ContentPanelLayoutBehavior.initializeBase(this,[n])}ContentPanelLayoutBehavior.prototype={$55_2:null,$49_2:null,$43_2:null,$3q_2:null,$7L_2:0,$65_2:!1,$7J_2:null,$5t_2:null,$5k_2:null,$3p_2:null,initialize:function(){Sys.UI.Behavior.prototype.initialize.call(this);var n=this;window.setTimeout(function(){if(n.$55_2){n.$7J_2=$get(n.$55_2);n.$7J_2.style.visibility="visible"}n.$8H_2(null)},0);this.$49_2&&(this.$5t_2=$get(this.$49_2));this.$43_2&&(this.$5k_2=$get(this.$43_2));this.$3q_2&&(this.$3p_2=$get(this.$3q_2));$addHandler(window,"load",this.$$d_$8H_2);$addHandler(window,"resize",this.$$d_$8H_2)},dispose:function(){$removeHandler(window,"load",this.$$d_$8H_2);$removeHandler(window,"resize",this.$$d_$8H_2);Sys.UI.Behavior.prototype.dispose.call(this)},get_WrapperControlId:function(){return this.$55_2},set_WrapperControlId:function(n){this.$55_2=n;return n},get_HeaderControlId:function(){return this.$49_2},set_HeaderControlId:function(n){this.$49_2=n;return n},get_FooterControlId:function(){return this.$43_2},set_FooterControlId:function(n){this.$43_2=n;return n},get_ContentControlId:function(){return this.$3q_2},set_ContentControlId:function(n){this.$3q_2=n;return n},get_WrapperMinHeight:function(){return this.$7L_2},set_WrapperMinHeight:function(n){this.$7L_2=n;return n},$8H_2:function(n){if(!this.$65_2){this.$65_2=!0;this.$Au_2();this.$65_2=!1}},$Au_2:function(){var n=0;var i=window.document.body.clientHeight;this.$5t_2&&(n+=this.$5t_2.offsetHeight);this.$5k_2&&(n+=this.$5k_2.offsetHeight);if(this.$7J_2&&this.$3p_2){var t=this.$7L_2-n;t<0&&(t=0);this.$3p_2.style.height=t+"px";i-=n;i>t&&(this.$3p_2.style.height=i+"px")}}};function ControlAssociationBehavior(n){this.$$d_$9T_2=Function.createDelegate(this,this.$9T_2);this.$$d_$9J_2=Function.createDelegate(this,this.$9J_2);ControlAssociationBehavior.initializeBase(this,[n])}ControlAssociationBehavior.prototype={$5U_2:null,$3U_2:null,initialize:function(){if(this.$S_2!==""&&this.$S_2){var n=this.$S_2.split(",");if(this.$3h_2){this.$5U_2=this.$$d_$9J_2;this.$3U_2=this.get_element().control;if(this.$3U_2)for(var t=0;t<n.length;t++)this.$3U_2.get_events().addHandler(n[t],this.$5U_2);else throw Error.argumentUndefined("The element doesn't have a control associated");}else if(this.$4I_2)for(var r=this.get_element().getElementsByTagName("INPUT"),i=0;i<r.length;i++)this.$7P_2(r[i],n,this.$$d_$9T_2);else this.$7P_2(this.get_element(),n,this.$$d_$9T_2)}if(this.$68_2){var u=this;window.setTimeout(function(){u.$4G_2()},0)}Sys.UI.Behavior.prototype.initialize.call(this)},dispose:function(){if(this.$S_2!==""&&this.$S_2){var n=this.$S_2.split(",");if(this.$3h_2){if(this.$3U_2)for(var t=0;t<n.length;t++)this.$3U_2.get_events().removeHandler(n[t],this.$5U_2)}else if(this.$4I_2)for(var r=this.get_element().getElementsByTagName("INPUT"),i=0;i<r.length;i++)this.$8Q_2(r[i],n,this.$$d_$9T_2);else this.$8Q_2(this.get_element(),n,this.$$d_$9T_2)}Sys.UI.Behavior.prototype.dispose.call(this)},get_IsRadioBtnList:function(){return this.$4I_2},set_IsRadioBtnList:function(n){this.$4I_2=n;return n},$4I_2:!1,$7P_2:function(n,t,i){for(var r=0;r<t.length;r++)$addHandler(n,t[r],i)},$8Q_2:function(n,t,i){for(var r=0;r<t.length;r++)$removeHandler(n,t[r],i)},get_InvokeOnInit:function(){return this.$68_2},set_InvokeOnInit:function(n){this.$68_2=n;return n},$68_2:!1,get_BindToControl:function(){return this.$3h_2},set_BindToControl:function(n){this.$3h_2=n;return n},$3h_2:!1,get_Trigger:function(){return this.$S_2},set_Trigger:function(n){if(this.get_isInitialized())throw Error.invalidOperation();this.$S_2=n;return n},$S_2:"click",get_AssociatedControl:function(){return this.$5E_2},set_AssociatedControl:function(n){if(!n)throw Error.argumentNull("AssociatedControl");this.$5E_2=n;return n},$5E_2:null,get_InvokedMethod:function(){return this.$7x_2},set_InvokedMethod:function(n){if(!n)throw Error.argument("InvokedMethod","Delegate is null.");this.$7x_2=n;return n},$7x_2:null,$9J_2:function(n,t){this.$4G_2()},$9T_2:function(n){this.$4G_2()},$4G_2:function(){var n=new ControlAssociationContext;n.targetControl=this.get_element();n.associatedControl=this.$5E_2;n.trigger=this.$S_2;this.get_InvokedMethod()(n)}};function ControlAssociationContext(){}ControlAssociationContext.prototype={targetControl:null,associatedControl:null,trigger:null};function ConvertFromDialingRuleEntries(){}ConvertFromDialingRuleEntries.prototype={convertFrom:function(n){if(_Object.isUndefined(n)||null!==n&&!Array.isInstanceOfType(n))throw Error.argument("value","Array of UMDialingRuleEntry is expected for DialingRuleEntries2RuleGroups.ConverTo.");if(null===n)return null;for(var u=n,f=[],e=[],i=0;i<u.length;i++){var o=u[i];var t=o.GroupName;if(_Object.isUndefined(t))throw Error.argument("value","Array of UMDialingRuleEntry is expected for DialingRuleEntries2RuleGroups.ConverTo.");if(!EcpUtil.containsCaseInsensitively(e,t)){var r={};r.Identity=new Identity(t,t);r.DisplayName=t;Array.add(e,t);Array.add(f,r)}}return f},convertTo:function(n){throw Error.invalidOperation("This converter class only supports convert from RuleEntries to RuleGroups using ConvertFrom function.");}};function DateTimePicker(n){this.$$d_$Ag_4=Function.createDelegate(this,this.$Ag_4);this.$$d_$AH_4=Function.createDelegate(this,this.$AH_4);this.$$d_$Ab_4=Function.createDelegate(this,this.$Ab_4);this.$$d_$AJ_4=Function.createDelegate(this,this.$AJ_4);this.$$d_$Aj_4=Function.createDelegate(this,this.$Aj_4);this.$$d_$AM_4=Function.createDelegate(this,this.$AM_4);this.$$d_$8J_4=Function.createDelegate(this,this.$8J_4);DateTimePicker.initializeBase(this,[n])}DateTimePicker.prototype={$U_4:null,$2L_4:null,$5W_4:null,$1n_4:null,$Z_4:null,$1K_4:!1,$h_4:null,$53_4:0,$46_4:null,$7I_4:null,$7N_4:null,$6O_4:null,$57_4:null,$58_4:null,$1e_4:null,$b_4:null,$d_4:null,$f_4:null,$2b_4:null,$1F_4:null,$i_4:null,$2K_4:null,$5V_4:null,$71_4:null,$D_4:null,$6D_4:null,$15_4:null,$1M_4:!1,$1s_4:null,$3x_4:!1,$19_4:null,$1r_4:null,$5r_4:!1,$5q_4:!1,add_selectedValueChanged:function(n){this.get_events().addHandler("change",n)},remove_selectedValueChanged:function(n){this.get_events().removeHandler("change",n)},get_DatePicker:function(){return this.$U_4},set_DatePicker:function(n){this.$U_4=n;return n},get_DateComboBox:function(){return this.$2L_4},set_DateComboBox:function(n){this.$2L_4=n;return n},get_DateText:function(){return this.$5W_4},set_DateText:function(n){this.$5W_4=n;return n},get_Calendar:function(){return this.$1n_4},set_Calendar:function(n){this.$1n_4=n;return n},get_TimePicker:function(){return this.$Z_4},set_TimePicker:function(n){this.$Z_4=n;return n},get_HasTimePicker:function(){return this.$1K_4},set_HasTimePicker:function(n){this.$1K_4=n;return n},get_Today:function(){return this.$h_4.format(this.$46_4)},set_Today:function(n){this.$h_4=new Date(n);return n},get_WeekStartDay:function(){return this.$53_4},set_WeekStartDay:function(n){this.$53_4=n;return n},get_GeneralizedDateTimeFormat:function(){return this.$46_4},set_GeneralizedDateTimeFormat:function(n){this.$46_4=n;return n},get_WeekdayDateFormat:function(){return this.$7I_4},set_WeekdayDateFormat:function(n){this.$7I_4=n;return n},get_YearMonthFormat:function(){return this.$7N_4},set_YearMonthFormat:function(n){this.$7N_4=n;return n},get_OneLetterDayNames:function(){return this.$6O_4},set_OneLetterDayNames:function(n){this.$6O_4=n;return n},get_AbbreviatedDayNames:function(){return this.$57_4},set_AbbreviatedDayNames:function(n){this.$57_4=n;return n},get_AbbreviatedMonthNames:function(){return this.$58_4},set_AbbreviatedMonthNames:function(n){this.$58_4=n;return n},get_MonthNames:function(){return this.$1e_4},set_MonthNames:function(n){this.$1e_4=n;return n},get_value:function(){return this.$D_4?this.$D_4.format(this.$46_4):null},set_value:function(n){_String.isNullOrEmpty(n)||this.set_selectedValue(new Date(n));return n},get_selectedValue:function(){return this.$D_4},set_selectedValue:function(n){if(n){this.$D_4=n;var t=this.$4w_4(n);this.$5W_4.innerHTML=EcpUtil.htmlEncode(t);var i=this.$4w_4(n,AriaUtil.dateFormatForScreenReader);this.$5V_4.innerText=i;if(this.$1K_4){this.$Z_4.selectedIndex=(n.getHours()*60+n.getMinutes())/30;this.$71_4.innerText=this.$Z_4.options[this.$Z_4.selectedIndex].innerText;this.$8J_4(null)}}return n},get_selectedDateText:function(){return this.$4w_4(this.$D_4)},initialize:function(){EcpControl.prototype.initialize.call(this);var n=0;var t=0;if(this.$1K_4){n=this.$h_4.getHours();t=this.$h_4.getMinutes()<30?0:30}this.$h_4=new Date(this.$h_4.getFullYear(),this.$h_4.getMonth(),this.$h_4.getDate(),n,t);this.get_value()||this.set_value(this.get_Today());this.$U_4.tabIndex=0;this.$9M_4();this.$3e_4();this.$93_4();this.get_element().getAttribute(GlobalVariables.rbacDisabled)==="true"&&this.set_enabled(!1)},dispose:function(){this.$v_4(!1);this.$9P_4();this.$3t_4();EcpControl.prototype.dispose.call(this)},addAriaAttribute:function(){EcpControl.prototype.addAriaAttribute.call(this);this.$U_4.setAttribute(AriaUtil.ariaRole,AriaUtil.ariaCombobox);var n=AriaUtil.findAssociatedLabel(this.get_element());this.$5V_4=AriaUtil.createAppendItemForScreenReader("label",null,null,this.$U_4.id+"_DatePickerHiddenLabel",this.$U_4);this.$71_4=AriaUtil.createAppendItemForScreenReader("label",null,null,this.$Z_4.id+"_TimePickerHiddenLabel",this.$Z_4);if(!_Object.isNullOrUndefined(n)){this.$U_4.setAttribute(AriaUtil.ariaLabelledby,AriaUtil.joinIDs(n.id,this.$5V_4.id));this.$Z_4.setAttribute(AriaUtil.ariaLabelledby,AriaUtil.joinIDs(n.id,this.$71_4.id))}},setEnabled:function(n){if(n){this.get_element().removeAttribute("disabled");this.$2L_4.removeAttribute("disabled");this.$1K_4&&this.$Z_4.removeAttribute("disabled");this.$U_4.tabIndex=0;this.$3e_4()}else{this.$3t_4();this.$U_4.removeAttribute("tabindex");this.get_element().setAttribute("disabled",!0);this.$2L_4.setAttribute("disabled",!0);this.$1K_4&&this.$Z_4.setAttribute("disabled",!0)}},$3e_4:function(){if(!this.$3x_4){this.$1K_4&&$addHandler(this.$Z_4,"change",this.$$d_$8J_4);this.$1r_4=this.$$d_$AM_4;$addHandler(document.documentElement,"mousedown",this.$1r_4);this.$1s_4=EcpApplication.get_instance();this.$1s_4&&this.$1s_4.get_Navigation()&&!window.opener&&!_Window.isModalDialog(window.self)&&$addHandler(this.$1s_4.get_navigationWindow().document.documentElement,"mousedown",this.$1r_4);$addHandler(window,"resize",this.$$d_$Aj_4);$addHandler(this.$U_4,"keydown",this.$$d_$AJ_4);this.$3x_4=!0}},$93_4:function(){if(this.$b_4){this.$19_4=this.$$d_$Ab_4;this.$19_4&&this.$d_4&&$addHandler(this.$d_4,"mousedown",this.$19_4);this.$19_4&&this.$f_4&&$addHandler(this.$f_4,"mousedown",this.$19_4);if(this.$1F_4){$addHandler(this.$1F_4,"click",this.$$d_$AH_4);this.$5r_4=!0}if(this.$i_4){$addHandler(this.$i_4,"click",this.$$d_$Ag_4);this.$5q_4=!0}}},$3t_4:function(){if(this.$3x_4){this.$1K_4&&$removeHandler(this.$Z_4,"change",this.$$d_$8J_4);if(this.$1r_4){try{this.$1s_4&&this.$1s_4.get_Navigation()&&!window.opener&&$removeHandler(this.$1s_4.get_navigationWindow().document.documentElement,"mousedown",this.$1r_4)}catch(n){}$removeHandler(document.documentElement,"mousedown",this.$1r_4);this.$1r_4=null}$removeHandler(window,"resize",this.$$d_$Aj_4);this.$U_4&&$removeHandler(this.$U_4,"keydown",this.$$d_$AJ_4);this.$3x_4=!1}},$9P_4:function(){if(this.$b_4){this.$19_4&&this.$d_4&&$removeHandler(this.$d_4,"mousedown",this.$19_4);this.$19_4&&this.$f_4&&$removeHandler(this.$f_4,"mousedown",this.$19_4);if(this.$1F_4&&this.$5r_4){$removeHandler(this.$1F_4,"click",this.$$d_$AH_4);this.$5r_4=!1}if(this.$i_4&&this.$5q_4){$removeHandler(this.$i_4,"click",this.$$d_$Ag_4);this.$5q_4=!1}this.$19_4=null}},$AI_4:function(n){n.button||this.$v_4(!this.$1M_4)},$Ab_4:function(n){var t=n.target;t.tagName==="IMG"&&(t=t.parentNode);this.$7X_4(t)},$7X_4:function(n){var t=Number.parseInvariant(n.attributes.getNamedItem("m").value)-1;var i=Number.parseInvariant(n.attributes.getNamedItem("y").value);this.$76_4(i,t)},$AH_4:function(n){var t=n.target;if(Sys.UI.DomElement.containsCssClass(t,"dpDay")){var i=Number.parseInvariant(t.attributes.getNamedItem("i").value);this.set_selectedValue(this.$15_4[i]);this.$v_4(!1)}},$Ag_4:function(n){this.$8i_4()},$8i_4:function(){this.set_selectedValue(this.$h_4);this.$v_4(!1)},$8J_4:function(n){var t=Number.parseInvariant(this.$Z_4.value)/60;var i=Number.parseInvariant(this.$Z_4.value)%60;this.$D_4.setHours(t);this.$D_4.setMinutes(i);this.$D_4.setSeconds(0);this.$8O_4()},$AM_4:function(n){for(var t=n.target;t;){if(t===this.$1n_4){n.stopPropagation();n.preventDefault();return}if(t===this.$U_4){n.stopPropagation();n.preventDefault();this.$AI_4(n);return}t=t.parentNode}this.$v_4(!1)},$Aj_4:function(n){this.$v_4(!1)},$AJ_4:function(n){if(n.altKey&&(n.keyCode===38||n.keyCode===40)){this.$v_4(!this.$1M_4);n.stopPropagation();n.preventDefault();return}if(!this.$1M_4&&(n.keyCode===13||n.keyCode===40)){this.$v_4(!0);n.stopPropagation();n.preventDefault();return}if(this.$1M_4){if(n.keyCode===9&&!n.ctrlKey&&(!n.altKey||EcpUtil.isSafari()&&n.altKey)){n.shiftKey&&n.target===this.$d_4?this.$v_4(!1):n.shiftKey||n.target!==this.$i_4||this.$v_4(!1);return}if((n.keyCode===13||n.keyCode===32)&&!n.altKey&&!n.ctrlKey){var i=n.target;var r=!1;if(i===this.$d_4||i===this.$f_4){this.$7X_4(i);r=!0}else if(i===this.$i_4){this.$8i_4();r=!0}if(r){n.stopPropagation();n.preventDefault();return}}var t=0;switch(n.keyCode){case 37:t=RtlUtil.isRtl?1:-1;break;case 39:t=RtlUtil.isRtl?-1:1;break;case 38:t=-7;break;case 40:t=7;break;case 13:this.$v_4(!1);break;case 27:this.set_selectedValue(this.$6D_4);this.$v_4(!1);break}if(t){this.$BF_4(t);this.$8r_4()}n.stopPropagation();n.preventDefault()}},$9Y_4:function(){_Object.isNullOrUndefined(this.$2K_4)?this.$U_4.focus():this.$8r_4()},$8r_4:function(){var n=this.$4w_4(this.$D_4,AriaUtil.dateFormatForScreenReader);this.$2K_4.tabIndex=0;this.$2K_4.setAttribute(AriaUtil.ariaSelected,!0);AriaUtil.updateElementLabelForScreenReader(this.$2K_4,n);EcpUtil.safeFocus(this.$2K_4)},$8O_4:function(){var n=this.get_events().getHandler("change");n&&n(this,Sys.EventArgs.Empty)},$v_4:function(n){if(n&&!this.$1M_4){this.$6D_4=this.$D_4;this.$76_4(this.$D_4.getFullYear(),this.$D_4.getMonth());Sys.UI.DomElement.addCssClass(this.$2L_4,"dropDownShowing");EcpUtil.showElement(this.$1n_4,!0);this.$1M_4=!0;this.$9Y_4();var t=BaseForm.getCurrentForm(this.get_element());t&&t.scrollIntoView(this.$1n_4)}else if(!n&&this.$1M_4){this.$6D_4=null;EcpUtil.showElement(this.$1n_4,!1);Sys.UI.DomElement.removeCssClass(this.$2L_4,"dropDownShowing");this.$1M_4=!1;this.$8O_4();EcpUtil.safeFocus(this.$U_4)}this.$U_4.setAttribute(AriaUtil.ariaExpanded,this.$1M_4)},$BF_4:function(n){var r=null;var t=Number.parseInvariant(this.$b_4.attributes.getNamedItem("y").value);var i=Number.parseInvariant(this.$b_4.attributes.getNamedItem("m").value)-1;r=this.$D_4.getFullYear()===t&&this.$D_4.getMonth()===i?new Date(this.$D_4.getFullYear(),this.$D_4.getMonth(),this.$D_4.getDate()+n,this.$D_4.getHours(),this.$D_4.getMinutes()):n>0?new Date(t,i,1,this.$D_4.getHours(),this.$D_4.getMinutes()):new Date(t,i+1,0,this.$D_4.getHours(),this.$D_4.getMinutes());this.set_selectedValue(r);this.$76_4(this.$D_4.getFullYear(),this.$D_4.getMonth())},$76_4:function(n,t){this.$b_4.id="div"+(t+1).toString()+n.toString();this.$b_4.setAttribute("m",(t+1).toString());this.$b_4.setAttribute("y",n.toString());this.$BD_4(n,t);var c=0;var l=0;if(this.$1K_4){c=Number.parseInvariant(this.$Z_4.value)/60;l=Number.parseInvariant(this.$Z_4.value)%60}var a=this.$BC_4(n,t,c,l);var v=a;var y=a+this.$9c_4(t,n)-1;var r=this.$15_4[0];r=new Date(r.getFullYear(),r.getMonth(),r.getDate());var u=this.$15_4[41];u=new Date(u.getFullYear(),u.getMonth(),u.getDate()+1);for(var e=r<=this.$h_4&&this.$h_4<u?this.$h_4.format("d"):null,o=r<=this.$D_4&&this.$D_4<u?this.$D_4.format("d"):null,f=0,s=0;s<this.$1F_4.childNodes.length;s++)for(var p=this.$1F_4.childNodes[s],h=0;h<7;h++){var i=p.childNodes[h];i.innerHTML=EcpUtil.htmlEncode(this.$15_4[f].getDate().toString());i.className="";i.tabIndex=-1;i.setAttribute(AriaUtil.ariaSelected,!1);Sys.UI.DomElement.addCssClass(i,"dpDay");(v>f||y<f)&&Sys.UI.DomElement.addCssClass(i,"dpPOrN");if(e&&e===this.$15_4[f].format("d")){Sys.UI.DomElement.addCssClass(i,"dpToday");e=null}if(o&&o===this.$15_4[f].format("d")){Sys.UI.DomElement.addCssClass(i,"dpSel");this.$2K_4=i;o=null}f++}},$BD_4:function(n,t){var o=t+(RtlUtil.isRtl?1:-1);var s=t+(RtlUtil.isRtl?-1:1);var u=new Date(n,o,1);var f=new Date(n,s,1);var e=new Date(n,t,1);var i=u.getMonth()+1;this.$d_4.setAttribute("m",i);this.$d_4.setAttribute("y",u.getFullYear());this.$d_4.title=String.format(Strings.get_PreviousMonth(),this.$1e_4[i-1]);this.$d_4.alt=String.format(Strings.get_PreviousMonth(),this.$1e_4[i-1]);var r=f.getMonth()+1;this.$f_4.setAttribute("m",r);this.$f_4.setAttribute("y",f.getFullYear());this.$f_4.title=String.format(Strings.get_NextMonth(),this.$1e_4[r-1]);this.$f_4.alt=String.format(Strings.get_NextMonth(),this.$1e_4[r-1]);this.$2b_4.innerHTML=e.format(this.$7N_4).replace("MMMM",this.$1e_4[e.getMonth()].toUpperCase()).replace(","," ")},$BC_4:function(n,t,i,r){var e=new Date(n,t,1,i,r);var u=e.getDay()-this.$53_4;u=u<0?7+u:u;if(!this.$15_4||this.$15_4[u].getTime()!==e.getTime()){this.$15_4=new Array(42);for(var o=-u,f=0;f<42;o++,f++)this.$15_4[f]=new Date(n,t,1+o,i,r);this.$h_4.setHours(i);this.$h_4.setMinutes(r)}return u},$9c_4:function(n,t){var i=[31,28,31,30,31,30,31,31,30,31,30,31,29];return n!==1||(t%4||!(t%100))&&t%400?i[n]:i[i.length-1]},$9M_4:function(){this.$b_4=document.createElement("DIV");this.$b_4.id="divMonth";Sys.UI.DomElement.addCssClass(this.$b_4,"dpMonth");this.$b_4.appendChild(this.$9L_4());this.$1F_4=document.createElement("DIV");this.$1F_4.id="divWeeks";for(var u=6,f=0,i=0;i<u;i++){var t=document.createElement("DIV");t.id="divWeek"+i;Sys.UI.DomElement.addCssClass(t,"dpWeek");for(var r=0;r<7;r++){var n=document.createElement("A");n.href="#";n.tabIndex=-1;n.setAttribute("i",f++);n.setAttribute(AriaUtil.ariaRole,AriaUtil.ariaButton);t.appendChild(n)}this.$1F_4.appendChild(t)}this.$b_4.appendChild(this.$9N_4());this.$b_4.appendChild(this.$1F_4);this.$b_4.appendChild(this.$9K_4());this.$1n_4.appendChild(this.$b_4)},$9L_4:function(){var n=document.createElement("DIV");n.id="divDpHdr";Sys.UI.DomElement.addCssClass(n,"dpHdr");this.$d_4=SpriteImage.createSpriteButton("CommonSprite Previous",null);this.$d_4.id=RtlUtil.isRtl?"imgNext":"imgPrev";Sys.UI.DomElement.addCssClass(this.$d_4,"vaM");Sys.UI.DomElement.addCssClass(this.$d_4,RtlUtil.isRtl?CssClasses.floatRight:CssClasses.floatLeft);n.appendChild(this.$d_4);this.$f_4=SpriteImage.createSpriteButton("CommonSprite Next",null);this.$f_4.id=RtlUtil.isRtl?"imgPrev":"imgNext";Sys.UI.DomElement.addCssClass(this.$f_4,"vaM");Sys.UI.DomElement.addCssClass(this.$f_4,RtlUtil.isRtl?CssClasses.floatLeft:CssClasses.floatRight);n.appendChild(this.$f_4);this.$2b_4=document.createElement("SPAN");this.$2b_4.id="spanMonthYear";Sys.UI.DomElement.addCssClass(this.$2b_4,"dpMonthYear");Sys.UI.DomElement.addCssClass(this.$2b_4,"vaM");n.appendChild(this.$2b_4);return n},$9N_4:function(){var n=document.createElement("DIV");Sys.UI.DomElement.addCssClass(n,"dpMonthHdr");for(var t=0;t<7;t++){var i=document.createElement("DIV");Sys.UI.DomElement.addCssClass(i,"dpDOW");i.innerHTML=EcpUtil.htmlEncode(this.$6O_4[(this.$53_4+t)%7]);n.appendChild(i)}return n},$9K_4:function(){var n=document.createElement("DIV");Sys.UI.DomElement.addCssClass(n,"btnDay");this.$i_4=document.createElement("DIV");Sys.UI.DomElement.addCssClass(this.$i_4,"dpBtn");this.$i_4.id="divToday";this.$i_4.tabIndex=0;this.$i_4.setAttribute(AriaUtil.ariaRole,AriaUtil.ariaButton);this.$i_4.title=Strings.get_Today();var t=document.createElement("SPAN");Sys.UI.DomElement.addCssClass(t,"dpTodayLh");t.innerHTML=EcpUtil.htmlEncode(Strings.get_Today());this.$i_4.appendChild(t);n.appendChild(this.$i_4);return n},$4w_4:function(n,t){_String.isNullOrEmpty(t)&&(t=this.$7I_4);return n.format(t).replace("ddd",this.$57_4[n.getDay()]).replace("MMMM",this.$1e_4[n.getMonth()]).replace("MMM",this.$58_4[n.getMonth()])}};function DetailsTable(n){DetailsTable.initializeBase(this,[n])}DetailsTable.prototype={initialize:function(){EcpControl.prototype.initialize.call(this);if(EcpUtil.isSafari()||EcpUtil.isFirefox()){var n=this;window.setTimeout(function(){n.$91_4()},0)}},$91_4:function(){for(var n=this.get_element(),i=0;i<n.rows.length;i++){var t=n.rows[i];if(t.cells.length===2){t.cells[0].style.width=EcpUtil.pX2EM(t.cells[0],t.cells[0].offsetWidth)+"em";break}}n.style.tableLayout="fixed";n.style.width="100%"}};function DLPCollectionEditor(n){DLPCollectionEditor.initializeBase(this,[n])}DLPCollectionEditor.prototype={onOK:function(n){for(var o=this.getCurrentItemKeys(),r=[],t=0;t<n.length;t++){var f=DataBinder.getPropertyValue(n[t],"Identity");var s=DataBinder.getPropertyValue(n[t],"LocalizedName");if(!o[Identity.generateKeyForIdentity(f)]){var u={};u.name=f.RawIdentity;u.displayName=s;Array.add(r,u)}}r.length>0&&this.$1_5.addRange(r,!0);for(var e=new Array(this.$1_5.get_count()),i=0;i<this.$1_5.get_count();i++)e[i]=i;this.$0_5.redrawItems(e);this.$0_5.get_DataSource().applySort(this.$0_5.get_SortProperty(),this.$0_5.get_SortDirection())},onEditDialogOK:function(n){this.resetPickerDialogVariables();var e=this.getCurrentItemKeys();var i=this.$0_5.get_selectedObjects();if(i.length===1){var t=i[0];var o=n[0];var r=o;for(var u in r){var f={key:u,value:r[u]};t[f.key]=f.value}var h=e[Identity.generateKeyForIdentity(DataBinder.getPropertyValue(t,"name"))];var s=this.$1_5.getIndex(t);this.$0_5.redrawItems([s])}}};function EcpCollectionEditor(n){this.$$d_onEditDialogOK=Function.createDelegate(this,this.onEditDialogOK);this.$$d_onWholeListEditorOk=Function.createDelegate(this,this.onWholeListEditorOk);this.$$d_$85_5=Function.createDelegate(this,this.$85_5);this.$$d_$A5_5=Function.createDelegate(this,this.$A5_5);this.$$d_listValueChanged=Function.createDelegate(this,this.listValueChanged);EcpCollectionEditor.initializeBase(this,[n])}EcpCollectionEditor.prototype={originalValues:null,$4M_5:null,$63_5:!1,$0_5:null,$1_5:null,$1t_5:null,$7D_5:!1,$54_5:null,$7E_5:!1,$4J_5:!1,$6W_5:0,$10_5:!1,$3B_5:!1,setEnabled:function(n){this.$0_5&&this.$0_5.set_enabled(n)},setReadOnly:function(n){if(this.$0_5&&this.$0_5.get_ToolBar())if(this.$0_5.get_ToolBar().findItemByName("ViewDetails")){for(var t=0;t<this.$0_5.get_ToolBar().get_Items().length;t+=2)if(this.$0_5.get_ToolBar().get_Items()[t].name!=="ViewDetails"){this.$0_5.get_ToolBar().get_Items()[t].set_enabled(!n);this.$0_5.get_ToolBar().get_Items()[t].set_visible(!n)}}else{this.$0_5.get_ToolBar().set_enabled(!n);this.$0_5.get_ToolBar().set_visible(!n)}},get_ListView:function(){return this.$0_5},set_ListView:function(n){this.$0_5=n;return n},get_DataSource:function(){return this.$1_5},set_DataSource:function(n){this.$1_5=n;return n},get_EditCommandUrl:function(){return this.$1t_5},set_EditCommandUrl:function(n){this.$1t_5=n;return n},get_IgnoreCaseWhenComparison:function(){return this.$10_5},set_IgnoreCaseWhenComparison:function(n){this.$10_5=n;return n},get_KeepOrderChange:function(){return this.$3B_5},set_KeepOrderChange:function(n){this.$3B_5=n;return n},get_SplitAddRemove:function(){return this.$6x_5},set_SplitAddRemove:function(n){this.$6x_5=n;return n},$6x_5:!1,get_UseModalPopup:function(){return this.$7D_5},set_UseModalPopup:function(n){this.$7D_5=n;return n},get_UseModalessForAdd:function(){return this.$7E_5},set_UseModalessForAdd:function(n){this.$7E_5=n;return n},get_IsUsingOwaPeoplePicker:function(){return this.$4J_5},set_IsUsingOwaPeoplePicker:function(n){this.$4J_5=n;return n},get_PickerCallerType:function(){return this.$6W_5},set_PickerCallerType:function(n){this.$6W_5=n;return n},get_value:function(){if(this.$6x_5){var r={};r.Added=this.get_valuesAdded();r.Removed=this.get_valuesRemoved();return r}else{for(var u=new Array(this.$1_5.get_count()),n=0;n<this.$1_5.get_count();n++)u[n]=DataBinder.getPropertyValue(this.$1_5.getAt(n),this.$6_4);var t=null;if(!_Object.isNullOrUndefined(this.originalValues)){t=new Array(this.originalValues.length);for(var i=0;i<this.originalValues.length;i++)t[i]=DataBinder.getPropertyValue(this.originalValues[i],this.$6_4)}return!this.$3B_5&&_Array.EqualsWithOutOrder(u,t)?t:u}},set_value:function(n){this.$1_5.clear();if(n){this.originalValues=EcpUtil.cloneArray(n);this.$1_5.setList(n,!0);if(this.$0_5.get_items().length>0){this.$0_5.get_items()[0].set_selected(!0);this.$63_5||(this.$63_5=!0)}}return n},get_fullValue:function(){for(var t=new Array(this.$1_5.get_count()),n=0;n<this.$1_5.get_count();n++)t[n]=EcpUtil.cloneDataObject(this.$1_5.getAt(n));return!this.$3B_5&&_Array.EqualsWithOutOrder(t,this.originalValues)?this.originalValues:t},set_fullValue:function(n){this.set_value(n);return n},get_valuesAdded:function(){var i=[];if(!_Object.isNullOrUndefined(this.originalValues)){for(var r={},n=0;n<this.originalValues.length;n++){var u=Identity.generateKeyForIdentityEx(DataBinder.getPropertyValue(this.originalValues[n],this.$6_4),this.$10_5);r[u]=this.originalValues[n]}for(var t=0;t<this.$1_5.get_count();t++){var f=Identity.generateKeyForIdentityEx(DataBinder.getPropertyValue(this.$1_5.getAt(t),this.$6_4),this.$10_5);r[f]||Array.add(i,DataBinder.getPropertyValue(this.$1_5.getAt(t),this.$6_4))}}return i},get_valuesRemoved:function(){var i=[];if(!_Object.isNullOrUndefined(this.originalValues)){for(var r={},n=0;n<this.$1_5.get_count();n++){var u=Identity.generateKeyForIdentityEx(DataBinder.getPropertyValue(this.$1_5.getAt(n),this.$6_4),this.$10_5);r[u]=this.$1_5.getAt(n)}for(var t=0;t<this.originalValues.length;t++){var f=Identity.generateKeyForIdentityEx(DataBinder.getPropertyValue(this.originalValues[t],this.$6_4),this.$10_5);r[f]||Array.add(i,DataBinder.getPropertyValue(this.originalValues[t],this.$6_4))}}return i},get_AddCommandDialogHeight:function(){return this.$3a_5},set_AddCommandDialogHeight:function(n){this.$3a_5=n;return n},$3a_5:0,get_AddCommandDialogWidth:function(){return this.$3b_5},set_AddCommandDialogWidth:function(n){this.$3b_5=n;return n},$3b_5:0,get_EditCommandDialogHeight:function(){return this.$3u_5},set_EditCommandDialogHeight:function(n){this.$3u_5=n;return n},$3u_5:0,get_EditCommandDialogWidth:function(){return this.$3v_5},set_EditCommandDialogWidth:function(n){this.$3v_5=n;return n},$3v_5:0,initialize:function(){EcpSelect.prototype.initialize.call(this);this.originalValues=new Array(this.$1_5.get_count());for(var n=0;n<this.$1_5.get_count();n++)this.originalValues[n]=EcpUtil.cloneDataObject(this.$1_5.getAt(n));this.$0_5.set_SortProperty(this.$1b_4);this.$4M_5=this.$$d_listValueChanged;this.$1_5.add_listChanged(this.$4M_5);this.$0_5.add_propertyChanged(this.$$d_$A5_5);this.$0_5.add_selectionChanged(this.$$d_$85_5)},dispose:function(){EcpSelect.prototype.dispose.call(this);this.$1_5&&this.$1_5.remove_listChanged(this.$4M_5);this.$4M_5=null},initAddCommandValue:function(){return null},addCommand:function(){if(this.$4J_5){var r=this;var u=function(n){r.onDialogOK(n)};var f=OwaPickerUtil.invokeOwaPickerCommon(this.$6W_5,null,!0,u);if(window.self.showModalDialog)this.onDialogOK(f)}else{var n=this.generatePickerUrl(this.$1Q_4,!1);var t=this.$3a_5?this.$3a_5:this.$1H_4;var i=this.$3b_5?this.$3b_5:this.$1I_4;if(this.$7D_5&&!this.$7E_5){var e=this;var o=function(){var n=window.dialogArguments;var t=EcpUtil.tryDeserialize(n.value);e.onDialogOK([t])};ModalPopupLauncherHelper.openModalPopup(n,t,i,this.initAddCommandValue(),this.get_DataContext(),this.$$d_onDialogOK,o)}else this.invokePickerEx(n,t,i)}},addAriaAttribute:function(){var n=$get(this.get_element().id+AriaUtil.associatedLabelSuffix);n&&AriaUtil.addAriaAttrToControlWithLab(this.get_element(),n);AriaUtil.addAriaAttrToControlWithLabelID(this.get_element(),AriaUtil.getFvaReaderSpanId(this.get_element()));var t=$get(this.get_element().id+"_Description_label");t&&this.get_element().setAttribute(AriaUtil.ariaDescribedby,t.id)},get_WholeListEditorUrl:function(){return this.$54_5},set_WholeListEditorUrl:function(n){if(this.$54_5!==n){this.$54_5=n;this.raisePropertyChanged("WholeListEditorUrl")}return n},editWholeListCommand:function(){var n=this.generatePickerUrl(this.$54_5,!1);var t=this;var i=function(){var n=window.dialogArguments;var i=EcpUtil.tryDeserialize(n.value);t.onWholeListEditorOk([i])};ModalPopupLauncherHelper.openModalPopup(n,this.$1H_4,this.$1I_4,this.get_DataContext().get_values(),this.get_DataContext(),this.$$d_onWholeListEditorOk,i)},onWholeListEditorOk:function(n){var t=EcpUtil.cloneDataObject(n[0]);for(var i in t){var r={key:i,value:t[i]};this.get_DataContext().setProperty(r.key,r.value)}},editCommand:function(){var n=this.$0_5.get_selectedObjects();var t=this.$3u_5?this.$3u_5:this.$1H_4;var i=this.$3v_5?this.$3v_5:this.$1I_4;n.length===1&&ModalPopupLauncherHelper.openModalPopup(this.$1t_5,t,i,n[0],this.get_DataContext(),this.$$d_onEditDialogOK)},onOK:function(n){this.resetPickerDialogVariables();var r=this.getCurrentItemKeys();this.$4J_5&&(r=this.getCurrentItemSmtpAddressKeys());for(var t=[],i=0;i<n.length;i++){var f=DataBinder.getPropertyValue(n[i],this.$6_4);r[Identity.generateKeyForIdentityEx(f,this.$10_5)]||Array.add(t,n[i])}if(t.length>0){var u=this.$0_5.get_items().length;var e=u+t.length-1;this.$1_5.addRange(t,!0);this.$0_5.deselectAllItems();this.$0_5.selectRange(u,e)}},onEditDialogOK:function(n){this.resetPickerDialogVariables();var u=this.$0_5.get_selectedObjects();if(u.length===1){var f=this.getCurrentItemKeys();var t=n[0];var o=DataBinder.getPropertyValue(t,this.$6_4);var s=DataBinder.getPropertyValue(u[0],this.$6_4);var e=f[Identity.generateKeyForIdentityEx(o,this.$10_5)];var i=f[Identity.generateKeyForIdentityEx(s,this.$10_5)];if(i&&(!e||e===i)){var r=this.$1_5.remove(i);r<this.$1_5.get_count()&&r>=0?this.$1_5.insert(r,t):this.$1_5.add(t)}}},getFirstFocusableField:function(){return EcpUtil.isVisible(this.get_element())&&!this.get_ReadOnly()&&null!==this.$0_5?this.$0_5.getFirstFocusableField():null},listValueChanged:function(n,t){this.$63_5&&this.$Am_5(t);this.raisePropertyChanged("value");this.raisePropertyChanged("fullValue")},$Am_5:function(n){var t=this.get_events().getHandler("listModified");t&&t(this,n)},resetPickerDialogVariables:function(){this.$23_4=null;PickerLauncherHelper.unregisterLauncher(this)},getCurrentItemKeys:function(){for(var t={},n=0;n<this.$1_5.get_count();n++)t[Identity.generateKeyForIdentityEx(DataBinder.getPropertyValue(this.$1_5.getAt(n),this.$6_4),this.$10_5)]=this.$1_5.getAt(n);return t},getCurrentItemSmtpAddressKeys:function(){for(var t={},n=0;n<this.$1_5.get_count();n++)t[Identity.generateKeyForIdentityEx(DataBinder.getPropertyValue(this.$1_5.getAt(n),"PrimarySmtpAddress"),this.$10_5)]=this.$1_5.getAt(n);return t},get_FocusedObject:function(){return this.$0_5.get_focusedObject()},$A5_5:function(n,t){t.get_propertyName()==="FocusedObject"&&this.raisePropertyChanged("FocusedObject")},$85_5:function(n,t){this.raisePropertyChanged("SelectedObjects")},get_SelectedObjects:function(){for(var t=this.$0_5.get_selectedObjects(),i=new Array(t.length),n=0;n<t.length;n++)i[n]=DataBinder.getPropertyValue(t[n],this.$6_4);return i}};function EcpMultiSelect(n){EcpMultiSelect.initializeBase(this,[n]);this.$3Q_7=!1}EcpMultiSelect.prototype={get_value:function(){return this.$25_7},set_value:function(n){this.set_selectedValues(n);return n}};function FingerprintLanguageCollectionEditor(n){this.$$d_$85_6=Function.createDelegate(this,this.$85_6);FingerprintLanguageCollectionEditor.initializeBase(this,[n]);this.$6_4="Locale"}FingerprintLanguageCollectionEditor.prototype={initialize:function(){EcpCollectionEditor.prototype.initialize.call(this);this.$0_5.add_selectionChanged(this.$$d_$85_6)},$85_6:function(n,t){if(this.$0_5.get_selectedObjects().length>0){var i=this.$0_5.get_selectedObjects()[0];i&&this.$0_5.get_ToolBar().findItemByName("Delete").set_enabled(!i.IsDefault)}},onOK:function(n){for(var h=this.getCurrentItemKeys(),u=[],i=0;i<n.length;i++){var c=DataBinder.getPropertyValue(n[i],"Description");var f=DataBinder.getPropertyValue(n[i],"Language");var e=DataBinder.getPropertyValue(n[i],"Locale");var l=DataBinder.getPropertyValue(n[i],"Name");var o=new Identity(e,f);var a=Identity.generateKeyForIdentity(o);if(!h[a]){var t={};t.__type="DataClassificationService.LanguageSetting:ECP";t.Description=c;t.Language=f;t.Locale=e;t.Name=l;t.IsDefault=!1;t.Identity=o;Array.add(u,t)}}u.length>0&&this.$1_5.addRange(u,!0);for(var s=new Array(this.$1_5.get_count()),r=0;r<this.$1_5.get_count();r++)s[r]=r;this.$0_5.redrawItems(s);this.$0_5.get_DataSource().applySort(this.$0_5.get_SortProperty(),this.$0_5.get_SortDirection())},get_value:function(){return this.$1_5.get_value()},set_value:function(n){EcpCollectionEditor.prototype.set_value.call(this,n);return n},onEditDialogOK:function(n){this.resetPickerDialogVariables();var u=this.getCurrentItemKeys();var i=this.$0_5.get_selectedObjects();if(i.length===1){var t=i[0];var r=n[0];t.Name=r.Name;t.Description=r.Description;var f=Identity.generateKeyForIdentity(DataBinder.getPropertyValue(t,this.$6_4));var o=u[f];var e=this.$1_5.getIndex(t);this.$0_5.redrawItems([e])}}};function EmailAddressCollectionEditor(n){this.$$d_$9H_6=Function.createDelegate(this,this.$9H_6);this.$$d_onEditDialogOK=Function.createDelegate(this,this.onEditDialogOK);this.$$d_onItemUpdated=Function.createDelegate(this,this.onItemUpdated);this.$$d_onSelectionChanged=Function.createDelegate(this,this.onSelectionChanged);EmailAddressCollectionEditor.initializeBase(this,[n])}EmailAddressCollectionEditor.comparePrefix=function(n,t){var r=n.toUpperCase();var u=t.toUpperCase();var i=r.localeCompare(u);i||(r===n?i=-1:u===t&&(i=1));return i};EmailAddressCollectionEditor.prototype={initialize:function(){EcpCollectionEditor.prototype.initialize.call(this);this.$0_5.add_selectionChanged(this.$$d_onSelectionChanged);this.$0_5.add_itemUpdated(this.$$d_onItemUpdated)},initAddCommandValue:function(){var n={};n.replyVisible=!this.get_DataContext().getProperty("EmailAddressPolicyEnabled");n.mustBePrimary=!this.$1_5.get_count();n.existingItems=this.$7m_6();return n},editCommand:function(){var n=this.$0_5.get_selectedObjects();if(n.length===1){var t=n[0];var i=DataBinder.getPropertyValue(n[0],"Prefix");var r=this.get_DataContext().getProperty("EmailAddressPolicyEnabled");t.replyVisible=!(r||i.toUpperCase()===i);t.mustBePrimary=i.toUpperCase()===i;t.originalIdentity=DataBinder.getPropertyValue(n[0],"Identity");t.existingItems=this.$7m_6();var u=this;var f=function(){var n=window.dialogArguments;var t=EcpUtil.tryDeserialize(n.value);u.onEditDialogOK([t])};ModalPopupLauncherHelper.openModalPopup(this.$1t_5,this.$1H_4,this.$1I_4,n[0],this.get_DataContext(),this.$$d_onEditDialogOK,f)}},get_dataSourceValue:function(){var n=this.$1_5.getList();return!this.$3B_5&&_Array.EqualsWithOutOrder(n,this.originalValues)?this.originalValues:n},set_dataSourceValue:function(n){this.$1_5.clearSortProperty();this.$1_5.set_customizedSortComparers({"*":this.$$d_$9H_6});this.set_value(n);this.$0_5.set_SortProperty("*");this.$0_5.applyLayoutEx();return n},onSelectionChanged:function(n,t){var r=this.$0_5.get_selectedObjects();var u=this.$0_5.get_ToolBar().findItemByName("Delete");if(r.length>0&&u){for(var f=!0,e=r,o=e.length,i=0;i<o;++i){var s=e[i];if(!this.$9O_6(s)){f=!1;break}}u.set_enabled(f)}},$9O_6:function(n){var t=!0;var r=DataBinder.getPropertyValue(n,"Prefix");r==="SMTP"&&(t=!1);var u=DataBinder.getPropertyValue(n,"Identity");var i=this.get_DataContext().getProperty("ExternalEmailAddress");i&&i.toUpperCase()===u.toUpperCase()&&(t=!1);return t},onItemUpdated:function(n,t){var i=t.get_item();var r=i.get_element();var u=DataBinder.getPropertyValue(i.get_dataObject(),"Prefix");var f=r.childNodes[0];var e=r.childNodes[1];if(u.toUpperCase()===u){f.style.fontWeight="bold";e.style.fontWeight="bold"}else{f.style.fontWeight="normal";e.style.fontWeight="normal"}},$7m_6:function(){for(var t={},n=0;n<this.$1_5.get_count();n++){var i=DataBinder.getPropertyValue(this.$1_5.getAt(n),this.$6_4);t[i.toLowerCase()]=i}return t},onOK:function(n){for(var u="",f=!1,a=this.getCurrentItemKeys(),r=[],t=0;t<n.length;t++){var v=DataBinder.getPropertyValue(n[t],this.$6_4);DataBinder.getPropertyValue(n[t],"ReplyAddress")&&(f=!0);u=DataBinder.getPropertyValue(n[t],"Prefix").toUpperCase();a[Identity.generateKeyForIdentity(v)]||Array.add(r,n[t])}if(f&&r.length>0)for(var s=0;s<this.$1_5.get_count();s++){var i=this.$1_5.getAt(s);if(i.Prefix.toUpperCase()===u){i.Prefix=i.Prefix.toLowerCase();i.Identity=i.Prefix+":"+i.AddressString}}if(!f&&r.length>0){for(var c=!1,h=0;h<this.$1_5.get_count();h++){var y=this.$1_5.getAt(h);if(y.Prefix.toUpperCase()===u){c=!0;break}}if(!c){var e=r[0];e.Prefix=u;e.Identity=e.Prefix+":"+e.AddressString}}EcpCollectionEditor.prototype.onOK.call(this,n);if(f&&r.length>0){this.raisePropertyChanged("DataSourceValue");for(var l=new Array(this.$1_5.get_count()),o=0;o<this.$1_5.get_count();o++)l[o]=o;this.$0_5.redrawItems(l)}this.$0_5.get_DataSource().applySort(this.$0_5.get_SortProperty(),this.$0_5.get_SortDirection())},onEditDialogOK:function(n){var a="";var v=!1;var y=!1;this.resetPickerDialogVariables();var i=null;var r=null;var u=null;var f=null;var p=this.getCurrentItemKeys();var w=this.$0_5.get_selectedObjects();if(w.length===1){var g=w[0];f=n[0];r=DataBinder.getPropertyValue(g,this.$6_4);u=DataBinder.getPropertyValue(f,this.$6_4);if(r!==u){var b=p[Identity.generateKeyForIdentity(u)];i=p[Identity.generateKeyForIdentity(r)];i&&(!b||b===i)&&(v=!0)}}if(v){for(var e=0;e<n.length;e++){a=DataBinder.getPropertyValue(n[e],"Prefix").toUpperCase();DataBinder.getPropertyValue(n[e],"ReplyAddress")&&(y=!0)}if(y)for(var s=0;s<this.$1_5.get_count();s++){var t=this.$1_5.getAt(s);if(t.Prefix.toUpperCase()===a){t.Prefix=t.Prefix.toLowerCase();t.Identity=t.Prefix+":"+t.AddressString}}var h=this.$1_5.remove(i);h>=0&&h<this.$1_5.get_count()?this.$1_5.insert(h,f):this.$1_5.add(f);this.raisePropertyChanged("DataSourceValue");for(var k=new Array(this.$1_5.get_count()),o=0;o<this.$1_5.get_count();o++)k[o]=o;this.$0_5.redrawItems(k);this.$0_5.get_DataSource().applySort(this.$0_5.get_SortProperty(),this.$0_5.get_SortDirection());var c=this.get_DataContext().getProperty("ExternalEmailAddress");if(c)if(r===c){this.get_DataContext().setProperty("ExternalEmailAddress",u);this.raisePropertyChanged("ExternalEmailAddress")}else for(var l=0;l<this.$1_5.get_count();l++){var d=this.$1_5.getAt(l);if(c.indexOf(d.AddressString)>0){this.get_DataContext().setProperty("ExternalEmailAddress",d.Identity);this.raisePropertyChanged("ExternalEmailAddress");break}}}this.$0_5.get_DataSource().applySort(this.$0_5.get_SortProperty(),this.$0_5.get_SortDirection())},listValueChanged:function(n,t){EcpCollectionEditor.prototype.listValueChanged.call(this,n,t);this.raisePropertyChanged("DataSourceValue")},dispose:function(){EcpCollectionEditor.prototype.dispose.call(this);if(this.$0_5){this.$0_5.remove_selectionChanged(this.$$d_onSelectionChanged);this.$0_5.remove_itemUpdated(this.$$d_onItemUpdated)}},$9H_6:function(n,t){var i=0;var r=DataBinder.getPropertyValue(n,"Prefix");var u=DataBinder.getPropertyValue(t,"Prefix");r&&u&&(i=EmailAddressCollectionEditor.comparePrefix(r,u));if(!i){var f=DataBinder.getPropertyValue(n,"AddressString");var e=DataBinder.getPropertyValue(t,"AddressString");f&&e&&(i=f.localeCompare(e))}return i}};function TeamMailboxUserCollectionEditor(n){TeamMailboxUserCollectionEditor.initializeBase(this,[n])}function EcpSelect(n){this.$$d_$AL_4=Function.createDelegate(this,this.$AL_4);this.$$d_$Ah_4=Function.createDelegate(this,this.$Ah_4);this.$$d_onDialogOK=Function.createDelegate(this,this.onDialogOK);this.$1H_4=GlobalVariables.defaultPickerDialogHeight;this.$1I_4=GlobalVariables.defaultPickerDialogWidth;EcpSelect.initializeBase(this,[n])}EcpSelect.prototype={$1Q_4:null,$23_4:null,initialize:function(){EcpControl.prototype.initialize.call(this);this.ecpApplication=EcpApplication.get_instance();$addHandler(window,"unload",this.$$d_$Ah_4)},dispose:function(){this.ecpApplication=null;$clearHandlers(this.get_element());EcpControl.prototype.dispose.call(this)},invokePicker:function(n){this.invokePickerEx(n,this.$1H_4,this.$1I_4)},invokePickerEx:function(n,t,i){if(this.$7C_4){document.activeElement&&Dialog.isInstanceOfType(this.get_dialogPicker())&&DialogManager.focusControlAfterClose(document.activeElement);var r=this.getOriginalSelection();var u=r&&r.length>0?r[0]:null;this.get_dialogPicker().showDialog(this.$5f_4,u,this.$$d_$AL_4)}else PickerLauncherHelper.openPicker(this,n,t,i)},generatePickerUrl:function(n,t){var r=t?EcpSelect.$8e:EcpSelect.$88;n=EcpUrl.setUrlParameter(n,EcpSelect.$86,r);var i=EcpUrl.dictionaryToQueryString(ControlHelper.getParameters(this.get_element()));EcpUtil.isNullOrBlank(i)||(n+="&"+i);return n},$Ah_4:function(n){this.dismissPicker();$removeHandler(window,"unload",this.$$d_$Ah_4)},dismissPicker:function(){if(this.$23_4){this.$23_4.close();this.$23_4=null}},onDialogClose:function(){this.$23_4=null;PickerLauncherHelper.unregisterLauncher(this)},onDialogOK:function(n){var t=null;try{t=EcpUtil.deserializeArray(n)}catch(i){}_Object.isNullOrUndefined(t)||(n=t);this.onOK(n);this.onDialogClose()},onOK:function(n){},getOriginalSelection:function(){var n=this.getOriginalSelectionInternal();return n&&n.length>0?EcpUtil.cloneArray(n):null},getOriginalSelectionInternal:function(){return null},get_PickerFormUrl:function(){return this.$1Q_4},set_PickerFormUrl:function(n){if(this.$1Q_4!==n){this.$1Q_4=n;this.raisePropertyChanged("PickerFormUrl")}return n},get_DisplayProperty:function(){return this.$1b_4},set_DisplayProperty:function(n){this.$1b_4=n;return n},$1b_4:"DisplayName",get_ValueProperty:function(){return this.$6_4},set_ValueProperty:function(n){this.$6_4=n;return n},$6_4:"Identity",get_pickerWindow:function(){return this.$23_4},set_pickerWindow:function(n){this.$23_4=n;return n},get_DialogHeight:function(){return this.$1H_4},set_DialogHeight:function(n){this.$1H_4=n;return n},get_DialogWidth:function(){return this.$1I_4},set_DialogWidth:function(n){this.$1I_4=n;return n},get_UseDialogPicker:function(){return this.$7C_4},set_UseDialogPicker:function(n){this.$7C_4=n;return n},$7C_4:!1,get_DialogPickerName:function(){return this.$5d_4},set_DialogPickerName:function(n){this.$5d_4=n;return n},$5d_4:"",get_DialogPickerTitle:function(){return this.$5f_4},set_DialogPickerTitle:function(n){this.$5f_4=n;return n},$5f_4:"",get_DialogPickerServiceUrl:function(){return this.$5e_4},set_DialogPickerServiceUrl:function(n){this.$5e_4=n;return n},$5e_4:"",get_dialogPicker:function(){if(!this.$5c_4){var n={};n.DialogPickerServiceUrl=this.$5e_4;this.$5c_4=ControlHelper.createControl(Type.parse(this.$5d_4),n)}return this.$5c_4},$5c_4:null,$AL_4:function(n,t){if(t){var i=EcpUtil.cloneDataObject(n);var r=[i];this.onOK(r)}}};function EcpSingleSelect(n){EcpSingleSelect.initializeBase(this,[n]);this.$3Q_7=!0}EcpSingleSelect.prototype={$7k_8:null,onOK:function(n){EcpTextBoxSelectBase.prototype.onOK.call(this,n);EcpUtil.isNullOrEmptyArray(n)||this.set_fullValue(n[0])},get_value:function(){return EcpUtil.isNullOrEmptyArray(this.$25_7)?null:this.$25_7[0]},set_value:function(n){n?this.set_selectedValues([n]):this.set_selectedValues(null);return n},get_fullValue:function(){return this.$7k_8},set_fullValue:function(n){this.$7k_8=n;this.raisePropertyChanged("FullValue");return n},getOriginalSelectionInternal:function(){return this.$25_7}};function EcpTextBoxSelectBase(n){EcpTextBoxSelectBase.initializeBase(this,[n])}EcpTextBoxSelectBase.prototype={$3H_7:null,$6Z_7:null,$2O_7:null,$3Q_7:!1,$25_7:null,initialize:function(){PickerControl.prototype.initialize.call(this);EcpUtil.isNullOrEmpty(this.$2O_7)||(this.$J_6.$7_4.value=this.$2O_7)},get_singleMode:function(){return this.$3Q_7},set_singleMode:function(n){this.$3Q_7=n;return n},get_selectedValues:function(){return this.$25_7},set_selectedValues:function(n){if(EcpUtil.isNullOrEmptyArray(n)){this.$25_7=null;this.clearDisplay()}else{this.$25_7=n;this.setDisplay(n)}this.onSelectedValuesChanged();return n},onSelectedValuesChanged:function(){this.raisePropertyChanged("Value")},onClear:function(n,t){this.set_selectedValues(null)},onBrowse:function(n,t){var i="";_Object.isNullOrUndefined(this.$3H_7)||EcpUtil.isNullOrBlank(this.$3H_7.innerHTML)||(i=String.format("&{0}={1}",this.$6Z_7,encodeURIComponent(this.$3H_7.innerHTML)));this.invokePicker(this.generatePickerUrl(this.$1Q_4,this.$3Q_7)+i)},onOK:function(n){if(!EcpUtil.isNullOrEmptyArray(n)){for(var i=new Array(0),r=n,u=r.length,t=0;t<u;++t){var f=r[t];Array.add(i,DataBinder.getPropertyValue(f,this.$6_4))}this.set_selectedValues(i);this.changeClearButtonLabel()}},clearDisplay:function(){this.$J_6.$7_4.value=_Object.isNullOrUndefined(this.$2O_7)?"":this.$2O_7;this.$J_6.setIndicatorStatus(!1)},setDisplay:function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=DataBinder.getPropertyValue(n[t],this.$1b_4);this.$J_6.$7_4.value=i.join(",");this.$J_6.setIndicatorStatus(!0)},get_QueryDataBound:function(){return this.$3H_7},set_QueryDataBound:function(n){this.$3H_7=n;return n},get_QueryDataBoundName:function(){return this.$6Z_7},set_QueryDataBoundName:function(n){this.$6Z_7=n;return n},get_EmptyValueText:function(){return this.$2O_7},set_EmptyValueText:function(n){this.$2O_7=n;return n}};function ECPValidators(){}ECPValidators.tryAddValidator=function(n,t,i){var r=$get(n.id+i);r&&Array.add(t,r)};ECPValidators.getValidatorsForTextBox=function(n){var t=[];ECPValidators.tryAddValidator(n,t,"_Validator1");ECPValidators.tryAddValidator(n,t,"_Validator2");ECPValidators.tryAddValidator(n,t,"_Validator3");return t};function FocusablePanel(n){FocusablePanel.initializeBase(this,[n])}FocusablePanel.prototype={$7j_5:!1,get_focused:function(){return this.$7j_5},set_focused:function(n){this.$7j_5=n;if(n){var t=this;_Window.SetTimeout(function(){FocusUtil.setFirstFieldFocused(t.get_element(),!1)},0)}return n}};function FocusUtil(){}FocusUtil.setFirstFieldFocused=function(n,t){var i=null;t&&(i=FieldValidationAssistant.getFirstErrorFieldInElement(n));i||(i=_DomElement.firstFocusableField(n));if(i){window.setTimeout(function(){i.disabled?DialogManager.hasVisibleModalDialog()?DialogManager.focusControlAfterClose(i):UpdateProgressPopUp.get_isAvailable()&&UpdateProgressPopUp.focusControlAfterClose(i):ActiveElementMoniter.setActive(i)},0);return!0}return!1};function ForwardEmailPropertiesWrapper(n){this.$$d_$B1_5=Function.createDelegate(this,this.$B1_5);ForwardEmailPropertiesWrapper.initializeBase(this,[n])}ForwardEmailPropertiesWrapper.prototype={$4t_5:null,initialize:function(){PropertiesWrapper.prototype.initialize.call(this);_Window.registerIInvoke(this);this.$4t_5=this.$$d_$B1_5;this.$4_4.add_Succeeded(this.$4t_5)},dispose:function(){this.$4t_5&&this.$4_4.remove_Succeeded(this.$4t_5);_Window.unregisterIInvoke(this);PropertiesWrapper.prototype.dispose.call(this)},get_IsSaveMethod:function(){return!0},invokeMethod:function(n){this.$V_4.$4_4.set_MethodName("SetObject");this.$V_4.$4_4.invoke(new ForwardEmailInvokeContext(n))},$B1_5:function(n,t){ForwardEmailInvokeContext.isInstanceOfType(t.get_userContext())&&t.get_userContext().saveSuccessCallback()}};function ForwardEmailInvokeContext(n){this.saveSuccessCallback=n}ForwardEmailInvokeContext.prototype={saveSuccessCallback:null};function FieldValidationAssistant(){this.$$d_$AT_1=Function.createDelegate(this,this.$AT_1);this.$$d_$AU_1=Function.createDelegate(this,this.$AU_1);this.$$d_$AE_1=Function.createDelegate(this,this.$AE_1);this.$$d_$AS_1=Function.createDelegate(this,this.$AS_1);this.$$d_$AV_1=Function.createDelegate(this,this.$AV_1);this.$$d_$AR_1=Function.createDelegate(this,this.$AR_1);this.$$d_$4W_1=Function.createDelegate(this,this.$4W_1);this.$$d_$90_1=Function.createDelegate(this,this.$90_1);this.$4O_1={};this.$3o_1=[];this.$4K_1=[];FieldValidationAssistant.initializeBase(this);this.$4r_1=[];this.$M_1=FVABubble.get_instance();this.$1V_1=ActiveElementMoniter.get_instance();this.$1V_1.add_activated(this.$$d_$90_1);this.$At_1();$addHandler(document.documentElement,"click",this.$$d_$4W_1);this.$As_1()}FieldValidationAssistant.add_elementValidating=function(n){var t=FieldValidationAssistant.get_instance();t.get_events().addHandler("elementvalidating",n)};FieldValidationAssistant.remove_elementValidating=function(n){var t=FieldValidationAssistant.get_instance();t.get_events().removeHandler("elementvalidating",n)};FieldValidationAssistant.get_instance=function(){FieldValidationAssistant.$3z||(FieldValidationAssistant.$3z=new FieldValidationAssistant);return FieldValidationAssistant.$3z};FieldValidationAssistant.get_fvaHelpEnabled=function(){var n=_Cookie.get("msExchEcpFvaHelp");return!n||n.length>1||n.charAt(0)!=="0"};FieldValidationAssistant.set_fvaHelpEnabled=function(n){n?_Cookie.set("msExchEcpFvaHelp","1",-3600):_Cookie.set("msExchEcpFvaHelp","0",31536e3);return n};FieldValidationAssistant.hasErrorMessage=function(n){var t=n.getAttribute(FieldValidationAssistant.$3S);return!_Object.isNullOrUndefined(t)&&!!t};FieldValidationAssistant.getFirstErrorFieldInElement=function(n){for(var i=n.getElementsByTagName("*"),t=0;t<i.length;t++)if(FieldValidationAssistant.$38(i[t])&&FieldValidationAssistant.hasErrorMessage(i[t]))return i[t];return null};FieldValidationAssistant.setDomAttribute=function(n,t,i){_Object.isNullOrUndefined(i)?n.removeAttribute(t):n.setAttribute(t,i)};FieldValidationAssistant.reEvaluateValidator=function(n,t){if(EcpUtil.isNullOrBlank(n.value))t&&ActiveElementMoniter.setActive(n);else{ActiveElementMoniter.setActive(n);EcpUtil.fireEvent(n,"change")}};FieldValidationAssistant.$9X=function(n){for(var t=n;t&&t.nodeType!==9;){if(t.nodeType===1){var i=t.getAttribute("fvaIndex");if(!_Object.isNullOrUndefined(i))return i}t=t.parentNode}return-1};FieldValidationAssistant.$83=function(n,t){var i=t.style.display.toLowerCase()!=="none";var r=FieldValidationAssistant.$A1(n,t);return i||r};FieldValidationAssistant.$A1=function(n,t){if(n.disabled||n.style.display.toLowerCase()==="none"||WizardPropertyUtil.isRbacDisabled(n))return!1;var i=!1;var r=t.attributes.getNamedItem("TypeId").value.toLowerCase();"reqfld"===r&&EcpUtil.isTextbox(n)?i=!n.value.length:"selone"===r&&DropDownList.isDropDownList(n)&&(i=!n.selectedIndex);return i};FieldValidationAssistant.$48=function(n){var t=FieldValidationAssistant.hasErrorMessage(n);if(!t)for(var e=ECPValidators.getValidatorsForTextBox(n),r=0;r<e.length;r++){var u=e[r];t=FieldValidationAssistant.$83(n,u);var f=u.getAttribute("ControlToCompare");if(f){var i=$get(f);if(t)FieldValidationAssistant.hasErrorMessage(i)||FieldValidationAssistant.get_instance().setControlInError(f,u.getAttribute("EcpErrorMessage").toString(),!1);else if(FieldValidationAssistant.hasErrorMessage(i)){FieldValidationAssistant.get_instance().setTextboxErrorProperties(i,null);FieldValidationAssistant.get_instance().setTextboxErrorProperties(i,FieldValidationAssistant.$31(i))}}if(t)break}return t};FieldValidationAssistant.$31=function(n){var t=null;FieldValidationAssistant.hasErrorMessage(n)&&(t=n.getAttribute(FieldValidationAssistant.$3S).toString());if(!t)for(var r=ECPValidators.getValidatorsForTextBox(n),i=0;i<r.length;i++){var u=r[i];if(FieldValidationAssistant.$83(n,u)){t=u.getAttribute("EcpErrorMessage").toString();break}}return t};FieldValidationAssistant.$38=function(n){var t=EcpUtil.isTextbox(n)||EcpUtil.isTextArea(n)||DropDownList.isDropDownList(n);if(t){var i=new ElementValidatingEventArgs(n,t);FieldValidationAssistant.$AP(i);t=i.$4z_1}return t};FieldValidationAssistant.$AP=function(n){var i=FieldValidationAssistant.get_instance();var t=i.get_events().getHandler("elementvalidating");t&&t(FieldValidationAssistant.get_instance(),n)};FieldValidationAssistant.$9z=function(n){return EcpUtil.isInlineEditor(n)};FieldValidationAssistant.$69=function(n,t){for(var i=t;i;i=i.parentNode)if(i===n)return!0;return!1};FieldValidationAssistant.prototype={$1V_1:null,$4r_1:null,$17_1:null,$M_1:null,$3F_1:null,$6X_1:null,$2W_1:!1,$4d_1:!1,$4c_1:!1,$q_1:null,get_firstTextboxInError:function(){return this.$q_1},set_firstTextboxInError:function(n){this.$q_1=n;return n},get_pageErrorReported:function(){return this.$2W_1&&this.$4d_1},set_pageErrorReported:function(n){this.$2W_1&&n&&(this.$4d_1=!0);return n},get_pageChecked:function(){return this.$2W_1&&this.$4c_1},set_pageChecked:function(n){this.$2W_1&&n&&(this.$4c_1=!0);return n},dispose:function(){this.$1V_1.remove_activated(this.$$d_$90_1);$removeHandler(document.documentElement,"click",this.$$d_$4W_1);for(var t=0;this.$17_1&&t<this.$17_1.length;t++){var n=$get(this.$17_1[t]);if(n){$removeHandler(n,"blur",this.$$d_$AR_1);$removeHandler(n,"keypress",this.$$d_$AV_1);$removeHandler(n,"focus",this.$$d_$AS_1)}}for(var i=0;i<this.$3o_1.length;i++)this.$8R_1(this.$3o_1[i]);for(var r=0;r<this.$4K_1.length;r++)this.$8R_1(this.$4K_1[r]);this.$17_1=null;Sys.Component.prototype.dispose.call(this)},enterMultiSaveMode:function(){this.$2W_1=!0;this.$4d_1=!1;this.$4c_1=!1},leaveMultiSaveMode:function(){this.$2W_1=!1;this.$4d_1=!1;this.$4c_1=!1},addSettings:function(n){var t=this.$4r_1.length;if(!_Object.isNullOrUndefined(n.get_targetElement().getAttribute("fvaIndex")))throw Error.invalidOperation("Multiple FieldValidationAssistantExtender are targeting to the same control.");this.$4r_1[t]=n;n.get_targetElement().setAttribute("fvaIndex",t)},setTextboxErrorMessage:function(n,t){FieldValidationAssistant.setDomAttribute(n,FieldValidationAssistant.$3S,t);AriaUtil.updateFvaReaderSpan(n,t)},setTextboxErrorProperties:function(n,t){var i=!!t;this.setTextboxErrorMessage(n,t);this.$B2_1(n,i)},clearTextboxValidatorsErrors:function(n){for(var i=ECPValidators.getValidatorsForTextBox(n),t=0;t<i.length;t++){var r=i[t];r.style.display="none"}},clearInputElementsValidationErrors:function(){for(var t=window.document.getElementsByTagName("*"),n=0;n<t.length;n++)if(FieldValidationAssistant.$38(t[n])){var i=t[n];if(FieldValidationAssistant.hasErrorMessage(i)){this.clearTextboxValidatorsErrors(i);this.setTextboxErrorProperties(i,null)}}},setControlInError:function(n,t,i,r){var u=$find(n);if(r&&u&&IValidatable.isImplementedBy(u))u.setControlInError(r,t);else{var f=$get(n);if(FieldValidationAssistant.$38(f)){var e=f;this.$B3_1(e,t,i)}}},pageHasErrors:function(){for(var t=window.document.getElementsByTagName("*"),n=0;n<t.length;n++)if(FieldValidationAssistant.$9z(t[n])){var i=t[n];var r=i.control;if(r.isInError())return!0}return!1},highlightFieldsInError:function(){this.$q_1=null;for(var r=window.document.getElementsByTagName("*"),n=0;n<r.length;n++)if(FieldValidationAssistant.$38(r[n])){var t=r[n];var e=FieldValidationAssistant.$48(t);e&&(this.$q_1?this.setControlInError(t.id,FieldValidationAssistant.$31(t),!1):this.$q_1=t)}this.$q_1&&this.setControlInError(this.$q_1.id,FieldValidationAssistant.$31(this.$q_1),!0);for(var u=!0,f=Sys.Application.getComponents(),i=0;i<f.length;i++)IValidatable.isImplementedBy(f[i])&&(u=u&&f[i].validate(!0));return!!this.$q_1||!u},updateSectionHeaderStyle:function(n,t){var f=this.$1V_1.get_activeElement();if(f&&f.nodeType===1){var r=WizardPropertyUtil.findParentSection(f);if(null!==r){for(var i=null,u=0;u<r.childNodes.length;u++)if(r.childNodes[u].id&&Sys.UI.DomElement.containsCssClass(r.childNodes[u],CssClasses.secHdr)){i=r.childNodes[u];Sys.UI.DomElement.removeCssClass(i,CssClasses.secHdr);Sys.UI.DomElement.addCssClass(i,CssClasses.secFocusHdr);break}if(i){if(i!==this.$3F_1){Sys.UI.DomElement.removeCssClass(i,CssClasses.secHdr);Sys.UI.DomElement.addCssClass(i,CssClasses.secFocusHdr);if(this.$3F_1){Sys.UI.DomElement.removeCssClass(this.$3F_1,CssClasses.secFocusHdr);Sys.UI.DomElement.addCssClass(this.$3F_1,CssClasses.secHdr)}}this.$3F_1=i}}}},$At_1:function(){if(window.Page_Validators){this.$17_1=[];for(var r=window.Page_Validators,t=0;t<r.length;t++){var u=r[t].id;var e=u.lastIndexOf("_");var f=u.substr(0,e);Array.contains(this.$17_1,f)||Array.add(this.$17_1,f)}if(this.$17_1.length>0)for(var i=0;i<this.$17_1.length;i++){var n=$get(this.$17_1[i]);if(n){$addHandler(n,"blur",this.$$d_$AR_1);$addHandler(n,"keypress",this.$$d_$AV_1);$addHandler(n,"focus",this.$$d_$AS_1)}}}},$90_1:function(n,t){var i=this.$1V_1.get_activeElement();if(i){var r=i.preFvaOnActive;r&&r(this,t)}if(this.$6X_1!==i){this.$75_1();this.updateSectionHeaderStyle(n,t);this.$6X_1=i}this.$BH_1(n,t)},$AV_1:function(n){if(n.charCode===13){var i=n.target;if(EcpUtil.isTextbox(i)){var t=i;this.setTextboxErrorProperties(t,null);if(FieldValidationAssistant.$48(t)){FieldValidationAssistant.hasErrorMessage(t)||this.setTextboxErrorProperties(t,FieldValidationAssistant.$31(t));this.$M_1.hide();this.$75_1()}}}},$AS_1:function(n){var t=n.target;if(t===this.$1V_1.get_activeElement()&&FieldValidationAssistant.hasErrorMessage(t)){this.$M_1.hide();this.$75_1()}},$75_1:function(){var t=this.$1V_1.get_activeElement();if(!t||t.nodeType!==1){this.$M_1.hide();return}if(!FieldValidationAssistant.$69(this.$M_1.element,t)&&!this.$M_1.isCanvas(t)&&t!==document.documentElement){var e=FieldValidationAssistant.$9X(t);if(e===-1){this.$M_1.hide();return}for(var r=this.$4r_1[e],n=t;;){if(n.nodeType===1){var u=n.getAttribute(GlobalVariables.helpIdAttributeName);var i=n.getAttribute(FieldValidationAssistant.$3S);var f=EcpControl.fromElement(n,!0);f&&f.get_lastError()&&(i=f.get_lastError().message);if(i){i=EcpUtil.htmlEncode(i);i=Strings.ValidationErrorFormat(i);this.$M_1.showValidationError(n,r,i,u);break}if(u){FieldValidationAssistant.get_fvaHelpEnabled()?this.$M_1.showInlineHelp(n,r,u):this.$M_1.hide();break}}if(!n.parentNode||n.id===r.get_targetElement().id){this.$M_1.hide();break}n=n.parentNode}}},$4W_1:function(n){if(this.$M_1.get_isShowing()){if(FieldValidationAssistant.$69(this.$M_1.$1P_1,n.target))return;if(FieldValidationAssistant.$69(this.$M_1.element,n.target))return;this.$M_1.hide();this.$6X_1=null}},$BH_1:function(n,t){var i=this.$1V_1.get_activeElement();i&&FieldValidationAssistant.$38(i)&&FieldValidationAssistant.$48(i)&&$addHandler(i,"change",this.$$d_$AE_1)},$AE_1:function(n){var t=n.target;this.setTextboxErrorProperties(t,null);$removeHandler(t,"change",this.$$d_$AE_1)},$AR_1:function(n){var t=n.target;if(t){var i=t.preFvaOnDeactive;i&&i(this,Sys.EventArgs.Empty)}FieldValidationAssistant.$48(t)?FieldValidationAssistant.hasErrorMessage(t)||this.setTextboxErrorProperties(t,FieldValidationAssistant.$31(t)):this.setTextboxErrorProperties(t,null)},$B2_1:function(n,t){_DomElement.toggelCssClass(n,t,CssClasses.get_inError())},$B3_1:function(n,t,i){this.setTextboxErrorProperties(n,t);i&&WizardPropertyUtil.scrollIntoViewInBaseForm(n,!0)},$As_1:function(){for(var u=[],n=document.getElementsByTagName("INPUT"),r=0;r<n.length;r++){var t=n[r];if(t.type==="checkbox"||t.type==="radio"){$addHandler(t,"mouseover",this.$$d_$AU_1);$addHandler(t,"mouseout",this.$$d_$AT_1);Array.add(this.$3o_1,t);Array.add(u,t.id)}}n=document.getElementsByTagName("LABEL");for(var i=0;i<n.length;i++){var f=n[i].attributes.getNamedItem("for");if(f&&Array.contains(u,f.value)){$addHandler(n[i],"mouseover",this.$$d_$AU_1);$addHandler(n[i],"mouseout",this.$$d_$AT_1);Array.add(this.$4K_1,n[i])}}},$AU_1:function(n){var t=new FVAMouseEventHandler(n.target);this.$4O_1[n.target.id]=window.setTimeout(t.$$d_mouseOverCallback,FieldValidationAssistant.$87)},$AT_1:function(n){window.clearTimeout(this.$4O_1[n.target.id]);delete this.$4O_1[n.target.id]},$8R_1:function(n){$removeHandler(n,"mouseover",this.$$d_$AU_1);$removeHandler(n,"mouseout",this.$$d_$AT_1)}};function FVAMouseEventHandler(n){this.$$d_mouseOverCallback=Function.createDelegate(this,this.mouseOverCallback);this.$8h_0=n}FVAMouseEventHandler.prototype={$8h_0:null,mouseOverCallback:function(){ActiveElementMoniter.setActiveWithoutFocus(this.$8h_0)}};function ElementValidatingEventArgs(n,t){ElementValidatingEventArgs.initializeBase(this);this.$5_1=n;this.$4z_1=t}ElementValidatingEventArgs.prototype={$5_1:null,$4z_1:!1,get_element:function(){return this.$5_1},get_validateElement:function(){return this.$4z_1},set_validateElement:function(n){this.$4z_1=n;return n}};function FVABubble(){this.$$d_$AZ_1=Function.createDelegate(this,this.$AZ_1);this.$$d_$9q_1=Function.createDelegate(this,this.$9q_1);this.$$d_$9p_1=Function.createDelegate(this,this.$9p_1);this.$$d_$8G_1=Function.createDelegate(this,this.$8G_1);FVABubble.initializeBase(this);this.element=this.$9I_1();this.$1B_1=new Array(2);this.$1J_1=this.$$d_$8G_1;$addHandler(window,"resize",this.$$d_$9p_1)}FVABubble.get_instance=function(){FVABubble.$M||(FVABubble.$M=new FVABubble);return FVABubble.$M};FVABubble.prototype={element:null,$1J_1:null,$5C_1:null,$1m_1:null,$7K_1:null,$5v_1:null,$3r_1:null,$1c_1:null,$2y_1:0,$5D_1:0,$6R_1:null,$1P_1:null,$6P_1:null,$n_1:null,$8L_1:0,$6Q_1:0,$4b_1:0,$1B_1:null,$m_1:null,$6f_1:0,$8K_1:null,$5s_1:!1,$4S_1:!1,get_isShowing:function(){return this.element.style.display!=="none"},set_isShowing:function(n){this.element.style.display=n?"block":"none";return n},get_targetElement:function(){return this.$1P_1},dispose:function(){this.hide();$removeHandler(window,"resize",this.$$d_$9p_1);this.$1c_1&&$clearHandlers(this.$1c_1);Sys.Component.prototype.dispose.call(this)},isCanvas:function(n){return this.$6P_1===n},hide:function(){this.set_isShowing(!1);this.$8T_1()},showValidationError:function(n,t,i,r){r=EcpUtil.getFullHelpId(t.$2a_2,r);DatapointManager.addDatapoint(DatapointManager.constructDatapointString([EcpInstrumentationMarkers.fvaShow,r]));if(AccUtil.screenReaderSupported()){var u=$get(n.id+AriaUtil.associatedLabelSuffix);u&&(this.$5v_1.innerHTML=u.innerHTML)}this.show(n,t,i,"",r)},showInlineHelp:function(n,t,i){i=EcpUtil.getFullHelpId(t.$2a_2,i);var r=EcpUtil.getLocString(t.$2a_2,i);if(_Object.isNullOrUndefined(r)){var u=String.format("The following FVA content is not downloaded to client side: LocStringsResource: {0}, HelpId: {1}.",t.$2a_2,i);throw Error.invalidOperation(u);}!t.$5X_2&&r&&r.startsWith("@")||!r.trim().length?this.hide():this.show(n,t,r,"",i)},show:function(n,t,i,r,u){if(!i||i===""){this.hide();return}if(this.$1P_1!==n){this.$8T_1();this.element.style.top="-500px";this.element.style.left="-500px";this.set_isShowing(!0);if(!this.$2y_1){this.$2y_1=this.element.offsetWidth;this.$5D_1=this.$5C_1.offsetHeight;this.$6f_1=this.$1m_1.childNodes[0].offsetHeight+_DomElement.getPad(this.$1m_1.childNodes[1],1,1,!1)+this.$1m_1.childNodes[2].offsetHeight+_DomElement.getPad(t.$x_2,2,1,!1)}this.$BB_1(n,t,i,r,u);this.$4S_1=!EcpUtil.isIE8OrPrior()&&this.$5s_1&&this.$8K_1!==u;this.$8K_1=u;this.$4S_1?_DomElement.insertAfter(AriaUtil.getInsertableElement(n),this.element):document.body.insertBefore(this.element,null);this.$6R_1=t;this.$1P_1=n;this.$6P_1=t.$x_2;this.$n_1=this.$9n_1(t.$x_2);FrameShowHide.add_shown(this.$1J_1);this.$m_1.scrollTop=0;this.$6r_1();$addHandler(this.$n_1,"scroll",this.$$d_$9q_1)}},$BB_1:function(n,t,i,r,u){this.$1c_1&&$clearHandlers(this.$1c_1);if(i.indexOf("{0}")>0){var f=String.format(t.$5u_2,u);i=i.replace("{0}",f);this.$5s_1=!0}else this.$5s_1=!1;this.$3r_1.innerHTML=i;this.$3r_1.className=r;this.$1c_1=$get("fva_learnmorelink");this.$1c_1&&$addHandler(this.$1c_1,"click",this.$$d_$AZ_1)},$9I_1:function(){var t="<DIV class='CommonSprite fvaArrow'></DIV><DIV class='box'><DIV class='CommonSprite FvaTop'></DIV><DIV class='middle'><DIV><LABEL><SPAN></SPAN><SPAN style='word-wrap: break-word; zoom:1; display:block;'></SPAN></LABEL></DIV></DIV><DIV class='CommonSprite FvaBottom'></DIV></DIV>";var n=document.createElement("div");n.id="fvaBubble";n.className="fvaBubble";n.innerHTML=t;n=document.body.insertBefore(n,null);n.setAttribute(AriaUtil.ariaRole,AriaUtil.ariaTooltip);this.$5C_1=n.childNodes[0];this.$1m_1=n.childNodes[1];this.$m_1=this.$1m_1.childNodes[1].childNodes[0];this.$7K_1=this.$m_1.childNodes[0];this.$5v_1=this.$7K_1.childNodes[0];this.$5v_1.className=CssClasses.hiddenForScreenReaderCSS;this.$3r_1=this.$7K_1.childNodes[1];return n},$8T_1:function(){this.$n_1&&$removeHandler(this.$n_1,"scroll",this.$$d_$9q_1);FrameShowHide.remove_shown(this.$1J_1);this.element.style.height="";this.element.style.clip="rect(auto, auto, auto, auto)";this.$1P_1=null;this.$6R_1=null;this.$6P_1=null;this.$n_1=null;this.$3r_1.innerHTML=""},$8G_1:function(n,t){this.$1m_1.style.display="";this.$1m_1.style.display="block"},$99_1:function(n){var t=AjaxControlToolkit.CommonToolkitScripts.getCurrentStyle(n,"overflowY");return t==="auto"||t==="scroll"},$9n_1:function(n){var t=n;do if(this.$99_1(t))return t;while(t=t.parentNode);return document.documentElement},$6r_1:function(){if(this.$1P_1){var u=this.$1P_1;var n=this.$6R_1;if(EcpUtil.isResizePending(n.get_targetElement())){var d=this;window.setTimeout(function(){d.$6r_1()},10);return}if(this.$9y_1()){var h=EcpUtil.getRelativePositionY(u);var c=EcpUtil.getRelativePositionY(this.$n_1);(h+u.offsetHeight<=c+this.$n_1.scrollTop||h>=c+this.$n_1.scrollTop+this.$n_1.offsetHeight)&&WizardPropertyUtil.scrollIntoViewInBaseForm(u,!0);this.element.style.clip="rect(auto, auto, auto, auto)";var t=this.element.offsetHeight;var i=n.$x_2.offsetHeight;var g=Math.max(this.$m_1.offsetHeight,this.$m_1.scrollHeight);var l=this.$6f_1+g>i;if(l){this.$m_1.style.overflow="auto";this.$m_1.style.height=Math.max(0,Math.max(i,50)-this.$6f_1)+"px";t=n.$x_2.offsetHeight}else{this.$m_1.style.overflow="";this.$m_1.style.height=""}var b=n.get_indentRight();!RtlUtil.rtlScrollBarOnTheRight&&n.get_targetElement().offsetHeight<n.get_targetElement().scrollHeight&&(b+=GlobalVariables.scrollBarWidth);var f=n.get_targetElement().offsetWidth-b;f=f>0?f:0;var k=RtlUtil.getDisToLeftBound(n.get_targetElement())+f;var a=EcpUtil.getRelativePositionY(n.$x_2);var v;var e=h+u.offsetHeight/2-a-n.$x_2.scrollTop;var y=(t-4)/2;v=l||y>e?0:t-y>i-e?i-t:e-y;var r=v+a;var o=i;var s=a;if(this.$4S_1){this.element.style.top=r-EcpUtil.getRelativePositionY(this.element.offsetParent)+n.$x_2.scrollTop+"px";RtlUtil.setStyleLeft(this.element,k-RtlUtil.getDisToLeftBound(this.element.offsetParent)+"px")}else{var p=this.$n_1;if(n.$x_2!==p){r-=p.scrollTop;o=p.offsetHeight;s=c;var w=s<r?0:s-r;var nt=w+o>t?t:w+o;this.element.style.clip=this.$5n_1(w,this.$2y_1,nt,0)}else l&&(this.element.style.clip=this.$5n_1(0,this.$2y_1,i,0));this.element.style.top=r+"px";RtlUtil.setStyleLeft(this.element,k+"px")}var tt=e-v-(this.$5D_1/2-1);this.$5C_1.style.top=Math.min(Math.max(tt,4),this.element.offsetHeight-this.$5D_1-4)+"px";this.$8L_1=this.$n_1.scrollTop;this.$6Q_1=this.element.offsetTop;this.$4b_1=this.element.offsetHeight;this.$1B_1[0]=r-s;this.$1B_1[1]=this.$4b_1+this.$1B_1[0]-o}}},$9p_1:function(n){if(this.$1P_1){var t=this;window.setTimeout(function(){t.$6r_1()},0)}},$9q_1:function(n){if(this.$1P_1&&this.$n_1&&!this.$4S_1){var t=this.$n_1.scrollTop-this.$8L_1;this.element.style.top=this.$6Q_1-t+"px";if(t<this.$1B_1[0]&&t>this.$1B_1[1]){this.element.style.top=this.$6Q_1-t+"px";this.element.style.clip="rect(auto, auto, auto, auto)";this.element.style.height=""}else{var i,r;if(t>=this.$1B_1[0]){i=t-this.$1B_1[0];r=this.$4b_1+t-this.$1B_1[0]}else{i=0;r=this.$4b_1-this.$1B_1[1]+t}r-i<0&&(r=i);this.element.style.clip=this.$5n_1(i,this.$2y_1,r,0)}}},$5n_1:function(n,t,i,r){return String.format("rect({0}px, {1}px, {2}px, {3}px)",n,t,i,r)},$AZ_1:function(n){PopupWindowManager.showHelpClient(this.$1c_1.href);n.preventDefault()},$9y_1:function(){var n=this.$m_1.style.height;this.$m_1.style.height="10px";var t=this.$m_1.offsetHeight;this.$m_1.style.height=n;return!!t}};function FVASettings(n){this.$4C_2=-1;FVASettings.initializeBase(this,[n])}FVASettings.$9f=function(n){var t=document.createElement("a");t.className=n;document.body.insertBefore(t,null);var i=RtlUtil.getPaddingRight(t);document.body.removeChild(t);return i};FVASettings.prototype={get_DebugMode:function(){return this.$5X_2},set_DebugMode:function(n){this.$5X_2=n;return n},$5X_2:!1,get_LocStringsResource:function(){return this.$2a_2},set_LocStringsResource:function(n){this.$2a_2=n;return n},$2a_2:null,get_Canvas:function(){return this.$2r_2},set_Canvas:function(n){this.$2r_2=n;return n},$2r_2:null,get_IndentCssClass:function(){return this.$60_2},set_IndentCssClass:function(n){this.$60_2=n;return n},$60_2:null,get_HelpLinkPrefix:function(){return this.$5u_2},set_HelpLinkPrefix:function(n){this.$5u_2=n;return n},$5u_2:null,get_targetElement:function(){return this.get_element()},get_canvasElement:function(){return this.$x_2},$x_2:null,get_indentRight:function(){this.$4C_2<0&&(this.$4C_2=FVASettings.$9f(this.$60_2));return this.$4C_2},initialize:function(){Sys.UI.Behavior.prototype.initialize.call(this);this.$x_2=this.$2r_2&&this.$2r_2!==""?$get(this.$2r_2):document.body;FieldValidationAssistant.get_instance().addSettings(this)},dispose:function(){Sys.UI.Behavior.prototype.dispose.call(this)}};function PopSubscriptionEnctryptionAndPort(n){WizardPropertyUtil.associateEncryptionAndPort(n,"995","110")}function ImapSubscriptionEncryptionAndPort(n){WizardPropertyUtil.associateEncryptionAndPort(n,"993","143")}function ShowEditPasswordTextbox(n){var t=n.targetControl;var i=n.associatedControl;if(!t||!i)throw Error.argument("context","The TargetControl or AssociatedControl is null or undefined");if(!EcpUtil.domElementDisabled(t)){Sys.UI.DomElement.removeCssClass(i,CssClasses.hiddenCSS);Sys.UI.DomElement.addCssClass(t,CssClasses.hiddenCSS);window.setTimeout(function(){ActiveElementMoniter.setActive(i)},0)}}function ShowElement(n){Sys.UI.DomElement.removeCssClass(n.associatedControl,CssClasses.hiddenCSS);Sys.UI.DomElement.addCssClass(n.associatedControl,CssClasses.displayBlock)}function SetCheckedIfTrue(n){var i=WizardPropertyUtil.getRadioButtonListValue(n.targetControl);var t=n.associatedControl;t.checked||i!=="true"||(t.checked=!0)}function SetRadioBoxForEditSecurityGroup(n){var u=n.targetControl.checked;var i=n.associatedControl.getElementsByTagName("INPUT");if(u)for(var t=0;t<i.length;t++){var r=i[t];r.type.toLowerCase()==="radio"&&r.value==="Open"&&(i[t].disabled=!0)}}function AlwaysHideElementIfFalse(n){n.targetControl.checked||Sys.UI.DomElement.addCssClass(n.associatedControl,CssClasses.hiddenAlways)}function JumpToElement(n){FocusUtil.setFirstFieldFocused(n.associatedControl,!1)}function ToggleDisabledIfTrue(n){var t=WizardPropertyUtil.getRadioButtonListValue(n.targetControl);WizardPropertyUtil.toggleChildrenDisabled(n.associatedControl,t==="true")}function ToggleDisabledIfTrueOrEmpty(n){var t=WizardPropertyUtil.getRadioButtonListValue(n.targetControl);WizardPropertyUtil.toggleChildrenDisabled(n.associatedControl,t==="true"||EcpUtil.isNullOrBlank(t))}function ToggleDisabledIfFalse(n){var t=WizardPropertyUtil.getRadioButtonListValue(n.targetControl);WizardPropertyUtil.toggleChildrenDisabled(n.associatedControl,t==="false")}function ResetEmptyDataText(n){if(n.targetControl.checked){var t=n.associatedControl.control;t.$0_5.set_EmptyDataText("")}}function ToggleVisibility(n){$8m(n,!0)}function ToggleVisibilityReversed(n){$8m(n,!1)}function ToggleVisible(n){var t=Sys.UI.DomElement.containsCssClass(n.associatedControl,CssClasses.hiddenCSS);_DomElement.toggelCssClass(n.associatedControl,t,CssClasses.displayBlock);_DomElement.toggelCssClass(n.associatedControl,!t,CssClasses.hiddenCSS)}function $8m(n,t){var i=n.targetControl.checked===t;_DomElement.toggelCssClass(n.associatedControl,i,CssClasses.displayBlock);_DomElement.toggelCssClass(n.associatedControl,!i,CssClasses.hiddenCSS)}function SetDisabledIfTrue(n){n.targetControl.checked&&WizardPropertyUtil.toggleChildrenDisabled(n.associatedControl,!0)}function ToggleDisabled(n){var t=!n.targetControl.checked;WizardPropertyUtil.toggleChildrenDisabled(n.associatedControl,t)}function ToggleNestedDisabled(n){var t=!n.targetControl.checked;WizardPropertyUtil.toggleNestedChildrenDisabled(n.targetControl,n.associatedControl,t,!1)}function HideIfTextIsEmpty(n){EcpUtil.isNullOrBlank(EcpUtil.getInnerText(n.associatedControl))&&Sys.UI.DomElement.addCssClass(n.targetControl,CssClasses.hiddenCSS)}function SetDefaultRadioBasedOnRbac(n){for(var i=n.targetControl.getElementsByTagName("INPUT"),t=0;t<i.length;t++)if(i[t].type==="radio"&&!WizardPropertyUtil.isRbacDisabled(i[t])){i[t].checked=!0;break}}function EcpWebForm_FireDefaultButton(n,t){var i=new Sys.UI.DomEvent(n);return WizardPropertyUtil.clientSide_FireDefaultButton(i,$get(t))}function EcpSlabTable_FireSaveButton(n,t){var i=new Sys.UI.DomEvent(n);return WizardPropertyUtil.clientSide_FireDefaultButton(i,$get(t),function(n){return n.keyCode===Strings.get_CtrlKeyToSave().charCodeAt(0)&&n.ctrlKey})}function RememberFieldValue(n){StaticVariables.fieldInitialValue=n.targetControl.value}function CleanConfirmField_OnKeyUp(n){var t=n.targetControl;t.value!==StaticVariables.fieldInitialValue&&CleanConfirmField(n)}function CleanConfirmField(n){var i=n.targetControl;var t=n.associatedControl;t.value="";var r=ControlHelper.findControlById(n.associatedControl.id);r.set_lastError(null);if(FieldValidationAssistant.hasErrorMessage(t)){FieldValidationAssistant.get_instance().setTextboxErrorProperties(t,null);FieldValidationAssistant.get_instance().clearTextboxValidatorsErrors(t)}FieldValidationAssistant.hasErrorMessage(i)&&FieldValidationAssistant.get_instance().setTextboxErrorMessage(i,null)}function ToggleReadOnlyCollectionEditor(n){var t=!n.targetControl.checked;var i=n.associatedControl.control;i.$0_5.get_ToolBar().set_enabled(t)}function CopyValue(n){var t=n.associatedControl;t.value=n.targetControl.value;if(FieldValidationAssistant.hasErrorMessage(t)){FieldValidationAssistant.get_instance().setTextboxErrorProperties(t,null);FieldValidationAssistant.get_instance().clearTextboxValidatorsErrors(t)}}function EvaluateIsNonBlank(n,t){var i=t.Value;t.IsValid=!i||!i.length||!!i.trim().length}function GetFileName(n){if(EcpUtil.isNullOrBlank(n))return"";var t="\\";n.indexOf("/")>=0&&(t="/");return n.substr(n.lastIndexOf(t)+1)}function GetFileExtension(n){var i=".";var t=n.lastIndexOf(i);return t>=0?n.substr(t+1):""}function StaticVariables(){}function HCWDomainCollectionEditor(n){this.$$d_onItemUpdated=Function.createDelegate(this,this.onItemUpdated);HCWDomainCollectionEditor.initializeBase(this,[n])}HCWDomainCollectionEditor.SetAutodiscoverDomain=function(n){for(var i=n.get_toolBar().get_OwnerControl(),u=i.get_selectedIndices()[0],t,r=0;r<i.get_DataSource().get_count();r++){t=i.get_DataSource().getAt(r);if(HCWDomainCollectionEditor.IsAutodiscoverDomain(t)){t.Value=t.Domain;HCWDomainCollectionEditor.$78(i.get_items()[r],!1);break}}if(u>=0){t=i.get_DataSource().getAt(u);t.Value="autod:"+t.Domain;HCWDomainCollectionEditor.$78(i.get_items()[u],!0)}};HCWDomainCollectionEditor.IsAutodiscoverDomain=function(n){return!!n&&n.Value.startsWith("autod:")};HCWDomainCollectionEditor.$78=function(n,t){var i=n.get_element();var r=i.childNodes[0];r.style.fontWeight=t?"bold":"normal"};HCWDomainCollectionEditor.prototype={initialize:function(){EcpCollectionEditor.prototype.initialize.call(this);this.$0_5.add_itemUpdated(this.$$d_onItemUpdated)},dispose:function(){EcpCollectionEditor.prototype.dispose.call(this);this.$0_5.remove_itemUpdated(this.$$d_onItemUpdated)},onItemUpdated:function(n,t){var i=t.get_item();HCWDomainCollectionEditor.$78(i,DataBinder.getPropertyValue(i.get_dataObject(),"Value").startsWith("autod:"))}};function InvokeWebService(n){this.$$d_$8z_2=Function.createDelegate(this,this.$8z_2);this.$$d_$8x_2=Function.createDelegate(this,this.$8x_2);this.$$d_$BL_2=Function.createDelegate(this,this.$BL_2);this.$$d_$8y_2=Function.createDelegate(this,this.$8y_2);this.$$d_$4G_2=Function.createDelegate(this,this.$4G_2);InvokeWebService.initializeBase(this,[n])}InvokeWebService.prototype={initialize:function(){this.$S_2!==""&&this.$S_2&&$addHandler(this.get_element(),this.$S_2,this.$$d_$4G_2);if(this.$3d_2){var t=this.$3d_2.split(",");this.$1W_2=new Array(t.length);for(var n=0;n<t.length;n++)this.$1W_2[n]=$get(t[n])}if(this.get_$4i_2())for(var r=WizardPropertyUtil.get_returnObjecType(),i=0;i<this.$N_2.length;i++)this.$N_2[i].set_returnObjectType(r);Sys.UI.Behavior.prototype.initialize.call(this)},dispose:function(){this.$S_2!==""&&this.$S_2&&$removeHandler(this.get_element(),this.$S_2,this.$$d_$4G_2);this.$6C_2&&_Window.unregisterIInvoke(this);this.set_WebServiceMethodIDs("");this.$N_2=null;Sys.UI.Behavior.prototype.dispose.call(this)},get_Trigger:function(){return this.$S_2},set_Trigger:function(n){if(this.get_isInitialized())throw Error.invalidOperation();this.$S_2=n;return n},$S_2:"click",get_AssociateElementID:function(){return this.$3d_2},set_AssociateElementID:function(n){this.$3d_2=n;return n},$3d_2:null,$1W_2:null,get_ProgressDescription:function(){return this.$4g_2},set_ProgressDescription:function(n){this.$4g_2=n;return n},$4g_2:null,get_EnableProgressPopup:function(){return this.$5h_2},set_EnableProgressPopup:function(n){this.$5h_2=n;return n},$5h_2:!1,$6t_2:function(){return this.$5h_2&&UpdateProgressPopUp.get_isAvailable()},get_EnableConfirmation:function(){return this.$5g_2},set_EnableConfirmation:function(n){this.$5g_2=n;return n},$5g_2:!1,get_IsSaveMethod:function(){return this.$6C_2},set_IsSaveMethod:function(n){this.$6C_2=n;n&&_Window.registerIInvoke(this);return n},$6C_2:!1,get_CloseAfterSuccess:function(){return this.$5N_2},set_CloseAfterSuccess:function(n){this.$5N_2=n;return n},$5N_2:!1,get_$4i_2:function(){return this.$5N_2||window.location.search.indexOf("CAS=")!==-1},$8y_2:function(n,t){this.get_element().disabled=!0;if(this.$1W_2)for(var i=0;i<this.$1W_2.length;i++)this.$1W_2[i].disabled=!0;this.$6t_2()&&!t.get_cancel()&&(this.get_$4i_2()?UpdateProgressPopUp.showProgress(this.$4g_2):UpdateProgressPopUp.showProgressImmediately(this.$4g_2))},get_WebServiceMethodIDs:function(){return this.$52_2},set_WebServiceMethodIDs:function(n){if(this.$N_2)for(var r=0;r<this.$N_2.length;r++){var i=this.$N_2[r];i.remove_Invoking(this.$$d_$8y_2);i.remove_Failed(this.$$d_$BL_2);i.remove_Completed(this.$$d_$8x_2);i.remove_Succeeded(this.$$d_$8z_2)}this.$52_2=n;if(this.$52_2){var f=this.$52_2.split(",");this.$N_2=[];for(var u=0;u<f.length;u++){var t=$find(f[u]);if(t){Array.add(this.$N_2,t);t.add_Invoking(this.$$d_$8y_2);t.add_Failed(this.$$d_$BL_2);t.add_Completed(this.$$d_$8x_2);t.add_Succeeded(this.$$d_$8z_2)}}}return n},$52_2:null,$N_2:null,addWebServiceMethod:function(n,t){if(n){if(t&&Array.contains(this.$N_2,n))return;Array.add(this.$N_2,n);n.add_Invoking(this.$$d_$8y_2);n.add_Failed(this.$$d_$BL_2);n.add_Completed(this.$$d_$8x_2);n.add_Succeeded(this.$$d_$8z_2)}},removeWebServiceMethod:function(n){if(n){n.remove_Succeeded(this.$$d_$8z_2);n.remove_Failed(this.$$d_$BL_2);n.remove_Completed(this.$$d_$8x_2);n.remove_Invoking(this.$$d_$8y_2);Array.remove(this.$N_2,n)}},$8x_2:function(n,t){var i=t.get_userContext();i.toComplete--;if(!i.toComplete)if(this.$6t_2()){var r=this;UpdateProgressPopUp.progressCompleted(function(){r.$7w_2(n,t,i)},t.get_cancelled())}else this.$7w_2(n,t,i)},$7w_2:function(n,t,i){var e=!1;if(i.toSuccess)if(i.exceptionHandlers.length===1){var r=new PropertiesExceptionHandlerContext;r.invokeWebService=this;if(i.results.ErrorRecords.length){var s=this;ErrorHandling.showPowerShellErrorsWithCallback(i.results,function(n,t){i.exceptionHandlers[0].handle(r)})}else{var o=this;window.setTimeout(function(){i.exceptionHandlers[0].handle(r)},0)}}else ErrorHandling.showPowerShellErrors(i.results);else i.saveSuccessCallback&&!_PowerShellResults.hasWarning(i.results)?i.saveSuccessCallback():this.get_$4i_2()&&(e=PopupWindowManager.onSaveSucceededClose(n,new WebServiceSucceededEventArgs(t.get_webServiceMethod(),i.results,t.get_userContext())));if(!e){this.get_element().disabled=!1;if(this.$1W_2)for(var u=0;u<this.$1W_2.length;u++)this.$1W_2[u].disabled=!1;for(var f=0;f<this.$N_2.length;f++)var h=this.$N_2[f]}},$8z_2:function(n,t){var u=t.get_results();var i=t.get_userContext();if(_PowerShellResults.hasError(u)||t.get_webServiceMethod().get_applicableExceptionHandlers().length)for(var f=t.get_webServiceMethod().get_applicableExceptionHandlers(),r=0;r<f.length;r++)Array.add(i.exceptionHandlers,f[r]);else i.toSuccess--;i.mergeMessage(u)},$BL_2:function(n,t){this.$6t_2()&&UpdateProgressPopUp.progressCompleted(null,!0)},$4G_2:function(n){n.preventDefault();this.$7v_2(null)},invokeMethod:function(n){this.$7v_2(n)},$7v_2:function(n){if(this.$N_2.length>0){var i=!1;var t=this.get_element();if(this.$5g_2&&t.confirmMessage)if(t.suppressConfirmIfPageNotDirty){var u=DataLossReporting.needRaiseWarning(!1);i=u.get_hasChange()}else i=!0;if(i){var r=new Info;r.MessageType=MessageBoxType.warning;r.Message=String.format(t.confirmMessage,t.confirmMessageTarget);var f=this;MessageBox.show(r,2,function(t,i){t===ModalDialogResult.yes&&f.$7y_2(n)},null)}else this.$7y_2(n)}},$7y_2:function(n){for(var r=0,u=new Array(this.$N_2.length),t=0;t<this.$N_2.length;t++){var f=this.$N_2[t];if(f.get_AlwaysInvokeSave()||f.hasChange()){u[t]=!0;++r}else u[t]=!1}if(r>0){var o=new MultiInvokeContext(r,n);var e=FieldValidationAssistant.get_instance();e.enterMultiSaveMode();for(var i=0;i<this.$N_2.length;i++){var s=this.$N_2[i];u[i]&&s.invoke(o)}e.leaveMultiSaveMode()}else this.get_$4i_2()&&window.close()}};function MultiInvokeContext(n,t){this.$7Z_0=n;this.saveSuccessCallback=t;this.results={};this.exceptionHandlers=[];this.reset()}MultiInvokeContext.prototype={$7Z_0:0,reset:function(){this.toComplete=this.toSuccess=this.$7Z_0;this.results.ErrorRecords=[];this.results.Warnings=[];this.results.Informations=[];this.results.Output=[]},toComplete:0,toSuccess:0,results:null,saveSuccessCallback:null,exceptionHandlers:null,mergeMessage:function(n){_PowerShellResults.mergeResults(this.results,n)}};function GroupedCheckBoxList(n){GroupedCheckBoxList.initializeBase(this,[n])}GroupedCheckBoxList.prototype={setReadOnly:function(n){},get_value:function(){return this.$7o_4()},set_value:function(n){this.$8a_4(n);return n},$7o_4:function(){var t=[];if(this.get_ReadOnly())return t;for(var i=this.get_element().getElementsByTagName("input"),n=0;n<i.length;n++)if(i[n].checked){var r=i[n].getAttribute("value");Array.add(t,Sys.Serialization.JavaScriptSerializer.deserialize(r))}return t},$8a_4:function(n){if(this.get_ReadOnly()){this.$9t_4(n);this.$9s_4()}else this.$9B_4(n)},$9s_4:function(){for(var t=this.get_element().getElementsByTagName("ul"),n=0;n<t.length;n++){var r=!0;if(t[n].hasChildNodes())for(var i=0;i<t[n].childNodes.length;i++)if(t[n].childNodes[i].style.display!=="none"){r=!1;break}EcpUtil.showElement(t[n].parentNode,!r)}},$9t_4:function(n){for(var i=this.get_element().getElementsByTagName("li"),t=0;t<i.length;t++)EcpUtil.showElement(i[t],this.$5S_4(n,i[t].getAttribute("value")))},$9B_4:function(n){for(var i=this.get_element().getElementsByTagName("input"),t=0;t<i.length;t++)this.$5S_4(n,i[t].getAttribute("value"))&&(i[t].checked=!0)},$5S_4:function(n,t){for(var i=0;i<n.length;i++)if(n[i].RawIdentity===Sys.Serialization.JavaScriptSerializer.deserialize(t).RawIdentity)return!0;return!1}};function GroupedCheckBoxTree(n){this.$$d_$B9_4=Function.createDelegate(this,this.$B9_4);GroupedCheckBoxTree.initializeBase(this,[n]);for(var i=this.get_element().getElementsByTagName("input"),t=0;t<i.length;t++)i[t].className.indexOf(CssClasses.groupedCheckBoxParent)>0&&$addHandler(i[t],"click",this.$$d_$B9_4)}GroupedCheckBoxTree.prototype={get_value:function(){return this.$7o_4()},set_value:function(n){this.$8a_4(n);return n},$7o_4:function(){for(var u=[],r=this.get_element().getElementsByTagName("ul"),t=0;t<r.length;t++)if(r[t].className.indexOf(CssClasses.groupedCheckboxSubList)<0)for(var i=r[t].getElementsByTagName("input"),n=0;n<i.length;n++)if(i[n].checked){var f=i[n].getAttribute("value");Array.add(u,Sys.Serialization.JavaScriptSerializer.deserialize(f));if(i[n].className.indexOf("GroupedCheckBoxParent")>0)break}return u},$8a_4:function(n){for(var i=this.get_element().getElementsByTagName("input"),t=0;t<i.length;t++)if(this.$5S_4(n,i[t].getAttribute("value"))){var r=i[t];r.checked=!0;r.className.indexOf("GroupedCheckBoxParent")>0&&this.$8k_4(r,!0)}},$8k_4:function(n,t){var u=$get(n.id+"_sublist");if(u)for(var r=u.getElementsByTagName("input"),i=0;i<r.length;i++){r[i].disabled=t;r[i].checked=t}},$B9_4:function(n){var t=n.target;this.$8k_4(t,t.checked)},$5S_4:function(n,t){for(var i=0;i<n.length;i++)if(n[i].RawIdentity===Sys.Serialization.JavaScriptSerializer.deserialize(t).RawIdentity)return!0;return!1}};function ImageUploader(n){this.$$d_onImageLoaded=Function.createDelegate(this,this.onImageLoaded);this.$$d_onCancel=Function.createDelegate(this,this.onCancel);this.$$d_onCommit=Function.createDelegate(this,this.onCommit);this.$$d_$7r_5=Function.createDelegate(this,this.$7r_5);this.$$d_$Av_5=Function.createDelegate(this,this.$Av_5);this.$$d_$Aw_5=Function.createDelegate(this,this.$Aw_5);this.$$d_$Ay_5=Function.createDelegate(this,this.$Ay_5);this.$$d_$Az_5=Function.createDelegate(this,this.$Az_5);this.$$d_$97_5=Function.createDelegate(this,this.$97_5);this.$$d_$98_5=Function.createDelegate(this,this.$98_5);ImageUploader.initializeBase(this,[n]);this.$3m_5=this.$$d_$98_5;this.$5I_5=this.$$d_$97_5;this.$4o_5=this.$$d_$Az_5;this.$6j_5=this.$$d_$Ay_5;this.$4j_5=this.$$d_$Aw_5;this.$6d_5=this.$$d_$Av_5;this.$o_5=1}ImageUploader.prototype={$5p_5:!1,$2U_5:!1,$5Z_5:!1,$1q_5:!1,$l_5:null,$4_5:null,$g_5:null,$3m_5:null,$5I_5:null,$4o_5:null,$6j_5:null,$4j_5:null,$6d_5:null,$1a_5:null,$1d_5:null,$1y_5:null,$1O_5:null,$o_5:0,$F_5:null,$18_5:null,$6e_5:null,get_RemovingPreviewPhotoText:function(){return this.$6e_5},set_RemovingPreviewPhotoText:function(n){this.$6e_5=n;return n},get_ObjectIdentity:function(){return this.$1O_5},set_ObjectIdentity:function(n){this.$1O_5=n;return n},get_identityBinding:function(){return this.$1d_5},initialize:function(){AjaxUploader.prototype.initialize.call(this);this.$2U_5=!0;this.$2k_5(!1);this.$P_4||this.$L_4||EcpUtil.showElement(this.$41_4,!1);this.$1d_5=new ComponentBinding(this.get_id(),"ObjectIdentity");this.$1y_5=[this.$1d_5];this.$l_5&&this.$l_5.set_Parameters(this.$1y_5);this.$4_5&&this.$4_5.set_Parameters(this.$1y_5);this.$g_5&&this.$g_5.set_Parameters(this.$1y_5);this.$1a_5=this.$$d_$7r_5;DataLossReporting.add_report(this.$1a_5);this.$F_5=BaseForm.getCurrentForm(this.$P_4);if(this.$F_5){$addHandler(this.$F_5.$H_3,"click",this.$$d_onCommit);$addHandler(this.$F_5.$1Z_3,"click",this.$$d_onCancel)}$addHandler(this.$18_5,"load",this.$$d_onImageLoaded)},dispose:function(){this.$3m_5=null;this.$4o_5=null;this.$4j_5=null;$removeHandler(this.$18_5,"load",this.$$d_onImageLoaded);this.$3K_5(this.$g_5);this.$3K_5(this.$4_5);if(this.$F_5){$removeHandler(this.$F_5.$H_3,"click",this.$$d_onCommit);$removeHandler(this.$F_5.$1Z_3,"click",this.$$d_onCancel)}DataLossReporting.remove_report(this.$1a_5);this.$1a_5=null;AjaxUploader.prototype.dispose.call(this)},get_CancelWebServiceMethod:function(){return this.$l_5},set_CancelWebServiceMethod:function(n){if(this.$l_5){this.$l_5.remove_Succeeded(this.$3m_5);this.$l_5.remove_Completed(this.$5I_5)}this.$l_5=n;this.$l_5.set_Parameters(this.$1y_5);if(this.$l_5){this.$l_5.add_Succeeded(this.$3m_5);this.$l_5.add_Completed(this.$5I_5)}return n},get_SaveWebServiceMethod:function(){return this.$4_5},set_SaveWebServiceMethod:function(n){if(this.$4_5){this.$4_5.remove_Succeeded(this.$4o_5);this.$4_5.remove_Completed(this.$6j_5)}this.$4_5=n;this.$4_5.set_Parameters(this.$1y_5);if(this.$4_5){this.$4_5.add_Succeeded(this.$4o_5);this.$4_5.add_Completed(this.$6j_5)}return n},get_RemoveWebServiceMethod:function(){return this.$g_5},set_RemoveWebServiceMethod:function(n){if(this.$g_5){this.$g_5.remove_Succeeded(this.$4j_5);this.$g_5.remove_Completed(this.$6d_5)}this.$g_5=n;this.$g_5.set_Parameters(this.$1y_5);if(this.$g_5){this.$g_5.add_Succeeded(this.$4j_5);this.$g_5.add_Completed(this.$6d_5)}return n},$7r_5:function(n,t){this.$5Z_5||(this.$o_5===2||this.$1q_5)&&t.turnOnHasChange()},$98_5:function(n,t){this.$5p_5?this.$8Z_5(!1):this.$2k_5(!1);this.$o_5=1;this.set_value("")},$97_5:function(n,t){this.$L_4.disabled=!1;this.$P_4.disabled=!1;this.$5p_5||UpdateProgressPopUp.progressCompleted(null,!0)},$Az_5:function(n,t){this.$o_5=1},$Ay_5:function(n,t){this.$L_4.disabled=!1;this.$P_4.disabled=!1},onCommit:function(n){if(this.$o_5===2){this.$L_4.disabled=!0;this.$P_4.disabled=!0}else if(this.$o_5===1)this.$3K_5(this.$4_5);else if(this.$1q_5){this.$5Z_5=!0;this.$1q_5=!1;this.$18_5.style.visibility="hidden";this.$18_5.src=EcpUrl.setUrlParameter(this.$18_5.src,"deleted","true")}},onCancel:function(n){this.$2U_5=!1;if(this.$o_5===2)try{this.$l_5.invoke(this)}catch(t){}},onImageLoaded:function(n){if(!this.$5Z_5){if(this.$o_5===1){this.$o_5=3;this.forceValueToNull();this.$2k_5(!0)}if(this.$2U_5){this.$5p_5=!0;this.$2U_5=!1}else UpdateProgressPopUp.progressCompleted(null,!0)}},$Aw_5:function(n,t){this.$o_5=1;this.$1q_5=!1;this.set_value("");this.$2k_5(!1)},$Av_5:function(n,t){this.$L_4.disabled=!1;this.$P_4.disabled=!1;UpdateProgressPopUp.progressCompleted(null,!0)},get_Image:function(){return this.$18_5},set_Image:function(n){this.$18_5=n;return n},handleSuccessfulUpload:function(){this.$2U_5=!1;this.$8Z_5(!0);this.$2k_5(!0);this.$o_5=2;this.$7u_5(this.$4_5);if(this.$1q_5){this.$1q_5=!1;this.$3K_5(this.$g_5);this.$L_4.disabled=!1}},customDeleteHandler:function(){this.$2U_5=!1;this.$L_4.disabled=!0;this.$P_4.disabled=!0;if(this.$o_5===2){this.$l_5.invoke(this);UpdateProgressPopUp.showProgressImmediately(this.$6e_5);this.$3K_5(this.$4_5)}else{this.$1q_5=!0;this.$o_5=1;this.$2k_5(!1);this.$P_4.disabled=!1;this.$7u_5(this.$g_5)}return!0},$7u_5:function(n){var t=window._isaves;if(t){var i=this;Array.forEach(t,function(t){if(InvokeWebService.isInstanceOfType(t)){var i=t;i.addWebServiceMethod(n,!0)}})}},$3K_5:function(n){var t=window._isaves;if(t){var i=this;Array.forEach(t,function(t){if(InvokeWebService.isInstanceOfType(t)){var i=t;i.removeWebServiceMethod(n)}})}},$2k_5:function(n){EcpUtil.showElement(this.$18_5,n)},$8Z_5:function(n){var t=this.$18_5.src;t=n?EcpUrl.setUrlParameter(t,"preview","true"):EcpUrl.setUrlParameter(t,"preview","false");var i=new Date;var r=i.getHours().toString()+i.getMinutes().toString()+i.getSeconds().toString();t=EcpUrl.setUrlParameter(t,"unused2",r);this.$18_5.src=t}};function InlineSelector(n){this.$$d_$AY_4=Function.createDelegate(this,this.$AY_4);this.$$d_$4W_4=Function.createDelegate(this,this.$4W_4);InlineSelector.initializeBase(this,[n])}InlineSelector.prototype={$1G_4:null,$1L_4:null,$61_4:null,$7_4:null,$5w_4:!1,add_browse:function(n){this.get_events().addHandler("browse",n)},remove_browse:function(n){this.get_events().removeHandler("browse",n)},add_clear:function(n){this.get_events().addHandler("clear",n)},remove_clear:function(n){this.get_events().removeHandler("clear",n)},addAriaAttribute:function(){this.$1G_4.setAttribute(AriaUtil.ariaRole,AriaUtil.ariaButton);this.$1L_4.setAttribute(AriaUtil.ariaRole,AriaUtil.ariaButton)},get_BrowseButton:function(){return this.$1G_4},set_BrowseButton:function(n){this.$1G_4=n;return n},get_HideClearButton:function(){return this.$5w_4},set_HideClearButton:function(n){this.$5w_4=n;return n},get_Indicator:function(){return this.$1L_4},set_Indicator:function(n){this.$1L_4=n;return n},get_IndicatorTd:function(){return this.$61_4},set_IndicatorTd:function(n){this.$61_4=n;return n},get_TextBox:function(){return this.$7_4},set_TextBox:function(n){this.$7_4=n;return n},get_disabled:function(){return this.$7_4.disabled},set_disabled:function(n){this.$7_4.disabled=n;this.$1L_4.disabled=n;this.$1G_4.disabled=n;return n},initialize:function(){EcpControl.prototype.initialize.call(this);$addHandler(this.$1G_4,"click",this.$$d_$4W_4);$addHandler(this.$1L_4,"click",this.$$d_$AY_4);Array.add(GlobalVariables.preventFireDefaultButton,this.$1L_4.id)},setIndicatorStatus:function(n){if(!this.$5w_4){_DomElement.toggelCssClass(this.$1L_4,!n,CssClasses.hiddenCSS);_DomElement.toggelCssClass(this.$61_4,n,CssClasses.enabledPickerIndicatorTd)}},dispose:function(){$removeHandler(this.$1G_4,"click",this.$$d_$4W_4);$removeHandler(this.$1L_4,"click",this.$$d_$AY_4);EcpControl.prototype.dispose.call(this)},getFirstFocusableField:function(){return this.$1G_4},onBrowse:function(n){var t=this.get_events().getHandler("browse");t&&t(this,n)},onClear:function(n){var t=this.get_events().getHandler("clear");t&&t(this,n)},$4W_4:function(n){if(!EcpUtil.domElementDisabled(this.get_element()))this.onBrowse(new Sys.EventArgs)},$AY_4:function(n){if(!EcpUtil.domElementDisabled(this.get_element()))this.onClear(new Sys.EventArgs)},setEnabled:function(n){this.set_disabled(!n)}};function FileChangedEventArgs(n,t,i){FileChangedEventArgs.initializeBase(this);this.$8B_1=n;this.$6J_1=t;this.$3X_1=i}FileChangedEventArgs.prototype={get_oldFileName:function(){return this.$8B_1},$8B_1:null,get_newFileName:function(){return this.$6J_1},$6J_1:null,get_uploader:function(){return this.$3X_1},$3X_1:null};function UploadCompletedEventArgs(n,t,i){UploadCompletedEventArgs.initializeBase(this);this.$6h_1=n;this.$2_1=t;this.$3X_1=i}UploadCompletedEventArgs.prototype={get_resultStatus:function(){return this.$6h_1},$6h_1:0,get_results:function(){return this.$2_1},$2_1:null,get_uploader:function(){return this.$3X_1},$3X_1:null};function LaunchPickerButton(n){LaunchPickerButton.initializeBase(this,[n]);var t=this;this.get_jQueryObject().click(function(n){n.preventDefault();t.get_enabled()&&t.invokePicker(t.generatePickerUrl(t.$1Q_4,!0))})}function MultiLineLabel(n){MultiLineLabel.initializeBase(this,[n])}MultiLineLabel.prototype={$3V_3:null,initialize:function(){EcpControl.prototype.initialize.call(this);this.$3V_3=$get(this.get_id()+"_textContainer");EcpUtil.isSafari()&&this.$4m_3&&(this.$3V_3.style.maxHeight=this.$4m_3)},get_SafariMaxHeight:function(){return this.$4m_3},set_SafariMaxHeight:function(n){this.$4m_3=n;return n},$4m_3:null,get_ReserveSpace:function(){return this.$4k_3},set_ReserveSpace:function(n){this.$4k_3=n;return n},$4k_3:!1,dispose:function(){this.$3V_3=null;EcpControl.prototype.dispose.call(this)},get_value:function(){var n=this.$3V_3.innerHTML;if(!n)return"";n=n.replace(new RegExp("<br />","g"),"\r\n");this.$4k_3&&(n=n.replace(new RegExp("&nbsp;","g")," "));return EcpUtil.htmlDecode(n)},set_value:function(n){var t=EcpUtil.htmlEncode(n);this.$4k_3&&(t=EcpUtil.reserveSpace(t));this.$3V_3.innerHTML=t.replace(new RegExp("\r\n|[\r\n]","g"),"<br />");return n}};function NameValueCollectionEditor(n){NameValueCollectionEditor.initializeBase(this,[n]);this.$6_4="Identity"}NameValueCollectionEditor.prototype={initAddCommandValue:function(){var n={};n[this.$6_4]="Index_"+(new Date).getTime();return n}};function PeopleIdentityWithType(n,t){PeopleIdentityWithType.initializeBase(this,[n,t]);this.__type="Identity:ECP"}PeopleIdentityWithType.prototype={__type:null};function EcpCollectionEditorPeopleIdentity(n,t,i,r,u,f){EcpCollectionEditorPeopleIdentity.initializeBase(this,[n,t,i,r,u,f]);this.PrimarySmtpAddress=i;this.Identity=new PeopleIdentityWithType(i,n)}EcpCollectionEditorPeopleIdentity.prototype={PrimarySmtpAddress:null,Identity:null};function OUPicker(n){OUPicker.initializeBase(this,[n]);this.$3l_2=!0;this.$2A_2=!0;this.$36_2=2;this.$2B_2=!0;this.$1U_2=!0;this.$4L_2=Strings.get_LegacyOUError()}OUPicker.Create=function(n){var t=n.DialogPickerServiceUrl;var i=new WebServiceTreeSource(t);return new OUPicker(i)};OUPicker.prototype={get_className:function(){return"OUPicker"},get_toggleButtonPanelClassName:function(){return this.$2A_2?"ToggleBtnBox":TreeBasedPicker.prototype.get_toggleButtonPanelClassName.call(this)},validateInput:function(n){return null},getInitialSelection:function(n){return null},get_value:function(){var n=this.$8_2;var i="";var t="";n&&n.$R_0&&(i=n.$K_0.ID);while(n&&n.$R_0){t=t===""?n.$K_0.Name:n.$K_0.Name+"/"+t;n=n.$R_0}var r=new Identity(i,t);r.__type="Identity:ECP";return r}};function OwaPickerUtil(n){OwaPickerUtil.initializeBase(this,[n])}OwaPickerUtil.getMetadataForPassValue=function(n,t,i){switch(n){case 0:t.val=!0;i.val=!0;break;case 1:t.val=!0;i.val=!0;break;case 2:t.val=!0;i.val=!0;break;case 3:t.val=!1;i.val=!0;break;case 4:t.val=!0;i.val=!1;break;case 6:t.val=!0;i.val=!1;break;case 5:t.val=!0;i.val=!1;break;case 7:t.val=!0;i.val=!1;break;case 8:t.val=!0;i.val=!1;break;case 9:t.val=!0;i.val=!1;break;case 10:t.val=!1;i.val=!1;break;case 11:t.val=!0;i.val=!1;break;default:t.val=!0;i.val=!0;break}};OwaPickerUtil.invokeOwaPickerCommon=function(n,t,i,r){var u=!0;var f=!0;var e,o;OwaPickerUtil.getMetadataForPassValue(n,e={val:u},o={val:f});u=e.val;f=o.val;var s=EcpOwaPeoplePickerPassValue.serializePassValue(t,u,f,n);var h="/owa/?viewmodel=OwaOptionRichPeoplePickerViewModelFactory";var c=function(){var n=window.dialogArguments;var t=EcpUtil.tryDeserialize(n.value);var u=EcpOwaPeoplePickerPassValue.deserializePassValue(t,i);r(u)};var l=ModalPopupLauncherHelper.openModalPopupCore(h,OwaPickerUtil.owaOptionPeoplePickerDefaultDialogHeight,OwaPickerUtil.owaOptionPeoplePickerDefaultDialogWidth,s,null,!1,c);return EcpOwaPeoplePickerPassValue.deserializePassValue(l,i)};OwaPickerUtil.prototype={$4f_5:null,get_owaScriptForPeoplePicker:function(){return window.OwaPeoplePickerUtil},get_peopleIdentityArrayList:function(){return this.$4f_5},invokeOwaPicker:function(n,t,i){var r=this;this.checkScriptStatusAndCall(function(){var u=function(n){r.$4f_5=n;i()};var f=OwaPickerUtil.invokeOwaPickerCommon(n,t,!1,u);if(window.self.showModalDialog){r.$4f_5=f;i()}})}};function EcpOwaPeoplePickerPassValue(){}EcpOwaPeoplePickerPassValue.serializePassValue=function(n,t,i,r){var e=[];n&&Array.forEach(n,function(n){var i=n;var t={};t.DisplayName=i.DisplayName;t.SmtpAddress=i.SMTPAddress;t.RoutingType=i.RoutingType;Array.add(e,Sys.Serialization.JavaScriptSerializer.serialize(t))});var u={};u.AllowMultipleSelection=t;u.AllowAddAsSmtpAddress=i;u.PickerCallerType=r;var f={};f.Properties=Sys.Serialization.JavaScriptSerializer.serialize(e);f.Metadata=Sys.Serialization.JavaScriptSerializer.serialize(u);return f};EcpOwaPeoplePickerPassValue.deserializePassValue=function(n,t){var u=Sys.Serialization.JavaScriptSerializer.deserialize(n.Properties);var i=[];var r={};Array.forEach(u,function(n){var u=Sys.Serialization.JavaScriptSerializer.deserialize(n);if(t){var f=new EcpCollectionEditorPeopleIdentity(u.DisplayName,u.SmtpAddress,u.SmtpAddress,0,u.RoutingType,0);if(!r[u.SmtpAddress]){Array.add(i,f);r[u.SmtpAddress]=!0}}else{var e=new PeopleIdentity(u.DisplayName,u.SmtpAddress,u.SmtpAddress,0,u.RoutingType,0,u.GALContactGuid);Array.add(i,e)}});return i};function OwaScriptsUtil(n){this.$$d_$8F_4=Function.createDelegate(this,this.$8F_4);OwaScriptsUtil.initializeBase(this,[n])}OwaScriptsUtil.prototype={$82_4:!1,$4H_4:!1,$4Y_4:null,initialize:function(){EcpControl.prototype.initialize.call(this);$addHandler(this.$2S_4,"load",this.$$d_$8F_4);document.body.appendChild(this.get_element());window[this.$4Q_4]=this.$2S_4.contentWindow;this.$Ax_4()},$Ax_4:function(){var n=new Sys.StringBuilder;var i=this.$5i_4?EcpUrl.get_owaVDir():EcpUrl.owaVDirForStaticResource;n.append("<script type='text/javascript'>");n.append("function stJS(){};");n.append("sOwaVDir='");n.append(escape(i));n.append("';");n.append("</script>");var t=this.$2S_4.contentWindow.document;t.write(n.toString());t.close()},get_NameSpace:function(){return this.$4Q_4},set_NameSpace:function(n){this.$4Q_4=n;return n},$4Q_4:null,get_IframeElement:function(){return this.$2S_4},set_IframeElement:function(n){this.$2S_4=n;return n},$2S_4:null,get_EsoFullAccess:function(){return this.$5i_4},set_EsoFullAccess:function(n){this.$5i_4=n;return n},$5i_4:!1,$8F_4:function(n){this.$82_4=!0;this.$9u_4();if(this.$4Y_4){this.$4Y_4();this.$4Y_4=null}},checkScriptStatusAndCall:function(n){if(this.$82_4)n();else{this.$B7_4();this.$4Y_4=n}},$B7_4:function(){if(!this.$4H_4){UpdateProgressPopUp.showProgress(Strings.get_Loading());this.$4H_4=!0}},$9u_4:function(){if(this.$4H_4){UpdateProgressPopUp.progressCompleted();this.$4H_4=!1}},dispose:function(){EcpControl.prototype.dispose.call(this);$removeHandler(this.$2S_4,"load",this.$$d_$8F_4);window[this.$4Q_4]=null}};function PeopleIdentity(n,t,i,r,u,f,e){PeopleIdentity.initializeBase(this,[i,n]);this.Address=t;this.AddressOrigin=r;this.DisplayName=n;this.galContactGuid=e;this.RecipientFlag=f;this.RoutingType=u;this.SMTPAddress=i}PeopleIdentity.batchConvertEcpRecipientsToOwa=function(n){var i=[];if(!_Object.isNullOrUndefined(n))for(var t=0;t<n.length;t++)Array.add(i,PeopleIdentity.convertEcpRecipientToOwa(n[t]));return i};PeopleIdentity.batchConvertOwaRecipientsToEcp=function(n){var i=[];if(!_Object.isNullOrUndefined(n))for(var t=0;t<n.length;t++)Array.add(i,PeopleIdentity.convertOwaRecipientToEcp(n[t]));return i};PeopleIdentity.convertEcpRecipientToOwa=function(n){var t=new OwaPeoplePickerUtil.Recip;t._dn=n.DisplayName;t._em=n.Address;t._rt=n.RoutingType;t._sa=n.SMTPAddress;t._ao=n.AddressOrigin;t._rf=n.RecipientFlag;t._id="";t._ei=0;return t};PeopleIdentity.convertOwaRecipientToEcp=function(n){return new PeopleIdentity(n._dn,n._em,n._sa,n._ao,n._rt,n._rf)};PeopleIdentity.prototype={Address:null,SMTPAddress:null,RoutingType:null,AddressOrigin:0,RecipientFlag:0,galContactGuid:null};function PickerControl(n){this.$$d_onClear=Function.createDelegate(this,this.onClear);this.$$d_onBrowse=Function.createDelegate(this,this.onBrowse);PickerControl.initializeBase(this,[n])}PickerControl.prototype={$2p_6:null,$2s_6:null,$J_6:null,initialize:function(){EcpSelect.prototype.initialize.call(this);this.$2p_6=this.$$d_onBrowse;this.$J_6.add_browse(this.$2p_6);this.$2s_6=this.$$d_onClear;this.$J_6.add_clear(this.$2s_6)},dispose:function(){if(this.$2p_6){this.$J_6.remove_browse(this.$2p_6);this.$2p_6=null}if(this.$2s_6){this.$J_6.remove_clear(this.$2s_6);this.$2s_6=null}EcpSelect.prototype.dispose.call(this)},get_InlineSelector:function(){return this.$J_6},set_InlineSelector:function(n){this.$J_6=n;return n},addAriaAttribute:function(){var n=this.get_element().getElementsByTagName("INPUT");var t=$get(this.get_element().id+AriaUtil.associatedLabelSuffix);AriaUtil.addAriaAttrToControlWithLab(n[0],t);var i=$get(this.get_element().id+AriaUtil.associatedFvaSpanSuffix);i&&AriaUtil.addAriaAttrToControlWithLabelID(n[0],AriaUtil.getFvaReaderSpanId(n[0]));var r=$get(this.$J_6.$1G_4.id+AriaUtil.associatedLabelSuffix);if(r){var u=t?EcpUtil.getInnerText(t):"";var f=i?EcpUtil.getInnerText(i)+" ":"";var e=u+" "+f;EcpUtil.setInnerText(r,e);AriaUtil.addAriaAttrToControlWithLab(this.$J_6.$1G_4,r)}},changeClearButtonLabel:function(){var n=$get(this.get_element().id+AriaUtil.associatedLabelSuffix);var t=n?EcpUtil.getInnerText(n):"";var i=Strings.ClearForPicker(this.$J_6.$7_4.value,t);var r=$get(this.$J_6.$1L_4.id+AriaUtil.associatedLabelSuffix);EcpUtil.setInnerText(r,i+" ")}};function PickerControlBase(n){PickerControlBase.initializeBase(this,[n])}function PickerFormBase(n){PickerFormBase.initializeBase(this,[n])}PickerFormBase.getPickerLauncher=function(){if(!window.opener)return null;var n=window.opener._pickerLauncher;if(!n)return null;var t=UrlUtil.getParameter(PickerLauncherHelper.launcherParam);return t?n[t]:null};PickerFormBase.prototype={closePicker:function(){var n=PickerFormBase.getPickerLauncher();n&&n.onDialogClose&&n.onDialogClose();window.close()},addSelectResult:function(n){var t=PickerFormBase.getPickerLauncher();if(t&&t.onDialogOK)t.onDialogOK(EcpUtil.serializeArray(n));else _Object.isNullOrUndefined(window.dialogArguments)||(window.returnValue=Sys.Serialization.JavaScriptSerializer.serialize(n));this.closePicker()},onCancel:function(n){n.preventDefault();this.closePicker()}};function PopupForm(n){PopupForm.initializeBase(this,[n])}PopupForm.prototype={$7q_4:null,initialValues:null,get_Converter:function(){return this.$2J_4},set_Converter:function(n){this.$2J_4=n;return n},$2J_4:null,initialize:function(){BaseForm.prototype.initialize.call(this);this.initialValues=this.$2J_4?this.$2J_4.convertFrom(this.get_$2w_4()):this.get_$2w_4()},onCommit:function(n){n.preventDefault();if(FieldValidationAssistant.get_instance().highlightFieldsInError()){if(DialogManager.hasVisibleModalDialog())return;DialogManager.focusControlAfterClose(FieldValidationAssistant.get_instance().$q_1);MessageBox.showMessage(Strings.get_FieldsInError(),MessageBoxType.error);return}if(this.get_getUpdatedValues()){var t={};_Object.copyDictionary(this.get_getUpdatedValues()(),t);this.$2J_4?this.set_$2w_4(this.$2J_4.convertTo(t)):this.set_$2w_4(t)}DataLossReporting.suspendWarning();window.close()},onCancel:function(n){BaseForm.prototype.onCancel.call(this,n);this.set_$2w_4(null)},get_$2w_4:function(){return PopupWindowManager.getPopupWindowArgumentsValue()},set_$2w_4:function(n){PopupWindowManager.setPopupWindowArgumentsValue(n);return n},get_getUpdatedValues:function(){return this.$7q_4},set_getUpdatedValues:function(n){this.$7q_4=n;return n},get_initialValues:function(){return this.initialValues}};function SimpleProgressBar(n){SimpleProgressBar.initializeBase(this,[n]);Sys.UI.DomElement.addCssClass(this.get_element(),"SimpleProgressBar")}SimpleProgressBar.prototype={$5Q_3:0,get_complete:function(){return this.$5Q_3},set_complete:function(n){if(n>=0&&n<=100){this.$5Q_3=n;this.$BE_3()}else{throw Error.invalidOperation();throw Error.argument("value","Complete should between 1 and 100");}return n},$BE_3:function(){var n=this.get_jQueryObject().children();n.css("width",this.$5Q_3+"%")}};function PostBackForm(n){this.$$d_onButtonClicked=Function.createDelegate(this,this.onButtonClicked);PostBackForm.initializeBase(this,[n])}PostBackForm.prototype={$1A_4:null,$1X_4:null,$6o_4:null,$5O_4:null,$6K_4:null,$5F_4:null,get_NextButton:function(){return this.$1A_4},set_NextButton:function(n){this.$1A_4=n;return n},get_BackButton:function(){return this.$1X_4},set_BackButton:function(n){this.$1X_4=n;return n},get_SenderButtonField:function(){return this.$6o_4},set_SenderButtonField:function(n){this.$6o_4=n;return n},get_CommitButtonProgressDescription:function(){return this.$5O_4},set_CommitButtonProgressDescription:function(n){this.$5O_4=n;return n},get_NextButtonProgressDescription:function(){return this.$6K_4},set_NextButtonProgressDescription:function(n){this.$6K_4=n;return n},get_BackButtonProgressDescription:function(){return this.$5F_4},set_BackButtonProgressDescription:function(n){this.$5F_4=n;return n},initialize:function(){BaseForm.prototype.initialize.call(this);this.$H_3&&$addHandler(this.$H_3,"click",this.$$d_onButtonClicked);this.$1A_4&&$addHandler(this.$1A_4,"click",this.$$d_onButtonClicked);this.$1X_4&&$addHandler(this.$1X_4,"click",this.$$d_onButtonClicked)},dispose:function(){this.$H_3&&$removeHandler(this.$H_3,"click",this.$$d_onButtonClicked);this.$1A_4&&$removeHandler(this.$1A_4,"click",this.$$d_onButtonClicked);this.$1X_4&&$removeHandler(this.$1X_4,"click",this.$$d_onButtonClicked);BaseForm.prototype.dispose.call(this)},onButtonClicked:function(n){for(var i=n.target;i&&i.tagName!=="BUTTON";)i=i.parentNode;var t="";i&&(t=i.id);this.$6o_4.value=t;if((this.$1A_4&&this.$1A_4.id===t||this.$H_3&&this.$H_3.id===t)&&FieldValidationAssistant.get_instance().highlightFieldsInError()){DialogManager.focusControlAfterClose(FieldValidationAssistant.get_instance().$q_1);MessageBox.showMessage(Strings.get_FieldsInError(),MessageBoxType.error);return}var r=null;this.$H_3&&this.$H_3.id===t?r=this.$5O_4:this.$1X_4&&this.$1X_4.id===t?r=this.$5F_4:this.$1A_4&&this.$1A_4.id===t&&(r=this.$6K_4);WizardPropertyUtil.submitForm(r)}};function PropertyPage(n){this.$$d_$B0_4=Function.createDelegate(this,this.$B0_4);this.$$d_$8P_4=Function.createDelegate(this,this.$8P_4);this.$$d_$BJ_4=Function.createDelegate(this,this.$BJ_4);this.$$d_$BK_4=Function.createDelegate(this,this.$BK_4);this.$$d_$9x_4=Function.createDelegate(this,this.$9x_4);this.$$d_$8w_4=Function.createDelegate(this,this.$8w_4);this.$$d_$50_4=Function.createDelegate(this,this.$50_4);this.$$d_$8z_4=Function.createDelegate(this,this.$8z_4);PropertyPage.initializeBase(this,[n]);this.webServiceMethod_Succeeded=this.$$d_$8z_4}PropertyPage.prototype={webServiceMethod_Succeeded:null,$5K_4:null,$E_4:null,$1l_4:null,$6k_4:null,$4u_4:!1,$3C_4:null,$8w_4:function(n){if(n.keyCode===13||n.keyCode===32){n.preventDefault();n.stopPropagation();this.$50_4(n)}},$50_4:function(n){this.$E_4.style.display="none";if(this.$2_4){var t=this.$2_4.Warnings.length+this.$2_4.ErrorRecords.length;t>1&&ErrorHandling.showPowerShellErrors(this.$2_4)}},reloadPage:function(n,t){try{var i=EcpApplication.get_instance();if(i&&i.get_Navigation()){var e=i.get_navigationWindow();var u=e._navTarget;u||(u=n);var o=t?_Cookie.get(EcpUrl.languageOverridenParam):UrlUtil.getParameter(EcpUrl.languageOverridenParam);i.get_Navigation().reloadWithPageIdAndLanguage(u,o,t)}else{var f=window.self;var r=f.location.href;t&&EcpUrl.getUrlParameter(r,EcpUrl.languageOverridenParam)&&(r=EcpUrl.setUrlParameter(r,EcpUrl.languageOverridenParam,""));f.location.href=r.replace(f.location.hash,"")}}catch(s){}},$8d_4:function(){if(this.$E_4)if(this.$2_4){var n=this.$2_4.Warnings.length+this.$2_4.ErrorRecords.length;if(n){this.$1l_4.innerHTML=n>1?EcpUtil.htmlEncode(Strings.get_WarningPanelMultipleWarnings()):this.$2_4.ErrorRecords.length>0?EcpUtil.htmlEncode(this.$2_4.ErrorRecords[0].Message):EcpUtil.htmlEncode(this.$2_4.Warnings[0]);this.$E_4.style.display="block"}else this.$E_4.style.display="none"}else this.$E_4.style.display="none"},get_UseSetObject:function(){return this.$7F_4},set_UseSetObject:function(n){this.$7F_4=n;return n},$7F_4:!1,get_RequireDataAtInitialize:function(){return this.$3L_4},set_RequireDataAtInitialize:function(n){this.$3L_4=n;return n},$3L_4:!1,get_ObjectIdentity:function(){return this.$1O_4},set_ObjectIdentity:function(n){this.$1O_4=n;return n},$1O_4:null,get_SaveMethodExpression:function(){return this.$8V_4},set_SaveMethodExpression:function(n){this.$8V_4=n;return n},$8V_4:null,get_CaptionTextField:function(){return this.$7V_4},set_CaptionTextField:function(n){this.$7V_4=n;return n},$7V_4:null,get_CaptionControl:function(){return this.$3n_4},set_CaptionControl:function(n){this.$3n_4=n;return n},$3n_4:null,get_Form:function(){return this.$F_4},set_Form:function(n){this.$F_4=n;return n},$F_4:null,get_JsonResults:function(){return Sys.Serialization.JavaScriptSerializer.serialize(this.$2_4)},set_JsonResults:function(n){this.set_Results(Sys.Serialization.JavaScriptSerializer.deserialize(n));return n},get_Results:function(){return this.$2_4},set_Results:function(n){this.$2_4=n;this.get_hasOutput()&&(this.$3C_4=this.$2_4.Output[0]);this.get_isInitialized()&&this.$8I_4();this.raisePropertyChanged("Results");this.$An_4();return n},get_identityBinding:function(){return this.$1d_4},$1d_4:null,initialize:function(){EcpControl.prototype.initialize.call(this);if(this.$3L_4&&window.opener&&this.$2_4&&this.$2_4.Output&&!this.$2_4.Output.length&&this.$2_4.ErrorRecords.length>0){var t=new Info;t.Message=this.$2_4.ErrorRecords[0].Message;t.MessageType=MessageBoxType.error;var u=this;MessageBox.show(t,4,function(n,t){window.close()},null);return}this.$E_4=$get(this.$51_4);if(this.$E_4){this.$1l_4=$get(this.$51_4+GlobalVariables.warningMessage);this.$E_4.tabIndex=0;$addHandler(this.$E_4,"click",this.$$d_$50_4);$addHandler(this.$E_4,"keydown",this.$$d_$8w_4);AriaUtil.addAriaStatusAndAriaAssertiv(this.$E_4)}if(!EcpUtil.isNullOrBlank(this.$4n_4)&&this.$F_4.$H_3){this.$F_4.$H_3.confirmMessage=this.$4n_4;this.$F_4.$H_3.confirmMessageTarget="";this.$F_4.$H_3.suppressConfirmIfPageNotDirty=!0}if(this.$F_4&&this.$F_4.$4e_3){var i=this.$F_4;if(!_Object.isNullOrUndefined(i.get_initialValues())){this.$7O_4();var n={};n.Output=[i.get_initialValues()];n.Warnings=new Array(0);n.ErrorRecords=new Array(0);this.set_Results(n)}var r=this;i.set_getUpdatedValues(function(){return r.$k_4.get_value()})}else this.$9w_4();this.$8I_4();DataLossReporting.add_report(this.$$d_$9x_4)},$9w_4:function(){this.$1d_4=new ComponentBinding(this.get_id(),"ObjectIdentity");if(this.$B_4){var t=[this.$1d_4];this.$B_4.set_Parameters(t)}if(this.$4_4)if(this.$7F_4){var n;switch(this.$4_4.get_ParameterNames()){case 6:case 1:n=[this.$1d_4];break;case 4:n=[this.$1d_4,new ChangedValuesBinding(this.$k_4)];break;default:throw Error.notImplemented();}this.$4_4.set_Parameters(n)}else this.$4_4.set_Parameters([this.$k_4]);this.$3L_4&&this.$7O_4()},$7O_4:function(){this.$3n_4&&(this.$5K_4=new ComponentBinding(this.$3n_4.id.replace("_textContainer",""),"value"))},dispose:function(){if(this.$E_4){$removeHandler(this.$E_4,"click",this.$$d_$50_4);$removeHandler(this.$E_4,"keydown",this.$$d_$8w_4)}this.$F_4&&this.$F_4.$4e_3&&this.$F_4.set_getUpdatedValues(null);this.$F_4=null;this.set_RefreshWebServiceMethod(null);this.set_SaveWebServiceMethod(null);DataLossReporting.remove_report(this.$$d_$9x_4);if(this.$O_4){this.$O_4.remove_Succeeded(this.$$d_$BK_4);this.$O_4.remove_Completed(this.$$d_$BJ_4);this.$O_4=null}EcpControl.prototype.dispose.call(this)},$9x_4:function(n,t){if(this.$k_4&&this.$k_4.get_isDirty()){t.turnOnHasChange();this.$4_4&&this.$4_4.get_isBusy()&&t.turnOnIsSaving()}},get_hasOutput:function(){return!!this.$2_4&&!!this.$2_4.Output&&this.$2_4.Output.length>0},$8I_4:function(){if(this.$2_4){if(this.get_hasOutput()&&!(!this.$3L_4&&this.$6E_4===this.$4_4)&&!(WizardPropertyUtil.get_returnObjecType()&&this.$4_4&&this.$6E_4===this.$4_4)){var n=this.$2_4.Output[0];var t=DataBinder.getPropertyValue(n,"Identity");t&&this.$1O_4&&t.RawIdentity===this.$1O_4.RawIdentity&&(this.$1O_4=t);if(this.$k_4){this.$k_4.set_value(n);this.$k_4.resetIsDirty();FieldValidationAssistant.get_instance().clearInputElementsValidationErrors()}this.$5K_4&&this.$5K_4.set_value(this.get_CaptionTextField()(n));if(this.get_SaveMethodExpression()){this.$6k_4=this.get_SaveMethodExpression()(n);this.$6k_4?this.$4_4.set_MethodName(this.$6k_4):_Object.isNullOrUndefined(this.$F_4.$H_3)||(this.$F_4.$H_3.style.display="none")}}this.processErrors()}},$2_4:null,processErrors:function(){for(var n=null,u=this.$2_4.ErrorRecords,t=u.length-1;t>=0;t--){var f=u[t];var i=f.Property;if(i){var r=this.$9b_4(i);if(r){FieldValidationAssistant.get_instance().setControlInError(r,f.Message,0===t,i);if(!n){n=$get(r);n&&(EcpUtil.isTextbox(n)||DropDownList.isDropDownList(n))&&DialogManager.focusControlAfterClose(n)}}}}this.$29_4&&Array.clear(this.$2_4.Warnings);this.$2D_4?this.$8d_4():this.$4u_4||ErrorHandling.showPowerShellErrors(this.$2_4);this.$4u_4&&(this.$4u_4=!1)},get_Bindings:function(){return this.$k_4},set_Bindings:function(n){this.$k_4=n;return n},$k_4:null,get_RefreshWebServiceMethod:function(){return this.$B_4},set_RefreshWebServiceMethod:function(n){if(this.$B_4){this.$B_4.remove_Succeeded(this.webServiceMethod_Succeeded);this.$B_4.remove_Succeeded(this.$$d_$8P_4)}this.$B_4=n;if(this.$B_4){this.$B_4.add_Succeeded(this.$$d_$8P_4);this.$B_4.add_Succeeded(this.webServiceMethod_Succeeded)}return n},$B_4:null,get_SaveWebServiceMethod:function(){return this.$4_4},set_SaveWebServiceMethod:function(n){if(this.$4_4){this.$4_4.remove_Succeeded(this.webServiceMethod_Succeeded);this.$4_4.remove_Invoking(this.$$d_$B0_4)}this.$4_4=n;if(this.$4_4){this.$4_4.add_Succeeded(this.webServiceMethod_Succeeded);this.$4_4.add_Invoking(this.$$d_$B0_4)}return n},$4_4:null,get_customWebServiceMethod:function(){if(!this.$O_4){this.$O_4=new WebServiceMethod;this.$O_4.set_ServiceUrl(this.$B_4.get_ServiceUrl());this.$O_4.add_Succeeded(this.$$d_$BK_4);this.$O_4.add_Completed(this.$$d_$BJ_4)}return this.$O_4},$O_4:null,$B0_4:function(n,t){var i=FieldValidationAssistant.get_instance();if(i.get_pageErrorReported())t.set_cancel(!0);else if(!i.get_pageChecked()&&(i.highlightFieldsInError()||i.pageHasErrors())){i.set_pageErrorReported(!0);var r=i.$q_1;if(this.$5x_4){if(r){var u=this;window.setTimeout(function(){ActiveElementMoniter.setActive(r)},0)}}else{r&&DialogManager.focusControlAfterClose(r);DialogManager.hasVisibleModalDialog()||MessageBox.showMessage(Strings.get_FieldsInError(),MessageBoxType.error)}t.set_cancel(!0)}i.set_pageChecked(!0)},$8z_4:function(n,t){this.$6E_4=t.get_webServiceMethod();this.$4u_4=MultiInvokeContext.isInstanceOfType(t.get_userContext());this.set_Results(t.get_results())},$8P_4:function(n,t){this.$2e_4&&this.$2e_4(t.get_results())},$6E_4:null,$9b_4:function(n){return this.$k_4?this.$k_4.getControlIdGivenPropertyName(n):""},$2Z_4:0,refresh:function(){this.$B_4&&this.$B_4.invoke(++this.$2Z_4)},$An_4:function(){var n=this.get_events().getHandler("selectionChanged");n&&n(this,Sys.EventArgs.Empty)},mergeRefresh:function(n){throw Error.notImplemented();},refreshObject:function(n){if(n){this.set_Results(n);this.$2e_4&&this.$2e_4(this.$2_4)}else this.refresh()},get_refreshing:function(){throw Error.notImplemented();},removeObject:function(n){throw Error.notImplemented();},get_returnObjectType:function(){return 0},get_warnings:function(){throw Error.notImplemented();},add_refreshStarted:function(n){throw Error.notImplemented();},remove_refreshStarted:function(n){throw Error.notImplemented();},add_refreshCompleted:function(n){throw Error.notImplemented();},remove_refreshCompleted:function(n){throw Error.notImplemented();},$2D_4:!1,get_UseWarningPanel:function(){return this.$2D_4},set_UseWarningPanel:function(n){this.$2D_4=n;return n},$29_4:!1,get_SuppressWarning:function(){return this.$29_4},set_SuppressWarning:function(n){this.$29_4=n;return n},$51_4:null,get_WarningPanelID:function(){return this.$51_4},set_WarningPanelID:function(n){this.$51_4=n;return n},$5x_4:!1,get_HideClientValidationError:function(){return this.$5x_4},set_HideClientValidationError:function(n){this.$5x_4=n;return n},$4n_4:null,get_SaveConfirmationText:function(){return this.$4n_4},set_SaveConfirmationText:function(n){this.$4n_4=n;return n},$5T_4:null,get_ContentContainerID:function(){return this.$5T_4},set_ContentContainerID:function(n){this.$5T_4=n;return n},get_OnRefreshSucceed:function(){return this.$2e_4},set_OnRefreshSucceed:function(n){this.$2e_4=n;return n},$2e_4:null,getContentElementByServerId:function(n){return $get(this.$5T_4+"_"+n)},executeWebMethod:function(n,t,i,r,u,f){this.get_customWebServiceMethod().set_isLongRunning(!_Object.isNullOrUndefined(u));this.get_customWebServiceMethod().set_progressInfo(u);this.get_customWebServiceMethod().set_MethodName(n);this.get_customWebServiceMethod().set_ParameterNames(2);this.get_customWebServiceMethod().invokeWithArgs(t,i)},$BK_4:function(n,t){var i=t.get_results();var r=t.get_userContext();if(r!=="None")if(r==="RefreshWindow")if(i.ErrorRecords&&i.ErrorRecords.length>0||i.Warnings&&i.Warnings.length>0){var u=this;ErrorHandling.showPowerShellErrorsWithCallback(i,function(n,t){RefreshWindow(window.self)})}else RefreshWindow(window.self);else this.refreshObject(t.get_results());else ErrorHandling.showPowerShellErrors(i)},$BJ_4:function(n,t){var i=t.get_userContext();t.get_cancelled()&&i==="RefreshAfterCancelled"&&this.refresh()},get_selectedObjects:function(){return this.$3C_4?[this.$3C_4]:[]},get_selectedIdentities:function(){return!this.$1O_4&&!this.$3C_4?[]:[this.$1O_4||this.$3C_4.Identity]},get_selectionCount:function(){return this.get_selectedObjects().length},add_selectionChanged:function(n){this.get_events().addHandler("selectionChanged",n)},remove_selectionChanged:function(n){this.get_events().removeHandler("selectionChanged",n)},get_NameProperty:function(){return this.$4P_4},set_NameProperty:function(n){this.$4P_4=n;return n},$4P_4:"Name",get_isSelectionBeingEdited:function(){return!1},getService:function(n){return n.isInstanceOfType(this)?this:null},get_data:function(){return this.$k_4.get_value()}};function PropertiesWrapper(n){this.$$d_$8x_4=Function.createDelegate(this,this.$8x_4);this.$$d_$8y_4=Function.createDelegate(this,this.$8y_4);PropertiesWrapper.initializeBase(this,[n])}PropertiesWrapper.prototype={$2X_4:null,$2H_4:null,initialize:function(){this.$2X_4=this.$$d_$8y_4;this.$2H_4=this.$$d_$8x_4;this.set_saveWebServiceMethod(this.$V_4.$4_4);this.set_$7b_4(this.$V_4.get_customWebServiceMethod());var n=this;window.setTimeout(function(){n.get_element().style.visibility="visible"},ControlSizeMonitor.checkInterval+100);EcpControl.prototype.initialize.call(this)},dispose:function(){this.set_saveWebServiceMethod(null);this.set_$7b_4(null);this.$2X_4=null;this.$2H_4=null;EcpControl.prototype.dispose.call(this)},get_saveWebServiceMethod:function(){return this.$4_4},set_saveWebServiceMethod:function(n){if(this.$4_4){this.$4_4.remove_Completed(this.$2H_4);this.$4_4.remove_Invoking(this.$2X_4)}this.$4_4=n;if(this.$4_4){this.$4_4.add_Completed(this.$2H_4);this.$4_4.add_Invoking(this.$2X_4)}return n},$4_4:null,get_$7b_4:function(){return this.$O_4},set_$7b_4:function(n){if(this.$O_4){this.$O_4.remove_Completed(this.$2H_4);this.$O_4.remove_Invoking(this.$2X_4)}this.$O_4=n;if(this.$O_4){this.$O_4.add_Completed(this.$2H_4);this.$O_4.add_Invoking(this.$2X_4)}return n},$O_4:null,get_PropertiesID:function(){return this.$6Y_4},set_PropertiesID:function(n){this.$6Y_4=n;this.$V_4=$find(this.$6Y_4);return n},$6Y_4:null,get_properties:function(){return this.$V_4},$V_4:null,get_ToolBar:function(){return this.$8o_4},set_ToolBar:function(n){this.$8o_4=n;return n},$8o_4:null,$8y_4:function(n,t){t.get_cancel()||UpdateProgressPopUp.showProgressImmediately()},$8x_4:function(n,t){UpdateProgressPopUp.progressCompleted()},executePropertiesSaveWebMethod:function(n,t,i){this.$4_4.set_MethodName(n);this.$4_4.invoke(t)},executeWebMethod:function(n,t,i,r,u,f){this.$V_4.executeWebMethod(n,t,i,r,u,f)},get_selectedObjects:function(){return this.$V_4.get_selectedObjects()},get_selectedIdentities:function(){return this.$V_4.get_selectedIdentities()},get_selectionCount:function(){return this.$V_4.get_selectionCount()},add_selectionChanged:function(n){this.$V_4.add_selectionChanged(n)},remove_selectionChanged:function(n){this.$V_4.remove_selectionChanged(n)},get_NameProperty:function(){return this.$V_4.$4P_4},set_NameProperty:function(n){this.$V_4.$4P_4=n;return n},get_isSelectionBeingEdited:function(){return this.$V_4.get_isSelectionBeingEdited()},getService:function(n){return n.isInstanceOfType(this)?this:this.$V_4.getService(n)}};function PropertyPageSheet(n){this.$$d_$9S_4=Function.createDelegate(this,this.$9S_4);this.$$d_$8w_4=Function.createDelegate(this,this.$8w_4);this.$$d_$50_4=Function.createDelegate(this,this.$50_4);PropertyPageSheet.initializeBase(this,[n]);this.addBinding(new Binding("MessageHandler","MessageHandler",4));this.addBinding(new Binding("ProgressText","ProgressDescription",2));this.addBinding(new Binding("ReadOnDemand","ReadOnDemand",4));this.addBinding(new Binding("IsSaved","IsSaved",2));this.addBinding(new Binding("InitialLoadedWorkflow","InitialLoadedWorkflow",4))}PropertyPageSheet.prototype={$2_4:null,$81_4:!1,$2D_4:!1,$29_4:!1,$5y_4:!1,$6b_4:!1,$62_4:null,$E_4:null,$1l_4:null,initialize:function(){if(this.$E_4){this.$1l_4=$get(this.$E_4.id+GlobalVariables.warningMessage);this.$E_4.tabIndex=0;$addHandler(this.$E_4,"click",this.$$d_$50_4);$addHandler(this.$E_4,"keydown",this.$$d_$8w_4);AriaUtil.addAriaStatusAndAriaAssertiv(this.$E_4)}EcpControl.prototype.initialize.call(this)},validate:function(n){FieldValidationAssistant.get_instance().highlightFieldsInError();return EcpControl.prototype.validate.call(this,n)},ensureVisibleCore:function(n){WizardPropertyUtil.showSectionByElement(n.get_element())},$9S_4:function(n,t,i){var r=!0;this.$2_4=n;if(!this.$5y_4&&this.$2_4){this.$29_4&&Array.clear(this.$2_4.Warnings);if(this.$2D_4)this.$8d_4();else if(_PowerShellResults.hasMessage(this.$2_4)){var u=this;ErrorHandling.showPowerShellErrorsWithCallback(this.$2_4,function(n,t){i()});r=!1}}r&&i()},$8d_4:function(){if(this.$E_4)if(this.$2_4){var n=this.$2_4.Warnings.length+this.$2_4.ErrorRecords.length;if(n){this.$1l_4.innerHTML=n>1?EcpUtil.htmlEncode(Strings.get_WarningPanelMultipleWarnings()):this.$2_4.ErrorRecords.length>0?EcpUtil.htmlEncode(this.$2_4.ErrorRecords[0].Message):EcpUtil.htmlEncode(this.$2_4.Warnings[0]);this.$E_4.style.display="block"}else this.$E_4.style.display="none"}else this.$E_4.style.display="none"},$8w_4:function(n){if(n.keyCode===13||n.keyCode===32){n.preventDefault();n.stopPropagation();this.$50_4(n)}},$50_4:function(n){this.$E_4.style.display="none";if(this.$2_4){var t=this.$2_4.Warnings.length+this.$2_4.ErrorRecords.length;t>1&&ErrorHandling.showPowerShellErrors(this.$2_4)}},get_MessageHandler:function(){return this.$$d_$9S_4},get_ProgressDescription:function(){return null},set_ProgressDescription:function(n){UpdateProgressPopUp.get_isAvailable()&&(n?UpdateProgressPopUp.showProgress(n):UpdateProgressPopUp.progressCompleted());return n},get_UseWarningPanel:function(){return this.$2D_4},set_UseWarningPanel:function(n){if(this.$2D_4!==n){this.$2D_4=n;this.raisePropertyChanged("UseWarningPanel")}return n},get_HideErrors:function(){return this.$5y_4},set_HideErrors:function(n){this.$5y_4=n;return n},get_IsSaved:function(){return this.$81_4},set_IsSaved:function(n){this.$81_4=n;return n},get_ReadOnDemand:function(){return this.$6b_4},set_ReadOnDemand:function(n){if(this.$6b_4!==n){this.$6b_4=n;this.raisePropertyChanged("ReadOnDemand")}return n},get_InitialLoadedWorkflow:function(){return this.$62_4},set_InitialLoadedWorkflow:function(n){if(this.$62_4!==n){this.$62_4=n;this.raisePropertyChanged("InitialLoadedWorkflow")}return n},get_SuppressWarning:function(){return this.$29_4},set_SuppressWarning:function(n){if(this.$29_4!==n){this.$29_4=n;this.raisePropertyChanged("SuppressWarning")}return n},get_WarningPanel:function(){return this.$E_4},set_WarningPanel:function(n){this.$E_4=n;return n}};function RecipientPickerControl(n){RecipientPickerControl.initializeBase(this,[n])}RecipientPickerControl.prototype={$1i_7:!1,$4A_7:null,$59_7:!1,$7G_7:!1,$6l_7:null,$T_7:"",$2f_7:null,$1g_7:null,get_HiddenField:function(){return this.$4A_7},set_HiddenField:function(n){this.$4A_7=n;return n},get_SingleSelect:function(){return this.$1i_7},set_SingleSelect:function(n){this.$1i_7=n;return n},get_UseVoicemailPicker:function(){return this.$7G_7},set_UseVoicemailPicker:function(n){this.$7G_7=n;return n},get_AllowTyping:function(){return this.$59_7},set_AllowTyping:function(n){this.$59_7=n;return n},get_disabled:function(){return this.$J_6.get_disabled()},set_disabled:function(n){this.$J_6.set_disabled(n);this.set_enabled(!n);n&&this.reset();return n},reset:function(){this.$1g_7=null;this.set_selectedRecipients(null)},get_value:function(){return this.$T_7},set_value:function(n){var r=null;var u=null;if(n){r=[];u=[];if(Array.isInstanceOfType(n))for(var f=n,t=0;t<f.length;t++){Array.add(r,f[t]);Array.add(u,this.$73_7(f[t].RawIdentity,f[t].DisplayName))}else for(var o=n.split(","),e=0;e<o.length;e++){var i=o[e];Array.add(r,new PeopleIdentity(i,i,i,3,"SMTP",0));Array.add(u,this.$73_7(i,i))}}this.set_selectedRecipients(r);this.$1g_7=u;return n},$73_7:function(n,t){var i={};i.Identity=new Identity(n,t);i[this.$6_4]=n;i[this.$1b_4]=t;return i},onClear:function(n,t){this.reset()},onOK:function(n){this.$1g_7=n;var t=null;if(n&&n.length>0){t=[];for(var i=0;i<n.length;i++){var r=this.$7a_7(n[i]);Array.add(t,r)}}this.set_selectedRecipients(t);this.changeClearButtonLabel()},getOriginalSelectionInternal:function(){return this.$1g_7},get_selectedRecipients:function(){return this.$6l_7},set_selectedRecipients:function(n){this.$6l_7=n;var r=this.$J_6;var t=r.$7_4;var e=t.value;if(n&&n.length>0){for(var u=[],f=[],i=0;i<n.length;i++){Array.add(u,n[i].DisplayName);Array.add(f,n[i].RawIdentity)}this.$T_7=f.join(",");t.value=u.join(", ");r.setIndicatorStatus(!0)}else{this.$T_7="";t.value="";r.setIndicatorStatus(!1)}if(t.value!==e){this.$6a_7(Sys.EventArgs.Empty);this.raisePropertyChanged("Value")}this.$4A_7&&(this.$4A_7.value=this.$T_7);return n},$6a_7:function(n){var t=this.get_events().getHandler("valueChanged");t&&t(this,n)},$7a_7:function(n){return this.$2f_7?n:new Identity(n[this.$6_4],n[this.$1b_4])},get_OwaPickerUtil:function(){return this.$2f_7},set_OwaPickerUtil:function(n){this.$2f_7=n;return n},onBrowse:function(n,t){if(this.$2f_7){var i;i=this.$7G_7?10:this.$1i_7?3:2;var r=this;this.$2f_7.invokeOwaPicker(i,this.$6l_7,function(){r.set_selectedRecipients(r.$2f_7.$4f_5)})}else this.invokePicker(this.generatePickerUrl(this.$1Q_4,this.$1i_7)+(this.$59_7?"&"+EcpUrl.allowTypingParam+"=t":""))}};function RichTextEditor(n){this.$$d_$Ae_3=Function.createDelegate(this,this.$Ae_3);this.$$d_$A4_3=Function.createDelegate(this,this.$A4_3);this.$$d_$4X_3=Function.createDelegate(this,this.$4X_3);this.$$d_$AB_3=Function.createDelegate(this,this.$AB_3);this.$$d_$8D_3=Function.createDelegate(this,this.$8D_3);this.$$d_$AG_3=Function.createDelegate(this,this.$AG_3);this.$$d_$AQ_3=Function.createDelegate(this,this.$AQ_3);this.$$d_$8G_3=Function.createDelegate(this,this.$8G_3);this.$$d_$9e_3=Function.createDelegate(this,this.$9e_3);RichTextEditor.initializeBase(this,[n])}RichTextEditor.prototype={$3i_3:null,$4V_3:null,$3j_3:null,$3s_3:null,$2Y_3:!1,$4N_3:0,$44_3:null,$z_3:null,$Q_3:null,$2z_3:null,$1C_3:null,$1J_3:null,$1h_3:null,get_FormatBarID:function(){return this.$44_3},set_FormatBarID:function(n){this.$44_3=n;return n},get_IFrameBody:function(){return this.$Q_3},set_IFrameBody:function(n){this.$Q_3=n;return n},get_ErrorBar:function(){return this.$z_3},set_ErrorBar:function(n){this.$z_3=n;return n},get_EndDiv:function(){return this.$2z_3},set_EndDiv:function(n){this.$2z_3=n;return n},get_ButtonsBIU:function(){return this.$3i_3},set_ButtonsBIU:function(n){this.$3i_3=n;return n},get_ButtonTooltips:function(){return this.$3j_3},set_ButtonTooltips:function(n){this.$3j_3=n;return n},get_CustomizeTooltips:function(){return this.$3s_3},set_CustomizeTooltips:function(n){this.$3s_3=n;return n},get_NoneButtonString:function(){return this.$4V_3},set_NoneButtonString:function(n){this.$4V_3=n;return n},get_IsMessageFontEditor:function(){return this.$2Y_3},set_IsMessageFontEditor:function(n){this.$2Y_3=n;return n},get_MaxLength:function(){return this.$4N_3},set_MaxLength:function(n){this.$4N_3=n;return n},get_value:function(){return this.$2Y_3?this.$1C_3.getFormatBarState():this.$1C_3.getHtml(!1)},set_value:function(n){if(this.$2Y_3){var i=null;var t=this.$Q_3.contentWindow;do{t=t.parent;try{if(!_Object.isNullOrUndefined(t.document.activeElement)&&t.document.activeElement!==t.document.body){i=t.document.activeElement;break}}catch(r){}}while(t.parent!==t.self);this.$1C_3.setFormatBarState(n);i&&EcpUtil.safeFocus(i)}else{if(EcpUtil.isFirefox()){if(this.get_enabled()){this.$3t_3();this.setEnabled(!1)}n||(n="<html><head></head><body></body></html>")}this.$1C_3.setHtml(n);if(EcpUtil.isFirefox()&&this.get_enabled()){this.setEnabled(!0);this.$3e_3()}}return n},get_$6u_3:function(){return this.$4N_3>0},initialize:function(){EcpControl.prototype.initialize.call(this);this.$z_3.innerHTML=String.format(RichTextEditor.$7f,EcpUtil.getSpriteImageSrc(),Strings.get_Error());this.$z_3.className=CssClasses.errorDivClass;this.$z_3.childNodes[0].className=CssClasses.containerSprite+" "+CssClasses.errSprite+" "+CssClasses.floatLeft;EcpUtil.showElement(this.$z_3,!1);this.$z_3.tabIndex=-1;var n=window;if(this.$2Y_3){var t=n.BTN_BIU|n.BTN_FORE_COLOR;var i="<html><head></head><body><center>"+Strings.get_MessageFontSampleText()+"</center></body></html>";this.$1C_3=n.GetNewStandaloneEditor(this.$44_3,this.$Q_3.id,this.$3i_3,this.$3j_3,this.$3s_3,this.$4V_3,this.$$d_$9e_3,t,null,i,null,0,null,!0)}else{var r=n.BTN_BIU|n.BTN_JUSTIFY|n.BTN_LISTS|n.BTN_INDENT|n.BTN_DIR|n.BTN_FORE_COLOR|n.BTN_BACK_COLOR|n.BTN_REMOVE_FORMAT|n.BTN_INSERT_RULE|n.BTN_LINKS|n.BTN_SUBSCRIPT_SUPERSCRIPT|n.BTN_STRIKE;this.$1C_3=n.GetNewStandaloneEditor(this.$44_3,this.$Q_3.id,this.$3i_3,this.$3j_3,this.$3s_3,this.$4V_3,this.$$d_$9e_3,r,null,null,null,0,null,!1)}this.$Q_3.contentDocument.body.tabIndex=1;this.$Q_3.contentDocument.body.style.outline="none";if(EcpUtil.isIE()){var u=EcpUtil.getIEDocumentMode();u>=9&&(this.$Q_3.contentDocument.body.style.margin="0px")}if(RtlUtil.isRtl){Sys.UI.DomElement.addCssClass(this.get_element(),"rtl");EcpUtil.isIE()&&(this.$1J_3=this.$$d_$8G_3)}EcpUtil.isIE()&&$addHandler(this.$2z_3,"keydown",this.$$d_$AQ_3);this.$3e_3();this.get_element().getAttribute(GlobalVariables.rbacDisabled)==="true"&&this.set_enabled(!1)},dispose:function(){if(this.$1C_3){this.$3t_3();EcpUtil.isIE()&&$removeHandler(this.$2z_3,"keydown",this.$$d_$AQ_3);this.$1J_3=null;this.$1C_3.dispose();EcpControl.prototype.dispose.call(this)}},setEnabled:function(n){this.$1C_3.enableFormatbar(n,!0)},validate:function(n){if(this.get_$6u_3()){var t=this.get_value().toString();if(t!==this.$1h_3&&t.length>this.$4N_3){this.setControlInError("",Strings.get_TextTooLongErrorMessage());return!1}else{this.$9C_3();return!0}}return!0},setControlInError:function(n,t){Sys.UI.DomElement.addCssClass(this.get_element(),CssClasses.get_richTextboxWithInvalidValue());this.$B6_3(t)},$3e_3:function(){$addHandler(this.$Q_3.contentDocument,"contextmenu",this.$$d_$AG_3);if(this.get_$6u_3()){EcpUtil.isSafari()?$addHandler(this.$Q_3.contentWindow,"DOMFocusOut",this.$$d_$8D_3):$addHandler(this.$Q_3.contentWindow,"blur",this.$$d_$8D_3);$addHandler(this.get_element(),GlobalVariables.bindingValueChanged,this.$$d_$AB_3)}EcpUtil.isIE()&&$addHandler(this.$Q_3.contentDocument,"keydown",this.$$d_$4X_3);$addHandler(this.$Q_3.contentDocument,"keydown",this.$$d_$A4_3);if(RtlUtil.isRtl&&EcpUtil.isIE()){$addHandler(window,"resize",this.$$d_$Ae_3);this.$1J_3&&FrameShowHide.add_shown(this.$1J_3)}},$3t_3:function(){$removeHandler(this.$Q_3.contentDocument,"contextmenu",this.$$d_$AG_3);EcpUtil.isIE()&&$removeHandler(this.$Q_3.contentDocument,"keydown",this.$$d_$4X_3);$removeHandler(this.$Q_3.contentDocument,"keydown",this.$$d_$A4_3);if(RtlUtil.isRtl&&EcpUtil.isIE()){$removeHandler(window,"resize",this.$$d_$Ae_3);this.$1J_3&&FrameShowHide.remove_shown(this.$1J_3)}if(this.get_$6u_3()){EcpUtil.isSafari()?$removeHandler(this.$Q_3.contentWindow,"DOMFocusOut",this.$$d_$8D_3):$removeHandler(this.$Q_3.contentWindow,"blur",this.$$d_$8D_3);$removeHandler(this.get_element(),GlobalVariables.bindingValueChanged,this.$$d_$AB_3)}},$AB_3:function(n){this.$1h_3=this.get_value().toString()},$8D_3:function(n){this.validate(!0)},$AG_3:function(n){n.stopPropagation();n.preventDefault()},$A4_3:function(n){if(n.keyCode===Strings.get_CtrlKeyToSave().charCodeAt(0)&&n.ctrlKey){n.preventDefault();n.stopPropagation();var t=EcpUtil.createEvent(n.type);t.ctrlKey=n.ctrlKey;t.keyCode=n.keyCode;EcpUtil.fireEvent(this.get_element(),n.type,t)}},$4X_3:function(n){if(n.keyCode===9){n.shiftKey?this.get_element().focus():this.$2z_3.focus();n.preventDefault()}},$AQ_3:function(n){if(n.keyCode===9&&n.shiftKey){this.$2Y_3?this.get_element().focus():this.$1C_3.focus();n.preventDefault()}},$Ae_3:function(n){this.$8S_3()},$8G_3:function(n,t){this.$8S_3()},$8S_3:function(){Sys.UI.DomElement.addCssClass(this.get_element(),"repaint");Sys.UI.DomElement.removeCssClass(this.get_element(),"repaint")},$9e_3:function(n){return EcpProfile.get_instance().getThemeResource(n)},$9C_3:function(){Sys.UI.DomElement.removeCssClass(this.get_element(),CssClasses.get_richTextboxWithInvalidValue());this.$9r_3()},$B6_3:function(n){this.$z_3.childNodes[1].innerHTML=EcpUtil.htmlEncode(n);EcpUtil.showElement(this.$z_3,!0)},$9r_3:function(){EcpUtil.showElement(this.$z_3,!1);this.$z_3.childNodes[1].innerHTML=""}};function FormatBarState(){}FormatBarState.prototype={sFontName:null,iFontSize:0,fBold:!1,fItalics:!1,fUnderline:!1,sTextColor:null,sHighlightColor:null};function RoleGroupPickerControl(n){RoleGroupPickerControl.initializeBase(this,[n]);this.$1H_4=500;this.$1I_4=750}RoleGroupPickerControl.prototype={$8X_7:null,$T_7:"",$1g_7:null,get_disabled:function(){return this.$J_6.get_disabled()},set_disabled:function(n){this.$J_6.set_disabled(n);n&&this.reset();return n},reset:function(){this.$1g_7=null;this.set_selectedRoleGroups(null)},get_value:function(){return this.$T_7},set_value:function(n){var i=null;var r=null;if(n){var f=n.split(",");i=[];r=[];for(var u=0;u<f.length;u++){var t=f[u];Array.add(i,new PeopleIdentity(t,t,t,3,"SMTP",0));Array.add(r,this.$73_7(t))}}this.set_selectedRoleGroups(i);this.$1g_7=r;return n},$73_7:function(n){var t={};t.Identity=new Identity(n,n);t[this.$6_4]=n;t[this.$1b_4]=n;return t},onClear:function(n,t){this.reset()},onOK:function(n){this.$1g_7=n;var t=null;if(n&&n.length>0){t=[];for(var i=0;i<n.length;i++){var r=this.$7a_7(n[i]);Array.add(t,r)}}this.set_selectedRoleGroups(t)},getOriginalSelectionInternal:function(){return this.$1g_7},get_selectedRoleGroups:function(){return this.$8X_7},set_selectedRoleGroups:function(n){this.$8X_7=n;var t=this.$J_6;var f=t.$7_4.value;if(n&&n.length>0){for(var r=[],u=[],i=0;i<n.length;i++){Array.add(r,n[i].DisplayName);Array.add(u,n[i].RawIdentity)}this.$T_7=u.join(",");t.$7_4.value=r.join(", ");t.setIndicatorStatus(!0)}else{this.$T_7="";t.$7_4.value="";t.setIndicatorStatus(!1)}t.$7_4.value!==f&&this.$6a_7(Sys.EventArgs.Empty);return n},$6a_7:function(n){var t=this.get_events().getHandler("valueChanged");t&&t(this,n)},$7a_7:function(n){return new Identity(n[this.$6_4],n[this.$1b_4])},onBrowse:function(n,t){this.invokePicker(this.generatePickerUrl(this.$1Q_4,!1))}};function NormalizedRectangle(n,t,i,r){if(n<=i){this.$1N_0=n;this.$1R_0=i}else{this.$1N_0=i;this.$1R_0=n}if(t<=r){this.$1E_0=t;this.$11_0=r}else{this.$1E_0=r;this.$11_0=t}}NormalizedRectangle.prototype={$1N_0:0,$1R_0:0,$1E_0:0,$11_0:0,get_left:function(){return this.$1N_0},get_right:function(){return this.$1R_0},get_top:function(){return this.$1E_0},set_top:function(n){this.$1E_0=n;return n},get_bottom:function(){return this.$11_0},set_bottom:function(n){this.$11_0=n;return n}};function SchedulerDOMCache(n){this.$6w_0=new Array(672);this.$13_0=0===n?96:24;this.$5L_0=new Array((this.$13_0+1)*8)}SchedulerDOMCache.prototype={$W_0:null,$2G_0:null,$5L_0:null,$6w_0:null,$28_0:!1,$13_0:0,get_scheduler:function(){return this.$W_0},set_scheduler:function(n){this.$W_0=n;return n},get_cellTable:function(){return this.$2G_0},set_cellTable:function(n){this.$2G_0=n;return n},get_cellsWidth:function(){return this.$13_0},get_suppressSelectionChangeOnFocus:function(){return this.$28_0},set_suppressSelectionChangeOnFocus:function(n){this.$28_0=n;return n},setCell:function(n,t,i){this.$5L_0[t*(this.$13_0+1)+n]=i},getCell:function(n,t){return this.$5L_0[t*(this.$13_0+1)+n]},setSlot:function(n,t,i){this.$6w_0[t*96+n]=i},getSlot:function(n,t){return this.$6w_0[t*96+n]}};function ToggleRangeBehavior(n,t,i,r,u,f){this.$$d_onMouseOut=Function.createDelegate(this,this.onMouseOut);this.$$d_onClick=Function.createDelegate(this,this.onClick);ToggleRangeBehavior.initializeBase(this,[n]);this.$2E_2=i;this.$3Y_2=r;this.$56_2=u;this.$7M_2=f;this.$6m_2=this.$56_2-this.$2E_2==1?this.$2E_2:this.$56_2-this.$2E_2==4?this.$2E_2/4:this.$2E_2-1;this.$6n_2=this.$7M_2-this.$3Y_2==1?this.$3Y_2:this.$3Y_2-1;this.$W_2=t;$addHandler(n,EventNames.click,this.$$d_onClick);$addHandler(n,EventNames.mouseOut,this.$$d_onMouseOut)}ToggleRangeBehavior.prototype={$2E_2:0,$3Y_2:0,$56_2:0,$7M_2:0,$6m_2:0,$6n_2:0,$W_2:null,dispose:function(){$removeHandler(this.get_element(),EventNames.click,this.$$d_onClick);$removeHandler(this.get_element(),EventNames.mouseOut,this.$$d_onMouseOut);Sys.UI.Behavior.prototype.dispose.call(this)},onClick:function(n){(this.$6m_2!==this.$W_2.$C_4||this.$6n_2!==this.$W_2.$G_4)&&this.$W_2.changeSelectedCell(this.$6m_2,this.$6n_2);this.$W_2.$74_4(this.$2E_2,this.$3Y_2,this.$56_2,this.$7M_2);this.$W_2.get_schedulerDOM().$28_0=!0;EcpUtil.isIE()&&this.$W_2.get_schedulerDOM().$W_0.focus();n.preventDefault()},onMouseOut:function(n){this.get_element().blur()}};function SchedulerControl(n){this.$$d_onEditDialogOK=Function.createDelegate(this,this.onEditDialogOK);this.$$d_onMouseOut=Function.createDelegate(this,this.onMouseOut);this.$$d_onEndSelection=Function.createDelegate(this,this.onEndSelection);this.$$d_onSelecting=Function.createDelegate(this,this.onSelecting);this.$$d_$8D_4=Function.createDelegate(this,this.$8D_4);this.$$d_$AX_4=Function.createDelegate(this,this.$AX_4);this.$$d_$4X_4=Function.createDelegate(this,this.$4X_4);this.$$d_onStartSelection=Function.createDelegate(this,this.onStartSelection);this.$$d_onResolutionChange=Function.createDelegate(this,this.onResolutionChange);this.$$d_$AN_4=Function.createDelegate(this,this.$AN_4);this.$u_4=[null,null,null];this.$3R_4=new Array(672);SchedulerControl.initializeBase(this,[n])}SchedulerControl.prototype={$26_4:0,$27_4:0,$X_4:0,$Y_4:0,$C_4:0,$G_4:0,$67_4:!1,$6g_4:null,$6F_4:null,$5R_4:null,$9_4:0,$1p_4:null,$6s_4:null,$35_4:null,$6V_4:null,$1j_4:null,$37_4:!1,$6B_4:!1,$16_4:null,$6H_4:null,$6G_4:null,$1t_4:null,$2N_4:null,$3M_4:null,$3J_4:null,$3I_4:null,$6_4:null,$7e_4:0,$7d_4:0,get_EditCommandUrl:function(){return this.$1t_4},set_EditCommandUrl:function(n){this.$1t_4=n;return n},get_RootContainer:function(){return this.$3M_4},set_RootContainer:function(n){this.$3M_4=n;return n},get_EditButton:function(){return this.$2N_4},set_EditButton:function(n){this.$2N_4=n;return n},get_DayStrings:function(){return this.$1p_4},set_DayStrings:function(n){this.$1p_4=n;return n},get_ShortestDayStrings:function(){return this.$6s_4},set_ShortestDayStrings:function(n){this.$6s_4=n;return n},get_HourStrings:function(){return this.$35_4},set_HourStrings:function(n){this.$35_4=n;return n},get_PartHourStrings:function(){return this.$6V_4},set_PartHourStrings:function(n){this.$6V_4=n;return n},get_TimeSlotStrings:function(){return this.$1j_4},set_TimeSlotStrings:function(n){this.$1j_4=n;return n},get_DayMapping:function(){return this.$16_4},set_DayMapping:function(n){this.$16_4=n;return n},get_Is24HourUserLocale:function(){return this.$37_4},set_Is24HourUserLocale:function(n){this.$37_4=n;return n},get_IsReadOnly:function(){return this.$6B_4},set_IsReadOnly:function(n){this.$6B_4=n;return n},get_LegendForTrueValueText:function(){return this.$6H_4},set_LegendForTrueValueText:function(n){this.$6H_4=n;return n},get_LegendForFalseValueText:function(){return this.$6G_4},set_LegendForFalseValueText:function(n){this.$6G_4=n;return n},get_value:function(){return EcpUtil.cloneArray(this.$3R_4)},set_value:function(n){if(n){this.$3R_4=EcpUtil.cloneArray(n);this.showScheduler(this.$9_4)}return n},get_schedulerDOM:function(){return this.$u_4[this.$9_4]},get_focusSelectX:function(){return this.$C_4},get_focusSelectY:function(){return this.$G_4},initialize:function(){EcpControl.prototype.initialize.call(this);this.$7d_4=550;this.$7e_4=600;this.$6_4="SchedulerData";this.$2N_4&&$addHandler(this.$2N_4,EventNames.click,this.$$d_$AN_4);this.$6g_4=this.buildResolutionSelection();this.$3M_4.appendChild(this.$6g_4);this.$5R_4=document.createElement("DIV");this.$3M_4.appendChild(this.$5R_4);this.$6F_4=this.buildLegend();this.$3M_4.appendChild(this.$6F_4);this.$6B_4?this.showScheduler(2):this.showScheduler(1)},dispose:function(){this.$2N_4&&$removeHandler(this.$2N_4,EventNames.click,this.$$d_$AN_4);$removeHandler(this.$3I_4,EventNames.click,this.$$d_onResolutionChange);$removeHandler(this.$3J_4,EventNames.click,this.$$d_onResolutionChange);if(2!==this.$9_4)for(var n=0;n<3;n++)null!==this.$u_4[n]&&null!==this.$u_4[n].$2G_0&&$removeHandler(this.$u_4[n].$2G_0,"mousedown",this.$$d_onStartSelection);this.$6c_4(this.$$d_$4X_4,EventNames.keyDown);this.$6c_4(this.$$d_$AX_4,EventNames.focus);this.$6c_4(this.$$d_$8D_4,EventNames.blur);EcpControl.prototype.dispose.call(this)},onEditDialogOK:function(n){this.set_value(DataBinder.getPropertyValue(n[0],this.$6_4))},$74_4:function(n,t,i,r){var u=!this.anySlotsOnInRange(n,t,i,r);this.setRange(n,t,i,r,u)},buildDiv:function(n,t){var i=document.createElement("DIV");i.innerHTML=n;null!==t&&(i.className=t);return i},buildRadioButton:function(n,t,i,r){var u;u=document.createElement("INPUT");u.checked=r;u.type="radio";u.name=t;u.id=n;u.value=i;return u},buildToggleButton:function(n,t,i,r,u,f,e){var o=document.createElement("DIV");o.id=this.get_id()+"_"+t+"_"+SchedulerMode.toString(this.$9_4);o.innerHTML=n;o.className=i;var s=new ToggleRangeBehavior(o,this,r,u,f,e);return o},buildCellChildren:function(n,t,i){if(0===this.$9_4){var u=document.createElement("DIV");u.id=this.getVisualSlotId(t,i);this.get_schedulerDOM().setSlot(t,i,u);n.appendChild(u)}else for(var r=0;r<4;r++){var f=document.createElement("DIV");f.id=this.getVisualSlotId(t*4+r,i);this.get_schedulerDOM().setSlot(t*4+r,i,f);n.appendChild(f)}},buildCellTable:function(){var i=document.createElement("TABLE");i.className="schedulerTable";i.setAttribute("cellPadding",0);i.setAttribute("cellSpacing",0);var u;var n;var t;if(2!==this.$9_4){$addHandler(i,"mousedown",this.$$d_onStartSelection);this.get_schedulerDOM().$2G_0=i}if(!1===this.$37_4){u=i.insertRow(-1);var c=0===this.$9_4?48:12;n=u.insertCell(-1);n.colSpan=c;n.appendChild(this.buildDiv(Strings.get_MidnightAM(),"schedulerAMPMHeader"));n=u.insertCell(-1);n.colSpan=c;n.appendChild(this.buildDiv(Strings.get_NoonPM(),"schedulerAMPMHeader"))}u=i.insertRow(-1);switch(this.$9_4){case 0:for(var r=0;r<96;r++){n=u.insertCell(-1);var s="";var l="schedulerToggleHour15";if(0==r%4){s=this.$35_4[r/4];l="schedulerToggleHour"}else s=this.$6V_4[r%4];var a=this.buildToggleButton(s,r.toString(),l,r,0,r+1,7);n.appendChild(a);this.get_schedulerDOM().setCell(r,7,a);n.cx=r;n.cy=-1}break;case 1:for(var f=0;f<24;f++){n=u.insertCell(-1);var v=this.buildToggleButton(this.$35_4[f],"timeslot_"+f.toString(),"schedulerToggleHour",f*4,0,f*4+4,7);n.appendChild(v);this.get_schedulerDOM().setCell(f,7,v);n.cx=f;n.cy=-1}break;case 2:for(var h=0;h<24;h+=2){t=document.createElement("DIV");t.className="schedulerDisplayHour";t.innerHTML=this.$35_4[h];n=u.insertCell(-1);n.colSpan=2;n.appendChild(t)}break}for(var e=0;e<7;e++){u=i.insertRow(-1);for(var w=0===this.$9_4?96:24,o=0;o<w;o++){n=u.insertCell(-1);t=document.createElement("DIV");t.id=this.getCellId(o,e);this.get_schedulerDOM().setCell(o,e,t);t.className=2===this.$9_4?"schedulerGridCellReadOnly":"schedulerGridCell";var y=0===this.$9_4?1:4;var p=o*y;var b=p+y;t.title=String.format(Strings.get_DayAndTimeRangeTooltip(),this.$1p_4[this.$16_4[e]],this.$1j_4[p],this.$1j_4[b]);n.cx=o;n.cy=e;n.schedulerDrag=!0;this.buildCellChildren(t,o,e);n.appendChild(t)}}t=document.createElement("DIV");if(this.$9_4)return i;else{t.className=!0===this.$37_4?"schedulerRightScrollWithoutAMPM":"schedulerRightScrollWithAMPM";t.appendChild(i);return t}},buildDayTable:function(){var i;var n;var u;var r=document.createElement("TABLE");r.className=this.$9_4===2?"schedulerTable":"schedulerTable schedulerTableDayFixup";r.setAttribute("cellPadding",0);r.setAttribute("cellSpacing",0);if(!1===this.$37_4){i=r.insertRow(-1);n=i.insertCell(-1);u=document.createElement("DIV");u.className="schedulerAMPMHeader";n.appendChild(u)}if(this.$9_4===2){i=r.insertRow(-1);n=i.insertCell(-1);n.appendChild(this.buildDiv("","schedulerDisplayHour"))}else{i=r.insertRow(-1);n=i.insertCell(-1);var f=this.buildToggleButton(Strings.get_All(),"All","schedulerToggleDay",0,0,96,7);n.appendChild(f);this.get_schedulerDOM().setCell(this.get_schedulerDOM().$13_0,7,f);this.$C_4=-1;this.$G_4=-1;n.cx=-1;n.cy=-1}for(var t=0;t<7;t++){i=r.insertRow(-1);n=i.insertCell(-1);if(this.$9_4===2)n.appendChild(this.buildDiv(this.$6s_4[this.$16_4[t]],"schedulerReadOnlyDay"));else{var e=this.buildToggleButton(this.$1p_4[this.$16_4[t]],"day_"+t.toString(),"schedulerToggleDay",0,t,96,t+1);n.appendChild(e);this.get_schedulerDOM().setCell(this.get_schedulerDOM().$13_0,t,e);n.cx=-1;n.cy=t}}return r},buildScheduler:function(){var i;var t;var n=document.createElement("TABLE");n.className="schedulerTable";n.setAttribute("cellPadding",0);n.setAttribute("cellSpacing",0);if(this.$9_4!==2){n.tabIndex=0;$addHandler(n,EventNames.focus,this.$$d_$AX_4);$addHandler(n,EventNames.keyDown,this.$$d_$4X_4);$addHandler(n,EventNames.blur,this.$$d_$8D_4)}i=n.insertRow(-1);var r=this.buildDayTable();t=i.insertCell(-1);t.appendChild(r);t.style.verticalAlign="top";var u=this.buildCellTable();t=i.insertCell(-1);t.appendChild(u);t.style.verticalAlign="top";return n},buildResolutionSelection:function(){var n=this.buildDiv("",null);var r=this.get_id()+"_schedulerResolution";this.$3J_4=this.buildRadioButton(this.get_id()+"_radio24",r,1..toString(),!0);$addHandler(this.$3J_4,EventNames.click,this.$$d_onResolutionChange);n.appendChild(this.$3J_4);var t=document.createElement("SPAN");t.id=this.$3J_4.id+AriaUtil.associatedLabelSuffix;EcpUtil.setInnerText(t,Strings.get_Select24Hours());n.appendChild(t);n.appendChild(document.createElement("BR"));this.$3I_4=this.buildRadioButton(this.get_id()+"_radio15",r,0..toString(),!1);$addHandler(this.$3I_4,EventNames.click,this.$$d_onResolutionChange);n.appendChild(this.$3I_4);var i=document.createElement("SPAN");i.id=this.$3I_4.id+AriaUtil.associatedLabelSuffix;EcpUtil.setInnerText(i,Strings.get_Select15Minutes());n.appendChild(i);n.appendChild(document.createElement("BR"));n.appendChild(document.createElement("BR"));return n},buildLegend:function(){var t=this.buildDiv("",null);t.appendChild(document.createElement("BR"));var n;n=this.buildDiv("","schedulerLegendLine");AriaUtil.isInHighContrastMode()?n.appendChild(this.buildDiv("","schedulerSlotOnHighContrast schedulerLegendBox")):n.appendChild(this.buildDiv("","schedulerSlotOn schedulerLegendBox"));n.appendChild(document.createTextNode(this.$6H_4));var i;i=this.buildDiv("","schedulerLegendLine");i.appendChild(this.buildDiv("","schedulerSlotOff schedulerLegendBox"));i.appendChild(document.createTextNode(this.$6G_4));var r=document.createElement("table");this.$7Q_4(r,n);this.$7Q_4(r,i);t.appendChild(r);t.appendChild(document.createElement("BR"));return t},$7Q_4:function(n,t){var i=document.createElement("tr");var r=document.createElement("td");r.appendChild(t);i.appendChild(r);n.appendChild(i)},refreshScheduler:function(){for(var n=0;n<7;n++)for(var t=0;t<96;t++)this.setVisualSlot(t,n,this.getSlot(t,n))},showScheduler:function(n){this.$9_4=n;if(null===this.$u_4[this.$9_4]){this.$u_4[this.$9_4]=new SchedulerDOMCache(this.$9_4);this.get_schedulerDOM().$W_0=this.buildScheduler();this.$5R_4.appendChild(this.get_schedulerDOM().$W_0)}this.refreshScheduler();for(var t=0;t<3;t++)null!==this.$u_4[t]&&EcpUtil.showElement(this.$u_4[t].$W_0,t===this.$9_4);EcpUtil.showElement(this.$6g_4,2!==this.$9_4);EcpUtil.showElement(this.$6F_4,2!==this.$9_4)},onResolutionChange:function(n){var i=n.target;var t=parseInt(i.value);t!==this.$9_4&&this.showScheduler(t)},getSlot:function(n,t){return this.$3R_4[this.$16_4[t]*96+n]},setSlot:function(n,t,i){if(i!==this.getSlot(n,t)){this.$3R_4[this.$16_4[t]*96+n]=i;this.setVisualSlot(n,t,i)}},setRange:function(n,t,i,r,u){for(var f=t;f<r;f++)for(var e=n;e<i;e++)this.setSlot(e,f,u)},anySlotsOnInRange:function(n,t,i,r){for(var u=t;u<r;u++)for(var f=n;f<i;f++)if(!0===this.getSlot(f,u))return!0;return!1},getVisualSlotId:function(n,t){return this.get_id()+"_"+n.toString()+"_"+t.toString()+"_"+SchedulerMode.toString(this.$9_4)},getCellId:function(n,t){return this.get_id()+"_grid_"+n.toString()+"_"+t.toString()+SchedulerMode.toString(this.$9_4)},setVisualSlot:function(n,t,i){var r=this.get_schedulerDOM().getSlot(n,t);r.className=this.getSlotClassName(i)},getSlotClassName:function(n){var t;switch(this.$9_4){case 1:t="schedulerSlot24Hour ";break;case 0:t="schedulerSlot15Minute ";break;case 2:default:t="schedulerSlotReadOnly ";break}t+=n?AriaUtil.isInHighContrastMode()?"schedulerSlotOnHighContrast":"schedulerSlotOn":"schedulerSlotOff";return t},getTooltipRangeString:function(n,t,i,r){var u=0===this.$9_4?1:4;return r===t?String.format(Strings.get_DayAndTimeRangeTooltip(),this.$1p_4[this.$16_4[t]],this.$1j_4[n*u],this.$1j_4[i*u]):String.format(Strings.get_DayRangeAndTimeRangeTooltip(),this.$1p_4[this.$16_4[t]],this.$1p_4[this.$16_4[r]],this.$1j_4[n*u],this.$1j_4[i*u])},setTooltipRange:function(n,t,i,r,u,f){var e=this.get_schedulerDOM().getCell(n,t);e.title=this.getTooltipRangeString(i,r,u,f)},setSelectionRange:function(n,t,i,r,u){if(0!==t)for(var f=n;f<i;f++){var h=this.get_schedulerDOM().getCell(f,t-1);h.className=u?"schedulerGridCellSelectedTop":"schedulerGridCell"}if(0!==n)for(var e=t;e<r;e++){var c=this.get_schedulerDOM().getCell(n-1,e);c.className=u?"schedulerGridCellSelectedLeft":"schedulerGridCell"}for(var o=t;o<r;o++)for(var s=n;s<i;s++){var l=this.get_schedulerDOM().getCell(s,o);l.className=u?"schedulerGridCellSelected":"schedulerGridCell"}},getDraggableParent:function(n){for(;null!==n&&document.documentElement!==n;n=n.parentNode)if(!0===n.schedulerDrag)return n;return null},onStartSelection:function(n){var t=this.getDraggableParent(n.target);if(this.$67_4){this.completeSelection(!1);return}else if(null!==t){if(0===n.button){this.$26_4=this.$X_4=t.cx;this.$27_4=this.$Y_4=t.cy;this.$67_4=!0;this.setSelectionRange(this.$26_4,this.$27_4,this.$26_4+1,this.$27_4+1,!0);this.changeSelectedCell(this.$X_4,this.$Y_4);$addHandler(this.get_element(),EventNames.mouseMove,this.$$d_onSelecting);$addHandler(this.get_element(),EventNames.mouseUp,this.$$d_onEndSelection);$addHandler(this.get_element(),EventNames.mouseOut,this.$$d_onMouseOut);var i=this;document.documentElement.onselectstart=function(){return!1}}n.preventDefault()}},completeSelection:function(n){$removeHandler(this.get_element(),EventNames.mouseMove,this.$$d_onSelecting);$removeHandler(this.get_element(),EventNames.mouseUp,this.$$d_onEndSelection);$removeHandler(this.get_element(),EventNames.mouseOut,this.$$d_onMouseOut);document.documentElement.onselectstart=null;var t=new NormalizedRectangle(this.$26_4,this.$27_4,this.$X_4,this.$Y_4);this.setTooltipRange(this.$X_4,this.$Y_4,this.$X_4,this.$Y_4,this.$X_4+1,this.$Y_4);this.setSelectionRange(t.$1N_0,t.$1E_0,t.$1R_0+1,t.$11_0+1,!1);if(!0===n){this.$7W_4(this.$26_4,this.$27_4,this.$X_4,this.$Y_4);this.changeSelectedCell(this.$X_4,this.$Y_4);this.get_schedulerDOM().$28_0=!0;this.get_schedulerDOM().$W_0.focus()}this.$67_4=!1},onSelecting:function(n){var i=this.getDraggableParent(n.target);if(null!==i){var r=i.cx;var u=i.cy;if(r!==this.$X_4||u!==this.$Y_4){var t;t=new NormalizedRectangle(this.$26_4,this.$27_4,this.$X_4,this.$Y_4);this.setTooltipRange(this.$X_4,this.$Y_4,this.$X_4,this.$Y_4,this.$X_4+1,this.$Y_4);this.setSelectionRange(t.$1N_0,t.$1E_0,t.$1R_0+1,t.$11_0+1,!1);this.$39_4(this.$C_4,this.$G_4)&&this.setSelectionRange(this.$C_4,this.$G_4,this.$C_4+1,this.$G_4+1,!1);this.$C_4=r;this.$G_4=u;this.$X_4=r;this.$Y_4=u;t=new NormalizedRectangle(this.$26_4,this.$27_4,this.$X_4,this.$Y_4);this.setTooltipRange(this.$X_4,this.$Y_4,t.$1N_0,t.$1E_0,t.$1R_0+1,t.$11_0);this.setSelectionRange(t.$1N_0,t.$1E_0,t.$1R_0+1,t.$11_0+1,!0)}}},onEndSelection:function(n){this.completeSelection(!0)},onMouseOut:function(n){var i=n.rawEvent;var t=i.toElement||i.relatedTarget;try{while(t){if(t===this.get_element())return;t=t.parentNode}}catch(r){}this.completeSelection(!1)},$AN_4:function(n){var t={};t[this.$6_4]=this.get_value();ModalPopupLauncherHelper.openModalPopup(this.$1t_4,this.$7d_4,this.$7e_4,t,this.get_DataContext(),this.$$d_onEditDialogOK)},$4X_4:function(n){if(n.keyCode!==9||n.altKey||n.ctrlKey){var t=this.$C_4;var i=this.$G_4;var r=RtlUtil.convertToLTLDirection(n.keyCode);switch(r){case 38:i=this.$G_4===-1?-1:this.$G_4-1;break;case 40:i=this.$G_4===6?6:this.$G_4+1;break;case 37:t=this.$C_4===-1?-1:this.$C_4-1;break;case 39:t=this.$C_4===this.get_schedulerDOM().$13_0-1?this.get_schedulerDOM().$13_0-1:this.$C_4+1;break;case 32:this.$39_4(this.$C_4,this.$G_4)?this.$7W_4(this.$C_4,this.$G_4,this.$C_4,this.$G_4):_DomElement.click(this.get_schedulerDOM().getCell(this.$2u_4(this.$C_4),this.$2v_4(this.$G_4)));break;default:return}if(this.$C_4!==t||this.$G_4!==i){this.changeSelectedCell(t,i);this.$9_4||-1===t||this.$9U_4(this.get_schedulerDOM().getCell(this.$2u_4(t),this.$2v_4(i)))}n.preventDefault();n.stopPropagation()}},$AX_4:function(n){if(this.get_schedulerDOM().$28_0){this.get_schedulerDOM().$28_0=!1;return}this.changeSelectedCell(-1,-1)},$8D_4:function(n){var t=this.get_schedulerDOM().getCell(this.$2u_4(this.$C_4),this.$2v_4(this.$G_4));this.$39_4(this.$C_4,this.$G_4)?this.setSelectionRange(this.$C_4,this.$G_4,this.$C_4+1,this.$G_4+1,!1):t.className=-1===this.$C_4?"schedulerToggleDay":this.$9_4===1?"schedulerToggleHour":"schedulerToggleHour15";this.get_schedulerDOM().$28_0=!1;n.preventDefault();n.stopPropagation()},$2u_4:function(n){return n===-1?this.get_schedulerDOM().$13_0:n},$2v_4:function(n){return n===-1?7:n},$39_4:function(n,t){return n!==-1&&t!==-1},$7W_4:function(n,t,i,r){var u;u=new NormalizedRectangle(n,t,i,r);this.$9_4===1?this.$74_4(u.$1N_0*4,u.$1E_0,u.$1R_0*4+4,u.$11_0+1):this.$74_4(u.$1N_0,u.$1E_0,u.$1R_0+1,u.$11_0+1)},changeSelectedCell:function(n,t){var i=this.get_schedulerDOM().getCell(this.$2u_4(this.$C_4),this.$2v_4(this.$G_4));this.$39_4(this.$C_4,this.$G_4)?this.setSelectionRange(this.$C_4,this.$G_4,this.$C_4+1,this.$G_4+1,!1):i.className=-1===this.$C_4?"schedulerToggleDay":this.$9_4===1?"schedulerToggleHour":"schedulerToggleHour15";this.$C_4=n;this.$G_4=t;var r=this.get_schedulerDOM().getCell(this.$2u_4(n),this.$2v_4(t));this.$39_4(n,t)?this.setSelectionRange(n,t,n+1,t+1,!0):r.className=-1===n?"schedulerToggleDaySelect":this.$9_4===1?"schedulerToggleHourSelect":"schedulerToggleHour15Select"},$6c_4:function(n,t){for(var i=0;i<2;i++)null!==this.$u_4[i]&&null!==this.$u_4[i].$W_0&&$removeHandler(this.$u_4[i].$W_0,t,n)},$9U_4:function(n){for(var i=this.get_schedulerDOM().$2G_0.parentNode,t=i.scrollLeft,u=EcpUtil.getRelativePositionX(i),r=i.offsetWidth,f=EcpUtil.getRelativePositionX(n),e=n.offsetWidth;f>u+t+r-r/2;)t+=e;while(f<u+t+r/2)t-=e;i.scrollLeft=t}};function SDOPropertySheet(n){this.$$d_$Aa_5=Function.createDelegate(this,this.$Aa_5);SDOPropertySheet.initializeBase(this,[n]);this.addBinding(new Binding("ObjectId","ObjectId",4));this.addBinding(new Binding("Results","Results",2))}SDOPropertySheet.prototype={$6M_5:null,$2_5:null,initialize:function(){PropertyPageSheet.prototype.initialize.call(this);$addHandler(window,"message",this.$$d_$Aa_5)},dispose:function(){$removeHandler(window,"message",this.$$d_$Aa_5);EcpControl.prototype.dispose.call(this)},get_Results:function(){return this.$2_5},set_Results:function(n){if(this.$2_5!==n&&n&&!_String.isNullOrEmpty(this.$6M_5)){this.$2_5=n;_Window.getParent(window.self).postMessage("onLoadObject",window.self.location.protocol.toLowerCase()+"//"+window.self.location.hostname.toLowerCase())}return n},get_ObjectId:function(){return this.$6M_5},set_ObjectId:function(n){this.$6M_5=n;this.raisePropertyChanged("ObjectId");return n},$Aa_5:function(n){this.$E_4.style.display="none";this.set_ObjectId(n.rawEvent.data)}};function PropertiesExceptionHandlerContext(){PropertiesExceptionHandlerContext.initializeBase(this)}PropertiesExceptionHandlerContext.prototype={invokeWebService:null};function SimpleRetry(){this.$$d_$9A_3=Function.createDelegate(this,this.$9A_3);this.$3Z_3=Strings.get_IUnderstandAction();SimpleRetry.initializeBase(this)}SimpleRetry.prototype={buttons:null,invokeWebService:null,$21_3:null,$5b_3:null,get_contentHtml:function(){return this.contentHtml},contentHtml:null,get_className:function(){return"msgbx"},get_PropertiesToAdd:function(){return this.$4h_3},set_PropertiesToAdd:function(n){this.$4h_3=n;return n},$4h_3:null,get_Description:function(){return this.$5a_3},set_Description:function(n){this.$5a_3=n;return n},$5a_3:null,get_AcceptanceText:function(){return this.$3Z_3},set_AcceptanceText:function(n){this.$3Z_3=n;return n},$2F_3:null,initialize:function(){Sys.Component.prototype.initialize.call(this);this.buttons=DialogButton.get_okCancel()},dispose:function(){this.invokeWebService=null},handle:function(n){this.invokeWebService=n.invokeWebService;DialogManager.show(this)},onInit:function(n){Dialog.prototype.onInit.call(this,n);this.$5b_3=n.get_id();var t=this.generateButtonHtml(this.buttons);this.contentHtml=String.format(SimpleRetry.$2M,n.get_id(),Strings.get_Warning(),Strings.get_Close(),this.get_innerContent(),this.$3Z_3,t,EcpUtil.getSpriteImageSrc())},get_innerContent:function(){return String.format('<div class="paddv msgboxDiv">{0}</div>',this.$5a_3)},onShown:function(){Dialog.prototype.onShown.call(this);this.$2F_3=$get(this.$5b_3+"_chkbox");$addHandler(this.$2F_3,"click",this.$$d_$9A_3);this.$21_3=$get(this.$5b_3+"_"+ModalDialogResult.OK);this.$21_3.disabled=!this.$2F_3.checked},$9A_3:function(n){this.set_dialogResultOnEnter(this.$2F_3.checked?ModalDialogResult.OK:ModalDialogResult.cancel);this.$21_3.disabled=!this.$2F_3.checked},onButtonClicked:function(n){if(n===ModalDialogResult.OK){_Object.copyDictionary(Sys.Serialization.JavaScriptSerializer.deserialize(this.$4h_3),this.get_webServiceMethod().get_oneOffParameters());this.invokeWebService.invokeMethod(null)}this.get_modalDialog().close();this.onClose()},onClose:function(){$removeHandler(this.$2F_3,"click",this.$$d_$9A_3);Dialog.prototype.onClose.call(this)},generateButtonHtml:function(n){var i="";if(n.length>0)for(var t=0;t<n.length;t++)i+=String.format(SimpleRetry.$2q,this.$9a_3(n[t]),n[t].get_type(),n[t].get_text());return i},$9a_3:function(n){return this.get_modalDialog().get_id()+"_"+n.get_type()}};function SmtpAddressesEditor(n){this.$$d_$AC_5=Function.createDelegate(this,this.$AC_5);this.$$d_$4W_5=Function.createDelegate(this,this.$4W_5);SmtpAddressesEditor.initializeBase(this,[n])}SmtpAddressesEditor.prototype={$s_5:null,$7_5:null,$7H_5:null,$3A_5:!1,initialize:function(){EcpSelect.prototype.initialize.call(this);this.$7H_5=ECPValidators.getValidatorsForTextBox(this.$7_5);if(this.$s_5){$addHandler(this.$s_5,"click",this.$$d_$4W_5);$addHandler(this.$s_5,"focus",this.$$d_$AC_5)}},dispose:function(){if(this.$s_5){$removeHandler(this.$s_5,"click",this.$$d_$4W_5);$removeHandler(this.$s_5,"focus",this.$$d_$AC_5);this.$s_5=null}EcpSelect.prototype.dispose.call(this)},get_PickerButton:function(){return this.$s_5},set_PickerButton:function(n){this.$s_5=n;return n},get_TextBox:function(){return this.$7_5},set_TextBox:function(n){this.$7_5=n;return n},get_SingleSelect:function(){return this.$1i_5},set_SingleSelect:function(n){this.$1i_5=n;return n},$1i_5:!1,get_value:function(){return EcpUtil.isNullOrBlank(this.$7_5.value)?"":this.$7_5.value},set_value:function(n){if(this.$7_5.maxLength>0&&n.length>this.$7_5.maxLength){var t=n.substr(0,this.$7_5.maxLength).lastIndexOf(",");t<0&&(t=this.$7_5.maxLength);n=n.substr(0,t)}this.$7_5.value=n;return n},get_disabled:function(){return this.$7_5.disabled},set_disabled:function(n){this.$7_5.disabled=n;this.$s_5&&(this.$s_5.disabled=n);if(this.$7_5.disabled){this.resetTextbox();this.$3A_5=!1;this.dismissPicker()}return n},resetTextbox:function(){this.set_value("");FieldValidationAssistant.get_instance().setTextboxErrorProperties(this.$7_5,null);for(var n=0;n<this.$7H_5.length;n++)this.$7H_5[n].style.display="none"},$4W_5:function(n){if(!this.get_element().disabled){FieldValidationAssistant.get_instance().setTextboxErrorProperties(this.$7_5,null);this.invokePicker(this.generatePickerUrl(this.$1Q_4,this.$1i_5));this.$3A_5=!0}},$AC_5:function(n){if(!this.get_disabled()&&this.$3A_5){ActiveElementMoniter.setActive(this.$7_5);this.$3A_5=!1}},onOK:function(n){this.$3A_5=!1;this.get_disabled()||this.$BI_5(this.$9o_5(n))},addAriaAttribute:function(){var n=$get(this.get_element().id+AriaUtil.associatedLabelSuffix);AriaUtil.addAriaAttrToControlWithLab(this.$7_5,n);AriaUtil.addAriaAttrToControlWithLabelID(this.$7_5,AriaUtil.getFvaReaderSpanId(this.$7_5))},$9o_5:function(n){var t=this.get_value();if(!n||!n.length)return t;for(var i=[],e=0,o=String.format(" {0} ",t),r=0;r<n.length;r++){var u=n[r][this.$6_4];if(!_Object.isNullOrUndefined(u)){var s=String.format("[,\\s]{0}[,\\s]",u);o.search(new RegExp(s,"g"))<0&&(i[e++]=EcpUtil.cloneDataObject(u))}}if(!e)return t;if(this.$1i_5)return i[0];var f=new Sys.StringBuilder(t);EcpUtil.isNullOrBlank(t)||t.trimEnd().endsWith(",")||f.append(", ");f.append(i.join(", "));return f.toString()},$BI_5:function(n){ActiveElementMoniter.setActive(this.$7_5);this.set_value(n);EcpUtil.fireEvent(this.$7_5,"change");ActiveElementMoniter.setActive(this.$s_5);this.get_value()&&this.get_value()!==n&&MessageBox.showMessage(Strings.get_SomeSelectionNotAdded(),MessageBoxType.warning)}};function StatisticsBar(n){StatisticsBar.initializeBase(this,[n]);this.$j_3=new StatisticsBarData;this.$j_3.UsagePercentage=0;this.$j_3.UsageState=0;this.$j_3.UsageText=null;this.$j_3.AdditionalInfoText=null;this.$3g_3="100%";this.$3f_3="16px";Sys.UI.DomElement.addCssClass(this.get_element(),"StatisticsBar");var t=this.get_element().getAttribute(AriaUtil.ariaLabelledby);this.$4D_3=this.get_element().id+"_InfoSpan";this.$3c_3=this.get_element().id+"_AdInfoSpan";this.$5B_3=_Object.isNullOrUndefined(t)?AriaUtil.joinIDs(this.$4D_3,this.$3c_3):AriaUtil.joinIDs(t,this.$4D_3,this.$3c_3)}StatisticsBar.prototype={$j_3:null,$3g_3:null,$3f_3:null,$4D_3:null,$3c_3:null,$5B_3:null,get_BarWidth:function(){return this.$3g_3},set_BarWidth:function(n){this.$3g_3=n;return n},get_BarHeight:function(){return this.$3f_3},set_BarHeight:function(n){this.$3f_3=n;return n},get_value:function(){return this.$j_3},set_value:function(n){if(!_Object.isNullOrUndefined(n)){this.$j_3=n;this.updateLayout()}return n},updateLayout:function(){var t="usagePart ";var i="sbTextBold ";var r;switch(this.$j_3.UsageState){case 1:t+="sbUsageWarning";i+="sbTextRed";r="sbTextBlack";break;case 2:t+="sbUsageExceeded";i+="sbTextRed";r="sbTextRed";break;default:t+="sbUsageNormal";i+="sbTextBlack";r="sbTextBlack";break}var n=this.$j_3.UsagePercentage>100?100:this.$j_3.UsagePercentage;var u="";var o=n>0&&n<=100?String.format('<td style="width: {0}%"><div class="{1}"></div></td>',n,t):"";var s=100-n>0?String.format('<td style="width: {0}%"><div style="height: {1}" class="{2}"></div></td>',100-n,this.$3f_3,"sbFreeSize"):"";u+=String.format('<table cellspacing="0" cellpadding="0" style="width: {0}" role="textbox" aria-disabled="true" aria-labelledby="{3}" tabindex=\'0\'><tr>{1}{2}</tr></table>',this.$3g_3,o,s,this.$5B_3);var f=!EcpUtil.isNullOrBlank(this.$j_3.UsageText);var e=!EcpUtil.isNullOrBlank(this.$j_3.AdditionalInfoText);if(f||e){var h=f?String.format('<span id="{2}" class="{0}" role="textbox">{1}</span>',i,this.$j_3.UsageText,this.$4D_3):"";var c=f&&e?"&nbsp;":"";var l=e?String.format('<span id="{2}" class="{0}" role="textbox">{1}</span>',r,this.$j_3.AdditionalInfoText,this.$3c_3):"";u+=String.format('<div class="sbText">{0}{1}{2}</div>',h,c,l)}this.get_element().innerHTML=u}};function StatisticsBarData(){}StatisticsBarData.prototype={UsagePercentage:0,UsageState:0,UsageText:null,AdditionalInfoText:null};function TextAreaUtil(){}TextAreaUtil.TextAreaOnPasteEvent=function(n){window.setTimeout(function(){TextAreaUtil.$70(n)},1)};TextAreaUtil.TextAreaOnKeyDownEvent=function(n){var r=n.getAttribute("maxLength");if(!EcpUtil.isFirefox()){var i=window.event;var t=i.keyCode;return t===127||t===8||t===35||t===36||t===40||t===38||t===37||t===39||t===34||t===33||i.ctrlKey||i.altKey||i.shiftKey||i.metaKey||t===46||n.value.length<r?!0:!1}return!0};TextAreaUtil.TextAreaOnMouseOverEvent=function(n){window.setTimeout(function(){TextAreaUtil.$70(n)},1)};TextAreaUtil.TextAreaOnInputEvent=function(n){TextAreaUtil.$70(n)};TextAreaUtil.$70=function(n){var t=n.getAttribute("maxLength");n.value.length>t&&(n.value=n.value.substring(0,t))};function TreeBasedPicker(n){this.$$d_$9F_2=Function.createDelegate(this,this.$9F_2);this.$$d_$9G_2=Function.createDelegate(this,this.$9G_2);this.$$d_$AW_2=Function.createDelegate(this,this.$AW_2);this.$$d_$Ad_2=Function.createDelegate(this,this.$Ad_2);this.$$d_$Ac_2=Function.createDelegate(this,this.$Ac_2);this.$$d_$9j_2=Function.createDelegate(this,this.$9j_2);this.$$d_$9k_2=Function.createDelegate(this,this.$9k_2);this.$1T_2=0;TreeBasedPicker.initializeBase(this);this.$4y_2=n}TreeBasedPicker.prototype={$4y_2:null,$1S_2:null,$8_2:null,$A_2:null,$c_2:null,$1f_2:null,$2d_2:null,$1h_2:null,$72_2:"",$3k_2:null,$1D_2:null,$6y_2:!1,$12_2:null,$8p_2:null,$4x_2:null,$33_2:0,$3W_2:!1,$4T_2:null,$21_2:null,$4v_2:!0,$2R_2:null,$4E_2:!1,get_treeSource:function(){return this.$4y_2},get_value:function(){var n=null;this.$8_2&&(n=new Identity(this.$8_2.$K_0.ID,this.$8_2.$K_0.Name));return n},get_contentHtml:function(){var n=[];if(this.$2c_2){var t=new DialogButton(this.$6I_2,"NewNode");this.$4U_2!==""&&(t.spriteImage=this.$4U_2);Array.add(n,t)}if(this.$2A_2){var i=new DialogButton(this.$4v_2?Strings.get_ExpandAll():Strings.get_CollapseAll(),"Toggle");i.isLeftAlign=!0;Array.add(n,i)}Array.add(n,DialogButton.get_OK()[0]);this.$3l_2&&Array.add(n,DialogButton.get_cancel()[0]);this.set_dialogResultOnEnter(DialogButton.get_OK()[0].get_type());var r=this.$94_2(n);return String.format(TreeBasedPicker.$2M,this.get_modalDialog().get_id(),this.$72_2,Strings.get_Close(),r,EcpUtil.getSpriteImageSrc(),this.$2B_2?"":CssClasses.hiddenCSS,Strings.get_NoTreeItem(),Strings.get_Loading(),this.get_toggleButtonPanelClassName())},get_newButtonText:function(){return this.$6I_2},set_newButtonText:function(n){this.$6I_2=n;return n},$6I_2:"new",get_newButtonSpriteImage:function(){return this.$4U_2},set_newButtonSpriteImage:function(n){this.$4U_2=n;return n},$4U_2:"",get_newButtonVisible:function(){return this.$2c_2},set_newButtonVisible:function(n){this.$2c_2=n;return n},$2c_2:!1,get_cancelButtonVisible:function(){return this.$3l_2},set_cancelButtonVisible:function(n){this.$3l_2=n;return n},$3l_2:!1,get_toggleButtonPanelClassName:function(){return""},get_toggleButtonVisible:function(){return this.$2A_2},set_toggleButtonVisible:function(n){this.$2A_2=n;return n},$2A_2:!1,get_initExpandedLevel:function(){return this.$36_2},set_initExpandedLevel:function(n){this.$36_2=n;return n},$36_2:1,get_toolBarVisible:function(){return this.$2B_2},set_toolBarVisible:function(n){this.$2B_2=n;return n},$2B_2:!1,get_useVirtualRoot:function(){return this.$1U_2},set_useVirtualRoot:function(n){this.$1U_2=n;return n},$1U_2:!1,get_legacyErrorString:function(){return this.$4L_2},set_legacyErrorString:function(n){this.$4L_2=n;return n},$4L_2:"",get_$8U_2:function(){return this.$1D_2},set_$8U_2:function(n){this.$1D_2=n;this.$12_2={};this.$95_2();this.$3y_2(this.$36_2);this.$1h_2||(this.$1h_2=this.getInitialSelection(this.$1D_2));this.get_isShowing()&&this.$8t_2();return n},$8t_2:function(){this.set_selectedNode(null);if(this.$1T_2)if(this.$1T_2===2)this.$3P_2(this.$8p_2,!0);else{this.$8c_2(!1);this.$4x_2&&this.$4x_2.length>0&&this.$3P_2(this.$4x_2,!1);var n=this.get_$t_2();if(n){this.$2j_2(!1);this.$BG_2(n.$5_0)}else this.$2j_2(!0);if(this.$c_2){this.$c_2.expandToNewNodeCreation();this.$c_2.scrollToNode()}else this.$9V_2()}else this.$B8_2()},get_$t_2:function(){var n=null;this.$1D_2&&(n=this.$12_2[this.$1D_2.ID]);return n},get_selectedNode:function(){return this.$8_2},set_selectedNode:function(n){this.$8W_2(n);if(this.$8_2&&!this.$6A_2){this.$8_2.scrollToNode();this.$8_2.$5_0.firstChild.focus()}return n},$8W_2:function(n){if(this.$8_2!==n){this.$8_2&&this.$8_2.set_selected(!1);this.$8_2=n;this.$8_2&&this.$8_2.set_selected(!0)}this.$9Q_2(!this.$8_2||!this.$8_2.$K_0.CanNewSubNode);this.$9R_2(!this.$8_2)},get_$A6_2:function(){this.$4T_2||(this.$4T_2=this.$5m_2("NewNode"));return this.$4T_2},get_$A9_2:function(){this.$21_2||(this.$21_2=this.$5m_2(ModalDialogResult.OK));return this.$21_2},get_$8j_2:function(){return this.$5m_2("Toggle")},get_$30_2:function(){return $get(this.get_modalDialog().get_id()+"_errorDiv",this.get_modalDialog().get_dialogFrame())},get_$2m_2:function(){return $get(this.get_modalDialog().get_id()+"_treeInDv",this.get_modalDialog().get_dialogFrame())},onInit:function(n){Dialog.prototype.onInit.call(this,n);this.$1T_2===2&&(this.$1T_2=0);this.$1T_2||this.$4y_2.getRootNode(this.$$d_$9k_2,this.$$d_$9j_2)},onPreShow:function(){Dialog.prototype.onPreShow.call(this);if(this.$2c_2){this.$1f_2||(this.$1f_2=this.$$d_$Ac_2);this.$2d_2||(this.$2d_2=this.$$d_$Ad_2)}if(this.$2B_2){var n=$get(this.get_modalDialog().get_id()+"_searchbarpanel",this.get_modalDialog().get_dialogFrame());var t=new FilterTextBoxBuilder;this.$1S_2=t.buidInto(n,this.get_modalDialog().get_id());this.$1S_2.initialize();this.$1S_2.set_enableInTimeSearch(!0);Array.remove(GlobalVariables.preventFireDefaultButton,this.$1S_2.get_element().id);this.$1S_2.add_filterTextChanged(this.$$d_$AW_2)}},dispose:function(){if(this.$2c_2){this.$1f_2=null;this.$2d_2=null}this.$1D_2=null;Sys.Component.prototype.dispose.call(this)},showDialog:function(n,t,i){this.$72_2=n;this.$1h_2=t;this.$3k_2=i;DialogManager.show(this)},onShown:function(){Dialog.prototype.onShown.call(this);this.$8t_2();this.$8_2||(this.$2B_2?this.$1S_2.get_element().focus():this.get_$2m_2().focus())},onKeyDown:function(n){Dialog.prototype.onKeyDown.call(this,n);if(!this.$c_2)if(this.$8_2){if(n.keyCode===RtlUtil.get_leftKey()||n.keyCode===GlobalVariables.minusKeyCode){this.$8_2.collapse();n.preventDefault();n.stopPropagation()}else if(n.keyCode===RtlUtil.get_rightKey()||n.keyCode===GlobalVariables.plusKeyCode){this.$8_2.expand();n.preventDefault();n.stopPropagation()}else if(n.keyCode===38){var t=this.$8_2.getUpVisibleChild(this.$12_2);t&&(!this.$1U_2||t!==this.get_$t_2())&&this.set_selectedNode(t);n.preventDefault();n.stopPropagation()}else if(n.keyCode===40){var i=this.$8_2.getDownVisibleChild(this.$12_2);i&&(!this.$1U_2||i!==this.get_$t_2())&&this.set_selectedNode(i);n.preventDefault();n.stopPropagation()}}else if(n.keyCode===9&&n.target===this.get_$2m_2()&&this.get_$t_2()&&!this.get_$t_2().$r_1){this.set_selectedNode(this.$1U_2?this.get_$t_2().getDownVisibleChild(this.$12_2):this.get_$t_2());n.preventDefault();n.stopPropagation()}},onClick:function(n){if(!this.$c_2){var i=n.target;var t=NodeElement.findNodeFromSrc(i,this.$12_2);if(t){if(this.$8_2!==t){this.get_$2m_2().className=CssClasses.scrollTreeInDv;this.$3W_2=!0}else{this.get_$2m_2().className=this.$3W_2?CssClasses.treeInDv:CssClasses.scrollTreeInDv;this.$3W_2=!this.$3W_2}NodeElement.isExpandableIcon(i)?t.toggleNode():this.set_selectedNode(t)}else{this.get_$2m_2().className=CssClasses.treeInDv;this.$3W_2=!1}}n.preventDefault()},onDoubleClick:function(n){if(!this.$c_2){var t=n.target;var i=null;if(!NodeElement.isExpandableIcon(t)&&(i=NodeElement.findNodeFromSrc(t,this.$12_2))){this.set_selectedNode(i);this.$8N_2();n.preventDefault()}}},onButtonClicked:function(n){if(n==="NewNode")this.$8_2&&this.$8_2.$K_0.CanNewSubNode&&this.$8f_2(null);else if(n==="Toggle")this.$c_2||(this.$4v_2?this.$7g_2():this.$9E_2());else if(n===ModalDialogResult.OK)this.$8_2&&this.$8N_2();else{this.get_modalDialog().close();this.onClose()}},$6A_2:!1,onClose:function(){this.$6A_2=!0;this.$A_2&&this.$5J_2();this.$c_2;if(this.$2B_2){this.$1S_2.remove_filterTextChanged(this.$$d_$AW_2);this.$1S_2.dispose();this.$1S_2=null}this.$5M_2();var n=this.get_$t_2();n&&(n.$5_0=n.$5_0.parentNode.removeChild(n.$5_0));if(this.$4E_2){this.$3y_2(this.$36_2);this.$4E_2=!1}this.set_selectedNode(null);this.$1h_2=null;this.$72_2="";this.$3k_2=null;this.$21_2=null;this.$4T_2=null;this.$2R_2=null;this.$6A_2=!1;Dialog.prototype.onClose.call(this)},$9k_2:function(n,t){this.$1U_2&&n&&(_Object.isNullOrUndefined(n.Children)||!n.Children.length)&&(n=null);this.get_isShowing()&&this.$5M_2();this.$1T_2=1;this.$4x_2=t;this.set_$8U_2(n)},$9j_2:function(n){this.get_isShowing()&&this.$5M_2();this.$1T_2=2;this.$8p_2=n;this.set_$8U_2(null)},$B8_2:function(){var n=this;this.$33_2=window.setTimeout(function(){n.get_isShowing()&&!n.$1T_2&&n.$8c_2(!0);n.$33_2=0},GlobalVariables.progressDelay)},$8N_2:function(){this.$3k_2&&this.$3k_2(this.get_value(),!0);this.get_modalDialog().close();this.onClose()},$Ad_2:function(n){if(n.keyCode===13){this.$6y_2=!0;EcpUtil.isSafari()?this.$A_2.get_inputElement().blur():this.$8g_2();n.stopPropagation();n.preventDefault()}else if(n.keyCode===27){this.$5J_2();n.stopPropagation();n.preventDefault()}},$Ac_2:function(n){if(this.$6y_2||this.$A_2.get_value().trim()!==""){this.$6y_2=!1;this.$8g_2()}else this.$5J_2()},$8f_2:function(n){if(!this.$A_2&&!this.$c_2){this.$8_2.expandToNewNodeCreation();this.$A_2=new NewNodeElement;this.$A_2.$K_0={};this.$A_2.$5_0=NewNodeElement.buildInputElement();this.$A_2.$R_0=this.$8_2;this.$8_2.$p_1.insertBefore(this.$A_2.$5_0,this.$8_2.$p_1.firstChild);if(!EcpUtil.isNullOrEmpty(n)){AriaUtil.updateElementLabelbyForScreenReaderSafe(this.$A_2.get_inputElement(),n);this.$A_2.get_inputElement().setAttribute(AriaUtil.ariaInvalid,!0)}this.$A_2.focus();$addHandler(this.$A_2.get_inputElement(),"blur",this.$1f_2);$addHandler(this.$A_2.get_inputElement(),"keydown",this.$2d_2);this.set_selectedNode(null)}},$8g_2:function(){if(this.$A_2){var t=this.$A_2.get_value();var i=this.validateInput(t);if(i){this.$8b_2(i,!0);AriaUtil.updateElementLabelbyForScreenReaderSafe(this.$A_2.get_inputElement(),i);this.$A_2.get_inputElement().setAttribute(AriaUtil.ariaInvalid,!0);$removeHandler(this.$A_2.get_inputElement(),"blur",this.$1f_2);AriaUtil.reFocusElement(this.$A_2.get_inputElement());$addHandler(this.$A_2.get_inputElement(),"blur",this.$1f_2);return}$removeHandler(this.$A_2.get_inputElement(),"blur",this.$1f_2);$removeHandler(this.$A_2.get_inputElement(),"keydown",this.$2d_2);AriaUtil.updateGlobalStatus(String.format(Strings.get_CreatingFolder(),t),!0);var r=NewNodeElement.buildWaitingCommitElement(t);var n=this.$A_2.$R_0;var u=n.$K_0.ID;n.$p_1.removeChild(n.$p_1.firstChild);n.$p_1.insertBefore(r,n.$p_1.firstChild);this.$A_2=null;this.$c_2=n;this.set_selectedNode(null);this.$4y_2.commitNewNode(t,u,this.$$d_$9G_2,this.$$d_$9F_2)}},$5J_2:function(){if(this.$A_2){this.$7t_2();$removeHandler(this.$A_2.get_inputElement(),"blur",this.$1f_2);$removeHandler(this.$A_2.get_inputElement(),"keydown",this.$2d_2);this.set_selectedNode(this.$A_2.$R_0);this.$8_2.get_hasChildNodesInSource()||this.$8_2.clearEcImage();this.$8_2.$p_1.removeChild(this.$A_2.$5_0);this.$A_2=null}},$9G_2:function(n,t){var i=this.$c_2;this.$c_2=null;i.$K_0.Children||(i.$K_0.Children=[]);Array.insert(i.$K_0.Children,0,n);var r=NodeElement.buildNodeFromSource(!1,!1,n);i.$I_1||(i.$I_1=[]);Array.insert(i.$I_1,0,r);r.$R_0=i;this.$12_2[r.$K_0.ID]=r;var u=i.$p_1;u.removeChild(u.firstChild);u.insertBefore(r.$5_0,u.firstChild);if(this.get_isShowing()){t&&t.length>0?this.$3P_2(t,!1):this.$7t_2();this.set_selectedNode(r)}},$9F_2:function(n){var t=this.$c_2;this.$c_2=null;t.$p_1.removeChild(t.$p_1.firstChild);t.get_hasChildNodesInSource()||t.clearEcImage();if(this.get_isShowing()){var i=null;if(n&&n.length>0){this.$3P_2(n,!0);i=n.join(",")}this.set_selectedNode(t);this.$8f_2(i)}},$BG_2:function(n){var t=$get(this.get_modalDialog().get_id()+"_treeFrm",this.get_modalDialog().get_dialogFrame());t.appendChild(n);t.parentNode.setAttribute(AriaUtil.ariaLabel,Strings.get_FolderTree())},$9V_2:function(){var n=null;if(this.$1h_2){var t=this.$1h_2.RawIdentity;n=this.$12_2[t];if(n){n.expandParentNodes();this.set_selectedNode(n)}else this.$8b_2(this.$4L_2,!1)}},$8c_2:function(n){var t=$get(this.get_modalDialog().get_id()+"_loadingTree",this.get_modalDialog().get_dialogFrame());t.style.display=n?"":"none"},$95_2:function(){if(this.$1D_2){this.$7U_2(this.$1D_2);this.onBuildTreeFinished(this.get_$t_2())}},onBuildTreeFinished:function(n){RtlUtil.setStylePaddingLeft(n.$5_0,"");if(this.$1U_2&&n){Sys.UI.DomElement.addCssClass(n.$5_0.firstChild,CssClasses.hiddenCSS);n.$K_0.Name=""}},$7U_2:function(n){var t=NodeElement.buildNodeFromSource(!1,!0,n);if(n.Children&&n.Children.length>0){t.$I_1=[];for(var i=0;i<n.Children.length;i++){var r=this.$7U_2(n.Children[i]);r.$R_0=t;Array.add(t.$I_1,r);t.$p_1.appendChild(r.$5_0)}}this.$12_2[n.ID]=t;return t},$3y_2:function(n){var t=this.get_$t_2();if(t){this.$5j_2=n;this.$7h_2(t,0)}},$5j_2:0,$7h_2:function(n,t){var r=t<this.$5j_2;var u=t-1>=this.$5j_2;n.set_hidden(u);if(n.get_hasChildNodesInSource()){n.set_expanded(r);t++;for(var i=0;i<n.$I_1.length;i++)this.$7h_2(n.$I_1[i],t)}},$94_2:function(n){for(var i="",r="",u="",t=0;t<n.length;t++){var f=n[t].get_text();n[t].isLeftAlign?r+=String.format(TreeBasedPicker.$2q,this.get_modalDialog().get_id(),n[t].get_type(),f):u+=String.format(TreeBasedPicker.$2q,this.get_modalDialog().get_id(),n[t].get_type(),f)}EcpUtil.isNullOrBlank(r)||(i+=String.format(TreeBasedPicker.$7S,r));EcpUtil.isNullOrBlank(u)||(i+=String.format(TreeBasedPicker.$7T,u));return i},$9Q_2:function(n){this.$2c_2&&(this.get_$A6_2().disabled=n)},$9R_2:function(n){this.get_$A9_2().disabled=n},$5m_2:function(n){for(var u=this.get_modalDialog().get_dialogFrame(),i=u.getElementsByTagName("button"),t=0;t<i.length;t++){var r=i[t].getAttribute(DialogButton.buttonTypeAttribute);if(r&&r===n)return i[t]}return null},$8b_2:function(n,t){this.$3P_2([n],t)},$3P_2:function(n,t){var i=EcpUtil.combineMsgsToHtml(n);this.get_$30_2().className=t?CssClasses.errorDivClass:CssClasses.warnDivClass;this.get_$30_2().childNodes[0].innerHTML=i;this.get_$30_2().style.display=""},$7t_2:function(){this.get_$30_2().childNodes[0].innerHTML="";this.get_$30_2().style.display="none"},$5M_2:function(){if(this.$33_2){window.clearTimeout(this.$33_2);this.$33_2=0}},$2j_2:function(n){var t=$get(this.get_modalDialog().get_id()+"_noItemTextPanel",this.get_modalDialog().get_dialogFrame());t.style.display=n?"block":"none"},$7g_2:function(){if(this.$1D_2){this.$3y_2(1e3);this.$2j_2(!1);if(this.$2A_2){this.$4v_2=!1;this.get_$8j_2().innerHTML=Strings.get_CollapseAll()}}},$9E_2:function(){if(this.$1D_2){this.$3y_2(this.$1U_2?1:0);this.$2j_2(!1);if(this.$2A_2){this.$4v_2=!0;this.get_$8j_2().innerHTML=Strings.get_ExpandAll()}}},$92_2:function(n){if(this.get_isShowing()&&this.get_$t_2())if(EcpUtil.isNullOrBlank(n)){this.$7g_2();this.$4E_2=!1}else{n=n.trim().toLocaleLowerCase();this.$8u_2(this.get_$t_2(),n);this.$8W_2(this.$2R_2);this.$2R_2?this.$2j_2(!1):this.$2j_2(!0);this.$2R_2=null;this.$4E_2=!0}},$8u_2:function(n,t){var i=n.$K_0.Name.toLocaleLowerCase().indexOf(t)>=0;!this.$2R_2&&i&&(this.$2R_2=n);if(n.get_hasChildNodesInSource()){for(var r=0,u=0;u<n.$I_1.length;u++)this.$8u_2(n.$I_1[u],t)&&r++;if(r>0){n.set_hidden(!1);n.set_expanded(r===n.$K_0.Children.length);return!0}else{n.set_expanded(!1);n.set_hidden(!i);return i}}else{n.set_hidden(!i);return i}},$AW_2:function(n,t){if(!this.$c_2){var i=DataBinder.getPropertyValue(n,"filterText");this.$92_2(i)}}};function NodeInfo(){}NodeInfo.prototype={ID:null,Name:null,CanNewSubNode:!0,Children:null};function NodeElementBase(){}NodeElementBase.prototype={$K_0:null,$5_0:null,$R_0:null,get_parent:function(){return this.$R_0},set_parent:function(n){this.$R_0=n;return n},get_nodeInfo:function(){return this.$K_0},set_nodeInfo:function(n){this.$K_0=n;return n},get_element:function(){return this.$5_0},set_element:function(n){this.$5_0=n;return n}};function NodeElement(){NodeElement.initializeBase(this)}NodeElement.isExpandableIcon=function(n){Sys.UI.DomElement.containsCssClass(n,"treeIconAlter")&&(n=n.previousSibling);return Sys.UI.DomElement.containsCssClass(n,"ec")&&!Sys.UI.DomElement.containsCssClass(n,"Blank")||Sys.UI.DomElement.containsCssClass(n,"treeIcon")&&Sys.UI.DomElement.containsCssClass(n,"ec")};NodeElement.buildNodeFromSource=function(n,t,i){var f=!!i.Children&&i.Children.length>0;var u=f?n?"Minus":"Plus":"Blank";var o=u==="Blank"?"":u==="Minus"?RtlUtil.collapseIconMock:RtlUtil.expandIconMock;var s=f?n?Strings.get_Collapse():Strings.get_Expand():"";var e=EcpUtil.reserveSpace(EcpUtil.htmlEncode(i.Name));var h=String.format(NodeElement.nodeFmt,u,s,e,EcpUtil.getSpriteImageSrc(),o);var r=new NodeElement;r.$5_0=document.createElement("div");r.$5_0.innerHTML=h;r.$K_0=i;r.$p_1=r.$5_0.firstChild.nextSibling;r.$r_1=t;r.$1u_1=u==="Minus";RtlUtil.setStylePaddingLeft(r.$5_0,"1em");r.$5_0.setAttribute(NodeElement.$6L,i.ID);r.$5_0.className=t?CssClasses.hiddenCSS:"";r.$5_0.firstChild.setAttribute(AriaUtil.ariaLabel,e);r.$5_0.firstChild.setAttribute(AriaUtil.ariaRole,AriaUtil.ariaTreeItem);f&&r.$5_0.firstChild.setAttribute(AriaUtil.ariaExpanded,r.$1u_1);return r};NodeElement.getNodeID=function(n){return n.getAttribute(NodeElement.$6L)};NodeElement.findNodeFromSrc=function(n,t){for(var i=0;i<4&&n;i++,n=n.parentNode){var r=NodeElement.getNodeID(n);if(r)return t[r]}return null};NodeElement.forEachChildNode=function(n,t){if(n.$I_1)for(var i=0;i<n.$I_1.length;i++)t(n.$I_1[i])};NodeElement.forEachDescendantNode=function(n,t,i){i&&t(n);if(n.$I_1)for(var r=0;r<n.$I_1.length;r++)NodeElement.forEachDescendantNode(n.$I_1[r],t,!0)};NodeElement.prototype={$I_1:null,$p_1:null,$r_1:!1,$1u_1:!1,get_childNodes:function(){return this.$I_1},set_childNodes:function(n){this.$I_1=n;return n},get_subNodesDiv:function(){return this.$p_1},get_hasChildNodesInSource:function(){return!!this.$K_0.Children&&this.$K_0.Children.length>0},get_hidden:function(){return this.$r_1},set_hidden:function(n){if(n!==this.$r_1){this.$5_0.className=n?CssClasses.hiddenCSS:"";this.$r_1=n}return n},get_expanded:function(){return this.$1u_1},set_expanded:function(n){if(this.$1u_1!==n){var t=this.get_$2x_1();_DomElement.toggelCssClass(t,!n,"Plus");_DomElement.toggelCssClass(t,n,"Minus");this.get_$7c_1().innerHTML=n?RtlUtil.collapseIconMock:RtlUtil.expandIconMock;t.title=n?Strings.get_Collapse():Strings.get_Expand();t.alt=n?Strings.get_Collapse():Strings.get_Expand();this.$5_0.firstChild.firstChild.setAttribute(AriaUtil.ariaExpanded,n);Sys.UI.DomElement.removeCssClass(t,"Blank");this.$1u_1=n}return n},expand:function(){if(this.get_hasChildNodesInSource()){var n=this;NodeElement.forEachChildNode(this,function(n){n.set_hidden(!1)});this.set_expanded(!0)}},collapse:function(){if(this.get_hasChildNodesInSource()){var n=this;NodeElement.forEachChildNode(this,function(n){n.set_hidden(!0)});this.set_expanded(!1)}},toggleNode:function(){this.$1u_1?this.collapse():this.expand()},get_selected:function(){return this.$5_0.firstChild.className==="nodeDvSlt"},set_selected:function(n){this.$5_0.firstChild.className=n?"nodeDvSlt":"nodeDv";this.$5_0.firstChild.setAttribute(AriaUtil.ariaSelected,n);this.$5_0.firstChild.tabIndex=n?0:-1;return n},get_$2x_1:function(){return this.$5_0.firstChild.firstChild.firstChild},get_$7c_1:function(){return this.get_$2x_1().nextSibling},clearEcImage:function(){Sys.UI.DomElement.removeCssClass(this.get_$2x_1(),"Minus");Sys.UI.DomElement.removeCssClass(this.get_$2x_1(),"Plus");Sys.UI.DomElement.addCssClass(this.get_$2x_1(),"Blank");this.get_$7c_1().innerHTML="";this.$5_0.firstChild.removeAttribute(AriaUtil.ariaExpanded);this.$1u_1=!1},expandToNewNodeCreation:function(){this.expandParentNodes();this.get_hasChildNodesInSource()?this.expand():this.set_expanded(!0)},getUpVisibleChild:function(n){for(var r=null,t=this.$R_0;t;){t.$r_1&&(r=t);t=t.$R_0}var u=r?r:this;var i=u.$9i_1(n);if(i){for(var f=null;i;){f=i;i=i.$9g_1()}return f}else return u.$R_0},getDownVisibleChild:function(n){for(var r=null,i=this.$R_0;i;){i.$r_1&&(r=i);i=i.$R_0}var t=r?r:this;if(!t.$r_1){var u=t.$9d_1();if(u)return u}while(t){var f=t.$9h_1(n);if(f)return f;t=t.$R_0}return null},$9d_1:function(){if(this.$I_1)for(var n=0;n<this.$I_1.length;n++){var t=this.$I_1[n];if(!t.$r_1)return t}return null},$9g_1:function(){if(this.$I_1)for(var n=this.$I_1.length-1;n>=0;n--){var t=this.$I_1[n];if(!t.$r_1)return t}return null},$7p_1:function(n){var t=this.$5_0.previousSibling;return t?n[NodeElement.getNodeID(t)]:null},$9i_1:function(n){for(var t=this.$7p_1(n);t&&t.$r_1;)t=t.$7p_1(n);return t},$7n_1:function(n){var t=this.$5_0.nextSibling;return t?n[NodeElement.getNodeID(t)]:null},$9h_1:function(n){for(var t=this.$7n_1(n);t&&t.$r_1;)t=t.$7n_1(n);return t},scrollToNode:function(){var n;n=EcpUtil.isSafari()?this.$5_0.firstChild.childNodes[2]:this.$5_0.firstChild.childNodes[1];n.focus();n.blur()},expandParentNodes:function(){for(var n=this.$R_0;n;){n.expand();n=n.$R_0}}};function NewNodeElement(){NewNodeElement.initializeBase(this)}NewNodeElement.buildInputElement=function(){var n=document.createElement("DIV");n.className="nodeDvEdt";RtlUtil.setStylePaddingLeft(n,"1em");n.innerHTML=String.format(NewNodeElement.$89,EcpUtil.getSpriteImageSrc());return n};NewNodeElement.buildWaitingCommitElement=function(n){var t=document.createElement("DIV");t.tabIndex=0;t.className="nodeDv";RtlUtil.setStylePaddingLeft(t,"1em");var i=EcpUtil.reserveSpace(EcpUtil.htmlEncode(n));t.innerHTML=String.format(NewNodeElement.$8A,i,EcpUtil.getSpriteImageSrc());return t};NewNodeElement.prototype={$66_1:null,get_inputElement:function(){!this.$66_1&&this.$5_0&&(this.$66_1=this.$5_0.getElementsByTagName("input")[0]);return this.$66_1},get_value:function(){return this.get_inputElement().value},focus:function(){var n=this;window.setTimeout(function(){n.get_inputElement().focus()},0)}};function UploaderBase(n){this.$$d_$Af_4=Function.createDelegate(this,this.$Af_4);this.$$d_$8E_4=Function.createDelegate(this,this.$8E_4);this.$$d_$8F_4=Function.createDelegate(this,this.$8F_4);UploaderBase.initializeBase(this,[n])}UploaderBase.prototype={$7s_4:null,$2P_4:null,$6T_4:null,$5H_4:null,$5G_4:null,$F_4:null,initialize:function(){EcpControl.prototype.initialize.call(this);this.$4l_4();$addHandler(this.$a_4,"load",this.$$d_$8F_4);ClientUploadManager.get_instance().register(this.get_id(),this)},dispose:function(){EcpControl.prototype.dispose.call(this);$removeHandler(this.$a_4,"load",this.$$d_$8F_4)},setEnabled:function(n){ContainerControl.prototype.setEnabled.call(this,n);ControlHelper.enableDescendantDomElement(this.$a_4.contentDocument.body,n)},get_UploadHandlerClass:function(){return this.$79_4},set_UploadHandlerClass:function(n){this.$79_4=n;return n},$79_4:null,get_Iframe:function(){return this.$a_4},set_Iframe:function(n){this.$a_4=n;return n},$a_4:null,get_ErrorLbl:function(){return this.$3w_4},set_ErrorLbl:function(n){this.$3w_4=n;return n},$3w_4:null,get_Parameters:function(){return this.$6U_4},set_Parameters:function(n){this.$6U_4=n;return n},$6U_4:null,get_ParameterNames:function(){return this.$22_4},set_ParameterNames:function(n){this.$22_4=n;return n},$22_4:null,get_Extensions:function(){return this.$1v_4},set_Extensions:function(n){this.$1v_4=n;return n},$1v_4:null,get_value:function(){return this.$2Q_4},set_value:function(n){this.$2Q_4=n;return n},get_isUploading:function(){return ClientUploadManager.get_instance().isComponentUploading(this.get_id())},$2Q_4:null,$8F_4:function(n){if(this.$A0_4()){var i=EcpUtil.getInnerText(this.$a_4.contentWindow.document.body);if(EcpUtil.isNullOrBlank(i))this.get_isUploading()?this.cancel():this.$4l_4();else{var u;var t;try{t=Sys.Serialization.JavaScriptSerializer.deserialize(i)}catch(f){t={};var r={};r.Message=Strings.get_UploaderUnhandledExceptionMessage();r.CallStack=f.message+"\n\nText: \n"+i;t.ErrorRecords=[r]}u=new UploadCompletedEventArgs(t.ErrorRecords.length>0?2:1,t,this);this.$4l_4();this.$4Z_4(u)}}},add_fileChanged:function(n){this.get_events().addHandler("FileChanged",n)},remove_fileChanged:function(n){this.get_events().removeHandler("FileChanged",n)},$Af_4:function(n){this.$F_4.getAttribute(UploaderBase.$6z)!=="true"&&n.preventDefault()},$8E_4:function(n){var t=GetFileName(this.$2P_4.value);if(this.$80_4(t)){this.$9D_4();var r=new FileChangedEventArgs(this.$2Q_4,t,this);this.$2Q_4=t;var i=this.get_events().getHandler("FileChanged");i&&i(r)}else this.setControlInError(null,Strings.WrongExtension(this.$1v_4.join(" "+Strings.get_Or()+" ")))},add_uploadCompleted:function(n){this.get_events().addHandler("UploadCompleted",n)},remove_uploadCompleted:function(n){this.get_events().removeHandler("UploadCompleted",n)},$4Z_4:function(n){var t=this.get_events().getHandler("UploadCompleted");t&&t(n)},tryUpload:function(){return ClientUploadManager.get_instance().tryUpload(this.get_id())},upload:function(){this.$6T_4.value=this.$Ak_4();var n=this;window.setTimeout(function(){n.$6T_4.disabled=!1;n.$5H_4.disabled=!1;n.$5G_4.disabled=!1;n.$2P_4.disabled=!1;n.$7s_4.disabled=!1;n.$F_4.setAttribute(UploaderBase.$6z,"true");n.$F_4.submit()},0)},cancel:function(){_Window.isAccessible(this.$a_4.contentWindow)&&(_Object.isNullOrUndefined(this.$a_4.contentWindow.stop)||this.$a_4.contentWindow.stop());this.$4l_4();var n=new UploadCompletedEventArgs(0,null,this);this.$4Z_4(n)},focusFileChooser:function(){if(EcpUtil.isVisible(this.get_element())&&!_Object.isNullOrUndefined(this.$2P_4)){var n=this;window.setTimeout(function(){EcpUtil.safeFocus(n.$2P_4)},0)}},validate:function(n){return EcpUtil.isNullOrBlank(this.$2Q_4)?!0:this.$80_4(this.$2Q_4)},setControlInError:function(n,t){Sys.UI.DomElement.addCssClass(this.$a_4,CssClasses.get_uploaderWithInvalidValue());this.$3w_4.innerHTML=String.format(UploaderBase.$8v,Strings.get_UploaderValidationError(),EcpUtil.htmlEncode(t))},$4l_4:function(){this.$a_4.src="";var n=this.$a_4.contentWindow.document;n.open();n.write(String.format(UploaderBase.$2M,this.$79_4));n.close();this.$7s_4=n.getElementById(ClientUploadManager.uploadHandlerFileName);this.$2P_4=n.getElementById(ClientUploadManager.uploadFileKey);this.$6T_4=n.getElementById(ClientUploadManager.uploadParameterKey);this.$5H_4=n.getElementById(Canary.ecpCanaryKey);this.$5G_4=n.getElementById(Canary.ecpCanaryFromUserIdKey);this.$F_4=n.getElementById(UploaderBase.$45);this.$5H_4.value=_Cookie.get(Canary.ecpCanaryKey);this.$5G_4.value=_Cookie.get(Canary.ecpCanaryFromUserIdKey);this.$Ar_4()},$Ar_4:function(){$addHandler(this.$2P_4,"change",this.$$d_$8E_4);$addHandler(this.$F_4,"submit",this.$$d_$Af_4)},$A0_4:function(){var n=null;_Window.isAccessible(this.$a_4.contentWindow)&&(n=this.$a_4.contentWindow.document);return!n||_Object.isNullOrUndefined(n.getElementById(UploaderBase.$45))},$80_4:function(n){if(!_Object.isNullOrUndefined(this.$1v_4)&&this.$1v_4.length>0)if(EcpUtil.isNullOrBlank(n))return!1;else{for(var i=GetFileExtension(n),r=this.$1v_4.length,t=0;t<r;t++)if(this.$1v_4[t].toLowerCase()===i.toLowerCase())return!0;return!1}else return!0},$Ak_4:function(){var i=this.$6U_4.get_value();if(this.$22_4&&this.$22_4.length>0){var r=this.get_DataContext();if(r)for(var n=0;n<this.$22_4.length;n++){var t=Binder.createBinder(r,this.$22_4[n],null);t.get_isActive()&&(i[this.$22_4[n]]=t.get_value());t.dispose()}}return Sys.Serialization.JavaScriptSerializer.serialize(i)},$9D_4:function(){Sys.UI.DomElement.removeCssClass(this.$a_4,CssClasses.get_uploaderWithInvalidValue());this.$3w_4.innerHTML=""}};function WaterMarkedTextArea(n){WaterMarkedTextArea.initializeBase(this,[n]);var t=this;this.get_jQueryObject().change(function(n){t.raisePropertyChanged("value")})}WaterMarkedTextArea.prototype={$6S_4:null,$42_4:null,get_WatermarkBehavior:function(){return this.$2o_4},set_WatermarkBehavior:function(n){this.$2o_4=n;return n},$2o_4:null,get_value:function(){return this.$42_4&&this.$42_4===this.$2o_4.get_Text()?this.$6S_4:this.$2o_4.get_Text()},set_value:function(n){n=n||"";this.$6S_4||(this.$6S_4=n);if(n!==this.get_value()){this.$2o_4.set_Text(this.filterStringTerminator(n.toString()));this.raisePropertyChanged("value")}this.$42_4||(this.$42_4=this.$2o_4.get_Text());return n}};function WebServiceDropDown(n){this.$$d_$Ao_3=Function.createDelegate(this,this.$Ao_3);this.$$d_$Ap_3=Function.createDelegate(this,this.$Ap_3);this.$$d_$Aq_3=Function.createDelegate(this,this.$Aq_3);this.$$d_$8P_3=Function.createDelegate(this,this.$8P_3);WebServiceDropDown.initializeBase(this,[n]);var t=this;this.get_jQueryObject().change(function(n){t.raisePropertyChanged("Value")})}WebServiceDropDown.prototype={$2_3:null,$2V_3:null,$4a_3:null,$3D_3:null,defaultContextForEmptyDropList:null,$B_3:null,$2g_3:null,$3G_3:null,$2Z_3:0,$4R_3:!1,get_DefaultContextForEmptyDropList:function(){return this.defaultContextForEmptyDropList},set_DefaultContextForEmptyDropList:function(n){this.defaultContextForEmptyDropList=n;return n},get_OptionText:function(){return this.$4a_3},set_OptionText:function(n){this.$4a_3=n;return n},get_OptionValue:function(){return this.$3D_3},set_OptionValue:function(n){this.$3D_3=n;return n},get_Results:function(){return this.$2_3},set_Results:function(n){this.$2_3=n;return n},get_InitialValue:function(){return this.$2V_3},set_InitialValue:function(n){this.$2V_3=n;return n},get_RefreshProperties:function(){return this.$2g_3},set_RefreshProperties:function(n){this.$2g_3=n;return n},get_RefreshWebServiceMethod:function(){return this.$B_3},set_RefreshWebServiceMethod:function(n){if(this.$B_3){this.$B_3.remove_Succeeded(this.$$d_$8P_3);this.$B_3.remove_Failed(this.$$d_$Aq_3);this.$B_3.remove_Completed(this.$$d_$Ap_3)}this.$B_3=n;if(this.$B_3){this.$B_3.add_Succeeded(this.$$d_$8P_3);this.$B_3.add_Failed(this.$$d_$Aq_3);this.$B_3.add_Completed(this.$$d_$Ap_3)}return n},get_value:function(){return this.get_element().value},set_value:function(n){EcpUtil.selectOption(this.get_element(),n);this.raisePropertyChanged("value");return n},get_starValue:function(){return this.get_value()&&this.get_value().startsWith("json:")?Sys.Serialization.JavaScriptSerializer.deserialize(this.get_value().substr(5)):null},set_starValue:function(n){this.set_value(this.$8n_3(n));return n},initialize:function(){EcpControl.prototype.initialize.call(this);_String.isNullOrEmpty(this.$2g_3)&&this.$77_3()},$77_3:function(){var e=this.get_value();this.get_element().innerHTML="";if(this.$2_3&&(!this.$2_3.Output||!this.$2_3.Output.length)&&!ErrorHandling.handlePreLoadTransientFailure(this.$2_3)){var h=this;var o=_Object.isNullOrUndefined(window.opener)?null:function(n,t){window.close()};ErrorHandling.showPowerShellErrorsWithCallback(this.$2_3,o)}var s=!_Object.isNullOrUndefined(this.defaultContextForEmptyDropList)&&this.defaultContextForEmptyDropList.length>0;var r=!!this.$2_3&&!!this.$2_3.Output&&this.$2_3.Output.length>0;if(r||s){for(var t=r?this.$2_3.Output:this.defaultContextForEmptyDropList,n=0;n<t.length;n++){var i=document.createElement("OPTION");if(_Object.isNullOrUndefined(this.$3D_3)){i.text=t[n].Text;i.value=t[n].Value;i.selected=t[n].Selected}else{i.value=this.$3D_3==="*"?this.$8n_3(t[n]):t[n][this.$3D_3];i.text=this.$4a_3?t[n][this.$4a_3]:i.value}EcpUtil.appendOption(this.get_element(),i)}if(this.$2V_3)this.$8s_3(this.$2V_3);else{var u=this.$7i_3(e);if(null!==u)u.selected=!0;else{var f=this.get_element().options;f.length>0&&(f[0].selected=!0)}}}else this.$2V_3&&this.$8s_3(this.$2V_3);this.raisePropertyChanged("value")},$8s_3:function(n){var i=this.$7i_3(n);if(null!==i)i.selected=!0;else{var t=document.createElement("OPTION");t.text=n;t.value=n;t.selected=!0;EcpUtil.appendOption(this.get_element(),t)}this.raisePropertyChanged("value")},$7i_3:function(n){var r=null;if(null!==n)for(var i=this.get_element().options,u=n.toLowerCase(),t=0;t<i.length;t++)if(i[t].value.toLowerCase()===u){r=i[t];break}return r},$8n_3:function(n){return"json:"+Sys.Serialization.JavaScriptSerializer.serialize(n)},$8P_3:function(n,t){if(t.get_userContext()===this.$2Z_3){this.$2_3=t.get_results();this.$77_3()}},$Aq_3:function(n,t){if(t.get_userContext()===this.$2Z_3){this.$2_3=null;this.$77_3()}},$Ap_3:function(n,t){if(t.get_userContext()===this.$2Z_3&&this.$4R_3){ControlHelper.enableDomElement(this.get_element(),!0);this.$4R_3=!1}},dispose:function(){EcpControl.prototype.dispose.call(this);this.$3G_3&&this.get_DataContext().remove_propertyChanged(this.$3G_3);if(this.$B_3){this.$B_3.remove_Succeeded(this.$$d_$8P_3);this.$B_3.remove_Failed(this.$$d_$Aq_3);this.$B_3.remove_Completed(this.$$d_$Ap_3)}},$Ao_3:function(n,t){if(this.$2g_3.toLowerCase().indexOf(t.get_propertyName().toLowerCase())>-1){this.$B_3.invoke(++this.$2Z_3);var i=this;window.setTimeout(function(){if(!i.$4R_3){i.$4R_3=!EcpUtil.domElementDisabled(i.get_element());ControlHelper.enableDomElement(i.get_element(),!1)}},0)}},onParentDataContextUpdated:function(){EcpControl.prototype.onParentDataContextUpdated.call(this);if(null!==this.$B_3&&!_String.isNullOrEmpty(this.$2g_3)){this.$3G_3||(this.$3G_3=this.$$d_$Ao_3);for(var r=this.$B_3.get_Parameters()[0],u=this.$2g_3.split("."),t=u,f=t.length,n=0;n<f;++n){var i=t[n];r.addBinding(i,new ViewModelBinding(this.get_DataContext(),i))}this.get_DataContext().add_propertyChanged(this.$3G_3);this.$B_3.invoke(++this.$2Z_3)}}};function WebServiceTreeSource(n){this.$$d_$A7_0=Function.createDelegate(this,this.$A7_0);this.$$d_$A8_0=Function.createDelegate(this,this.$A8_0);this.$$d_$9l_0=Function.createDelegate(this,this.$9l_0);this.$$d_$9m_0=Function.createDelegate(this,this.$9m_0);var t=EcpUrl.get_ecpFullUrl()+n.replace("~/","");this.$1w_0=new WebServiceMethod;this.$1w_0.add_Succeeded(this.$$d_$9m_0);this.$1w_0.add_Failed(this.$$d_$9l_0);this.$1w_0.set_MethodName("GetList");this.$1w_0.set_ServiceUrl(t);this.$1w_0.set_ParameterNames(7);this.$20_0=new WebServiceMethod;this.$20_0.add_Succeeded(this.$$d_$A8_0);this.$20_0.add_Failed(this.$$d_$A7_0);this.$20_0.set_MethodName("NewObject");this.$20_0.set_ServiceUrl(t);this.$20_0.set_ParameterNames(3)}WebServiceTreeSource.prototype={$5o_0:null,$32_0:null,$5P_0:null,$2t_0:null,$1w_0:null,$20_0:null,getRootParameter:function(){return[null,null]},commitNewNodeParameter:function(n,t){throw Error.notImplemented("override this class to set specified parameter for NewObject");},getRootNode:function(n,t){this.$1w_0.invokeWithArgs(this.getRootParameter(),null);this.$5o_0=n;this.$32_0=t},commitNewNode:function(n,t,i,r){this.$20_0.invokeWithArgs(this.commitNewNodeParameter(n,t),null);this.$5P_0=i;this.$2t_0=r},$9l_0:function(n,t){if(this.$32_0){this.$32_0([t.get_error().get_message()]);t.set_handled(!0)}},$9m_0:function(n,t){var i=t.get_results();if(i.ErrorRecords.length>0){if(this.$32_0){var u=EcpUtil.retrieveErrorMsgs(i);this.$32_0(u)}}else if(this.$5o_0){var r=null;i.Output.length>0&&(r=t.get_results().Output[0]);this.$5o_0(r,i.Warnings)}},$A7_0:function(n,t){if(this.$2t_0){this.$2t_0([t.get_error().get_message()]);t.set_handled(!0)}},$A8_0:function(n,t){var i=t.get_results();if(i.ErrorRecords.length>0){if(this.$2t_0){var r=EcpUtil.retrieveErrorMsgs(i);this.$2t_0(r)}}else i.Output.length>0&&this.$5P_0&&this.$5P_0(i.Output[0],i.Warnings)}};function WellKnownRecipientTypeControl(n){this.$$d_$AF_4=Function.createDelegate(this,this.$AF_4);WellKnownRecipientTypeControl.initializeBase(this,[n])}WellKnownRecipientTypeControl.prototype={$2n_4:null,initialize:function(){EcpControl.prototype.initialize.call(this);this.$2n_4=this.$$d_$AF_4;this.$2T_4.add_propertyChanged(this.$2n_4);this.$2l_4.add_propertyChanged(this.$2n_4)},dispose:function(){if(this.$2n_4){this.$2T_4.remove_propertyChanged(this.$2n_4);this.$2l_4.remove_propertyChanged(this.$2n_4)}EcpControl.prototype.dispose.call(this)},get_IncludeOnlySpecifiedRecipientTypesRadioButtonList:function(){return this.$2T_4},set_IncludeOnlySpecifiedRecipientTypesRadioButtonList:function(n){this.$2T_4=n;return n},$2T_4:null,get_SpecifiedRecipientTypesCheckBoxList:function(){return this.$2l_4},set_SpecifiedRecipientTypesCheckBoxList:function(n){this.$2l_4=n;return n},$2l_4:null,get_Value:function(){return this.$2T_4.get_value()==="true"?this.$2l_4.get_ValueString():"AllRecipients"},set_Value:function(n){var t=_Object.isNullOrUndefined(n)?"":n;this.$2T_4.set_value(t.indexOf("AllRecipients")<0?"true":"false");this.$2l_4.set_ValueString(t);return n},$AF_4:function(n,t){t.get_propertyName().toLowerCase()==="value"&&this.get_Value()&&this.raisePropertyChanged("value")}};function AjaxUploaderBinding(n,t){AjaxUploaderBinding.initializeBase(this,[n,t])}AjaxUploaderBinding.prototype={get_isDirty:function(){return ComponentBinding.prototype.get_isDirty.call(this)||this.get_$A3_2()},resetIsDirty:function(){ComponentBinding.prototype.resetIsDirty.call(this)},get_$A3_2:function(){return this.get_component().get_isUploading()}};function WizardPropertyUtil(){}WizardPropertyUtil.findParentSection=function(n){for(var t=n;t&&t.nodeType!==9;){if(t.id&&Sys.UI.DomElement.containsCssClass(t,CssClasses.section))return t;t=t.parentNode}return null};WizardPropertyUtil.scrollIntoViewInBaseForm=function(n,t){WizardPropertyUtil.showSectionByElement(n);var r=RtlUtil.getScrollLeft(window.top.document.body);n.scrollIntoView(t);r!==RtlUtil.getScrollLeft(window.top.document.body)&&RtlUtil.setScrollLeft(window.top.document.body,0);for(var i=n.parentNode;i.parentNode;i=i.parentNode){i.scrollTop&&AjaxControlToolkit.CommonToolkitScripts.getCurrentStyle(i,"overflowY")==="hidden"&&(i.scrollTop=0);RtlUtil.getScrollLeft(i)&&AjaxControlToolkit.CommonToolkitScripts.getCurrentStyle(i,"overflowX")==="hidden"&&RtlUtil.setScrollLeft(i,0)}};WizardPropertyUtil.getRadioButtonListValue=function(n){for(var i=n.getElementsByTagName("INPUT"),t=0;t<i.length;t++)if(i[t].type.toLowerCase()==="radio"&&i[t].checked)return i[t].value;return""};WizardPropertyUtil.toggleChildrenDisabled=function(n,t){if(!WizardPropertyUtil.$8q(n,t)&&!WizardPropertyUtil.isRbacDisabled(n)){WizardPropertyUtil.$8l(n,t);for(var i=0;i<n.childNodes.length;i++)WizardPropertyUtil.toggleChildrenDisabled(n.childNodes[i],t)}};WizardPropertyUtil.toggleNestedChildrenDisabled=function(n,t,i,r){if(t&&t.attributes&&n&&n.id&&n.id.length>0){var s=t.getAttribute(GlobalVariables.disablingElementIdsAttributeName);var u=null;s&&(u=WizardPropertyUtil.$Al(";",s));if(i){var h=!1;if(u){for(var f=0;f<u.length;f++)if(u[f]===n.id){h=!0;break}}else u=[];if(!h){Array.add(u,n.id);t.setAttribute(GlobalVariables.disablingElementIdsAttributeName,u.join(";"))}}else if(u){Array.remove(u,n.id)&&t.setAttribute(GlobalVariables.disablingElementIdsAttributeName,u.join(";"));if(u.length>0){if(null===WizardPropertyUtil.$7l(t))for(var e=0;e<t.childNodes.length;e++)WizardPropertyUtil.toggleNestedChildrenDisabled(n,t.childNodes[e],i,r?r:WizardPropertyUtil.isRbacDisabled(t));return}}}if(!r&&!WizardPropertyUtil.$8q(t,i)&&!WizardPropertyUtil.isRbacDisabled(t)){WizardPropertyUtil.$8l(t,i);for(var o=0;o<t.childNodes.length;o++)WizardPropertyUtil.toggleNestedChildrenDisabled(n,t.childNodes[o],i,r)}};WizardPropertyUtil.associateEncryptionAndPort=function(n,t,i){var r=n.targetControl;var u=n.associatedControl;if(!r||!u)throw Error.argument("context","The TargetControl or AssociatedControl is null or undefined");r.value==="None"||r.value==="Tls"?u.value=i:r.value==="Ssl"&&(u.value=t);FieldValidationAssistant.get_instance().setTextboxErrorProperties(u,null)};WizardPropertyUtil.isRbacDisabled=function(n){n.tagName==="INPUT"&&n.type.toLowerCase()==="radio"&&(n=n.parentNode);return n.attributes&&n.getAttribute(GlobalVariables.rbacDisabled)?n.getAttribute(GlobalVariables.rbacDisabled)==="true":!1};WizardPropertyUtil.submitForm=function(n){var t=$get("aspnetForm");UpdateProgressPopUp.showProgress(n);try{t.submit()}catch(i){UpdateProgressPopUp.progressCompleted();MessageBox.showMessage(Strings.get_FileUploadFailed(),MessageBoxType.error)}};WizardPropertyUtil.clientSide_FireDefaultButton=function(n,t,i){var r=n.rawEvent;var u=!0;if(!_Object.isNullOrUndefined(i)&&i(n)||r.keyCode===13&&!r.ctrlKey&&!EcpUtil.isActionElement(n.target)&&!WizardPropertyUtil.$B4(n)){if(t&&t.style.display!=="none"&&!t.disabled){_Object.isNullOrUndefined(i)&&ActiveElementMoniter.setActive(t);t.click();u=!1}n.stopPropagation();n.preventDefault()}return u};WizardPropertyUtil.$B4=function(n){return n.target&&(n.target.tagName.toLowerCase()==="textarea"||n.target.tagName.toLowerCase()==="select"||Sys.UI.DomElement.containsCssClass(n.target,"DropDown"))?!0:!1};WizardPropertyUtil.get_returnObjecType=function(){var n=EcpUrl.GetCurrWindowQuery(GlobalVariables.returnObjectObjectType);return n?parseInt(n):0};WizardPropertyUtil.showSectionByIndex=function(n){var t=$("div.section").each(function(t,i){var r=$(i);if(n===t){r.show();r.attr(AriaUtil.ariaHidden,"false");i.parentNode.parentNode.parentNode.scrollTop=0}else{r.hide();r.attr(AriaUtil.ariaHidden,"true")}})};WizardPropertyUtil.showSectionByElement=function(n){var i=WizardPropertyUtil.findParentSection(n);if(i){var t=i.getElementsByTagName("A");if(t&&t.length>0){var r=t[0];var u=Bookmark.findSelectedIndex(r);Bookmark.select(u)}}};WizardPropertyUtil.$Al=function(n,t){if(t&&t.length>0){var i=[];return t.split(n)}return null};WizardPropertyUtil.$7l=function(n){if(n.id){var t=$find(n.id);if(t&&t.set_enabled)return t}return null};WizardPropertyUtil.$8q=function(n,t){var i=WizardPropertyUtil.$7l(n);if(i){WizardPropertyUtil.isRbacDisabled(n)?i.set_enabled(!1):i.set_enabled(!t);return!0}return!1};WizardPropertyUtil.$8l=function(n,t){typeof n.disabled!="undefined"&&(n.disabled=t);if(n.tagName==="DIV"||n.tagName==="TR"||n.tagName==="SPAN")t?n.setAttribute("disabled",t):n.removeAttribute("disabled");else if(EcpUtil.isTextbox(n)){var i=n;if(t){if(FieldValidationAssistant.hasErrorMessage(i)){FieldValidationAssistant.get_instance().setTextboxErrorProperties(i,null);FieldValidationAssistant.get_instance().clearTextboxValidatorsErrors(i);i.setAttribute("ecpClearValidation","true")}}else if(i.getAttribute("ecpClearValidation")){i.removeAttribute("ecpClearValidation");FieldValidationAssistant.reEvaluateValidator(i,!1)}}};function WrappedRetry(){WrappedRetry.initializeBase(this)}WrappedRetry.prototype={get_ContentElement:function(){return this.$14_4},set_ContentElement:function(n){this.$14_4=n;return n},$14_4:null,$8M_4:null,$7Y_4:null,get_innerContent:function(){return String.format('<div class="wrappedRetryDiv" id="{0}_ctlDiv"></div>',this.get_modalDialog().get_id())},onPreShow:function(){Dialog.prototype.onPreShow.call(this);this.$8M_4=this.$14_4.parentNode;this.$7Y_4=$get(this.get_modalDialog().get_id()+"_ctlDiv");if(EcpUtil.isIE()&&this.get_ExceptionHandlerType()===2){var n=this.$14_4.innerHTML;this.$14_4.innerHTML=n}this.$7Y_4.appendChild(this.$14_4);this.$14_4.style.display="block"},onButtonClicked:function(n){if(n===ModalDialogResult.OK){var t=null;switch(this.get_ExceptionHandlerType()){case 2:t=WizardPropertyUtil.getRadioButtonListValue(this.$14_4);break;case 1:t=this.$4h_3;break}if(null!==t){_Object.copyDictionary(Sys.Serialization.JavaScriptSerializer.deserialize(t),this.get_webServiceMethod().get_oneOffParameters());var i=this;window.setTimeout(function(){i.invokeWebService.invokeMethod(null)},0)}}this.$8M_4.appendChild(this.$14_4);this.$14_4.style.display="none";this.get_modalDialog().close();this.onClose()}};Type.registerNamespace("Owa.UIControls");AjaxUploader.registerClass("AjaxUploader",ContainerControl);BaseForm.registerClass("BaseForm",EcpControl);Bookmark.registerClass("Bookmark",EcpControl);BulkEditPopupForm.registerClass("BulkEditPopupForm",BaseForm);EcpSelect.registerClass("EcpSelect",ContainerControl,IPickerLauncher);EcpCollectionEditor.registerClass("EcpCollectionEditor",EcpSelect);CertDomainCollectionEditor.registerClass("CertDomainCollectionEditor",EcpCollectionEditor);ClientUploadManager.registerClass("ClientUploadManager",Sys.Component,IValidatable);ContentPanelLayoutBehavior.registerClass("ContentPanelLayoutBehavior",Sys.UI.Behavior);ControlAssociationBehavior.registerClass("ControlAssociationBehavior",Sys.UI.Behavior);ControlAssociationContext.registerClass("ControlAssociationContext");ConvertFromDialingRuleEntries.registerClass("ConvertFromDialingRuleEntries",null,IConverter);DateTimePicker.registerClass("DateTimePicker",ContainerControl);DetailsTable.registerClass("DetailsTable",ContainerControl);DLPCollectionEditor.registerClass("DLPCollectionEditor",EcpCollectionEditor);PickerControlBase.registerClass("PickerControlBase",EcpSelect);PickerControl.registerClass("PickerControl",PickerControlBase);EcpTextBoxSelectBase.registerClass("EcpTextBoxSelectBase",PickerControl);EcpMultiSelect.registerClass("EcpMultiSelect",EcpTextBoxSelectBase);FingerprintLanguageCollectionEditor.registerClass("FingerprintLanguageCollectionEditor",EcpCollectionEditor);EmailAddressCollectionEditor.registerClass("EmailAddressCollectionEditor",EcpCollectionEditor);TeamMailboxUserCollectionEditor.registerClass("TeamMailboxUserCollectionEditor",EcpCollectionEditor);EcpSingleSelect.registerClass("EcpSingleSelect",EcpTextBoxSelectBase);ECPValidators.registerClass("ECPValidators");FocusablePanel.registerClass("FocusablePanel",Panel);FocusUtil.registerClass("FocusUtil");PropertiesWrapper.registerClass("PropertiesWrapper",ContainerControl,IPropertiesWebServiceExecutor,IWebServiceExecutor,ISelectionService,IComponent);ForwardEmailPropertiesWrapper.registerClass("ForwardEmailPropertiesWrapper",PropertiesWrapper,IInvoke);ForwardEmailInvokeContext.registerClass("ForwardEmailInvokeContext");FieldValidationAssistant.registerClass("FieldValidationAssistant",Sys.Component);FVAMouseEventHandler.registerClass("FVAMouseEventHandler");ElementValidatingEventArgs.registerClass("ElementValidatingEventArgs",Sys.EventArgs);FVABubble.registerClass("FVABubble",Sys.Component);FVASettings.registerClass("FVASettings",Sys.UI.Behavior);StaticVariables.registerClass("StaticVariables");HCWDomainCollectionEditor.registerClass("HCWDomainCollectionEditor",EcpCollectionEditor);InvokeWebService.registerClass("InvokeWebService",Sys.UI.Behavior,IInvoke);MultiInvokeContext.registerClass("MultiInvokeContext",null,IResetable);GroupedCheckBoxList.registerClass("GroupedCheckBoxList",ContainerControl);GroupedCheckBoxTree.registerClass("GroupedCheckBoxTree",ContainerControl);ImageUploader.registerClass("ImageUploader",AjaxUploader);InlineSelector.registerClass("InlineSelector",ContainerControl);FileChangedEventArgs.registerClass("FileChangedEventArgs",Sys.EventArgs);UploadCompletedEventArgs.registerClass("UploadCompletedEventArgs",Sys.EventArgs);LaunchPickerButton.registerClass("LaunchPickerButton",EcpSelect);MultiLineLabel.registerClass("MultiLineLabel",EcpControl);NameValueCollectionEditor.registerClass("NameValueCollectionEditor",EcpCollectionEditor);PeopleIdentityWithType.registerClass("PeopleIdentityWithType",Identity);PeopleIdentity.registerClass("PeopleIdentity",Identity);EcpCollectionEditorPeopleIdentity.registerClass("EcpCollectionEditorPeopleIdentity",PeopleIdentity);TreeBasedPicker.registerClass("TreeBasedPicker",Dialog,IEntryEditor);OUPicker.registerClass("OUPicker",TreeBasedPicker);OwaScriptsUtil.registerClass("OwaScriptsUtil",ContainerControl);OwaPickerUtil.registerClass("OwaPickerUtil",OwaScriptsUtil);EcpOwaPeoplePickerPassValue.registerClass("EcpOwaPeoplePickerPassValue");PopupForm.registerClass("PopupForm",BaseForm,IPopupForm);PickerFormBase.registerClass("PickerFormBase",PopupForm);SimpleProgressBar.registerClass("SimpleProgressBar",EcpControl);PostBackForm.registerClass("PostBackForm",BaseForm);PropertyPage.registerClass("PropertyPage",ContainerControl,IRefreshable,IWebServiceExecutor,ISelectionService,IComponent,IDataProvider);PropertyPageSheet.registerClass("PropertyPageSheet",ContainerControl);RecipientPickerControl.registerClass("RecipientPickerControl",PickerControl);RichTextEditor.registerClass("RichTextEditor",EcpControl,IValidatable);FormatBarState.registerClass("FormatBarState");RoleGroupPickerControl.registerClass("RoleGroupPickerControl",PickerControl);NormalizedRectangle.registerClass("NormalizedRectangle");SchedulerDOMCache.registerClass("SchedulerDOMCache");ToggleRangeBehavior.registerClass("ToggleRangeBehavior",Sys.UI.Behavior);SchedulerControl.registerClass("SchedulerControl",ContainerControl);SDOPropertySheet.registerClass("SDOPropertySheet",PropertyPageSheet);PropertiesExceptionHandlerContext.registerClass("PropertiesExceptionHandlerContext",ExceptionHandlerContext);SimpleRetry.registerClass("SimpleRetry",WebServiceExceptionHandler);SmtpAddressesEditor.registerClass("SmtpAddressesEditor",EcpSelect);StatisticsBar.registerClass("StatisticsBar",EcpControl);StatisticsBarData.registerClass("StatisticsBarData");TextAreaUtil.registerClass("TextAreaUtil");NodeInfo.registerClass("NodeInfo");NodeElementBase.registerClass("NodeElementBase");NodeElement.registerClass("NodeElement",NodeElementBase);NewNodeElement.registerClass("NewNodeElement",NodeElementBase);UploaderBase.registerClass("UploaderBase",ContainerControl,IValidatable,IUploader);WaterMarkedTextArea.registerClass("WaterMarkedTextArea",TextBox);WebServiceDropDown.registerClass("WebServiceDropDown",EcpControl);WebServiceTreeSource.registerClass("WebServiceTreeSource",null,ITreeSource);WellKnownRecipientTypeControl.registerClass("WellKnownRecipientTypeControl",ContainerControl);AjaxUploaderBinding.registerClass("AjaxUploaderBinding",ComponentBinding);WizardPropertyUtil.registerClass("WizardPropertyUtil");WrappedRetry.registerClass("WrappedRetry",SimpleRetry);ClientUploadManager.handlerClassKey="handlerClass";ClientUploadManager.uploadFileKey="uploadFile";ClientUploadManager.uploadParameterKey="parameters";ClientUploadManager.uploadHandlerFileName="UploadHandler.ashx";ClientUploadManager.$4F=null;EcpSelect.$86="mode";EcpSelect.$8e="single";EcpSelect.$88="multiple";EcpSingleSelect.fullValuePropertyName="FullValue";EcpTextBoxSelectBase.valuePropertyName="Value";FieldValidationAssistant.$3S=EcpControl.fvaErrorMessageAttributeName;FieldValidationAssistant.$3z=null;FieldValidationAssistant.$87=200;FVABubble.$M=null;StaticVariables.fieldInitialValue=null;OwaPickerUtil.owaOptionPeoplePickerDefaultDialogWidth=1200;OwaPickerUtil.owaOptionPeoplePickerDefaultDialogHeight=700;EcpOwaPeoplePickerPassValue.passValueDisplayName="DisplayName";EcpOwaPeoplePickerPassValue.passValueSmtpAddress="SmtpAddress";EcpOwaPeoplePickerPassValue.passValueRoutingType="RoutingType";EcpOwaPeoplePickerPassValue.passValueAllowMultipleSelection="AllowMultipleSelection";EcpOwaPeoplePickerPassValue.passValueAllowAddAsSmtpAddress="AllowAddAsSmtpAddress";EcpOwaPeoplePickerPassValue.passValueAllowPickerCallerType="PickerCallerType";EcpOwaPeoplePickerPassValue.passValueProperties="Properties";EcpOwaPeoplePickerPassValue.passValueMetadata="Metadata";EcpOwaPeoplePickerPassValue.passValueGalContactGuid="GALContactGuid";RichTextEditor.$7f='<img src="{0}" alt="{1}" title="{1}" /><div class="alertDivContent"></div>';SimpleRetry.$2M='<table cellpadding="0" cellspacing="0" class="MsgCtrl"><tr><td><table class="title"><tr><td class="ttlrw">{1}</td><td class="ttlrwp"></td><td class="ttlrwx"><img id="{0}_ImageX" class="imgx CommonSprite formletClose" alt="{2}" title="{2}" buttontype="Cancel" src="{6}" /><span id="{0}_ImageXAlter" class="imgx formletCloseAlter" title="{2}" buttontype="Cancel" >'+AriaUtil.closeIconFont+"</span>"+"</td>"+"</tr>"+"</table>"+"</td>"+"</tr>"+"<tr>"+'<td id="{0}_tdDlgBdy">'+'<table cellspacing="0" cellpadding="0" class="bdy">'+"<tr>"+'<td class="msgbox">'+'<div id="{0}_msgboxDiv" class="hw100">'+"{3}"+'<div class="acceptancedv chkboxDiv"><input id="{0}_chkbox" type="checkbox"><label id="{0}_chkbox_label" for="{0}_chkbox">'+"{4}"+"</label></div>"+"</div>"+"</td>"+"</tr>"+"<tr>"+'<td class="btnbox">'+"{5}"+"</td>"+"</tr>"+"</table>"+"</td>"+"</tr>"+"</table>";SimpleRetry.$2q='<button id="{0}" type="button" buttontype="{1}">{2}</button>';TreeBasedPicker.$2M='<table cellpadding="0" cellspacing="0" class="MsgCtrl" role="presentation"><tr><td><div class="title"><div class="ttlrwx"><img id="{0}_ImageX" src="{4}" class="imgx CommonSprite formletClose" alt="{2}" title="{2}" buttontype="Cancel" /><span id="{0}_ImageXAlter" class="imgx formletCloseAlter" title="{2}" buttontype="Cancel">'+AriaUtil.closeIconFont+"</span>"+"</div>"+'<div class="pickerTtlrw" tabindex="0">'+"{1}"+"</div>"+"</div>"+"</td>"+"</tr>"+"<tr>"+'<td id="{0}_tdDlgBdy">'+'<table cellspacing="0" cellpadding="0" class="bdy" role="presentation">'+"<tr>"+'<td id="{0}_toolbar"  class="{5} pickerToolbarPanel">'+'<table style="width: 100%">'+"<tr>"+'<td id ="{0}_searchbarpanel">'+"</td>"+"</tr>"+"</table>"+"</td>"+"</tr>"+"<tr>"+'<td class="msgbox hw100 treeDv">'+'<div id="{0}_msgboxDiv">'+'<div class="treeOutDiv">'+'<div id="{0}_errorDiv" style="display:none">'+'<div class="alertDivContent" '+AriaUtil.ariaRole+'="'+AriaUtil.ariaAlert+'"></div>'+"</div>"+'<div id="{0}_treeInDv" class="treeInDv" '+AriaUtil.ariaRole+'="'+AriaUtil.ariaTree+'" tabindex="0">'+'<div id="{0}_treeFrm" class="treeFrm">'+'<div id="{0}_loadingTree" stype="display: none" class="ProgressPanel"><span>{7}</span></div>'+'<div style="text-align: center; display: none;" class="ContentPanel NoItemTextPanel" id="{0}_noItemTextPanel" role="presentation">{6}</div>'+"</div>"+"</div>"+"</div>"+"</div>"+"</td>"+"</tr>"+"<tr>"+'<td class="pickerBtnBox {8}">'+"{3}"+"</td>"+"</tr>"+"</table>"+"</td>"+"</tr>"+"</table>";TreeBasedPicker.$7S="<div>{0}</div>";TreeBasedPicker.$7T='<div class="floatRight bottomButtonDiv">{0}</div>';TreeBasedPicker.$2q='<button id="{0}_{1}" type="button" buttontype="{1}">{2}</button>';NodeElementBase.nodeClass="nodeDv";NodeElement.nodeFmt='<div class="nodeDv"><div class="ec treeIcon" '+AriaUtil.ariaRole+'="'+AriaUtil.ariaPresentation+'"><img class="ec CommonSprite {0}" src="{3}" alt="{1}" title="{1}" '+AriaUtil.ariaRole+'="'+AriaUtil.ariaPresentation+"\"/><span title='{1}' class='"+"treeIconAlter"+"'>{4}</span></div>"+'<A tabindex="-1" style="display:inline" '+AriaUtil.ariaRole+'="'+AriaUtil.ariaPresentation+'"></A><A href="#" class="nodeA" title="{2}" tabindex="-1" hideFocus="-1" '+AriaUtil.ariaRole+'="'+AriaUtil.ariaPresentation+'">{2}</A>'+"</div>"+"<div "+AriaUtil.ariaRole+'="'+AriaUtil.ariaGroup+'">'+"</div>";NodeElement.$6L="nid";NewNodeElement.$8A='<div><img class="ec CommonSprite Blank" src="{1}" alt="" title="" /><A class="nodeA" href="#" title="{0}" tabindex="-1" hideFocus="-1">{0}</A></div><div></div>';NewNodeElement.$89='<div><img class="ec CommonSprite Blank" src="{0}" alt="" title="" /><input type="text" class="nodeInp" '+AriaUtil.ariaRole+'="'+AriaUtil.ariaTextBox+'"/>'+"</div>"+"<div></div>";UploaderBase.$45="uploaderForm";UploaderBase.$6z="submitting";UploaderBase.$2M='<html dir="'+(RtlUtil.isRtl?"rtl":"ltr")+'">'+'<body style="margin: 0px; border:0px; overflow:hidden">'+'<Form id="'+UploaderBase.$45+'" action="'+EcpUrl.get_ecpFullUrl()+"//Handlers//"+ClientUploadManager.uploadHandlerFileName+'" enctype="multipart/form-data" method="post">'+'<input type="file" id="'+ClientUploadManager.uploadFileKey+'"name="'+ClientUploadManager.uploadFileKey+'">'+'<input type="hidden" id="'+ClientUploadManager.uploadHandlerFileName+'" name="'+ClientUploadManager.handlerClassKey+'" value="{0}" />'+'<input type="hidden" id="'+ClientUploadManager.uploadParameterKey+'" name="'+ClientUploadManager.uploadParameterKey+'" />'+'<input type="hidden" id="'+Canary.ecpCanaryKey+'" name="'+Canary.ecpCanaryKey+'" />'+'<input type="hidden" id="'+Canary.ecpCanaryFromUserIdKey+'" name="'+Canary.ecpCanaryFromUserIdKey+'" />'+"</Form>"+"</body>"+"</html>";UploaderBase.$8v='<SPAN Class="'+CssClasses.uploaderErrorText+'">{0}</SPAN>{1}'