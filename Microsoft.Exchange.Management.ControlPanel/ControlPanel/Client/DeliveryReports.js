Type.registerNamespace("ECP");var RecipientDeliveryStatus=function(){};RecipientDeliveryStatus.prototype={unsuccessful:0,pending:1,delivered:2,transferred:3,read:4,all:99};RecipientDeliveryStatus.registerEnum("RecipientDeliveryStatus",!1);var BodyFormat=function(){};BodyFormat.prototype={plaintext:1,html:2,rtf:3};BodyFormat.registerEnum("BodyFormat",!1);function RefreshWebServiceListSource(n){var t=n.targetControl.control;t.get_InlineSelector().get_BrowseButton().style.visibility=t.get_value()===""?"":"hidden";n.associatedControl.control.refresh()}function DeliveryReportsSlab(n){this.$$d_$m_4=Function.createDelegate(this,this.$m_4);this.$$d_$R_4=Function.createDelegate(this,this.$R_4);this.$$d_$Y_4=Function.createDelegate(this,this.$Y_4);this.$$d_$k_4=Function.createDelegate(this,this.$k_4);this.$$d_$l_4=Function.createDelegate(this,this.$l_4);this.$$d_$o_4=Function.createDelegate(this,this.$o_4);this.$$d_$i_4=Function.createDelegate(this,this.$i_4);this.$$d_$n_4=Function.createDelegate(this,this.$n_4);DeliveryReportsSlab.initializeBase(this,[n])}DeliveryReportsSlab.prototype={$C_4:null,$D_4:null,$c_4:null,$U_4:null,$Q_4:null,$F_4:null,$6_4:null,$Z_4:null,$S_4:null,$X_4:null,$4_4:null,$H_4:null,$2_4:null,$3_4:null,$T_4:!1,$B_4:null,$L_4:"",get_FvaResource:function(){return this.$L_4},set_FvaResource:function(n){this.$L_4=n;return n},initialize:function(){EcpControl.prototype.initialize.call(this);this.$c_4=this.$9_4.get_InlineSelector().get_TextBox();this.$U_4=this.$1_4.get_InlineSelector().get_TextBox();this.$B_4=this.$$d_$n_4;FrameShowHide.add_shown(this.$B_4);this.$H_4.add_Invoking(this.$$d_$i_4);$addHandler(this.$C_4,"click",this.$$d_$o_4);$addHandler(this.$D_4,"click",this.$$d_$l_4);this.$Z_4=$get("searchParamsDiv");this.$S_4=$get("buttonsPanel");this.$X_4=$get(this.$4_4.get_id());this.$6_4.checked=!0;this.$1_4.set_disabled(!0);$addHandler(this.$6_4,"click",this.$$d_$k_4);$addHandler(this.$F_4,"click",this.$$d_$k_4);$addHandler(window,"resize",this.$$d_$Y_4);EcpUtil.isIE()?this.$Y_4(null):this.$R_4();try{this.$a_4()}catch(t){}AriaUtil.addFvaReaderSpan(this.get_element(),this.$L_4);var n=this;window.setTimeout(function(){AriaUtil.addAriaAttrFromPage(n.get_element())},0)},$n_4:function(n,t){this.$a_4()},$a_4:function(){this.$4_4.get_items().length>0?ActiveElementMoniter.setActive(this.$C_4):this.$2_4?ActiveElementMoniter.setActive(this.$2_4.get_InlineSelector().get_BrowseButton()):this.$6_4.checked?ActiveElementMoniter.setActive(this.$c_4):ActiveElementMoniter.setActive(this.$U_4)},dispose:function(){this.$H_4.remove_Invoking(this.$$d_$i_4);$removeHandler(this.$C_4,"click",this.$$d_$o_4);$removeHandler(this.$6_4,"click",this.$$d_$k_4);$removeHandler(this.$F_4,"click",this.$$d_$k_4);$removeHandler(this.$D_4,"click",this.$$d_$l_4);$removeHandler(window,"resize",this.$$d_$Y_4);if(this.$B_4){FrameShowHide.remove_shown(this.$B_4);this.$B_4=null}EcpControl.prototype.dispose.call(this)},$Y_4:function(n){window.setTimeout(this.$$d_$R_4,0)},$R_4:function(){var n=this.get_element().scrollHeight;var t=Math.max(200,n-this.$Z_4.offsetHeight-this.$S_4.offsetHeight);this.$X_4.style.height=t.toString()+"px"},get_ListView:function(){return this.$4_4},set_ListView:function(n){this.$4_4=n;return n},get_ListViewDataSource:function(){return this.$3_4},set_ListViewDataSource:function(n){this.$3_4=n;return n},get_ListViewRefreshMethod:function(){return this.$H_4},set_ListViewRefreshMethod:function(n){this.$H_4=n;return n},get_SearchButton:function(){return this.$C_4},set_SearchButton:function(n){this.$C_4=n;return n},get_ClearButton:function(){return this.$D_4},set_ClearButton:function(n){this.$D_4=n;return n},get_FromEditor:function(){return this.$1_4},set_FromEditor:function(n){this.$1_4=n;return n},$1_4:null,get_ToEditor:function(){return this.$9_4},set_ToEditor:function(n){this.$9_4=n;return n},$9_4:null,get_SubjectTextBox:function(){return this.$Q_4},set_SubjectTextBox:function(n){this.$Q_4=n;return n},get_FromAddressRadioButton:function(){return this.$F_4},set_FromAddressRadioButton:function(n){this.$F_4=n;return n},get_ToAddressRadioButton:function(){return this.$6_4},set_ToAddressRadioButton:function(n){this.$6_4=n;return n},get_MailboxPicker:function(){return this.$2_4},set_MailboxPicker:function(n){this.$2_4=n;return n},$o_4:function(n){if(FieldValidationAssistant.get_instance().highlightFieldsInError())MessageBox.showMessageWithCallback(Strings.get_DeliveryReportSearchFieldsInError(),MessageBoxType.error,this.$$d_$m_4);else{var t=this.$d_4();t?this.$b_4(t,this.$2_4.get_InlineSelector().get_BrowseButton()):this.$1_4.get_disabled()||this.$1_4.get_value()!==""?this.$3_4.search():this.$b_4(Strings.get_SenderRequiredErrorMessage(),this.$1_4.get_InlineSelector().get_BrowseButton())}},$b_4:function(n,t){var i=new Info;i.Message=n;i.MessageType=MessageBoxType.error;MessageBox.show(i,4,this.$$d_$m_4,t)},$d_4:function(){var n=null;this.$2_4&&!this.$2_4.get_value()&&(n=Strings.get_MailboxToSearchRequiredErrorMessage());return n},$m_4:function(n,t){var i=FieldValidationAssistant.get_instance().get_firstTextboxInError();if(i){var r=this;window.setTimeout(function(){ActiveElementMoniter.setActive(i)},100)}if(t){i=t;var u=this;window.setTimeout(function(){ActiveElementMoniter.setActive(i)},100)}},$l_4:function(n){if(this.$2_4){this.$2_4.get_InlineSelector().get_TextBox().value="";this.$2_4.set_value(null)}this.$9_4.reset();this.$1_4.reset();this.$Q_4.value="";this.$3_4.clear()},$i_4:function(n,t){if(this.$T_4){var i=this.$d_4();(i||FieldValidationAssistant.get_instance().highlightFieldsInError())&&t.set_cancel(!0)}else{t.set_cancel(!0);this.$T_4=!0}},$k_4:function(n){var t=n.target;if(t.id===this.$6_4.id){this.$1_4.set_disabled(!0);this.$9_4.set_disabled(!1)}else{this.$9_4.set_disabled(!0);this.$1_4.set_disabled(!1)}}};function DeliveryReportSummary(n){this.$$d_$e_4=Function.createDelegate(this,this.$e_4);this.$$d_$j_4=Function.createDelegate(this,this.$j_4);this.$$d_$h_4=Function.createDelegate(this,this.$h_4);this.$$d_$p_4=Function.createDelegate(this,this.$p_4);this.$I_4=99;DeliveryReportSummary.initializeBase(this,[n])}DeliveryReportSummary.SendDeliveryReport=function(n){var o=n.get_toolBar().get_OwnerControl();var s=o.get_Frame();var u="";_Window.isAccessible(s.contentWindow)&&(u=s.contentWindow.location.href);var f="";var a=o.get_ListView().get_selectedItems()[0].getCellText(0);var t=u.indexOf("?");t>0&&(f=u.substr(t+1));var i=null;var e=null;t=DeliveryReportSummary.$7.indexOf("?");e=t>0?DeliveryReportSummary.$7+"&"+f:DeliveryReportSummary.$7+"?"+f;var h=Strings.DeliveryReportEmailSubject(a);if(DeliveryReportSummary.$G){i=Strings.DeliveryReportEmailBody(EcpUtil.htmlEncode(e));var r={};r.Subject=h;r.Body=i;r.BodyFormat=2;DeliveryReportSummary.$8.invokeWithArgs([r],null)}else{var c=n.navigateUrl;i=String.format("{0}\n{1}",Strings.get_DeliveryReportEmailBodyForMailTo(),e);if(c&&c.length>0){var l=null;l=String.format(n.navigateUrl,encodeURIComponent(h),encodeURIComponent(i));PopupWindowManager.OpenWindow(l,"_blank",BuildCenteredWindowFeatureString(500,700,GlobalVariables.FeaturesForPopups))}}};DeliveryReportSummary.prototype={$4_4:null,$5_4:null,$M_4:null,$0_4:null,$P_4:null,$3_4:null,$O_4:null,$E_4:null,$K_4:null,$N_4:null,$W_4:!1,$V_4:!1,get_LargeRecipientsTextRow:function(){return this.$M_4},set_LargeRecipientsTextRow:function(n){this.$M_4=n;return n},get_RecipientsStatusLinksCell:function(){return this.$5_4},set_RecipientsStatusLinksCell:function(n){this.$5_4=n;return n},get_ListView:function(){return this.$4_4},set_ListView:function(n){this.$4_4=n;return n},get_ListViewDataSource:function(){return this.$3_4},set_ListViewDataSource:function(n){this.$3_4=n;return n},get_Status:function(){return this.$I_4},set_Status:function(n){this.$I_4=n;return n},get_RecipientCounts:function(){return this.$0_4},set_RecipientCounts:function(n){this.$0_4=n;this.$0_4&&this.$q_4();return n},get_IsOWA:function(){return DeliveryReportSummary.$G},set_IsOWA:function(n){DeliveryReportSummary.$G=n;return n},get_NewMailMessageWebServiceMethod:function(){return DeliveryReportSummary.$8},set_NewMailMessageWebServiceMethod:function(n){DeliveryReportSummary.$8=n;return n},get_DeliveryReportUrl:function(){return DeliveryReportSummary.$7},set_DeliveryReportUrl:function(n){DeliveryReportSummary.$7=n;return n},get_DeliveryStatusDataSourceRefreshMethod:function(){return this.$E_4},set_DeliveryStatusDataSourceRefreshMethod:function(n){this.$E_4=n;return n},initialize:function(){EcpControl.prototype.initialize.call(this);this.$P_4=this.$$d_$p_4;this.$N_4=this.$$d_$h_4;this.$3_4.add_refreshCompleted(this.$N_4);this.$O_4=this.$$d_$j_4;DeliveryReportSummary.$8.add_Succeeded(this.$O_4);this.$K_4=this.$$d_$e_4;this.$E_4.add_Invoking(this.$K_4)},dispose:function(){for(var t=this.$5_4.getElementsByTagName("a"),n=0;n<t.length;n++)$removeHandler(t[n],"click",this.$P_4);DeliveryReportSummary.$8.remove_Succeeded(this.$O_4);this.$E_4.remove_Invoking(this.$K_4);this.$3_4.remove_refreshCompleted(this.$N_4);EcpControl.prototype.dispose.call(this)},$e_4:function(n,t){if(!this.$W_4){t.set_cancel(!0);this.$W_4=!0}},$h_4:function(n,t){if(!this.$V_4){this.$4_4.get_items().length>1&&this.$r_4();this.$V_4=!0}},$j_4:function(n,t){var i=t.get_results();i.ErrorRecords&&i.ErrorRecords.length>0&&ErrorHandling.showPowerShellErrors(i);if(i.Output&&i.Output.length>0){var r=i.Output[0];var u=String.format("{0}&StoreId={1}",EcpUrl.get_owaMailComposeViewModelVDir(),encodeURIComponent(r.Identity.RawIdentity));var f=BuildCenteredWindowFeatureString(500,700,GlobalVariables.FeaturesForPopups);window.open(u,"_blank",f)}},$q_4:function(){this.$g_4();this.$0_4.Total<=this.$0_4.MaxRecipientsInList&&(this.$M_4.style.display="none")},$g_4:function(){this.$0_4.Total>0&&this.$A_4(99,this.$0_4.Total,!0);this.$0_4.Delivered>0&&this.$A_4(2,this.$0_4.Delivered,!1);this.$0_4.Pending>0&&this.$A_4(1,this.$0_4.Pending,!1);this.$0_4.Transferred>0&&this.$A_4(3,this.$0_4.Transferred,!1);this.$0_4.Unsuccessful>0&&this.$A_4(0,this.$0_4.Unsuccessful,!1)},$A_4:function(n,t,i){var r=document.createElement("a");i?r.style.color="gray":r.href="#";r.setAttribute("statusFilter",n);$addHandler(r,"click",this.$P_4);var f=this.$f_4(n);r.id="lnk_"+n;var u=document.createElement("span");u.innerHTML=this.$5_4.childNodes.length>1?"&nbsp;|&nbsp;":"&nbsp;&nbsp;&nbsp;";r.innerHTML=String.format("{0}&nbsp;{1}",t,EcpUtil.htmlEncode(f));this.$5_4.appendChild(u);this.$5_4.appendChild(r)},$f_4:function(n){var t="";switch(n){case 99:t=Strings.get_Recipients();break;case 2:t=Strings.get_Delivered();break;case 1:t=Strings.get_Pending();break;case 3:t=Strings.get_Transferred();break;case 0:t=Strings.get_Unsuccessful();break}return t},$p_4:function(n){if(n.target.getAttribute("href")){for(var i=this.$5_4.getElementsByTagName("a"),t=0;t<i.length;t++)if(i[t].id===n.target.id){i[t].style.color="gray";i[t].removeAttribute("href")}else{i[t].setAttribute("href","#");i[t].style.color="blue"}var r=n.target.attributes.getNamedItem("statusFilter");if(r){this.$I_4=Number.parseInvariant(r.value);this.$3_4.search()}}},$r_4:function(){var n=this.get_element().parentNode.parentNode;n.style.display="";DockPanel.relayoutParentDockPanel(n)}};DeliveryReportsSlab.registerClass("DeliveryReportsSlab",ContainerControl);DeliveryReportSummary.registerClass("DeliveryReportSummary",ContainerControl);DeliveryReportSummary.$8=null;DeliveryReportSummary.$G=!1;DeliveryReportSummary.$7=""