Type.registerNamespace("ECP");var OwaFeatureGroup=function(){};OwaFeatureGroup.prototype={communicationManagement:0,informationManagement:1,security:2,userExperience:3,timeManagement:4,max:4};OwaFeatureGroup.registerEnum("OwaFeatureGroup",!1);var PublicFolderPermissionRole=function(){};PublicFolderPermissionRole.prototype={reviewer:1025,contributor:1026,nonEditingAuthor:1043,author:1051,editor:1147,publishingAuthor:1243,publishingEditor:1275,owner:2043,custom:0};PublicFolderPermissionRole.registerEnum("PublicFolderPermissionRole",!1);var ServerRoleType=function(){};ServerRoleType.prototype={mixed:1,clientAccess:2,mailbox:3,hubTransport:4};ServerRoleType.registerEnum("ServerRoleType",!1);function AddressListSDOViewModel(){AddressListSDOViewModel.initializeBase(this)}AddressListSDOViewModel.prototype={get_ConditionTextList:function(){return EmailAddressPolicySDOViewModel.$1k(this)}};function BulkEditPaneViewModel(){BulkEditPaneViewModel.initializeBase(this)}BulkEditPaneViewModel.prototype={$1b_4:null,get_ServiceUrls:function(){return Sys.Serialization.JavaScriptSerializer.serialize(this.$1b_4)},set_ServiceUrls:function(n){this.$1b_4=Sys.Serialization.JavaScriptSerializer.deserialize(n);return n},initialize:function(){PropertyPageViewModel.prototype.initialize.call(this);if(window.parent){var t=Sys.Serialization.JavaScriptSerializer.deserialize(window.parent.BulkEditIdentities);var i=window.parent.BulkEditArguments;i&&this.setValue("BulkEditArgumentsStr",i);var r=window.parent.BulkEditFilter;r&&this.setValue("SearchText",r);this.setValue("BulkEditApplyToAllSelected",Strings.ApplyToAllSelected(t.length));var n=window.parent.bulkEditType;this.setValue("BulkEditType",n);var u=n==="SharedMailbox";this.setValue("IsSharedMailbox",u);this.setValue("BulkEditServiceUrl",this.$1b_4[n]);this.setValue("BulkEditShowContactAndOrganization",this.getBulkEditShowContactAndOrganization());this.setValue("identities",t)}},getBulkEditShowContactAndOrganization:function(){var n=this.getValue("BulkEditType");return n==="LinkedMailbox"?!1:!0}};function BulkEditPopupViewModel(){this.$$d_saveCommand_PreExecute=Function.createDelegate(this,this.saveCommand_PreExecute);this.$$d_onSaveProgress=Function.createDelegate(this,this.onSaveProgress);this.$$d_getSaveParameters=Function.createDelegate(this,this.getSaveParameters);this.$$d_$2V_5=Function.createDelegate(this,this.$2V_5);BulkEditPopupViewModel.initializeBase(this);DataLossReporting.add_report(this.$$d_$2V_5)}BulkEditPopupViewModel.prototype={$2C_5:null,$1I_5:!1,$13_5:null,$3_5:null,$2_5:null,$1g_5:!1,$1f_5:!1,get_progressUrl:function(){return this.$2C_5},set_progressUrl:function(n){this.$2C_5=n;return n},get_postUrl:function(){return this.$13_5},set_postUrl:function(n){this.$13_5=n;return n},get_checkDataChange:function(){return this.$1I_5},set_checkDataChange:function(n){this.$1I_5=n;return n},get_Results:function(){return PropertyPageViewModel.prototype.get_Results.call(this)},set_Results:function(n){this.get_IsSaved()&&this.$3_5&&Object.getType(this.$3_5)===Array&&this.$3_5.length>=10&&n&&(n.ErrorRecords=null);PropertyPageViewModel.prototype.set_Results.call(this,n);return n},get_reportDataLoss:function(){return!1},get_switchOffBulkProgressBar:function(){return this.$1g_5},set_switchOffBulkProgressBar:function(n){this.$1g_5=n;return n},get_showBulkMessageWithNoSuccessOrFailure:function(){return this.$1f_5},set_showBulkMessageWithNoSuccessOrFailure:function(n){this.$1f_5=n;return n},initialize:function(){PopupFormViewModel.prototype.initialize.call(this);this.$3_5=this.getValue("identities");if(this.$3_5){this.$2_5=null;this.setValue("BulkEditMultipleRecipientsSelected",Strings.MultipleRecipientsSelected(this.$3_5.length));this.$3_5.length<100?this.setValue("BulkEditNotificationMinute",""):this.$3_5.length<=500?this.setValue("BulkEditNotificationMinute",Strings.get_BulkEditNotificationMinuteLabel()):this.setValue("BulkEditNotificationMinute",Strings.get_BulkEditNotificationTenMinuteLabel());var n=new WebServiceCommand;n.init(this.$13_5,"MultiObjectExecute",this.$$d_getSaveParameters);n.get_webServiceMethod().set_ParameterNames(10);n.get_webServiceMethod().set_showBulkMessageWithNoSuccessOrFailure(this.$1f_5);this.$3_5.length<10||this.$1g_5?n.get_webServiceMethod().add_Progress(this.$$d_onSaveProgress):n.get_webServiceMethod().set_isLongRunning(!0);this.$1I_5&&n.set_preCheck(this.$$d_saveCommand_PreExecute);this.set_SaveCommand(n)}},getSaveParameters:function(){var n="schema";DatapointManager.addDatapoint(DatapointManager.constructDatapointString([EcpInstrumentationMarkers.bulkEdit,this.getValue("identities").length.toString()]),EcpUrl.getUrlParameter(this.$13_5,n));return[this.getValue("identities"),BulkEditHelper.BulkEditFilter(this.get_values())]},onSaveProgress:function(n,t){if(t.record){if(t.record.Errors&&t.record.Errors.length>0){var r=0;if(this.$2_5)r=this.$2_5.length;else{this.$2_5=new Array(t.record.Errors.length);r=0}for(var i=0;i<t.record.Errors.length;i++)this.$2_5[r+i]=t.record.Errors[i]}if(t.record.HasCompleted){this.get_SaveCommand().get_webServiceMethod().remove_Progress(this.$$d_onSaveProgress);TestHelper.raiseTestEvent(this,TestHelper.bulkEditComplete)}}},saveCommand_PreExecute:function(){if(!BulkEditHelper.BulkEditDataChanged(this.get_values())){DataLossReporting.suspendWarning();window.close();return!1}return!0},dispose:function(){DataLossReporting.remove_report(this.$$d_$2V_5);PropertyPageViewModel.prototype.dispose.call(this)},handleMessage:function(){var u=!!this.get_SaveCommand()&&this.get_Results()===this.get_SaveCommand().get_LastResults();if(this.$3_5&&Object.getType(this.$3_5)===Array&&this.$3_5.length<10&&u&&(this.$2_5&&this.$2_5.length>0||this.get_Results().Warnings&&this.get_Results().Warnings.length>0||this.get_Results().ErrorRecords&&this.get_Results().ErrorRecords.length>0)){var r=0;this.$2_5?r=this.$2_5.length:this.$2_5=new Array(0);if(this.get_Results().ErrorRecords)for(var n=0;n<this.get_Results().ErrorRecords.length;n++)this.$2_5[r+n]=this.get_Results().ErrorRecords[n];var i=null;if(this.get_Results().Warnings){i=new Array(0);for(var t=0;t<this.get_Results().Warnings.length;t++)i[t]=this.get_Results().Warnings[t]}this.get_Results().ErrorRecords=null;this.get_Results().Warnings=null;var f=BulkEditErrorDlg.showErrorDialog(this.$2_5,i);var e=this;f.add_closing(function(n,t){e.closeWindowAfterSave()})}else PropertyPageViewModel.prototype.handleMessage.call(this)},closeWindowAfterSave:function(){if(this.get_SaveCommand().get_webServiceMethod().get_isLongRunning()){DataLossReporting.suspendWarning();DialogManager.closeWindowAfterClose()}else PropertyPageViewModel.prototype.closeWindowAfterSave.call(this)},$2V_5:function(n,t){if(BulkEditHelper.BulkEditDataChanged(this.get_values())){t.turnOnHasChange();t.turnOnIsSaving()}}};function BulkEnableArchiveViewModel(){BulkEnableArchiveViewModel.initializeBase(this)}BulkEnableArchiveViewModel.prototype={get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.ArchiveDomain=this.get_AdhocValues().get_values().TargetDeliveryDomain;return n}};function BulkEditHelper(){}BulkEditHelper.BulkEditDataChanged=function(n){var t={};_Object.copyDictionary(n,t);delete t.identities;delete t.SearchText;var r=t;for(var u in r){var f={key:u,value:r[u]};var i=f.value;if(!f.key.startsWith("BulkEdit")&&i)return Object.getType(i)===String&&EcpUtil.isNullOrEmpty(i)?!1:!0}return!1};BulkEditHelper.BulkEditFilter=function(n){var t={};_Object.copyDictionary(n,t);delete t.identities;var r=t;for(var u in r){var f={key:u,value:r[u]};var i=f.value;(!i||Object.getType(i)===String&&EcpUtil.isNullOrEmpty(i))&&delete t[f.key]}return BulkEditHelper.$37(BulkEditHelper.MailboxQuotaHelper(t))};BulkEditHelper.MailboxQuotaHelper=function(n){(n.IssueWarningQuota||n.ProhibitSendQuota||n.ProhibitSendReceiveQuota)&&(n.UseDatabaseQuotaDefaults=!1);(n.RetainDeletedItemsFor||n.RetainDeletedItemsUntilBackup)&&(n.UseDatabaseRetentionDefaults=!1);return n};BulkEditHelper.$37=function(n){n.RetentionPolicy&&n.RetentionPolicy==="null"&&(n.RetentionPolicy=_String.empty);return n};function BulkEditCustomAttributesPopupViewModel(){this.$G_6={};BulkEditCustomAttributesPopupViewModel.initializeBase(this)}BulkEditCustomAttributesPopupViewModel.prototype={get_CustomAttributes:function(){return this.$G_6},set_CustomAttributes:function(n){if(this.$G_6!==n){var t=this.$G_6;for(var i in t){var e={key:i,value:t[i]};this.setProperty(e.key,null)}this.$G_6=n;var r=this.$G_6;for(var u in r){var f={key:u,value:r[u]};this.setProperty(f.key,f.value)}}return n}};function BulkEditErrorDlg(n,t){BulkEditErrorDlg.initializeBase(this);this.$Z_2=t;this.$2_2=n}BulkEditErrorDlg.showErrorDialog=function(n,t){var i=new BulkEditErrorDlg(n,t);i.show();return i};BulkEditErrorDlg.prototype={$N_2:null,$2_2:null,$Z_2:null,$r_2:null,$f_2:null,$B_2:null,add_closing:function(n){this.get_events().addHandler("Closing",n)},remove_closing:function(n){this.get_events().removeHandler("Closing",n)},get_className:function(){return"BulkEditErrorDlg"},get_contentHtml:function(){return this.$N_2},get_dialogID:function(){return this.get_modalDialog().get_id()},onInit:function(n){Dialog.prototype.onInit.call(this,n);this.$N_2=String.format('<table cellpadding="0" cellspacing="0" class="MsgCtrl"><tr><td id="{0}_tdDlgBdy"><table cellspacing="0" cellpadding="0" class="bdy"><tr><td class="msgbox"><div id="{0}_msgboxDiv" class="hw100 msgboxDiv"><div class="paddv"><div id="detailsPanel"><a id="copyToClipboard" href="#">{1}</a><br/><div id="errorsPanel" class="errorsPanel"></div></div></div></div></td></tr><tr><td class="btnbox" style="padding-top:24px;"><button id="{0}_Close">{2}</button></td></tr></table></td></tr></table>',n.get_id(),Strings.get_LongRunCopyToClipboardLabel(),Strings.get_Close())},onShowing:function(){this.$B_2=$($get("copyToClipboard",this.get_modalDialog().get_dialogFrame()));this.$r_2=$($get("errorsPanel",this.get_modalDialog().get_dialogFrame()));this.$f_2=$($get(String.format("{0}_Close",this.get_modalDialog().get_id()),this.get_modalDialog().get_dialogFrame()));this.$3C_2();if(EcpUtil.isIE()){var n=this;this.$B_2.click(function(t){t.preventDefault();if(n.$2_2){for(var i=new Sys.StringBuilder,f=n.$Z_2,s=f.length,r=0;r<s;++r){var h=f[r];i.appendLine(Strings.get_Warning());i.appendLine(h)}for(var e=n.$2_2,c=e.length,u=0;u<c;++u){var o=e[u];i.appendLine(Strings.get_Error());i.appendLine(o.TargetObject);i.appendLine(o.Message)}EcpUtil.copyTextToClipboard(i.toString())}})}else this.$B_2.hide();var t=this;this.$f_2.click(function(){t.$2U_2()});Dialog.prototype.onShowing.call(this)},dispose:function(){this.$1l_2();Sys.Component.prototype.dispose.call(this)},$2U_2:function(){this.$31_2();this.get_modalDialog().close();this.onClose()},onClose:function(){Dialog.prototype.onClose.call(this);this.$1l_2()},$31_2:function(){var n=this.get_events().getHandler("Closing");n&&n(this,Sys.EventArgs.Empty)},$3C_2:function(){if(this.$2_2&&this.$2_2.length||this.$Z_2&&this.$Z_2.length){window.clipboardData&&this.$B_2.show();for(var n=new Sys.StringBuilder,r=this.$Z_2,e=r.length,t=0;t<e;++t){var o=r[t];n.appendLine(String.format('<div><div><label style="font-weight:bold;" >{0}</label></div><div><span>{1}</span></div><hr style="margin:2px 0 2px 0"/></div>',Strings.get_LongRunWarningLabel(),o))}for(var u=this.$2_2,s=u.length,i=0;i<s;++i){var f=u[i];n.appendLine(String.format('<div><div><label style="font-weight:bold;" >{0}</label></div><div><span>{1}</span><br /></div><div><span>{2}</span></div><hr style="margin:2px 0 2px 0"/></div>',Strings.get_LongRunErrorLabel(),f.TargetObject,f.Message))}this.$r_2.html(n.toString())}else this.$B_2.hide()},$1l_2:function(){_Object.isNullOrUndefined(this.$B_2)||EcpControl.freejQueryObject(this.$B_2);_Object.isNullOrUndefined(this.$f_2)||EcpControl.freejQueryObject(this.$f_2);_Object.isNullOrUndefined(this.$r_2)||EcpControl.freejQueryObject(this.$r_2)}};function MailboxBulkEditPaneViewModel(){this.$$d_$27_5=Function.createDelegate(this,this.$27_5);this.$10_5=CrossSlabRefresher.createRefresher("MigrationBatches",!1,Strings.get_JumpToMigrationSlabConfirmation());this.$16_5=CrossSlabRefresher.createRefresher("MigrationBatches",!0,Strings.get_JumpToMigrationSlabConfirmation(),Strings.get_JumpToOffice365MigrationSlabFailed());MailboxBulkEditPaneViewModel.initializeBase(this)}MailboxBulkEditPaneViewModel.prototype={get_LocalMoveRefresher:function(){return this.$10_5},get_RemoteMoveRefresher:function(){return this.$16_5},get_CanShowMigration:function(){return this.get_AdhocValues().getProperty("EnterpriseHybrid")||this.get_AdhocValues().getProperty("LocalMoveRoles")},initialize:function(){BulkEditPaneViewModel.prototype.initialize.call(this);var n=this.get_Commands().getProperty("MigrationOnboardingCommand");n.add_preExecute(this.$$d_$27_5)},$27_5:function(n,t){ViewUserMailboxDetailsPageViewModel.preCheckOnboarding(this.get_AdhocValues().getProperty("OnPremiseLinkToOffice365"))||t.set_cancel(!0)}};function NewCertificateViewModel(){this.$$d_$2N_5=Function.createDelegate(this,this.$2N_5);this.$$d_saveCommand_PreExecute=Function.createDelegate(this,this.saveCommand_PreExecute);NewCertificateViewModel.initializeBase(this)}NewCertificateViewModel.prototype={$C_5:null,get_CertificateType:function(){return this.getValue("CertificateType")},set_CertificateType:function(n){this.setValue("CertificateType",n);n==="CertificateCA"?this.$1J_5("CA"):this.$1J_5("SelfSigned");return n},get_WildCard:function(){return this.getValue("WildCard")},set_WildCard:function(n){this.setValue("WildCard",n);if(this.$C_5&&this.get_CertificateType()==="CertificateCA"){this.$1J_5("CA");this.$2P_5(n)}return n},get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.FriendlyName=this.$2d_5();this.$2e_5(n);var f=this.$2f_5();_Object.isNullOrUndefined(f)||(n.SubjectName=f);var i=n.DomainName;if(!_Object.isNullOrUndefined(i)){for(var e=[],r=0;r<i.length;r++){var o=i[r];var u=o.Domain;if(o.IsDefault){var t=n.SubjectName;if(_Object.isNullOrUndefined(t))t="CN="+u;else{t+=",CN=";t+=u}n.SubjectName=t}Array.add(e,u)}n.DomainName=e}return n},initialize:function(){WizardViewModel.prototype.initialize.call(this);this.get_SaveCommand().set_preCheck(this.$$d_saveCommand_PreExecute);this.$C_5=this.findViewModelWithID("SelectCertificateType");this.set_CertificateType("CertificateCA")},saveCommand_PreExecute:function(){var n=this.get_SaveCommand();if(this.get_CertificateType()==="CertificateCA"){n.get_webServiceMethod().set_MethodName("NewCertificateCA");n.get_webServiceMethod().set_isLongRunning(!1);this.set_IsLongRunning(!1)}else{this.set_MessageHandler(this.$$d_$2N_5);n.get_webServiceMethod().set_MethodName("NewCertificateSelfSign");n.get_webServiceMethod().set_isLongRunning(!0);this.set_IsLongRunning(!0)}return!0},saveCommand_Completed:function(n,t){this.set_ReadOnDemand(!0);PropertyPageViewModel.prototype.saveCommand_Completed.call(this,n,t);this.set_ReadOnDemand(!1)},closeWindowAfterSave:function(){if(DialogManager.hasVisibleModalDialog()){DataLossReporting.suspendWarning();DialogManager.closeWindowAfterClose()}else this.get_CancelCommand().execute()},$1J_5:function(n){var t=this.$C_5;if(t){for(var i=0;i<this.get_ChildrenViewModels().length;i++){var r=this.get_ChildrenViewModels()[i].get_ViewModelID();if(t&&!r.indexOf(n)){t.set_NextViewModelID(r);t=this.get_ChildrenViewModels()[i]}}t.set_NextViewModelID(null)}},$2P_5:function(n){if(n){var r=this.findViewModelWithID("CACertificateServer");var u=this.findViewModelWithID("CACertificateCity");r&&u&&r.set_NextViewModelID(u.get_ViewModelID())}else{var f=this.findViewModelWithID("CACertificateCity");var e=this.findViewModelWithID("CACertificateServer");var t=this.findViewModelWithID("SelfSignedCertificateKnownDomain");var i=this.findViewModelWithID("SelfSignedCertificateDomain");i.set_NextViewModelID(null);t.set_NextViewModelID(null);if(e&&f&&t&&i){e.set_NextViewModelID(t.get_ViewModelID());t.set_NextViewModelID(i.get_ViewModelID());i.set_NextViewModelID(f.get_ViewModelID())}}},$2d_5:function(){var n=this.getValue("_FriendlyNameSelfSigned");if(!_Object.isNullOrUndefined(n))return n;n=this.getValue("_FriendlyNameCA");return _Object.isNullOrUndefined(n)?null:n},$2e_5:function(n){if(this.get_CertificateType()==="CertificateCA")n.Server=this.getValue("_ServerCA");else{var t=this.getValue("_ServerSelfSigned");if(t.length===1)n.Server=t[0];else{n.Server=t[0];for(var r=[],i=1;i<t.length;i++)Array.add(r,t[i]);n.ServerList=r}}},$2N_5:function(n,t,i){if(t){n.ErrorRecords=null;i()}},$s_5:function(n){return n.replace(new RegExp('"',"g"),'""')},$2f_5:function(){var i="";var n=new Sys.StringBuilder;var t=this.getValue("_Country");if(!_Object.isNullOrUndefined(t)){n.append(i);n.append("C=");n.append(t);i=","}t=this.getValue("_State");if(!_Object.isNullOrUndefined(t)){n.append(i);n.append('S="');n.append(this.$s_5(t));n.append('"');i=","}t=this.getValue("_City");if(!_Object.isNullOrUndefined(t)){n.append(i);n.append('L="');n.append(this.$s_5(t));n.append('"');i=","}t=this.getValue("_OrgName");if(!_Object.isNullOrUndefined(t)){n.append(i);n.append('O="');n.append(this.$s_5(t));n.append('"');i=","}t=this.getValue("_DeptName");if(!_Object.isNullOrUndefined(t)){n.append(i);n.append('OU="');n.append(this.$s_5(t));n.append('"');i=","}t=this.getValue("_DomainNameCA");if(!_Object.isNullOrUndefined(t)){n.append(i);n.append("CN=");n.append(t)}return n.isEmpty()?null:n.toString()}};function ImportCertificateViewModel(){this.$$d_$2N_5=Function.createDelegate(this,this.$2N_5);this.$$d_saveCommand_PreExecute=Function.createDelegate(this,this.saveCommand_PreExecute);ImportCertificateViewModel.initializeBase(this)}ImportCertificateViewModel.prototype={initialize:function(){WizardViewModel.prototype.initialize.call(this);this.get_SaveCommand().set_preCheck(this.$$d_saveCommand_PreExecute)},saveCommand_PreExecute:function(){var t=this.getValue("Servers");var n=this.get_SaveCommand();if(t.length===1){n.get_webServiceMethod().set_ParameterNames(4);n.get_webServiceMethod().set_MethodName("SetObject");n.get_webServiceMethod().set_isLongRunning(!1);this.set_IsLongRunning(!1)}else{this.set_MessageHandler(this.$$d_$2N_5);n.get_webServiceMethod().set_ParameterNames(10);n.get_webServiceMethod().set_MethodName("BulkEditWorflow");n.get_webServiceMethod().set_isLongRunning(!0);this.set_IsLongRunning(!0)}return!0},getSaveParameters:function(){var n=this.get_values();var t=n.Servers;delete n.Servers;return t.length===1?[t[0],n]:[t,n]},closeWindowAfterSave:function(){if(DialogManager.hasVisibleModalDialog()){DataLossReporting.suspendWarning();DialogManager.closeWindowAfterClose()}else this.get_CancelCommand().execute()},$2N_5:function(n,t,i){if(t){n.ErrorRecords=null;i()}}};function RenewCertificateViewModel(){RenewCertificateViewModel.initializeBase(this)}RenewCertificateViewModel.prototype={get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.DomainName=this.getValue("CertificateDomains");n.CertificateType=this.getValue("CertificateType");n.FriendlyName=this.getValue("FriendlyName");n.SubjectName=this.getValue("SubjectName");n.Thumbprint=this.getValue("Thumbprint");n.Services=this.getValue("Services");n.Server=this.getValue("Server");return n},initialize:function(){PropertyPageViewModel.prototype.initialize.call(this);var t=this.getValue("IsSelfSigned");t?this.setValue("CertificateType","CertificateSelfSigned"):this.setValue("CertificateType","CertificateCA");var i=this.getValue("FriendlyName");this.setValue("_CARenewHelp",Strings.RenewCertificateHelp(i));var r=this.getValue("Identity");var u=r.RawIdentity.split("\\");this.setValue("Server",u[0]);var n=this.getValue("Services");n==="none"?this.setValue("NewServices",null):this.setValue("NewServices",n)}};function CompleteCertificateViewModel(){CompleteCertificateViewModel.initializeBase(this)}CompleteCertificateViewModel.prototype={get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);var t=this.getValue("Identity");var i=t.RawIdentity.split("\\");n.Server=i[0];delete n.Identity;return n}};function EditCertificateViewModel(){this.$$d_$2a_4=Function.createDelegate(this,this.$2a_4);EditCertificateViewModel.initializeBase(this)}EditCertificateViewModel.prototype={get_IsMBXorCAS:function(){return this.getProperty("IsMBX")||this.getProperty("IsCAS")},initialize:function(){PropertyPageViewModel.prototype.initialize.call(this);var n=this.get_SaveCommand();n.get_webServiceMethod().get_shouldContinueExceptionHandler().add_cancelling(this.$$d_$2a_4);n.get_webServiceMethod().get_shouldContinueExceptionHandler().set_button(2);var t=this.getValue("Services");this.setValue("DisabledService",t);if(t==="none"){this.setValue("DisabledService",null);this.setValue("Services",null)}},dispose:function(){var n=this.get_SaveCommand();n.get_webServiceMethod().get_shouldContinueExceptionHandler().remove_cancelling(this.$$d_$2a_4);PropertyPageViewModel.prototype.dispose.call(this)},$2a_4:function(n,t){DataLossReporting.suspendWarning();window.close()}};function CertificateViewModelDomain(){CertificateViewModelDomain.initializeBase(this)}CertificateViewModelDomain.prototype={onNext:function(){this.$2Q_5();WebServiceWizardStepViewModel.prototype.onNext.call(this)},addToDomainName:function(n,t){if(!_Object.isNullOrUndefined(t)&&!_String.isNullOrEmpty(t)){for(var r=0;r<n.length;r++){var u=n[r].Domain;if(u.toLowerCase()===t.toLowerCase())return}var i={};i.Domain=t;i.Identity=new Identity(t.toLowerCase(),t.toLowerCase());i.IsDefault=!n.length;Array.add(n,i)}},getParameterValues:function(){var n={};n.ServerList=this.getValue("CertificateType")==="CertificateCA"?[this.getValue("_ServerCA")]:this.getValue("_ServerSelfSigned");return n},handleResults:function(n){WebServiceWizardStepViewModel.prototype.handleResults.call(this,n);if(n&&(!n.ErrorRecords||!n.ErrorRecords.length)){for(var i=new Array(n.Output.length),t=0;t<n.Output.length;t++){var e=n.Output[t];i[t]=e.AcceptedName}var r=[];var f=this.getValue("DomainName");f&&Array.addRange(r,f);for(var u=0;u<i.length;u++)this.addToDomainName(r,i[u]);this.setValue("DomainName",r)}},$2Q_5:function(){var n=[];var t=this.getValue("DomainName");if(t)for(var i=0;i<t.length;i++){var s=t[i];this.addToDomainName(n,s.Domain)}for(var e=this.getValue("_KnownDomain"),r=0;r<e.length;r++){var h=e[r];var u=h.Domain;if(!_Object.isNullOrUndefined(u)&&u!==Strings.get_DomainNoValue())for(var o=u.split(","),f=0;f<o.length;f++)this.addToDomainName(n,o[f])}this.setValue("DomainName",n)}};function CertificateKnownViewModel(){CertificateKnownViewModel.initializeBase(this)}CertificateKnownViewModel.prototype={onNext:function(){if(this.getValue("WildCard"))this.onNextCompleted(new GoNextStepCompletedEventArgs(!1,this.get_NextViewModelID()));else WebServiceWizardStepViewModel.prototype.onNext.call(this)},buildKnownDomain:function(n,t){var i={};i.OwaExternalDomain=Strings.get_OwaExternal();i.OwaInternalDomain=Strings.get_OwaInternal();i.OABExternalDomain=Strings.get_OABExternal();i.OABInternalDomain=Strings.get_OABInternal();i.WebServicesExternalDomain=Strings.get_WebServicesExternal();i.WebServicesInternalDomain=Strings.get_WebServicesInternal();i.MobileExternalDomain=Strings.get_MobileExternal();i.MobileInternalDomain=Strings.get_MobileInternal();i.AutoExternalDomain=Strings.get_AutoExternal();i.AutoInternalDomain=Strings.get_AutoInternal();i.PopDomain=Strings.get_Pop();i.ImapDomain=Strings.get_Imap();i.OutlookDomain=Strings.get_Outlook();var f=i;for(var e in f){var r={key:e,value:f[e]};var u={};var o=this.$2h_5(t,r.key);u.Identity=new Identity(r.value,r.value);u.AccessType=r.value;u.Domain=o;Array.add(n,u)}},handleResults:function(n){WebServiceWizardStepViewModel.prototype.handleResults.call(this,n);if(n&&(!n.ErrorRecords||!n.ErrorRecords.length)){var t=[];this.buildKnownDomain(t,n);this.setValue("_KnownDomain",t)}},getParameterValues:function(){var n={};n.ServerList=this.getValue("CertificateType")==="CertificateCA"?[this.getValue("_ServerCA")]:this.getValue("_ServerSelfSigned");return n},$2h_5:function(n,t){for(var i=0;i<n.Output.length;i++){var r=n.Output[i][t];if(r&&r!=="")return r}return null}};function DomainEditorViewModel(){DomainEditorViewModel.initializeBase(this)}DomainEditorViewModel.prototype={get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);if(this.getValue("DomainEditorMode")==="DomainName"){var t=n.DomainName;if(!_Object.isNullOrUndefined(t)&&t!==""){n.Identity=new Identity(t.toLowerCase(),t.toLowerCase());n.Domain=t}}else{var i=n.DomainKnown;n.Identity=new Identity(n.AccessType,n.AccessType);n.Domain=i===""?null:this.$2c_5(i)}return n},initialize:function(){PopupFormViewModel.prototype.initialize.call(this);var n=EcpUrl.getUrlParameter(window.location.href,"Mode");var i=EcpUrl.getUrlParameter(window.location.href,"Edit");if(_Object.isNullOrUndefined(n)){this.setValue("DefaultCheckBoxHidden",!0);this.setValue("DomainEditorMode","KnownDomain")}else{this.setValue("DefaultCheckBoxHidden",!1);this.setValue("DomainEditorMode","DomainName")}if(_Object.isNullOrUndefined(i))_Object.isNullOrUndefined(n)?this.setValue("Title",Strings.get_EditDomain()):this.setValue("Title",Strings.get_NewDomain());else{this.setValue("DefaultCheckBoxHidden",!0);this.setValue("Title",Strings.get_EditDomain())}this.setValue("DefaultCheckBox",this.getValue("IsDefault"));var t=this.getValue("Domain");this.getValue("DomainEditorMode")==="DomainName"?this.setValue("DomainName",t):this.setValue("DomainKnown",t)},$2c_5:function(n){if(n&&n!==""){for(var o=0,t=[],f=n.split(new RegExp("[\n ;,]+")),r=0;r<f.length;r++){var e=f[r].trim();e!==""&&(t[o++]=e)}if(t.length>0){for(var u=new Sys.StringBuilder,i=0;i<t.length;i++){i>0&&u.append(",");u.append(t[i])}return u.toString()}else return null}return n}};function DatabasesWebServiceListSource(n){this.$$d_$2W_5=Function.createDelegate(this,this.$2W_5);this.$$d_$2X_5=Function.createDelegate(this,this.$2X_5);this.$$d_$2Y_5=Function.createDelegate(this,this.$2Y_5);this.$$d_$33_5=Function.createDelegate(this,this.$33_5);this.$$d_$32_5=Function.createDelegate(this,this.$32_5);this.$D_5=0;DatabasesWebServiceListSource.initializeBase(this,[n])}DatabasesWebServiceListSource.prototype={$7_5:null,$w_5:!0,$l_5:null,$P_5:null,$O_5:null,get_DeferLoadWorkflowName:function(){return this.$l_5},set_DeferLoadWorkflowName:function(n){this.$l_5=n;return n},initialize:function(){WebServiceListSource.prototype.initialize.call(this);this.$O_5=this.$$d_$32_5;this.$P_5=this.$$d_$33_5;FrameShowHide.add_hiding(this.$O_5);FrameShowHide.add_shown(this.$P_5)},dispose:function(){this.$7_5=null;if(this.$O_5){FrameShowHide.remove_hiding(this.$O_5);this.$O_5=null}if(this.$P_5){FrameShowHide.remove_shown(this.$P_5);this.$P_5=null}WebServiceListSource.prototype.dispose.call(this)},add:function(n){ListSource.prototype.add.call(this,n);this.$E_5()},addRange:function(n,t){ListSource.prototype.addRange.call(this,n,t);this.$E_5()},insert:function(n,t){ListSource.prototype.insert.call(this,n,t);this.$E_5()},setAt:function(n,t){ListSource.prototype.setAt.call(this,n,t);this.$E_5()},setList:function(n,t){ListSource.prototype.setList.call(this,n,t);this.$E_5()},mergeAt:function(n,t,i){var r=this.getAt(n);r.IsFullyLoaded=!1;r.LoadRetryCount=0;ListSource.prototype.mergeAt.call(this,n,t,i);this.$E_5()},$E_5:function(){if(!EcpUtil.isNullOrBlank(this.$l_5)&&this.$D_5!==1){if(!this.$w_5){this.$D_5=2;return}this.$D_5=1;var n=this;window.setTimeout(function(){n.$1u_5()},100)}},$1u_5:function(){if(!this.$w_5){this.$D_5=2;return}for(var n=[],f=[],t=0;t<this.get_count();t++){var i=this.getAt(t);if(_Object.isNullOrUndefined(i)||!i.IsFullyLoaded){var r=_Object.isNullOrUndefined(i.LoadRetryCount)?0:i.LoadRetryCount;if(r>=3)continue;r++;i.LoadRetryCount=r;Array.add(f,DataBinder.getPropertyValue(this.getAt(t),"Name"));Array.add(n,DataBinder.getPropertyValue(this.getAt(t),this.get_identityProperty()));if(n.length>=5)break}}if(!this.$7_5){this.$7_5=new WebServiceMethod;this.$7_5.add_Succeeded(this.$$d_$2Y_5);this.$7_5.add_Failed(this.$$d_$2X_5);this.$7_5.add_Completed(this.$$d_$2W_5);this.$7_5.set_ServiceUrl(this.get_ServiceUrl());this.$7_5.set_MethodName(this.$l_5);this.$7_5.set_ParameterNames(7)}if(n.length>0){var u={};var e={};e.identities=n;u.DeferLoadIdentities=n;u.DeferLoadNames=f;this.$7_5.invokeWithArgs([u,null],e)}else this.$D_5=0},$2Y_5:function(n,t){var i=t.get_results();var o=t.get_userContext();if(i&&i.Output&&i.Output.length>0){for(var u=0;u<i.Output.length;u++){var r=i.Output[u];r.IsFullyLoaded=!0;r.LoadRetryCount=0;var e=DataBinder.getPropertyValue(r,this.get_identityProperty());var f={};f.RefreshSDO=!1;this.tryMergeRow(e,r,f)}this.updateColumnDictionary(i.Output[0])}},$2W_5:function(n,t){this.$1u_5()},$2X_5:function(n,t){t.set_handled(!0)},$33_5:function(n,t){this.$w_5=!0;this.$D_5===2&&this.$E_5()},$32_5:function(n,t){this.$w_5=!1}};function DatabaseSDOViewModel(){DatabaseSDOViewModel.initializeBase(this)}DatabaseSDOViewModel.prototype={get_RemovedDatabaseCopy:function(){return null},set_RemovedDatabaseCopy:function(n){if(!_Object.isNullOrUndefined(n)){var u=DataBinder.getPropertyValue(n,"DBCopyName");var f=DataBinder.getPropertyValue(n,"Identity");var e=DBConverters.ExtractServerFromDBCopyName(u);var r=EcpUtil.cloneArray(this.get_servers());Array.remove(r,e);for(var t=EcpUtil.cloneArray(this.get_databaseCopies()),i=0;i<t.length;i++)if(t[i].RawIdentity===f.RawIdentity){Array.removeAt(t,i);break}this.set_servers(r);var o=this;window.setTimeout(function(){o.set_databaseCopies(t)},0)}this.resetIsDirty();return n},get_servers:function(){return this.getProperty("Servers")},set_servers:function(n){this.setProperty("Servers",n);return n},get_databaseCopies:function(){return this.getProperty("DatabaseCopies")},set_databaseCopies:function(n){this.setProperty("DatabaseCopies",n);return n},get_Results:function(){return PropertyPageViewModel.prototype.get_Results.call(this)},set_Results:function(n){n&&n.ErrorRecords&&n.ErrorRecords.length||PropertyPageViewModel.prototype.set_Results.call(this,n);return n}};function DBConverters(){}DBConverters.ArrayCountToSequencePlusOne=function(n){var t=[];Array.add(t,"1");if(!_Object.isNullOrUndefined(n))for(var i=0;i<n.length;i++)Array.add(t,(i+2).toString());return t};DBConverters.ExtractServerFromDBCopyName=function(n){var t=n.split("\\");return t[1]};function EditDatabaseViewModel(){EditDatabaseViewModel.initializeBase(this)}EditDatabaseViewModel.prototype={get_UnlimitedOption:function(){return[ByteQuotaConverter.unlimited]}};function NewDatabaseViewModel(){NewDatabaseViewModel.initializeBase(this)}NewDatabaseViewModel.prototype={get_Name:function(){return this.getValue("Name")},set_Name:function(n){var i=this.getValue("Name");this.setValue("Name",n);if(!_Object.isNullOrUndefined(n)&&n!==i&&!_Object.isNullOrUndefined(this.getValue("Server"))){var t=this.getValue("Server").DataPath;if(!_Object.isNullOrUndefined(t)){this.setValue("EdbFilePath",t+"\\"+n+"\\"+n+".edb");this.setValue("LogFolderPath",t+"\\"+n)}}return n},get_Server:function(){return this.getValue("Server")},set_Server:function(n){var r=this.getValue("Server");this.setValue("Server",n);if(!_Object.isNullOrUndefined(n)&&n!==r){var i=n.DataPath;var t=this.getValue("Name");if(!_Object.isNullOrUndefined(t)){this.setValue("EdbFilePath",i+"\\"+t+"\\"+t+".edb");this.setValue("LogFolderPath",i+"\\"+t)}}return n},get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.Server=n.Server.Name;return n}};function DAGNetworkViewModel(){DAGNetworkViewModel.initializeBase(this)}DAGNetworkViewModel.prototype={get_valuesToSave:function(){var t=PropertyPageViewModel.prototype.get_valuesToSave.call(this);var i=t.Subnets;if(i){for(var r=[],n=0;n<i.length;++n)r[n]=i[n].SubnetIPAddress;t.Subnets=r}return t},handleSaveResult:function(n){n&&n.Warnings&&n.Warnings.length>0&&(n.Warnings=null);PropertyPageViewModel.prototype.handleSaveResult.call(this,n)}};function DAGSDOViewModel(){DAGSDOViewModel.initializeBase(this)}DAGSDOViewModel.prototype={get_RemovedDAGNetwork:function(){return null},set_RemovedDAGNetwork:function(n){if(!_Object.isNullOrUndefined(n)){for(var u=DataBinder.getPropertyValue(n,"Identity"),f=this.getProperty("DagNetworks"),t=EcpUtil.cloneArray(f),r=-1,i=0;i<t.length;++i)if(_Object.equals(t[i].Identity,u)){r=i;break}r!==-1&&Array.removeAt(t,r);var e=this;window.setTimeout(function(){e.setProperty("DagNetworks",t)},0)}this.resetIsDirty();return n}};function AddressTemplateConverter(){}AddressTemplateConverter.prototype={convertFrom:function(n){var t=n?n:{};var i=n;if(i){t.mustBePrimary=!0===n.mustBePrimary?!0:!1;if(i.Prefix){t.IsPrimaryAddress=EAPHelper.isReplyAddress(i);t.PrimaryPrefix=i.Prefix.toUpperCase();t.SecondaryPrefix=i.Prefix.toLowerCase();t.ValueString=i.AddressString}}return t},convertTo:function(n){var t={};var i=n;if(i){t.Prefix=i.IsPrimaryAddress?i.PrimaryPrefix:i.SecondaryPrefix;t.AddressString=i.ValueString;t.Identity=t.Prefix+":"+t.AddressString;t.ReplyAddress=i.IsPrimaryAddress;EAPHelper.updateEmailAddressTemplate(t)}return t}};function AddressTemplateViewModel(){AddressTemplateViewModel.initializeBase(this)}AddressTemplateViewModel.prototype={$b_6:null,$8_6:null,$i_6:null,$j_6:null,$k_6:null,$1Q_6:!1,$X_6:!1,$S_6:!1,$p_6:null,$1D_6:null,$1E_6:null,$1F_6:!1,get_currentIdentity:function(){return EAPHelper.ecpProxyAddressToString(this.get_values())},get_AcceptedDomain:function(){return this.$b_6},set_AcceptedDomain:function(n){if(this.$b_6!==n){this.$b_6=n;this.raisePropertyChanged("AcceptedDomain");this.$1C_6()}return n},get_AddressType:function(){return this.$8_6},set_AddressType:function(n){if(this.$8_6!==n){this.$8_6=n;this.raisePropertyChanged("AddressType");if(n){this.setValue("PrimaryPrefix",this.$8_6.toUpperCase());this.setValue("SecondaryPrefix",this.$8_6.toLowerCase())}}return n},get_CustomAddressType:function(){return this.$i_6},set_CustomAddressType:function(n){if(this.$i_6!==n){this.$i_6=n;this.raisePropertyChanged("CustomAddressType");this.$1c_6()}return n},get_CustomDomain:function(){return this.$j_6},set_CustomDomain:function(n){if(this.$j_6!==n){this.$j_6=n;this.raisePropertyChanged("CustomDomain");this.$1C_6()}return n},get_CustomEmailAddressFormat:function(){return this.$k_6},set_CustomEmailAddressFormat:function(n){if(this.$k_6!==n){this.$k_6=n;this.raisePropertyChanged("CustomEmailAddressFormat");this.$1A_6()}return n},get_EmailAddressFormat:function(){return this.$p_6},set_EmailAddressFormat:function(n){if(this.$p_6!==n){this.$p_6=n;this.raisePropertyChanged("EmailAddressFormat");this.setValue("ValueString",n)}return n},get_UseCustomEmailAddressFormat:function(){return this.$X_6},set_UseCustomEmailAddressFormat:function(n){if(this.$X_6!==n){this.$X_6=n;this.raisePropertyChanged("UseCustomEmailAddressFormat");this.$1c_6();this.$1A_6()}return n},get_IsAdvancedView:function(){return this.$1Q_6},set_IsAdvancedView:function(n){if(this.$1Q_6!==n){this.$1Q_6=n;this.raisePropertyChanged("IsAdvancedView")}return n},get_isPrimaryReplyAddress:function(){return this.$S_6},set_isPrimaryReplyAddress:function(n){if(this.$S_6!==n){this.$S_6=n;this.raisePropertyChanged("IsPrimaryReplyAddress");this.setValue("IsPrimaryAddress",this.$S_6)}return n},get_SmtpEmailAddressFormat:function(){return this.$1D_6},set_SmtpEmailAddressFormat:function(n){if(this.$1D_6!==n){this.$1D_6=n;this.raisePropertyChanged("SmtpEmailAddressFormat");this.$1A_6()}return n},get_SmtpEmailAddressLocalPartFormat:function(){return this.$1E_6},set_SmtpEmailAddressLocalPartFormat:function(n){if(this.$1E_6!==n){this.$1E_6=n;this.raisePropertyChanged("SmtpEmailAddressLocalPartFormat");this.$1C_6()}return n},get_UseAcceptedDomain:function(){return this.$1F_6},set_UseAcceptedDomain:function(n){if(this.$1F_6!==n){this.$1F_6=n;this.raisePropertyChanged("UseAcceptedDomain");this.$1C_6()}return n},onValueInitialized:function(){NotifyPropertyChangedJson.prototype.onValueInitialized.call(this);if(this.$2w_6()){var n=this.get_values();this.set_AddressType(EAPHelper.getPrefixString(n));this.set_isPrimaryReplyAddress(n.IsPrimaryAddress);this.$8_6.toLowerCase()==="SMTP".toLowerCase()&&EAPHelper.isLocalPartPredefined(n.ValueString)?this.$2u_6():this.$2t_6()}else this.$2v_6();this.setValue("PrimaryPrefix",this.$8_6.toUpperCase());this.setValue("SecondaryPrefix",this.$8_6.toLowerCase());this.setValue("ValueString",this.$p_6);this.setValue("IsPrimaryAddress",this.$S_6)},$1C_6:function(){var n=this.$1F_6?this.$b_6:this.$j_6;var t;var i="";if(n&&n.length>0){t=this.$1E_6;i=t+"@"+n}this.set_SmtpEmailAddressFormat(i)},$1c_6:function(){this.set_AddressType(this.$X_6?this.$i_6:"SMTP")},$1A_6:function(){this.set_EmailAddressFormat(this.$X_6?this.$k_6:this.$1D_6)},$2w_6:function(){var n=EAPHelper.getEmailAddressFormat(this.get_values());return!!n&&n.length>0},$2t_6:function(){this.set_CustomAddressType(this.$8_6);this.set_CustomEmailAddressFormat(this.get_values().ValueString);this.set_IsAdvancedView(!0);this.set_UseCustomEmailAddressFormat(!0)},$2u_6:function(){var n;var t;var i,r;EAPHelper.parseSmtpEmailAddress(this.get_values(),i={val:n},r={val:t});n=i.val;t=r.val;this.set_SmtpEmailAddressLocalPartFormat(n?n:"%m");this.set_UseAcceptedDomain(!1);this.set_CustomDomain(t)},$2v_6:function(){this.set_SmtpEmailAddressLocalPartFormat("%m");this.set_isPrimaryReplyAddress(this.getValue("mustBePrimary"));this.$1c_6();this.$1A_6();this.set_UseAcceptedDomain(!0)}};function EAPHelper(){}EAPHelper.get_emailAddressTemplateLocalPartTexts=function(){if(!EAPHelper.$6){EAPHelper.$6={};EAPHelper.$6["%m"]=Strings.get_UseAlias();EAPHelper.$6["%g.%s"]=Strings.get_FirstNameLastName();EAPHelper.$6["%1g%s"]=Strings.get_FirstNameInitialLastName();EAPHelper.$6["%g%1s"]=Strings.get_FirstNameLastNameInitial();EAPHelper.$6["%s.%g"]=Strings.get_LastNameFirstName();EAPHelper.$6["%1s%g"]=Strings.get_LastNameInitialFirstName();EAPHelper.$6["%s%1g"]=Strings.get_LastNameFirstNameInitial()}return EAPHelper.$6};EAPHelper.isSmtpAddress=function(n){return n.Prefix.toUpperCase()===GlobalVariables.primarySMTPPrefix};EAPHelper.isReplyAddress=function(n){return n.Prefix.toUpperCase()===n.Prefix};EAPHelper.isLocalPartPredefined=function(n){var t=n.split("@");if(n&&t.length===2){var u=t[0].toLowerCase();var i=EAPHelper.get_emailAddressTemplateLocalPartTexts();for(var r in i){var f={key:r,value:i[r]};if(f.key.toString().toLowerCase()===u)return!0}}return!1};EAPHelper.getEmailAddressDisplayString=function(n){var r=n.AddressString;if(EAPHelper.isSmtpAddress(n)){var t=n.AddressString.split("@");var i=EAPHelper.get_emailAddressTemplateLocalPartTexts()[t[0]];i||(i=t[0]);r=i+"@"+t[1]}return r};EAPHelper.parseSmtpEmailAddress=function(n,t,i){t.val=i.val="";var r=n.ValueString;if(r){var u=r.split("@");t.val=u[0];i.val=u[1]}};EAPHelper.getEmailAddressFormat=function(n){return n.ValueString};EAPHelper.getPrefixString=function(n){return n.IsPrimaryAddress?n.PrimaryPrefix:n.SecondaryPrefix};EAPHelper.ecpProxyAddressToString=function(n){return EAPHelper.getPrefixString(n)+":"+n.ValueString};EAPHelper.updateEmailAddressTemplate=function(n){n.DisplayString=EAPHelper.getEmailAddressDisplayString(n);return n};EAPHelper.getPrecedingLabel=function(n){return n===1?Strings.get_PrimaryAddressLabel():Strings.AddressLabel(n)};EAPHelper.getJoinedString=function(n,t){for(var r=new Sys.StringBuilder,i=0;i<n.length;i++){var u=n[i];i>0&&r.append(t);r.append(u)}return r.toString()};function EmailAddressPolicySDOViewModel(){EmailAddressPolicySDOViewModel.initializeBase(this)}EmailAddressPolicySDOViewModel.$1k=function(n){var t=[];var i=[];var r=" "+Strings.get_ConditionValueSeparator()+" ";var f=n.getProperty("RecipientContainer");f&&f.DisplayName&&Array.add(t,Strings.RecipientContainerText(f.DisplayName));var e=n.getProperty("ConditionalStateOrProvince");e&&e.length>0&&Array.add(t,Strings.StateOrProvinceConditionText(EAPHelper.getJoinedString(e,r)));var o=n.getProperty("ConditionalCompany");o&&o.length>0&&Array.add(t,Strings.CompanyConditionText(EAPHelper.getJoinedString(o,r)));var s=n.getProperty("ConditionalDepartment");s&&s.length>0&&Array.add(t,Strings.DepartmentConditionText(EAPHelper.getJoinedString(s,r)));for(var u=1;u<=15;u++){var h=n.getProperty("ConditionalCustomAttribute"+u.toString());h&&h.length>0&&Array.add(t,Strings.CustomAttributeConditionText(u,EAPHelper.getJoinedString(h,r)))}var l=n.getProperty("IncludeRecipientDescription");if(!EcpUtil.isNullOrEmpty(l)){var a=ValueConverter.StringSplit(l,",");Array.addRange(i,a)}Array.addRange(i,t);for(var c=0;c<i.length-1;c++)i[c]+=",";return i};EmailAddressPolicySDOViewModel.prototype={get_EmailAddressesByTypes:function(){for(var i=this.$2n_5(),r=[],u="",f=null,e=0,n=0;n<i.length;n++){var o=i[n];var s=o.Prefix.toUpperCase();if(s!==u){e=0;var t={};t.Type=u=s;t.EmailAddressList=f=[];Array.add(r,t)}var h=EAPHelper.getPrecedingLabel(++e)+EAPHelper.getEmailAddressDisplayString(o);Array.add(f,h)}return r},get_ConditionTextList:function(){return EmailAddressPolicySDOViewModel.$1k(this)},$2n_5:function(){var n=this.getValue("EnabledEmailAddressTemplates");_Object.isNullOrUndefined(n)&&(n=[]);var t=this;n.sort(function(n,t){var i=n;var r=t;var u=i.Prefix.toUpperCase().localeCompare(r.Prefix.toUpperCase());if(!u){var f=EAPHelper.isReplyAddress(i);var e=EAPHelper.isReplyAddress(r);u=f||e?f?-1:1:i.AddressString.localeCompare(r.AddressString)}return u});return n}};function EmailAddressPolicyViewModel(){EmailAddressPolicyViewModel.initializeBase(this)}EmailAddressPolicyViewModel.prototype={$T_5:null,$14_5:null,get_PriorityOptions:function(){if(!0===this.getValue("IsDefaultPolicy")){var n=[];Array.addRange(n,this.get_$2B_5());Array.add(n,this.getValue("PriorityText"));return n}else return this.get_$2B_5()},get_$1X_5:function(){if(!this.$T_5){var n=UrlUtil.getParameter(EcpUrl.priorityParameter);this.$T_5=n?Number.parseInvariant(n):1;this.$T_5<1&&(this.$T_5=1)}return this.$T_5},get_$2B_5:function(){if(!this.$14_5){this.$14_5=new Array(this.get_$1X_5());for(var n=0;n<this.get_$1X_5();n++)this.$14_5[n]=(n+1).toString()}return this.$14_5},onValueInitialized:function(){NotifyPropertyChangedJson.prototype.onValueInitialized.call(this);this.getValue("PriorityText")||this.setValue("PriorityText",this.get_$1X_5().toString());this.$3B_5()},$3B_5:function(){var n=this.getValue("EnabledEmailAddressTemplates");if(n){for(var t=0;t<n.length;t++)EAPHelper.updateEmailAddressTemplate(n[t]);this.raisePropertyChanged("EnabledEmailAddressTemplates")}}};function EmailAddressViewModelBase(){EmailAddressViewModelBase.initializeBase(this)}EmailAddressViewModelBase.prototype={get_currentIdentity:function(){return this.getValue("Identity")},initialize:function(){this.set_UseSetObject(!1);PopupFormViewModel.prototype.initialize.call(this)},validateSave:function(){var n=PropertyPageViewModel.prototype.validateSave.call(this);if(n){var t=this.getValue("existingItems");if(t){var i=this.getValue("originalIdentity");var r=this.get_currentIdentity();var u=r?t[r.toLowerCase()]:null;var f=i?t[i.toLowerCase()]:null;if(i!==r&&u&&u!==f){n=!1;var e=this;window.setTimeout(function(){MessageBox.showMessage(Strings.get_AddressExists(),MessageBoxType.error)},0)}}}return n}};function DenyIsAnyDomainValidator(n){DenyIsAnyDomainValidator.initializeBase(this,[n])}DenyIsAnyDomainValidator.prototype={validate:function(n){if(n)throw Error.create(Strings.get_SharingRuleEntryDomainConflict());}};function DenySpecifiedDomainsValidator(n){DenySpecifiedDomainsValidator.initializeBase(this,[n])}DenySpecifiedDomainsValidator.prototype={validate:function(n){if(!_Object.isNullOrUndefined(this.get_validatorInfo().Domains))for(var t=0;t<this.get_validatorInfo().Domains.length;t++)if(!_Object.isNullOrUndefined(this.get_validatorInfo().Domains[t])&&this.get_validatorInfo().Domains[t]===n)throw Error.create(Strings.get_SharingRuleEntryDomainConflict());}};function DenySpecifiedDomainsValidatorInfo(){DenySpecifiedDomainsValidatorInfo.initializeBase(this)}DenySpecifiedDomainsValidatorInfo.prototype={Domains:null};function EditSharingEnabledDomainsViewModel(){EditSharingEnabledDomainsViewModel.initializeBase(this)}EditSharingEnabledDomainsViewModel.prototype={handleSaveResult:function(n){(!_PowerShellResults.hasError(n)||n.ErrorRecords[0].Context.LastOuput.ExecutedStep)&&(_Window.getOpener(window.self)?PopupWindowManager.tryRefreshOpener(window.self,n):_Window.getParent(window.self)&&PopupWindowManager.tryRefreshParent(window.self,n))},updateResults:function(){this.get_isFirstResults()&&PropertyPageViewModel.prototype.updateResults.call(this);if(this.get_Results()){if(_PowerShellResults.hasError(this.get_Results())&&!this.get_Results().ErrorRecords[0].Context.LastOuput.ExecutedStep)return;var t=null;var n=null;_PowerShellResults.hasError(this.get_Results())?n=this.get_Results().ErrorRecords[0].Context.LastOuput:this.get_Results().Output&&this.get_Results().Output.length>0&&(n=this.get_Results().Output[0]);if(n){t=n;this.set_Identity(DataBinder.getPropertyValue(t,"Identity"));this.raisePropertyChanged("DefaultCaptionText")}this.reInitialize(t,null,!1)}}};function NewSharingPolicyViewModel(){NewSharingPolicyViewModel.initializeBase(this)}function SharingPolicyViewModelBase(){SharingPolicyViewModelBase.initializeBase(this)}SharingPolicyViewModelBase.prototype={get_Domains:function(){return this.getValue("Domains")},set_Domains:function(n){if(n&&n.length){this.setValue("Domains",n);this.updateValidators()}else{this.get_Validators().setProperty("IsAnyDomain",null);this.get_Validators().setProperty("Domain",null);this.setValue("Domains",n)}return n},updateValidators:function(){if(this.get_Validators()){var i=this.get_Validators();i.setProperty("IsAnyDomain",null);var n=this.getProperty("Domains");var u=new Array(_Object.isNullOrUndefined(n)?0:n.length);if(!_Object.isNullOrUndefined(n))for(var t=0;t<n.length;t++){var f=n[t];if(f.IsAnyDomain){var e=new ValidatorInfo;e.Type="DenyIsAnyDomainValidator";i.setProperty("IsAnyDomain",[e])}u[t]=f.Domain}var r=new DenySpecifiedDomainsValidatorInfo;r.Domains=u;r.Type="DenySpecifiedDomainsValidator";i.setProperty("Domain",[r])}}};function EditSharingPolicyViewModel(){EditSharingPolicyViewModel.initializeBase(this)}EditSharingPolicyViewModel.prototype={updateResults:function(){PropertyPageViewModel.prototype.updateResults.call(this);this.get_isFirstResults()&&this.updateValidators()}};function FederationViewModel(){FederationViewModel.initializeBase(this)}FederationViewModel.prototype={refresh:function(){this.get_LoadCommand().execute()},refreshObject:function(n){return},handleMessage:function(){this.handleMessageInternal(!1)}};function OrgRelPropertyPageViewModel(){OrgRelPropertyPageViewModel.initializeBase(this);this.addPropertyMapping("FreeBusyAccessScope","IsFreeBusyAccessScopeSet")}OrgRelPropertyPageViewModel.prototype={$R_4:!1,$1O_4:null,get_FreeBusyAccessEnabled:function(){return this.getValue("FreeBusyAccessEnabled")},set_FreeBusyAccessEnabled:function(n){this.setValue("FreeBusyAccessEnabled",n);this.raisePropertyChanged("FreeBusyAccessScopeEnabled");return n},get_IsFreeBusyAccessScopeSet:function(){return this.$R_4},set_IsFreeBusyAccessScopeSet:function(n){this.$R_4=n;n||this.set_$x_4(null);this.raisePropertyChanged("FreeBusyAccessScopeEnabled");return n},get_FreeBusyAccessScope:function(){return this.$1O_4},set_FreeBusyAccessScope:function(n){this.$1O_4=n;this.$R_4&&this.set_$x_4(n);return n},get_FreeBusyAccessScopeEnabled:function(){return this.$R_4&&this.get_FreeBusyAccessEnabled()},get_$x_4:function(){return this.getValue("FreeBusyAccessScope")},set_$x_4:function(n){this.setValue("FreeBusyAccessScope",n);return n},updateResults:function(){PropertyPageViewModel.prototype.updateResults.call(this);this.$1O_4=this.get_$x_4();this.$R_4=!_Object.isNullOrUndefined(this.get_$x_4())}};function SharingRuleEntry(){this.IsAnyDomain=!0;this.Domain=null;this.IsCalendarSharing=!0;this.CalendarSharing="CalendarSharingFreeBusySimple";this.IsContactsSharing=!1}SharingRuleEntry.copyToSharingRuleEntry=function(n){var t=null;if(null!==n){var i=n;t=new SharingRuleEntry;SharingRuleEntry.$1s(t,i);t.RawIdentity=SharingRuleEntry.$2R(i);t.SharingDesc=SharingRuleEntry.$2S(i)}return t};SharingRuleEntry.copyToDictionary=function(n){var t={};t.__type="SharingRuleEntry:ECP";var i=t;SharingRuleEntry.$1s(i,n);return t};SharingRuleEntry.$2R=function(n){return n.IsAnyDomain?"*":n.Domain};SharingRuleEntry.$2S=function(n){var t=null;if(n.IsCalendarSharing)switch(n.CalendarSharing){case"CalendarSharingFreeBusySimple":t=Strings.get_CalendarSharingFreeBusySimple();break;case"CalendarSharingFreeBusyDetail":t=Strings.get_CalendarSharingFreeBusyDetail();break;case"CalendarSharingFreeBusyReviewer":t=Strings.get_CalendarSharingFreeBusyReviewer();break}n.IsContactsSharing&&(t=null===t?Strings.get_ContactsSharing():t+Strings.get_ListSeparator()+Strings.get_ContactsSharing());return t};SharingRuleEntry.$1s=function(n,t){n.IsAnyDomain=t.IsAnyDomain;n.Domain=t.Domain;n.FormattedDomain=t.FormattedDomain;n.IsCalendarSharing=t.IsCalendarSharing;n.CalendarSharing=t.CalendarSharing;n.IsContactsSharing=t.IsContactsSharing};SharingRuleEntry.prototype={IsAnyDomain:!1,Domain:null,FormattedDomain:null,IsCalendarSharing:!1,CalendarSharing:null,IsContactsSharing:!1,RawIdentity:null,SharingDesc:null};function SharingRuleEntryConverter(){}SharingRuleEntryConverter.prototype={convertTo:function(n){var t=n;var i=SharingRuleEntry.copyToSharingRuleEntry(n);i.FormattedDomain=t.IsAnyDomain?Strings.get_SharingDomainOptionAll():t.Domain;return i},convertFrom:function(n){return _Object.isNullOrUndefined(n)?new SharingRuleEntry:n}};function SharingRuleEntryListConverter(){}SharingRuleEntryListConverter.prototype={convertBack:function(n,t){var r=[];if(null!==n&&Array.isInstanceOfType(n))for(var u=n,i=0;i<u.length;i++)Array.add(r,SharingRuleEntry.copyToDictionary(u[i]));return r},convert:function(n,t){var r=[];if(null!==n&&Array.isInstanceOfType(n))for(var u=n,i=0;i<u.length;i++)Array.add(r,SharingRuleEntry.copyToSharingRuleEntry(u[i]));return r}};function SharingRuleEntryViewModel(){this.$$d_$3H_5=Function.createDelegate(this,this.$3H_5);SharingRuleEntryViewModel.initializeBase(this);this.add_propertyChanged(this.$$d_$3H_5)}SharingRuleEntryViewModel.prototype={$3H_5:function(n,t){if(t.get_propertyName()==="Validators"&&this.get_Validators()&&!this.get_IsForNew()){var u=this.get_Validators();if(this.get_Results().Output[0].IsAnyDomain)u.setProperty("IsAnyDomain",null);else{var i=u.getProperty("Domain");if(i)for(var r=0;r<i[0].Domains.length;r++)i[0].Domains[r]===this.get_Results().Output[0].Domain&&(i[0].Domains[r]=null)}}}};function GroupUtil(){}GroupUtil.GetGroupTypeText=function(n){if(n==="MailNonUniversalGroup"||n==="MailUniversalDistributionGroup")return Strings.get_DistributionGroupText();else if(n==="MailUniversalSecurityGroup")return Strings.get_SecurityGroupText();else if(n==="DynamicDistributionGroup")return Strings.get_DynamicDistributionGroupText();else throw Error.argument("distributionGroupType");};GroupUtil.GetGroupNotesText=function(n){return EcpUtil.isNullOrBlank(n)?Strings.get_NoneForEmpty():n};GroupUtil.GetMemberUpdateTypeText=function(n){if(n==="Closed")return Strings.get_MemberUpdateTypeClosed();else if(n==="Open")return Strings.get_MemberUpdateTypeOpen();else if(n==="ApprovalRequired")return Strings.get_MemberUpdateTypeApprovalRequired();else throw Error.argument("memberUpdateType");};GroupUtil.GetItemsText=function(n){return _Object.isNullOrUndefined(n)||!n.length?[Strings.get_NoneForEmpty()]:n};GroupUtil.IsDynamicDistributionGroup=function(n){return n==="DynamicDistributionGroup"};GroupUtil.IsNotDynamicDistributionGroup=function(n){return!GroupUtil.IsDynamicDistributionGroup(n)};function CloseAndForwardCommand(){CloseAndForwardCommand.initializeBase(this)}CloseAndForwardCommand.prototype={$e_2:!1,$H_2:null,get_closeAndForward:function(){return this.$e_2},set_closeAndForward:function(n){this.$e_2=n;return n},get_forwardURL:function(){return this.$H_2},set_forwardURL:function(n){this.$H_2=n;return n},executeCore:function(){DataLossReporting.suspendWarning();this.$e_2&&this.$H_2&&window.open(this.$H_2);window.close()}};function HybridSelectCertControl(n){this.$$d_$2g_4=Function.createDelegate(this,this.$2g_4);this.$$d_$3K_4=Function.createDelegate(this,this.$3K_4);this.$$d_$2m_4=Function.createDelegate(this,this.$2m_4);HybridSelectCertControl.initializeBase(this,[n])}HybridSelectCertControl.prototype={$V_4:null,$1Z_4:null,$1W_4:null,$2G_4:null,$25_4:null,$A_4:null,get_RefServer:function(){return this.$V_4},set_RefServer:function(n){if(this.$V_4!==n){this.$V_4=n;this.$3A_4()}return n},get_Subject:function(){return this.$2G_4},set_Subject:function(n){this.$2G_4=n;this.raisePropertyChanged("Subject");return n},get_Issuer:function(){return this.$25_4},set_Issuer:function(n){this.$25_4=n;this.raisePropertyChanged("Issuer");return n},get_SelectedCertificateThumbprint:function(){return this.$1Z_4},set_SelectedCertificateThumbprint:function(n){this.$1Z_4=n;this.raisePropertyChanged("SelectedCertificateThumbprint");return n},get_MailCertificateOptions:function(){return this.$1W_4},set_MailCertificateOptions:function(n){this.$1W_4=n;this.raisePropertyChanged("MailCertificateOptions");return n},validate:function(n){var t=EcpControl.prototype.validate.call(this,n);t&&this.$3F_4();return t},$3F_4:function(){var i=this.$1Z_4;var n=this.$1W_4;if(n)for(var t=0;t<n.length;t++)if(n[t].Thumbprint===i){this.set_Subject(n[t].Subject);this.set_Issuer(n[t].Issuer)}},$3A_4:function(){if(!this.$A_4){this.$A_4=new WebServiceCommand;this.$A_4.init(EcpUrl.get_ecpVDir()+"DDI/DDIService.svc?schema=HybridConfigurationWizardService","GetCertificateOptions",this.$$d_$2m_4);this.$A_4.get_webServiceMethod().set_ParameterNames(7);this.$A_4.get_webServiceMethod().add_Failed(this.$$d_$3K_4);this.$A_4.add_completed(this.$$d_$2g_4)}this.$V_4?this.$A_4.execute():this.set_MailCertificateOptions(null)},$2m_4:function(){var n={};n.Server=this.$V_4;return[n,null]},$2g_4:function(n,t){this.set_MailCertificateOptions(HCWPrepareCertViewModel.getCertificateOption(this.$A_4.get_LastResults()))},$3K_4:function(n,t){t.set_handled(!0)}};function HCWHelper(){}HCWHelper.getDomainNameList=function(n){return n&&n.length>0&&String.isInstanceOfType(n[0])?n:HCWHelper.$1z(n,null,null,"Domain")};HCWHelper.filterArrayByNameList=function(n,t,i){var r=null;t&&t.length>0&&(r=HCWHelper.$1z(n,t,i,null));return r};HCWHelper.$1z=function(n,t,i,r){var f=null;if(n&&n.length>0){var o=!!i&&!!t&&t.length>0;f=[];for(var u=0;u<n.length;u++)if(o){var e=HCWHelper.$1P(n[u],i);e&&Array.contains(t,e)&&Array.add(f,HCWHelper.$1P(n[u],r))}else Array.add(f,HCWHelper.$1P(n[u],r))}return f};HCWHelper.$1P=function(n,t){return n&&t?n[t]:n};function HCWIntroductionViewModel(){this.$$d_$3G_5=Function.createDelegate(this,this.$3G_5);HCWIntroductionViewModel.initializeBase(this)}HCWIntroductionViewModel.prototype={$2F_5:0,$F_5:null,$1y_5:!1,initialize:function(){WebServiceWizardStepViewModel.prototype.initialize.call(this);HCWIntroductionViewModel.wwOAuth=this.getValue("WWoAuth");var n=EcpUtil.getCrossSiteAgent();if(n){this.$F_5=null;var t=this;n.getTenantDomainInfo(this.$$d_$3G_5,function(){t.$1y_5=!0})}},onNext:function(){this.$2F_5=(new Date).getTime();this.setValue("ServiceInstance",HCWIntroductionViewModel.serviceInstance);var t=this.getValue("GallatinBlock");var i=!0;try{var r=Object.getType(t).toString()}catch(u){i=!1}var n=this;this.$2O_5(function(){var u=!0;if(i)if(t){n.set_NextViewModelID("GallatinBlockError");n.onNextCompleted(new GoNextStepCompletedEventArgs(!1,n.get_NextViewModelID()))}else if(n.$F_5)if(_PowerShellResults.hasError(n.$F_5)){n.setValue(WizardViewModel.errorRecordsPropertyName,n.$F_5.ErrorRecords);n.set_NextViewModelID("ErrorPage");n.onNextCompleted(new GoNextStepCompletedEventArgs(!1,n.get_NextViewModelID()))}else{var r=n.$F_5.Output;if(r.length>0){u=r[0].HasCoexistenceDomain;n.setValue("CloudDomains",r[0].DomainNames)}if(u){n.get_parentViewModel().set_ProgressText(null);WebServiceWizardStepViewModel.prototype.onNext.call(n)}else{n.set_NextViewModelID("ErrorPage_NoCoexistenceDomain");n.onNextCompleted(new GoNextStepCompletedEventArgs(!1,n.get_NextViewModelID()))}}else{n.get_parentViewModel().set_ProgressText(null);n.get_parentViewModel().set_ProgressText(Strings.get_ProceedWithoutTenantInfo());window.setTimeout(function(){n.get_parentViewModel().set_ProgressText(null);WebServiceWizardStepViewModel.prototype.onNext.call(n)},3e3)}else{n.set_NextViewModelID("NeedToSetExternalUrl");n.onNextCompleted(new GoNextStepCompletedEventArgs(!1,n.get_NextViewModelID()))}})},handleResults:function(n){WebServiceWizardStepViewModel.prototype.handleResults.call(this,n);var i=!!n&&!!n.Output&&n.Output.length>0;var r=!!n&&!!n.ErrorRecords&&n.ErrorRecords.length>0;if(!r&&i&&!this.$2T_5(n.Output[0])){var t=n.Output[0].DomainOptions;this.setValue("_DomainOptions",t);this.$2q_5(t);this.setValue("_SharingDomains",n.Output[0].SharingDomains);this.set_NextViewModelID("SelectDomain");EcpUrl.getUrlParameter(window.location.href,"SkipRefreshWindowForTest")!=="1"&&RefreshWindow(_Window.getOpener())}},$3G_5:function(n){this.$F_5=Sys.Serialization.JavaScriptSerializer.deserialize(n)},$2O_5:function(n){var t=(new Date).getTime()-this.$2F_5;if(!this.$F_5&&!this.$1y_5&&t<23e3){this.get_parentViewModel().set_ProgressText(Strings.get_ConnectToO365());var i=this;window.setTimeout(function(){i.$2O_5(n)},500)}else n()},$2T_5:function(n){var t=!1;var i=n.DomainOptions;if(!i||!i.length){this.set_NextViewModelID("ErrorPage_NoDomains");t=!0}return t},$2q_5:function(n){if(n.length===1){this.get_parentViewModel().findViewModelWithID("SelectDomain").set_ShouldSkip(!0);this.setValue("Domains",n)}else if(n.length>1){this.get_parentViewModel().findViewModelWithID("SelectDomain").set_ShouldSkip(!1);var t=this.getValue("Domains");t&&t.length?this.$2b_5(n):this.setValue("Domains",n)}},$2b_5:function(n){for(var i=!1,r=this.getValue("Domains"),u=HCWHelper.getDomainNameList(n),f=r,e=f.length,t=0;t<e;++t){var o=f[t];if(!Array.contains(u,o.Domain)){i=!0;break}}i&&this.setValue("Domains",HCWHelper.filterArrayByNameList(r,u,"Domain"))}};function HCWPrepareCertViewModel(){HCWPrepareCertViewModel.initializeBase(this)}HCWPrepareCertViewModel.getCertificateOption=function(n){var t=!!n&&!_PowerShellResults.hasError(n)&&_PowerShellResults.hasOutput(n);return t?n.Output[0].MailCertificateOptions:null};HCWPrepareCertViewModel.prototype={handleResults:function(n){WebServiceWizardStepViewModel.prototype.handleResults.call(this,n);this.setValue("MailCertificateOptions",HCWPrepareCertViewModel.getCertificateOption(n))}};function HybridConfigurationSlab(n){this.$$d_$30_4=Function.createDelegate(this,this.$30_4);HybridConfigurationSlab.initializeBase(this,[n])}HybridConfigurationSlab.prototype={$q_4:null,$o_4:null,$y_4:null,$1V_4:null,$1U_4:null,get_EnableButton:function(){return this.$q_4},set_EnableButton:function(n){this.$q_4=n;return n},get_EditButton:function(){return this.$o_4},set_EditButton:function(n){this.$o_4=n;return n},get_IsGallatinCheckbox:function(){return this.$y_4},set_IsGallatinCheckbox:function(n){this.$y_4=n;return n},get_LinkToCrossPremiseWorldWide:function(){return this.$1V_4},set_LinkToCrossPremiseWorldWide:function(n){this.$1V_4=n;return n},get_LinkToCrossPremiseGallatin:function(){return this.$1U_4},set_LinkToCrossPremiseGallatin:function(n){this.$1U_4=n;return n},initialize:function(){EcpControl.prototype.initialize.call(this);$addHandler(this.$q_4,"click",this.$$d_$30_4);$addHandler(this.$o_4,"click",this.$$d_$30_4)},dispose:function(){$removeHandler(this.$q_4,"click",this.$$d_$30_4);$removeHandler(this.$o_4,"click",this.$$d_$30_4);EcpControl.prototype.dispose.call(this)},$30_4:function(n){n.preventDefault();var i=this.$y_4.checked?"1":"0";var r=EcpApplication.get_instance();if(r&&EcpUrl.getUrlParameter(r.get_navigationWindow().location.href,"xprs"))EcpUtil.isHybridUI()?i==="1"?window.open("http://go.microsoft.com/fwlink/?LinkID=399492"):window.open("http://go.microsoft.com/fwlink/?LinkID=399490"):MessageBox.showMessage(Strings.get_WaitForHybridUIReady(),MessageBoxType.information);else{_Cookie.set("ServiceInstance",i,14400);var t=new Info;t.set_Title(Strings.get_Information());t.Message=Strings.get_EnterHybridUIConfirm();var u="EnterHybridUI";var f=new DialogButton(Strings.get_EnterHybridUIButtonText(),u);var e=this.$y_4.checked?this.$1U_4:this.$1V_4;var o=this;MessageBox.showChoices(t,[f],null,function(n,t){n===u&&JumpTo("office365",!1,e)},null)}}};function HybridConfigurationViewModel(){HybridConfigurationViewModel.initializeBase(this)}HybridConfigurationViewModel.prototype={onValueInitialized:function(){NotifyPropertyChangedJson.prototype.onValueInitialized.call(this);var n=_Cookie.get("ServiceInstance");if(_String.isNullOrEmpty(n))this.setValue("TenantLoginCompleted",!1);else{this.setValue("IsHostedOnGallatin",n==="1");this.setValue("TenantLoginCompleted",!0)}}};function HybridConfigurationWizardViewModel(){this.$$d_$2r_5=Function.createDelegate(this,this.$2r_5);HybridConfigurationWizardViewModel.initializeBase(this);this.set_IsLongRunning(!0);this.add_propertyChanged(this.$$d_$2r_5)}HybridConfigurationWizardViewModel.prototype={$11_5:!1,get_IsHubTransportPath:function(){return this.getValue("_IsHubTransportPath")},set_IsHubTransportPath:function(n){if(n!==this.get_IsHubTransportPath()){var t=this.findViewModelWithID("TransportPathSelection");t&&this.findViewModelWithID("TransportPathSelection").set_NextViewModelID(n?"ReceivingTransportServers":"EdgeTransportServers");n||this.setValue("MailCertificateOptions",null);this.setValue("_IsHubTransportPath",n);this.raisePropertyChanged("IsHubTransportPath")}return n},initialize:function(){WizardViewModel.prototype.initialize.call(this);var n=this.getValue("EdgeTransportServers");this.set_IsHubTransportPath(!n||!n.length);this.$1B_5("SelectSMTPCert",this.$11_5);this.$1B_5("ModifySMTPCert",!this.$11_5);this.$1x_5()},onValueInitialized:function(){NotifyPropertyChangedJson.prototype.onValueInitialized.call(this);this.$11_5=!!this.getValue("Issuer");var n=!!this.getValue("Identity");var t=n?Strings.get_ModifyExchangeHybrid():Strings.get_SetupExchangeHybrid();this.setValue("_ModifyCert",this.$11_5);this.setValue("_ModifyMode",n);this.setValue("_CaptionName",t)},onCurrentViewModelChanged:function(){WizardViewModel.prototype.onCurrentViewModelChanged.call(this);if(this.get_currentViewModel()){this.get_NextCommand().set_Text(Strings.get_Next());this.get_CancelCommand().set_Text(Strings.get_Cancel());if(HCWIntroductionViewModel.isInstanceOfType(this.get_currentViewModel())){this.get_NextCommand().set_Text(Strings.get_Yes());this.get_CancelCommand().set_Text(Strings.get_No());if(HCWIntroductionViewModel.wwOAuth){this.setValue("showGallatinOAuthLink",!1);this.setValue("showWWOAuthLink",!0);this.setValue("showOAuthLinks",!0)}else if(HCWIntroductionViewModel.serviceInstance==="1"){this.setValue("showGallatinOAuthLink",!0);this.setValue("showWWOAuthLink",!1);this.setValue("showOAuthLinks",!0)}else{this.setValue("showGallatinOAuthLink",!1);this.setValue("showWWOAuthLink",!1);this.setValue("showOAuthLinks",!1)}}else if(this.get_currentViewModel().get_StepType()===WizardStepViewModel.failureStep)this.get_CanBack()||this.get_CancelCommand().set_Text(Strings.get_OK());else if(this.get_currentViewModel().get_StepType()===WizardStepViewModel.successStep){this.get_CancelCommand().set_Text(Strings.get_Close());if(HCWIntroductionViewModel.wwOAuth||HCWIntroductionViewModel.serviceInstance==="1"){this.set_CancelCommand(new CloseAndForwardCommand);this.get_CancelCommand().$e_2=!0;this.get_CancelCommand().set_Text(Strings.get_ConfigureOAuth())}if(HCWIntroductionViewModel.wwOAuth){this.setValue("showGallatinOAuthLink",!1);this.setValue("showWWOAuthLink",!0);this.setValue("showOAuthLinks",!0);this.get_CancelCommand().$H_2="http://go.microsoft.com/fwlink/?LinkID=320386"}else if(HCWIntroductionViewModel.serviceInstance==="1"){this.setValue("showGallatinOAuthLink",!0);this.setValue("showWWOAuthLink",!1);this.setValue("showOAuthLinks",!0);this.get_CancelCommand().$H_2="http://go.microsoft.com/fwlink/?LinkID=392853"}else{this.setValue("showGallatinOAuthLink",!1);this.setValue("showWWOAuthLink",!1);this.setValue("showOAuthLinks",!1)}}else if(this.get_currentViewModel().get_ViewModelID()==="Update"){var n=this.get_SaveCommand();n.set_Text(Strings.get_Update());if(n.get_webServiceMethod()&&n.get_webServiceMethod().get_progressInfo()){var t=n.get_webServiceMethod().get_progressInfo();t.set_objectName(Strings.get_HybridConfiguration());t.set_completedDescription(Strings.get_HCWCompletedDescription());t.set_stoppedDescription(Strings.get_HCWStoppedDescription());var i=this;n.add_invoked(function(){i.setValue("_UpdateStarted",!0)})}}}},handleMessage:function(){if(this.get_SaveCommand()){var n=this.get_SaveCommand().get_LastResults();if(n&&_PowerShellResults.hasError(n)&&n.ProgressRecord){n.ProgressRecord.Errors=n.ErrorRecords;this.setValue("OnPremPassword","");this.setValue("CloudPassword","")}if(this.get_currentViewModel().get_ViewModelID()==="Update"&&n&&n.Warnings.length>0){var t=n.Warnings.join("\r\n");this.setValue("HCWWarningsString",t);this.setValue("HCWWarnings",t.split("\r\n"))}}PropertyPageViewModel.prototype.handleMessage.call(this)},closeWindowAfterSave:function(){},$2r_5:function(n,t){(t.get_propertyName()==="_DomainNames"||t.get_propertyName()==="_SharingDomains"||t.get_propertyName()==="*")&&this.$1x_5();(t.get_propertyName()==="Domains"||t.get_propertyName()==="*")&&this.setValue("_DomainNames",HCWHelper.getDomainNameList(this.getValue("Domains")))},$1x_5:function(){if(this.get_isInitialized())if(this.getValue("ServiceInstance")==="1")this.$1B_5("DomainOwnershipProven",!0);else{var r="DomainName";var u=this.getValue("_SharingDomains");var f=this.getValue("_DomainNames");var n=HCWHelper.filterArrayByNameList(u,f,r);var t=new Sys.StringBuilder;if(n)for(var i=0;i<n.length;i++){t.append(n[i][r]);t.append(": ");t.appendLine(n[i].Proof)}this.setValue("_DomainProofInfo",t.toString());this.setValue("_SelectedDomainProofs",n);this.$1B_5("DomainOwnershipProven",!n||!n.length)}},$1B_5:function(n,t){var i=this.findViewModelWithID(n);i&&i.set_ShouldSkip(t)}};function OwaMailboxPolicySDOViewModel(){this.$0_5=new Array(5);this.$26_5=[Strings.get_OwaMailboxPolicyCommunicationManagement(),Strings.get_OwaMailboxPolicyInformationManagement(),Strings.get_OwaMailboxPolicySecurity(),Strings.get_OwaMailboxPolicyUserExperience(),Strings.get_OwaMailboxPolicyTimeManagement()];OwaMailboxPolicySDOViewModel.initializeBase(this);for(var n=0;n<=4;n++)this.$0_5[n]={};this.$0_5[0].InstantMessagingEnabled=Strings.get_OwaMailboxPolicyInstantMessaging();this.$0_5[0].TextMessagingEnabled=Strings.get_OwaMailboxPolicyTextMessaging();this.$0_5[0].UMIntegrationEnabled=Strings.get_OwaMailboxPolicyUMIntegration();this.$0_5[0].ActiveSyncIntegrationEnabled=Strings.get_OwaMailboxPolicyActiveSyncIntegration();this.$0_5[0].ContactsEnabled=Strings.get_OwaMailboxPolicyContacts();this.$0_5[0].AllowCopyContactsToDeviceAddressBook=Strings.get_OwaMailboxPolicyAllowCopyContactsToDeviceAddressBook();this.$0_5[0].AllAddressListsEnabled=Strings.get_OwaMailboxPolicyAllAddressLists();if(EcpProfile.get_instance().get_IsDataCenter()){this.$0_5[0].LinkedInEnabled=Strings.get_OwaMailboxPolicyLinkedIn();this.$0_5[0].FacebookEnabled=Strings.get_OwaMailboxPolicyFacebook()}this.$0_5[1].JournalEnabled=Strings.get_OwaMailboxPolicyJournal();this.$0_5[1].NotesEnabled=Strings.get_OwaMailboxPolicyNotes();this.$0_5[1].RulesEnabled=Strings.get_OwaMailboxPolicyRules();this.$0_5[1].RecoverDeletedItemsEnabled=Strings.get_OwaMailboxPolicyRecoverDeletedItems();if(!EcpProfile.get_instance().get_IsDataCenter()){this.$0_5[2].ChangePasswordEnabled=Strings.get_OwaMailboxPolicyChangePassword();this.$0_5[2].JunkEmailEnabled=Strings.get_OwaMailboxPolicyJunkEmail()}this.$0_5[3].ThemeSelectionEnabled=Strings.get_OwaMailboxPolicyThemeSelection();this.$0_5[3].PremiumClientEnabled=Strings.get_OwaMailboxPolicyPremiumClient();this.$0_5[3].SignaturesEnabled=Strings.get_OwaMailboxPolicySignatures();this.$0_5[3].PlacesEnabled=Strings.get_OwaMailboxPolicyPlaces();this.$0_5[3].WeatherEnabled=Strings.get_OwaMailboxPolicyWeather();this.$0_5[4].CalendarEnabled=Strings.get_OwaMailboxPolicyCalendar();this.$0_5[4].TasksEnabled=Strings.get_OwaMailboxPolicyTasks();this.$0_5[4].RemindersAndNotificationsEnabled=Strings.get_OwaMailboxPolicyRemindersAndNotifications()}OwaMailboxPolicySDOViewModel.prototype={get_EnabledFeatures:function(){for(var r=[],n=0;n<=4;n++){var t=[];var u=this.$0_5[n];for(var f in u){var e={key:f,value:u[f]};this.getValue(e.key)&&Array.add(t,e.value)}if(t.length>0){var i={};i.GroupName=this.$26_5[n];i.Features=t;Array.add(r,i)}}return r},get_HasFeatureEnabled:function(){return this.get_EnabledFeatures().length>0}};function OwaMailboxPolicyViewModel(){this.$2J_4=["InstantMessagingEnabled","TextMessagingEnabled","UMIntegrationEnabled","ActiveSyncIntegrationEnabled","ContactsEnabled","LinkedInEnabled","FacebookEnabled","AllowCopyContactsToDeviceAddressBook"];this.$2K_4=["JournalEnabled"];this.$2L_4=["ChangePasswordEnabled","JunkEmailEnabled"];this.$2M_4=["ThemeSelectionEnabled","PremiumClientEnabled"];this.$1m_4=["AllAddressListsEnabled"];this.$1n_4=["NotesEnabled","RulesEnabled","RecoverDeletedItemsEnabled"];this.$1p_4=["SignaturesEnabled","PlacesEnabled","WeatherEnabled"];this.$1o_4=["CalendarEnabled","TasksEnabled","RemindersAndNotificationsEnabled"];OwaMailboxPolicyViewModel.initializeBase(this)}OwaMailboxPolicyViewModel.prototype={$1N_4:!0,get_FeatureSettingCollapsed:function(){return this.$1N_4},set_FeatureSettingCollapsed:function(n){this.$1N_4=n;this.raisePropertyChanged("FeatureSettingCollapsed");this.raisePropertyChanged("ShouldShowCommunicationManagement");this.raisePropertyChanged("ShouldShowInformationManagement");this.raisePropertyChanged("ShouldShowSecurity");this.raisePropertyChanged("ShouldShowUserExperience");this.raisePropertyChanged("ShouldShowTimeManagement");return n},get_ShouldShowCommunicationManagement:function(){return this.$W_4(this.$2J_4,this.$1m_4)},get_ShouldShowInformationManagement:function(){return this.$W_4(this.$2K_4,this.$1n_4)},get_ShouldShowSecurity:function(){return this.$W_4(this.$2L_4,null)},get_ShouldShowUserExperience:function(){return this.$W_4(this.$2M_4,this.$1p_4)},get_ShouldShowTimeManagement:function(){return this.$W_4(null,this.$1o_4)},$W_4:function(n,t){var i=!1;if(n)for(var f=n,h=f.length,r=0;r<h;++r){var e=f[r];i=i||this.get_CanGet().getProperty(e)&&this.get_CanSet().getProperty(e)}if(!i&&t&&!this.$1N_4)for(var o=t,c=o.length,u=0;u<c;++u){var s=o[u];i=i||this.get_CanGet().getProperty(s)&&this.get_CanSet().getProperty(s)}return i}};function RecipientConditionViewModel(){RecipientConditionViewModel.initializeBase(this);this.addPropertyMapping("ConditionalCompany","conditions")}RecipientConditionViewModel.prototype={get_conditions:function(){return this.get_values()},set_conditions:function(n){var r=n;for(var u in r){var t={key:u,value:r[u]};var f=this.getValue(t.key);var i=t.value;f&&Array.isInstanceOfType(f)&&null===i&&(i=new Array(0));this.setValue(t.key,i)}return n}};function EditServerViewModel(){EditServerViewModel.initializeBase(this);this.set_propertyConverters({UMDialPlans:ValueConverter.ToIdentity,UCRDialPlans:ValueConverter.ToIdentity});this.addPropertyMapping("IsMBX","Is14OrLaterMBX");this.addPropertyMapping("IsE14OrLater","Is14OrLaterMBX")}EditServerViewModel.prototype={get_Is14OrLaterMBX:function(){return this.getProperty("IsMBX")&&this.getProperty("IsE14OrLater")},get_Is14OrPrevious:function(){var n=this.getProperty("MajorVersion");return n<=14},get_IsE12OrPrevious:function(){var n=this.getProperty("MajorVersion");return n<=12},get_Is15OrLater:function(){var n=this.getProperty("MajorVersion");return n>=15},get_IsCASorE15MBX:function(){return this.getProperty("IsCAS")||this.get_Is15OrLater()&&this.getProperty("IsMBX")},get_IsE14CASorE15MBX:function(){return this.get_Is14OrPrevious()&&this.getProperty("IsCAS")||this.get_Is15OrLater()&&this.getProperty("IsMBX")},get_IsCASandMBX:function(){return this.getProperty("IsCAS")&&this.getProperty("IsMBX")},get_IsE15MBX:function(){return this.get_Is15OrLater()&&this.getProperty("IsMBX")},get_IsE15CAS:function(){return this.get_Is15OrLater()&&this.getProperty("IsCAS")},get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);this.saveIPbinding("Imap4UnencryptedOrTLSBindings",n);this.saveIPbinding("Imap4SSLBindings",n);this.saveIPbinding("Pop3UnencryptedOrTLSBindings",n);this.saveIPbinding("Pop3SSLBindings",n);this.checkDNSValue("External",n);this.checkDNSValue("Internal",n);n.OutlookAnywhereEnabled=this.getValue("OutlookAnywhereEnabled");n.OLKAnywhereIdentity=this.getValue("OLKAnywhereIdentity");n.IsE14OrPrevious=this.get_Is14OrPrevious();n.IsCAS=this.getProperty("IsCAS");n.IsMBX=this.getProperty("IsMBX");return n},get_MaxOutboundConnectionsOptions:function(){return["100","1000","5000","unlimited"]},get_ExternalDNSAdapterGuid:function(){return this.getValue("ExternalDNSAdapterGuid")},set_ExternalDNSAdapterGuid:function(n){this.internalSetAdapterGuid("External",n);return n},get_ExternalDNSServers:function(){return this.getValue("ExternalDNSServers")},set_ExternalDNSServers:function(n){this.internalSetDNSServers("External",n);return n},get_InternalDNSAdapterGuid:function(){return this.getValue("InternalDNSAdapterGuid")},set_InternalDNSAdapterGuid:function(n){this.internalSetAdapterGuid("Internal",n);return n},get_InternalDNSServers:function(){return this.getValue("InternalDNSServers")},set_InternalDNSServers:function(n){this.internalSetDNSServers("Internal",n);return n},mergeRefresh:function(n){var i=n;if(this.get_ReadOnDemand()&&i&&(!i.ErrorRecords||!i.ErrorRecords.length))for(var r=0;r<i.Output.length;r++){var t=i.Output[r];this.loadPopImapSetting("Imap4",t);this.loadPopImapSetting("Pop3",t);this.loadAdapterGuids(t);this.loadAdapterDNSServers(t);this.loadDNSServers("External",t);this.loadDNSServers("Internal",t);this.verifyAdapterGuid("External",t);this.verifyAdapterGuid("Internal",t);this.updateDNSServers("External",t);this.updateDNSServers("Internal",t);this.loadAuthenticationMethods(t);this.loadDialPlans(t,"UCRDialPlans");this.loadDialPlans(t,"UMDialPlans")}PropertyPageViewModel.prototype.mergeRefresh.call(this,n)},loadPopImapSetting:function(n,t){var i=t[n+"UnencryptedOrTLSBindings"];i&&this.loadIPbinding(n+"UnencryptedOrTLSBindings",t,i);var r=t[n+"SSLBindings"];r&&this.loadIPbinding(n+"SSLBindings",t,r)},saveIPbinding:function(n,t){var i=t[n];if(!_Object.isNullOrUndefined(i)){for(var u=[],r=0;r<i.length;r++){var f=i[r];Array.add(u,f.Identity.RawIdentity)}t[n]=u}},loadIPbinding:function(n,t,i){for(var s=[],h=i,l=h.length,u=0;u<l;++u){var c=h[u];var r={};r.Identity=c;var f=c.RawIdentity;var e=f.lastIndexOf(":");if(e>0){r.Port=f.substr(e+1);var o=f.substr(0,e);r.Address=o==="::"?Strings.get_AllAvailableIPV6Address():o==="0.0.0.0"?Strings.get_AllAvailableIPV4Address():o;Array.add(s,r)}}t[n]=s},checkDNSValue:function(n,t){var i=t[n+"DNSAdapterGuid"];if(_Object.isNullOrUndefined(i)){var r=t[n+"DNSServers"];if(!_Object.isNullOrUndefined(r)){t[n+"DNSAdapterEnabled"]=!1;t[n+"DNSServers"]=this.stringArrayFromDNSObjects(t[n+"DNSServers"]);delete t[n+"DNSAdapterGuid"]}}else if(i==="FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF"){t[n+"DNSAdapterEnabled"]=!1;t[n+"DNSServers"]=this.stringArrayFromDNSObjects(t[n+"DNSServers"]);delete t[n+"DNSAdapterGuid"]}else{t[n+"DNSAdapterEnabled"]=!0;delete t[n+"DNSServers"]}},loadAdapterGuids:function(n){var r=n.AdapterGuids;if(r){for(var u=[],f=r,o=f.length,t=0;t<o;++t){var e=f[t];var i={};i.Guid=e.RawIdentity;i.Name=e.DisplayName;Array.add(u,i)}n.AdapterGuids=u}},loadAdapterDNSServers:function(n){var i=n.AdapterDNSServers;if(i){for(var r={},u=n.AdapterGuids,t=0;t<i.length;t++)r[u[t].Guid]=this.dnsObjectsFromStringArray(i[t]);this.saveToDNSServerBuffer("External",EcpUtil.cloneDataObject(r));this.saveToDNSServerBuffer("Internal",EcpUtil.cloneDataObject(r))}},dnsObjectsFromStringArray:function(n){if(!_Object.isNullOrUndefined(n)){for(var u=[],f=n,e=f.length,t=0;t<e;++t){var i=f[t];var r={};r.Identity=new Identity(i,i);r.Address=i;Array.add(u,r)}return u}return null},stringArrayFromDNSObjects:function(n){if(!_Object.isNullOrUndefined(n)){for(var i=[],r=n,u=r.length,t=0;t<u;++t){var f=r[t];Array.add(i,f.Identity.RawIdentity)}return i}return null},verifyAdapterGuid:function(n,t){var e=t[n+"DNSAdapterEnabled"];if(!_Object.isNullOrUndefined(e)){for(var r=!1,o=t[n+"DNSAdapterGuid"],u=t.AdapterGuids,f=u,s=f.length,i=0;i<s;++i){var h=f[i];if(h.Guid===o){r=!0;break}}r||(t[n+"DNSAdapterGuid"]=u[0].Guid)}},loadDNSServers:function(n,t){var i=t[n+"DNSServers"];if(i){var r={};r["FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF"]=this.dnsObjectsFromStringArray(i);this.saveToDNSServerBuffer(n,r);delete t[n+"DNSServers"]}},updateDNSServers:function(n,t){var i=t[n+"DNSAdapterGuid"];if(i){var r=this.getValue("_"+n+"DNSBuffer");r&&(t[n+"DNSServers"]=r[i])}},internalSetAdapterGuid:function(n,t){if(this.getValue(n+"DNSAdapterGuid")!==t){this.setValue(n+"DNSAdapterGuid",t);var i=this.getValue("_"+n+"DNSBuffer");i&&this.setValue(n+"DNSServers",i[t])}},internalSetDNSServers:function(n,t){if(this.getValue(n+"DNSServers")!==t){this.setValue(n+"DNSServers",t);if(this.getValue(n+"DNSAdapterGuid")==="FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF"){var i=this.getValue("_"+n+"DNSBuffer");i&&(i["FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF"]=t)}}},saveToDNSServerBuffer:function(n,t){var i=this.getValue("_"+n+"DNSBuffer");if(i){var r=t;for(var u in r){var f={key:u,value:r[u]};i[f.key]=f.value}}else this.setValue("_"+n+"DNSBuffer",t)},loadAuthenticationMethods:function(n){var i=n.AuthenticationMethods;if(!_Object.isUndefined(i)){var r={Description:Strings.get_BasicAuth(),Value:"Basic"};var u={Description:Strings.get_NtlmAuth(),Value:"Ntlm"};var t=[];Array.add(t,r);Array.add(t,u);if(this.get_Is15OrLater()){var f={Description:Strings.get_NegotiateAuth(),Value:"Negotiate"};Array.add(t,f)}n.AuthenticationMethods=t}},loadDialPlans:function(n,t){var u=n[t];if(u){for(var f=[],e=u,s=e.length,i=0;i<s;++i){var o=e[i];var r={};r.Identity=o;r.DisplayName=o.DisplayName;Array.add(f,r)}n[t]=f}}};function ExpiringServerDialog(n){ExpiringServerDialog.initializeBase(this,[Strings.get_Warning(),"06034328-c8fd-4f17-a0be-892878c80e72",null,DialogButton.get_OK(),ModalDialogResult.OK,null,null,null]);this.$1t_3=n;this.set_extraDependantResources(EcpProfile.get_instance().getScriptResource("list.js"))}ExpiringServerDialog.prototype={$N_3:null,$n_3:null,$m_3:null,$1t_3:null,get_contentHtml:function(){return MessageBoxDialog.prototype.get_contentHtml.call(this).replace("06034328-c8fd-4f17-a0be-892878c80e72",this.$N_3)},onInit:function(n){MessageBoxDialog.prototype.onInit.call(this,n);this.$N_3=String.format("<div>{1}</div><br />\r\n<div id='{0}_msgboxDiv' class='expsrv'>{2}</div>\r\n",n.get_id(),Strings.get_ServerAboutToExpireWarningText(),ListViewUtil.getListViewHtml("ServerListView",[]))},onShowing:function(){Dialog.prototype.onShowing.call(this);var t=[new ColumnHeader("ServerName",_String.empty,_String.empty,"left",_String.empty,Strings.get_ServerNameColumnText(),50,"%",16),new ColumnHeader("TrialDays",_String.empty,_String.empty,"left",_String.empty,Strings.get_ServerTrailDaysColumnText(),50,"%",16)];var n=ListViewUtil.setupListView("ServerListView",32,[],t,this.$1t_3,this.get_modalDialog().get_dialogFrame().ownerDocument);if(n&&n.length===2){this.$m_3=n[0];this.$n_3=n[1]}},onButtonClicked:function(n){this.get_modalDialog().close();this.onClose()},onClose:function(){this.$N_3=null;if(this.$m_3){this.$m_3.dispose();this.$m_3=null}if(this.$n_3){this.$n_3.dispose();this.$n_3=null}MessageBoxDialog.prototype.onClose.call(this)}};function IPAddrEditorViewModel(){IPAddrEditorViewModel.initializeBase(this)}IPAddrEditorViewModel.prototype={get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);var t=parseInt(n.Port);var f=n.Address;if(n.AddrType==="AllavailableIPv4"){var i="0.0.0.0:"+t;n.Identity=new Identity(i,i);n.Address=Strings.get_AllAvailableIPV4Address()}else if(n.AddrType==="AllavailableIPv6"){var r=":::"+t;n.Identity=new Identity(r,r);n.Address=Strings.get_AllAvailableIPV6Address()}else{var u=f+":"+t;n.Identity=new Identity(u,u)}n.Port=t;return n},initialize:function(){PopupFormViewModel.prototype.initialize.call(this);var i=!0;var r=UrlUtil.getParameter("new");_Object.isNullOrUndefined(r)||(i=Boolean.parse(r));var n=UrlUtil.getParameter("data");if(i){this.setValue("Caption",Strings.get_AddIPAddress());this.setValue("AddrType","AllavailableIPv4");n==="POPTLS"?this.setValue("Port",110):n==="POPSSL"?this.setValue("Port",995):n==="IMAPTLS"?this.setValue("Port",143):this.setValue("Port",993)}else{this.setValue("Caption",Strings.get_EditIPAddress());var t=this.getValue("Identity");if(!_Object.isNullOrUndefined(t)){var u=t.RawIdentity.lastIndexOf(":");if(u>0){var f=t.RawIdentity.substr(0,u);if(f==="0.0.0.0"){this.setValue("AddrType","AllavailableIPv4");this.setValue("Address",null)}else if(f==="::"){this.setValue("AddrType","AllavailableIPv6");this.setValue("Address",null)}else this.setValue("AddrType","IPSpecial")}}}}};function ServerListView(n){this.$$d_$3L_4=Function.createDelegate(this,this.$3L_4);ServerListView.initializeBase(this,[n])}ServerListView.prototype={$a_4:null,$1Y_4:null,initialize:function(){ListView.prototype.initialize.call(this);this.$a_4=this.get_DataSource();this.$1Y_4=this.$$d_$3L_4;this.$a_4.add_refreshCompleted(this.$1Y_4)},dispose:function(){this.$a_4.remove_refreshCompleted(this.$1Y_4);ListView.prototype.dispose.call(this)},$3L_4:function(n,t){if("true"!==_Cookie.get("SrvTrialChecked")){_Cookie.set("SrvTrialChecked","true",0);for(var r=[],o=this.$a_4.get_value(),c=o.length,u=0;u<c;++u){var l=o[u];var i=l;i.TrialDays<=30&&i.TrialDays>0&&Array.add(r,{ServerName:i.Name,TrialDays:i.TrialDays})}r.length>0&&new ExpiringServerDialog(r).show();for(var s=this.$a_4.get_value(),a=s.length,f=0;f<a;++f){var v=s[f];var h=v;if(h.IsExpiredExchangeTrialEdition){var e=new Info;e.Message=String.format(Strings.get_TrialExpiredWarningText(),h.Name,EcpUrl.get_ecpVDir()+"GoHelp.aspx?helpid=Servers");e.MessageType=MessageBoxType.warning;MessageBox.showCustom(e,4,null,null)}}}}};function EditGlobalSettingsViewModel(){EditGlobalSettingsViewModel.initializeBase(this)}EditGlobalSettingsViewModel.prototype={get_MaxRecipientsOptions:function(){return["100","1000","5000","unlimited"]},get_MaxMessageSizeOptions:function(){return["10","25","100","unlimited"]}};function SimpleIPEditorViewModel(){SimpleIPEditorViewModel.initializeBase(this)}SimpleIPEditorViewModel.prototype={get_DefaultCaptionText:function(){return this.get_IsForNew()?Strings.get_AddIPAddress():Strings.get_EditIPAddress()},get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);var t=n.Address;n.Identity=new Identity(t,t);return n}};function ConnectMailboxWizardViewModel(){this.$$d_getLoadParameters=Function.createDelegate(this,this.getLoadParameters);this.$$d_$3J_6=Function.createDelegate(this,this.$3J_6);this.$J_6=new Array(0);ConnectMailboxWizardViewModel.initializeBase(this)}ConnectMailboxWizardViewModel.prototype={$I_6:null,$1w_6:null,$1v_6:null,get_HasMatchedUsers:function(){return!!this.$J_6&&this.$J_6.length>0},$1G_6:!0,get_UseCustomizedUser:function(){return this.$1G_6},set_UseCustomizedUser:function(n){if(n!==this.$1G_6){this.$1G_6=n;this.raisePropertyChanged("UseCustomizedUser")}return n},get_MatchedUsers:function(){return this.$J_6},set_MatchedUsers:function(n){if(this.$J_6!==n){this.$J_6=n;this.raisePropertyChanged("MatchedUsers");this.raisePropertyChanged("HasMatchedUsers")}return n},$18_6:null,get_SelectedSuggestUser:function(){return this.$18_6},set_SelectedSuggestUser:function(n){if(this.$18_6!==n){this.$18_6=n;this.raisePropertyChanged("SelectedSuggestUser")}return n},$1a_6:null,get_SelectedCustomizedUser:function(){return this.$1a_6},set_SelectedCustomizedUser:function(n){this.$1a_6=n;this.raisePropertyChanged("SelectedCustomizedUser");return n},initialize:function(){this.add_propertyChanged(this.$$d_$3J_6);var n=new WebServiceCommand;n.init(this.get_ServiceUrl(),"FindMatchedUser",this.$$d_getLoadParameters);n.get_webServiceMethod().set_ParameterNames(7);var t=this;n.add_invoked(function(){t.setProgressText()});var i=this;n.add_completed(function(){i.clearProgressText()});this.set_LoadCommand(n);this.$I_6=PopupWindowManager.getPopupWindowArguments();this.setValue("DisplayName",this.$I_6.DisplayName);WizardViewModel.prototype.initialize.call(this)},$3J_6:function(n,t){(t.get_propertyName()==="TargetMailboxType"||t.get_propertyName()==="*")&&this.$34_6()},getLoadParameters:function(){var n={};n.DisplayName=this.$I_6.DisplayName;n.LegacyDN=this.$I_6.LegacyDN;return[n,null]},loadCommand_Completed:function(n,t){var i=n.get_LastResults();this.$39_6(i.Output);i.Output=[{}];this.set_ReadOnDemand(!0);PropertyPageViewModel.prototype.loadCommand_Completed.call(this,n,t);this.set_ReadOnDemand(!1);this.set_Identity(this.$I_6.Identity);this.setValue("Database",this.$I_6.Database);this.setValue("TargetMailboxType","UserMailbox")},$34_6:function(){this.set_MatchedUsers(this.getValue("TargetMailboxType")==="UserMailbox"?this.$1w_6:this.$1v_6);this.set_UseCustomizedUser(!this.get_HasMatchedUsers());this.set_SelectedCustomizedUser(null);this.raisePropertyChanged("UserPickerFullUrl")},$39_6:function(n){var r=[];var u=[];if(!_Object.isNullOrUndefined(n))for(var f=n,e=f.length,i=0;i<e;++i){var t=f[i];t.RecipientTypeDetails==="User"?Array.add(r,t):t.RecipientTypeDetails==="DisabledUser"&&Array.add(u,t)}this.$1w_6=r;this.$1v_6=u},getSaveParameters:function(){var n=this.$1G_6?this.$1a_6:this.$18_6[0];this.setValue("UserID",n);return PropertyPageViewModel.prototype.getSaveParameters.call(this)},$1H_6:null,get_UserPickerUrl:function(){return this.$1H_6},set_UserPickerUrl:function(n){n=n.replace("~/",EcpUrl.get_ecpFullUrl());this.$1H_6!==n&&(this.$1H_6=n);return n},get_UserPickerFullUrl:function(){return this.$1H_6+"?filter=RecipientTypeDetails -eq '"+(this.getValue("TargetMailboxType")==="UserMailbox"?"User":"DisabledUser")+"'"},onCurrentViewModelChanged:function(){this.get_currentViewModel().get_ViewModelID()==="SelectTrust"&&this.get_NextCommand()&&!this.getValue("_HasTrust")&&this.get_NextCommand().set_CanExecute(!1)}};function ConnectMBXSelectUserVM(){ConnectMBXSelectUserVM.initializeBase(this)}ConnectMBXSelectUserVM.prototype={onActive:function(){this.set_NextViewModelID(this.getValue("TargetMailboxType")==="LinkedMailbox"?"SelectTrust":"");WizardStepViewModel.prototype.onActive.call(this)}};function DurationConverter(){this.$2D_0=new RegExp(CommonRegex.get_NonNegativeDecimal1Reges())}DurationConverter.prototype={$2D_0:null,convertBack:function(n,t){var r=n;if(!this.$2D_0.test(r)){var u=String.format(Strings.get_InvalidDecimal1(),Globalize.get_CultureNumberDecimalSeparator());throw Error.create(Strings.ConstraintViolationStringDoesNotMatchRegularExpression(u,n));}var i=Number.parseLocale(r);i=i*60;if(!_Object.isNullOrUndefined(t)&&i>t)throw Error.create(String.format(Strings.get_ConstraintViolationValueOutOfRange(),0,(t/60).toFixed(1),n,""));return i.toFixed()},convert:function(n,t){var i=n/60;return Globalize.toLocaleNumberString(i.toFixed(1))}};function EmailAddressViewModel(){EmailAddressViewModel.initializeBase(this)}EmailAddressViewModel.prototype={$Q_6:!1,$u_6:null,$t_6:null,get_currentIdentity:function(){var n=this.get_values();if(this.$Q_6||this.get_IsEditingEumMail())return"EUM:"+this.$21_6();var t=n.Prefix;_Object.isNullOrUndefined(t)&&(_Object.isNullOrUndefined(n.IsNotSmtpAddress)||!n.IsNotSmtpAddress)&&(t="smtp");t=!_Object.isNullOrUndefined(n.ReplyAddress)&&n.ReplyAddress?t.toUpperCase():t.toLowerCase();return t+":"+n.AddressString},get_EUMExtension:function(){return this.$t_6},set_EUMExtension:function(n){if(n!==this.$t_6){this.$t_6=n;this.raisePropertyChanged("EUMExtension")}return n},get_IsEditingEumMail:function(){return this.getValue("IsEditingEumMail")},get_IsEumEmail:function(){return this.$Q_6},set_IsEumEmail:function(n){if(n!==this.$Q_6){this.$Q_6=n;this.raisePropertyChanged("IsEumEmail")}return n},get_EUMPhoneContext:function(){return this.$u_6},set_EUMPhoneContext:function(n){if(n!==this.$u_6){this.$u_6=n;this.raisePropertyChanged("EUMPhoneContext")}return n},get_valuesToSave:function(){if(this.$Q_6||this.get_IsEditingEumMail()){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.Prefix="EUM";n.AddressString=this.$21_6();return n}else return PropertyPageViewModel.prototype.get_valuesToSave.call(this)},onValueInitialized:function(){NotifyPropertyChangedJson.prototype.onValueInitialized.call(this);var n=this.getValue("Prefix");var t=!1;if(n&&n.toUpperCase()==="EUM"){t=!0;var i=this.getValue("AddressString");if(i){var r=i.split(";phone-context=");this.set_EUMExtension(r[0]);this.set_EUMPhoneContext(r[1])}}this.setValue("IsEditingEumMail",t)},$21_6:function(){return this.$t_6+";phone-context="+this.$u_6}};function EmailAddressConverter(){}EmailAddressConverter.prototype={convertFrom:function(n){var t=n;if(n){var i=t.Prefix;var r=t.AddressString;if(i||r){t.IsNotSmtpAddress=i&&(i==="SMTP"||i==="smtp")?!1:!0;t.ReplyAddress=i.toUpperCase()===i?!0:!1}else{t.IsNotSmtpAddress=!1;t.ReplyAddress=!1}}else{t={};t.IsNotSmtpAddress=!1;t.ReplyAddress=!1}return t},convertTo:function(n){var t=n;_Object.isNullOrUndefined(t.Prefix)&&(_Object.isNullOrUndefined(t.IsNotSmtpAddress)||!t.IsNotSmtpAddress)&&(t.Prefix="smtp");t.Prefix=!_Object.isNullOrUndefined(t.ReplyAddress)&&t.ReplyAddress?t.Prefix.toUpperCase():t.Prefix.toLowerCase();t.Identity=t.Prefix+":"+t.AddressString;return n}};function LinkedMailboxWizardInputCredentialVM(){LinkedMailboxWizardInputCredentialVM.initializeBase(this)}LinkedMailboxWizardInputCredentialVM.prototype={handleResults:function(n){WebServiceWizardStepViewModel.prototype.handleResults.call(this,n);!n||n.ErrorRecords&&n.ErrorRecords.length||this.setValue("_LinkedDCOptions",n.Output)}};function LinkedMailboxWizardSelectTrustVM(){LinkedMailboxWizardSelectTrustVM.initializeBase(this)}LinkedMailboxWizardSelectTrustVM.prototype={onNext:function(){var n=this.getValue("DomainName");if(_Object.isNullOrUndefined(n))WebServiceWizardStepViewModel.prototype.onNext.call(this);else{this.$23_5(n);this.onNextCompleted(new GoNextStepCompletedEventArgs(!1,this.get_NextViewModelID()))}},handleResults:function(n){WebServiceWizardStepViewModel.prototype.handleResults.call(this,n);if(!n||n.ErrorRecords&&n.ErrorRecords.length)this.$23_5(this.getValue("Forest"));else{this.set_NextViewModelID("SelectMasterAccount");this.setValue("_LinkedDCOptions",n.Output);this.setValue("_SkipCredential",!0);this.setValue("UserName","");this.setValue("Password","")}},$23_5:function(n){this.set_NextViewModelID("InputCredential");this.getValue("UserName")||this.setValue("UserName",n+"\\")}};function MailUserPageViewModelBase(){MailUserPageViewModelBase.initializeBase(this);this.addPropertyMapping("UserPrincipalName","UPNDomain");this.addPropertyMapping("UserPrincipalName","UPNName");this.addPropertyMapping("MicrosoftOnlineServicesID","WLDDomain");this.addPropertyMapping("MicrosoftOnlineServicesID","WLDName")}MailUserPageViewModelBase.prototype={get_UPNName:function(){if(this.getValue("UserPrincipalName")){var n=this.getValue("UserPrincipalName");return n.substring(0,n.lastIndexOf("@"))}else return""},set_UPNName:function(n){this.setValue("UserPrincipalName",(n||"")+"@"+this.get_UPNDomain());return n},get_WLDName:function(){if(this.getValue("MicrosoftOnlineServicesID")){var n=this.getValue("MicrosoftOnlineServicesID");return n.substring(0,n.lastIndexOf("@"))}else return""},set_WLDName:function(n){this.setValue("MicrosoftOnlineServicesID",(n||"")+"@"+this.get_WLDDomain());return n},get_UPNDomain:function(){if(this.getValue("UserPrincipalName")){var n=this.getValue("UserPrincipalName");return n.substr(n.lastIndexOf("@")+1)}else return""},set_UPNDomain:function(n){this.setValue("UserPrincipalName",this.get_UPNName()+"@"+(n||""));return n},get_WLDDomain:function(){if(this.getValue("MicrosoftOnlineServicesID")){var n=this.getValue("MicrosoftOnlineServicesID");return n.substr(n.lastIndexOf("@")+1)}else return""},set_WLDDomain:function(n){this.setValue("MicrosoftOnlineServicesID",this.get_WLDName()+"@"+(n||""));return n}};function MailUserPropertyPageViewModel(){MailUserPropertyPageViewModel.initializeBase(this);this.set_propertyConverters({EmailAddresses:ValueConverter.ToIdentity,AcceptMessagesOnlyFromSendersOrMembers:ValueConverter.ToIdentity,RejectMessagesFromSendersOrMembers:ValueConverter.ToIdentity});this.addPropertyMapping("HasArchive","CanShowArchive");this.addPropertyMapping("MailboxCanHaveArchive","CanShowArchive");this.addPropertyMapping("HasArchive","HasArchiveOrInMultiTenant");this.addPropertyMapping("LitigationHoldDate","_ValidatedLitigationHoldDate");this.addPropertyMapping("LitigationHoldOwner","_ValidatedLitigationHoldOwner");this.addPropertyMapping("_EASVisible","MobileFeaturesVisible");this.addPropertyMapping("_MOWAVisible","MobileFeaturesVisible");this.addPropertyMapping("ExternalEmailAddress","ExternalEmailAddressesSource");this.addPropertyMapping("EmailAddresses","ExternalEmailAddressesSource")}MailUserPropertyPageViewModel.prototype={get_UseDatabaseQuotaDefaults:function(){return this.getValue("UseDatabaseQuotaDefaults")},set_UseDatabaseQuotaDefaults:function(n){this.setValue("UseDatabaseQuotaDefaults",n);if(!n){this.makeDirty("IssueWarningQuota");this.makeDirty("ProhibitSendQuota");this.makeDirty("ProhibitSendReceiveQuota")}return n},get_MobileFeaturesVisible:function(){return this.getValue("_EASVisible")||this.getValue("_MOWAVisible")},get_CanShowArchive:function(){return this.getValue("HasArchive")||this.getValue("MailboxCanHaveArchive")},get_HasArchiveOrInMultiTenant:function(){return this.getValue("HasArchive")||this.get_AdhocValues().get_values().MultiTenantRoles},get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);_Object.isUndefined(n.EnableArchive)||(n.HasArchive=this.getValue("HasArchive"));return n},get_UnlimitedOption:function(){return[ByteQuotaConverter.unlimited]},updateResults:function(){PropertyPageViewModel.prototype.updateResults.call(this);this.setValue("_ValidatedLitigationHoldDate",this.$2I_6("LitigationHoldDate",Strings.get_LitigationHoldDateNotSet()));this.setValue("_ValidatedLitigationHoldOwner",this.$2I_6("LitigationHoldOwner",Strings.get_LitigationHoldOwnerNotSet()))},get_ExternalEmailAddressesSource:function(){var t=[];var n=this.getProperty("ExternalEmailAddress");_Object.isNullOrUndefined(n)||Array.add(t,n);var u=this.getProperty("EmailAddresses");if(!_Object.isNullOrUndefined(u))for(var f=u,e=f.length,i=0;i<e;++i){var r=f[i];r.Identity&&(_Object.isNullOrUndefined(n)||n.toUpperCase()===r.Identity.toUpperCase()||Array.add(t,r.Identity))}return t},$2I_6:function(n,t){var i=this.getValue(n);return EcpUtil.isNullOrEmpty(i)?t:i}};function NewLinkedMailboxViewModel(){this.$$d_$2y_5=Function.createDelegate(this,this.$2y_5);NewLinkedMailboxViewModel.initializeBase(this);this.add_propertyChanged(this.$$d_$2y_5);this.setValue("_HasTrust",!1)}NewLinkedMailboxViewModel.prototype={$2A_5:null,onCurrentViewModelChanged:function(){WizardViewModel.prototype.onCurrentViewModelChanged.call(this);this.get_NextCommand()&&!this.getValue("_HasTrust")&&this.get_NextCommand().set_CanExecute(!1)},$2y_5:function(n,t){if(t.get_propertyName()==="_SelectedTrust"){var i=this.getValue("_SelectedTrust");var u=!!i;this.setValue("_HasTrust",u);if(u){var r=i.TrustName;if(this.$2A_5!==r){this.$36_5();var f=i.IsForest;var e=f?"Forest":"DomainName";this.setValue(e,r);this.$2A_5=r}}}},$36_5:function(){try{this.setValue("DomainName",null);this.setValue("Forest",null);this.setValue("UserName","");this.setValue("Password","");this.setValue("_SkipCredential",!1);this.setValue("LinkedMasterAccount","")}catch(n){}}};function NewMailboxOnPremisePageViewModel(){NewMailboxOnPremisePageViewModel.initializeBase(this)}NewMailboxOnPremisePageViewModel.prototype={get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.ArchiveDomain=this.get_AdhocValues().get_values().TargetDeliveryDomain;return n}};function NewTeamMailboxControl(n){this.$$d_$2p_3=Function.createDelegate(this,this.$2p_3);this.$$d_executeCommandCompleted=Function.createDelegate(this,this.executeCommandCompleted);this.$$d_$2z_3=Function.createDelegate(this,this.$2z_3);this.$$d_onLoad=Function.createDelegate(this,this.onLoad);NewTeamMailboxControl.initializeBase(this,[n])}NewTeamMailboxControl.$2i=function(n){var i=new Sys.StringBuilder;if(n&&n.length>0)for(var t=0;t<n.length;t++){n[t].Message&&i.append(EcpUtil.htmlEncode(n[t].Message));if(n[t].CallStack){var r=String.format("<br />{0}<br />",EcpUtil.htmlEncode(n[t].CallStack));i.append(r)}}return i.toString()};NewTeamMailboxControl.prototype={$M_3:null,$5_3:null,$9_3:null,$12_3:null,$1M_3:null,$K_3:null,$z_3:!1,$2H_3:null,get_DisplayName:function(){return this.$1M_3},set_DisplayName:function(n){this.$1M_3=n;return n},get_SharePointUrl:function(){return this.$K_3},set_SharePointUrl:function(n){this.$K_3=n;return n},get_TeamMailboxAppUrl:function(){return this.$2H_3},set_TeamMailboxAppUrl:function(n){this.$2H_3=n;return n},get_BrandingLink:function(){return this.$M_3},set_BrandingLink:function(n){this.$M_3=n;return n},get_ContentPanel:function(){return this.$5_3},set_ContentPanel:function(n){this.$5_3=n;return n},initialize:function(){EcpControl.prototype.initialize.call(this);this.$12_3=this.$$d_onLoad;Sys.Application.add_load(this.$12_3);$addHandler(this.$M_3,"click",this.$$d_$2z_3);this.$5_3.innerHTML=OwaOptionStrings.get_NewTeamMailboxInProgress();this.$5_3.innerHTML=this.$2l_3();this.$5_3.focus()},dispose:function(){this.$12_3&&Sys.Application.remove_load(this.$12_3);this.$M_3&&$removeHandler(this.$M_3,"click",this.$$d_$2z_3);this.$9_3&&this.$9_3.remove_completed(this.$$d_executeCommandCompleted);EcpControl.prototype.dispose.call(this)},onLoad:function(n,t){this.$9_3=new WebServiceCommand;this.$9_3.init("../DDI/DDIService.svc?schema=TeamMailboxProperties","NewObject",this.$$d_$2p_3);this.$9_3.get_webServiceMethod().set_ParameterNames(3);this.$9_3.add_completed(this.$$d_executeCommandCompleted);this.$9_3.execute()},executeCommandCompleted:function(n,t){var i=this.$9_3.get_LastResults();if(i){if(i.ErrorRecords&&i.ErrorRecords.length>0){var r=NewTeamMailboxControl.$2i(i.ErrorRecords);!EcpUtil.isNullOrEmpty(r)&&(r.indexOf("ERRCODEURL")>0||r.indexOf("HttpStatusCode:Unauthorized")>0)||(this.$z_3=!0);this.$5_3.innerHTML=this.$22_3(r);this.$5_3.focus();return}}else{this.$5_3.innerHTML=this.$22_3("");this.$5_3.focus();return}this.$z_3=!0;this.$5_3.innerHTML=this.$2o_3();this.$5_3.focus()},$2p_3:function(){var n={};n.DisplayName=this.$1M_3;n.SharePointUrl=this.$K_3;return[n]},$2z_3:function(n){this.$z_3?window.location.href=this.$K_3:alert(OwaOptionStrings.get_TeamMailboxCreationFailedPageLinkBackToSiteDisabled())},$2l_3:function(){return String.format('<table cellpadding="0" cellspacing="0"><tr><td class="newTMContentTitle"><span class="dspBlock breakWord" tabindex="0">{0}</span></td></tr><tr><td><div class="newTMContentDetails" tabindex="0">{1}</div></td></tr><tr><td class="newTMContentLink">{2}</td></tr></table>',OwaOptionStrings.get_NewTeamMailboxInProgress(),"","")},$2o_3:function(){var n=String.format('<span class="dspBlock breakWord"><a href="{0}">{1}</a></span>',this.$K_3,OwaOptionStrings.get_TeamMailboxCreationCompletionPageLinkBackToSite());return String.format('<table cellpadding="0" cellspacing="0"><tr><td class="newTMContentTitle"><span class="dspBlock breakWord" tabindex="0">{0}</span></td></tr><tr><td><div class="newTMContentDetails" tabindex="0">{1}</div></td></tr><tr><td class="newTMContentLink">{2}</td></tr></table>',OwaOptionStrings.get_TeamMailboxCreationCompletionPageHeadingText(),OwaOptionStrings.get_TeamMailboxCreationCompletionPageDetailedText(),n)},$22_3:function(n){var t=OwaOptionStrings.get_TeamMailboxCreationFailedPageLinkBackToSiteDisabled();this.$z_3&&(t=String.format('<span class="dspBlock breakWord"><a href="{0}">{1}</a></span>',this.$K_3,OwaOptionStrings.get_TeamMailboxCreationCompletionPageLinkBackToSite()));return String.format('<table cellpadding="0" cellspacing="0"><tr><td class="newTMContentTitle"><span class="dspBlock breakWord" tabindex="0">{0}</span></td></tr><tr><td><div class="newTMContentDetails" tabindex="0">{1}</div></td></tr><tr><td class="newTMContentLink">{2}</td></tr></table>',OwaOptionStrings.get_NewTeamMailboxFailed(),n,t)}};function RecipientViewModel(){this.$$d_$38_4=Function.createDelegate(this,this.$38_4);this.$d_4=["Name"];RecipientViewModel.initializeBase(this);for(var n=1;n<=15;n++)this.addPropertyMapping("CustomAttribute"+n.toString().trim(),"CustomAttributes");this.$15_4=this.$$d_$38_4;this.add_propertyChanged(this.$15_4)}RecipientViewModel.prototype={$15_4:null,get_CustomAttributes:function(){for(var t=[],n=1;n<=15;n++){var i="CustomAttribute"+n.toString().trim();this.getValue(i)&&(t=t.concat({DisplayName:n,Value:this.getValue(i)}))}return t},get_AutoGenerateNameProperties:function(){return this.$d_4},set_AutoGenerateNameProperties:function(n){this.$d_4=n;return n},get_FirstName:function(){return this.getValue("FirstName")},set_FirstName:function(n){this.$1d_4("FirstName",n);return n},get_Initials:function(){return this.getValue("Initials")},set_Initials:function(n){this.$1d_4("Initials",n);return n},get_LastName:function(){return this.getValue("LastName")},set_LastName:function(n){this.$1d_4("LastName",n);return n},dispose:function(){this.$15_4&&this.remove_propertyChanged(this.$15_4);PropertyPageViewModel.prototype.dispose.call(this)},$38_4:function(n,t){t.get_propertyName().startsWith("CustomAttribute")&&t.get_propertyName()!=="CustomAttributes"&&this.raisePropertyChanged("CustomAttributes")},$1d_4:function(n,t){var i=this.$2j_4();var r=this.getValue(n);this.setValue(n,t);var u=this.getValue(n);_Object.isValueChanged(r,u)&&i.length>0&&this.$3D_4(i)},$20_4:function(){var n=null;var t=this.getValue("FirstName");var r=this.getValue("Initials");var i=this.getValue("LastName");n=EcpUtil.isNullOrEmpty(r)?EcpUtil.isNullOrEmpty(t)&&EcpUtil.isNullOrEmpty(i)?null:Strings.NameFromFirstLastName(t,i):Strings.NameFromFirstInitialsLastName(t,r,i);n&&(n=n.trim());return n},$3D_4:function(n){for(var r=this.$20_4(),i=n,u=i.length,t=0;t<u;++t){var f=i[t];try{this.setValue(f,r)}catch(e){}}},$2j_4:function(){for(var t=new Array(0),f=this.$20_4(),i=this.$d_4,e=i.length,n=0;n<e;++n){var r=i[n];var u=this.getValue(r);(EcpUtil.isNullOrEmpty(u)||u===f)&&Array.add(t,r)}return t}};function SmtpAddressControl(n){SmtpAddressControl.initializeBase(this,[n])}SmtpAddressControl.prototype={get_Value:function(){return this.get_$Y_3().getProperty("_UserName")+"@"+this.get_$Y_3().getProperty("_DomainName")},set_Value:function(n){if(!_Object.isNullOrUndefined(n)&&this.get_$Y_3()&&n!==this.get_Value()){var t=n.split("@");this.get_$Y_3().setProperty("_UserName",t[0]);this.get_$Y_3().setProperty("_DomainName",t[1])}return n},get_$Y_3:function(){return this.get_DataContext()}};function TeamMailboxPage(n){TeamMailboxPage.initializeBase(this,[n])}TeamMailboxPage.prototype={initialize:function(){BaseForm.prototype.initialize.call(this);this.get_CancelButton().style.display="none"}};function TeamMailboxPropertyPageViewModel(){TeamMailboxPropertyPageViewModel.initializeBase(this)}TeamMailboxPropertyPageViewModel.prototype={get_LifecycleStatusString1:function(){var n=this.getValue("Active");return n?OwaOptionStrings.get_TeamMailboxLifecycleStatusActiveString1():OwaOptionStrings.TeamMailboxLifecycleStatusClosedString1(this.getValue("ClosedTime"))},get_LifecycleStatusString2:function(){var n=this.getValue("Active");return n?OwaOptionStrings.get_TeamMailboxLifecycleStatusActiveString2():OwaOptionStrings.get_TeamMailboxLifecycleStatusClosedString2()}};function TeamMailboxViewModel(){this.$$d_$2Z_4=Function.createDelegate(this,this.$2Z_4);this.$$d_$3E_4=Function.createDelegate(this,this.$3E_4);TeamMailboxViewModel.initializeBase(this);this.set_propertyConverters({Members:ValueConverter.ToIdentity});var n=new WebServiceCommand;n.init(EcpUrl.get_ecpFullUrl()+"DDI/DDIService.svc?schema=TeamMailboxProperties&workflow=UpdateTeamMailbox","SetObject",this.$$d_$3E_4);n.get_webServiceMethod().set_ParameterNames(4);n.set_RefreshAction(2);var i=this;n.add_completed(function(t,r){var u=n.get_LastResults();i.set_SyncStarted(!0);u&&u.ErrorRecords&&u.ErrorRecords.length>0&&ErrorHandling.showPowerShellErrors(u)});this.get_Commands().setProperty("TeamMailboxUpdateCommand",n);var t=new WebServiceCommand;t.init(EcpUrl.get_ecpFullUrl()+"DDI/DDIService.svc?schema=TeamMailboxProperties&workflow=EmailTeamMailboxDiagnostics","SetObject",this.$$d_$2Z_4);t.get_webServiceMethod().set_ParameterNames(4);t.set_RefreshAction(2);var r=this;t.add_completed(function(n,i){var u=t.get_LastResults();r.set_DiagnosticsDetailsSent(!0);u&&(u.ErrorRecords&&u.ErrorRecords.length>0?ErrorHandling.showPowerShellErrors(u):MessageBox.showMessage(OwaOptionStrings.get_SiteMailboxEmailMeDiagnosticsConfirmation(),MessageBoxType.information))});this.get_Commands().setProperty("TeamMailboxDiagnosticsCommand",t)}TeamMailboxViewModel.prototype={$24_4:!1,get_SyncStarted:function(){return this.getValue("SyncStarted")},set_SyncStarted:function(n){this.setValue("SyncStarted",n);this.raisePropertyChanged("SyncStarted");return n},get_DiagnosticsDetailsSent:function(){return this.getValue("DiagnosticsDetailsSent")},set_DiagnosticsDetailsSent:function(n){this.setValue("DiagnosticsDetailsSent",n);this.raisePropertyChanged("DiagnosticsDetailsSent");return n},get_SharePointUrl:function(){return this.getValue("SharePointUrl")},set_SharePointUrl:function(n){EcpUtil.isNullOrEmpty(n)&&(n=null);this.setValue("SharePointUrl",n);this.raisePropertyChanged("SharePointUrl");return n},updateResults:function(){PropertyPageViewModel.prototype.updateResults.call(this);this.$24_4||(this.$24_4=!0);this.makeDirty("IsOwner")},$3E_4:function(){var n={};return[this.get_Identity(),n]},$2Z_4:function(){var n={};n.SendMeEmail=!0;return[this.get_Identity(),n]}};function ViewUserMailboxDetailsPageViewModel(){this.$$d_$27_5=Function.createDelegate(this,this.$27_5);this.$10_5=CrossSlabRefresher.createRefresher("MigrationBatches",!1,Strings.get_JumpToMigrationSlabConfirmation());this.$16_5=CrossSlabRefresher.createRefresher("MigrationBatches",!0,Strings.get_JumpToMigrationSlabConfirmation(),Strings.get_JumpToOffice365MigrationSlabFailed());ViewUserMailboxDetailsPageViewModel.initializeBase(this)}ViewUserMailboxDetailsPageViewModel.preCheckOnboarding=function(n){if(EcpUtil.isHybridUI()){if(!EcpUtil.isInRoleOnOtherPremise("Onboarding")){MessageBox.showMessage(Strings.get_NoOnboardingPermission(),MessageBoxType.warning);return!1}}else{var i=EcpApplication.get_instance();if(i&&EcpUrl.getUrlParameter(i.get_navigationWindow().location.href,"xprs"))MessageBox.showMessage(Strings.get_WaitForHybridUIReady(),MessageBoxType.warning);else{var t=new Info;t.set_Title(Strings.get_Information());t.Message=Strings.get_SetupHybridUIFirst();var r="EnterHybridUI";var u=new DialogButton(Strings.get_EnterHybridUIButtonText(),r);MessageBox.showChoices(t,[u],null,function(t,i){t===r&&JumpTo("office365",!1,n)},null)}return!1}return!0};ViewUserMailboxDetailsPageViewModel.prototype={get_LocalMoveRefresher:function(){return this.$10_5},get_RemoteMoveRefresher:function(){return this.$16_5},get_CanShowArchive:function(){return this.getValue("HasArchive")||this.getValue("MailboxCanHaveArchive")&&this.get_AdhocValues().get_values().CanEnableArchiveRoles},get_IsLinkOrSharedMailbox:function(){return this.getValue("IsLinkedMailbox")||this.getValue("IsSharedMailbox")},get_MigrationArgumentsStr:function(){return Sys.Serialization.JavaScriptSerializer.serialize([this.getValue("PrimarySmtpAddress")])},get_CanShowMigration:function(){return this.get_AdhocValues().getProperty("EnterpriseHybrid")||this.get_AdhocValues().getProperty("LocalMoveRoles")},get_CanShowViewMobileDevices:function(){return this.getValue("ActiveSyncEnabled")||this.getValue("OWAforDevicesEnabled")},initialize:function(){PropertyPageViewModel.prototype.initialize.call(this);var n=this.get_Commands().getProperty("MigrationOnboardingCommand");n.add_preExecute(this.$$d_$27_5)},$27_5:function(n,t){ViewUserMailboxDetailsPageViewModel.preCheckOnboarding(this.get_AdhocValues().getProperty("OnPremiseLinkToOffice365"))||t.set_cancel(!0)}};function UniversalGroupsViewModel(){UniversalGroupsViewModel.initializeBase(this);this.addPropertyMapping("PrimarySmtpAddress","SmtpDomain");this.addPropertyMapping("PrimarySmtpAddress","SmtpName");this.set_propertyConverters({EmailAddresses:ValueConverter.ToIdentity})}UniversalGroupsViewModel.prototype={$1R_5:!1,$1T_5:!1,$1S_5:!1,initialize:function(){PropertyPageViewModel.prototype.initialize.call(this);this.set_IsMembershipApprovalOpenEnabled(this.get_IsSecurityGroupType()?!1:!0)},get_SmtpName:function(){if(this.getValue("PrimarySmtpAddress")){var n=this.getValue("PrimarySmtpAddress");return n.substring(0,n.lastIndexOf("@"))}else return""},set_SmtpName:function(n){this.setValue("PrimarySmtpAddress",(n||"")+"@"+this.get_SmtpDomain());return n},get_SmtpDomain:function(){if(this.getValue("PrimarySmtpAddress")){var n=this.getValue("PrimarySmtpAddress");return n.substr(n.lastIndexOf("@")+1)}else return""},set_SmtpDomain:function(n){this.setValue("PrimarySmtpAddress",this.get_SmtpName()+"@"+(n||""));return n},get_IsSecurityGroupType:function(){return this.getValue("IsSecurityGroupType")},set_IsSecurityGroupType:function(n){this.setValue("IsSecurityGroupType",n);if(this.$1R_5){var i=this.getValue("MemberDepartRestriction");var r=this.getValue("MemberJoinRestriction");var u=_Object.isUndefined(i)||i==="Open";var f=_Object.isUndefined(r)||r==="Open";if(n&&(u||f)){var t=this;MessageBox.showMessageWithCallback(Strings.get_MemberApprovalHasChanged(),MessageBoxType.information,function(n,i){u&&t.setValue("MemberDepartRestriction","Closed");f&&t.setValue("MemberJoinRestriction","Closed");t.set_IsMembershipApprovalOpenEnabled(!1);t.set_IsMembershipApprovalDivFocused(!0)})}else{this.set_IsMembershipApprovalOpenEnabled(!n);this.set_IsMembershipApprovalDivFocused(!1)}}return n},get_IsMembershipApprovalOpenEnabled:function(){return this.$1T_5},set_IsMembershipApprovalOpenEnabled:function(n){if(n!==this.$1T_5){this.$1T_5=n;this.raisePropertyChanged("IsMembershipApprovalOpenEnabled")}return n},get_IsMembershipApprovalDivFocused:function(){return this.$1S_5},set_IsMembershipApprovalDivFocused:function(n){if(n!==this.$1S_5){this.$1S_5=n;this.raisePropertyChanged("IsMembershipApprovalDivFocused")}return n},get_isInOwaOption:function(){return this.$1R_5},set_isInOwaOption:function(n){this.$1R_5=n;return n}};function PublicFolderColumnHeader(n,t,i,r,u,f,e,o,s){PublicFolderColumnHeader.initializeBase(this,[n,t,i,r,u,f,e,o,s])}PublicFolderColumnHeader.prototype={renderItem:function(n,t,i){var u=null;this.get_name()&&(u=DataBinder.getPropertyValue(n,this.get_name()));var f=null;f=DataBinder.getPropertyValue(n,"EntryId");var e=!1;e=DataBinder.getPropertyValue(n,"HasSubfolders");var r=new Sys.StringBuilder;r.append(String.format("<u><span tabindex=\"0\" onkeydown=\"javascript:$get('{0}').control.drillDownOnKeyDownHandler(event, '{1}');\" onclick=\"javascript:$get('{0}').control.searchFor('{1}');\" onmouseover=\"this.style.cursor='pointer';this.style.cursor='hand'\" onmouseout=\"\">",this.listView.get_id(),f));r.append(EcpUtil.htmlEncode(u));r.append("</span></u>");return r.toString()}};function PublicFoldersListView(n){PublicFoldersListView.initializeBase(this,[n])}PublicFoldersListView.PublicFolderUpArrowCommandHandler=function(n){for(var i=n.get_toolBar().get_OwnerControl().get_SearchTextBox().get_text().split("\\"),r=new Sys.StringBuilder,t=0;t<i.length-1;t++){r.append(i[t]);i.length-2!==t&&r.append("\\")}n.get_toolBar().get_OwnerControl().get_SearchTextBox().set_text(r.toString());n.get_toolBar().get_OwnerControl().prepareSearchTextBox();n.get_toolBar().get_OwnerControl().get_SearchTextBox().invokeSearch()};PublicFoldersListView.prototype={$1e_4:!1,get_showAll:function(){return this.$1e_4},set_showAll:function(n){this.$1e_4!==n&&(this.$1e_4=n);return n},initialize:function(){ListView.prototype.initialize.call(this);this.get_SearchTextBox().set_RemoveWhitespacesFromText(!1)},searchFor:function(n){for(var i=this.get_items(),u=i.length,t=0;t<u;++t){var r=i[t];var f=DataBinder.getPropertyValue(r.get_dataObjectId(),"RawIdentity");if(f===n){this.get_SearchTextBox().set_text(DataBinder.getPropertyValue(r.get_dataObject(),"FolderPath"));this.prepareSearchTextBox();this.get_SearchTextBox().invokeSearch();break}}},prepareSearchTextBox:function(){if(EcpUtil.isNullOrBlank(this.get_text()))this.get_SearchTextBox().get_searchMode()===1?this.get_SearchTextBox().set_searchMode(0):this.get_SearchTextBox().get_searchMode()===3&&this.get_SearchTextBox().set_searchMode(2);else if(this.get_text()!==this.get_SearchTextBox().get_filterText())switch(this.get_SearchTextBox().get_searchMode()){case 0:this.get_SearchTextBox().set_searchMode(1);break;case 2:this.get_SearchTextBox().set_searchMode(3);break}},drillDownOnKeyDownHandler:function(n,t){if(n.keyCode===13){n.preventDefault();n.stopPropagation();this.searchFor(t)}},recreateItems:function(){this.get_SearchTextBox().get_text()&&this.get_SearchTextBox().get_text().trim().length&&this.get_SearchTextBox().get_text()!=="\\"?this.set_EmptyDataText(Strings.get_PublicFoldersEmptyDataTextChildren()):this.set_EmptyDataText(Strings.get_PublicFoldersEmptyDataTextRoot());ListView.prototype.recreateItems.call(this)}};function PublicFolderPermissionInfoViewModel(){PublicFolderPermissionInfoViewModel.initializeBase(this)}PublicFolderPermissionInfoViewModel.sumAccessRights=function(n){var i=0;if(n&&n.length>0)for(var r=n,u=r.length,t=0;t<u;++t){var f=r[t];i+=Number.parseInvariant(f)}return i.toString()};PublicFolderPermissionInfoViewModel.prototype={get_PermissionLevel:function(){return this.getPermissionLevel()},set_PermissionLevel:function(n){this.get_PermissionLevel()!==n&&this.setValue("AccessRights",this.getAccessRights(n));return n},get_AccessRights:function(){return this.getValue("AccessRights")},set_AccessRights:function(n){this.setValue("AccessRights",n);this.raisePropertyChanged("PermissionLevel");return n},getPermissionLevel:function(){var n=PublicFolderPermissionInfoViewModel.sumAccessRights(this.get_AccessRights());return n in PublicFolderPermissionInfoViewModel.permissionSets?n:0..toString()},getAccessRights:function(n){return PublicFolderPermissionInfoViewModel.permissionSets[n]},validateSave:function(){var n=PropertyPageViewModel.prototype.validateSave.call(this);if(n){var t=this.getValue("AccessRights");if(t&&!t.length){n=!1;var i=this;window.setTimeout(function(){MessageBox.showMessage(Strings.get_PermissionLevelWarning(),MessageBoxType.error)},0)}}return n}};function PublicFolderPermissionInfoConverter(){}PublicFolderPermissionInfoConverter.prototype={convertTo:function(n){return PublicFolderPermissionInfo.copyToPublicFolderPermissionInfo(n)},convertFrom:function(n){return _Object.isNullOrUndefined(n)?new PublicFolderPermissionInfo:n}};function PublicFolderPermissionInfoListConverter(){}PublicFolderPermissionInfoListConverter.prototype={convertBack:function(n,t){var r=[];if(null!==n&&Array.isInstanceOfType(n))for(var u=n,i=0;i<u.length;i++)Array.add(r,PublicFolderPermissionInfo.copyToDictionary(u[i]));return r},convert:function(n,t){var r=[];if(null!==n&&Array.isInstanceOfType(n))for(var u=n,i=0;i<u.length;i++)Array.add(r,PublicFolderPermissionInfo.copyToPublicFolderPermissionInfo(u[i]));return r}};function PublicFolderPermissionInfo(){this.AccessRights=PublicFolderPermissionInfoViewModel.permissionSets[1275..toString()]}PublicFolderPermissionInfo.copyToPublicFolderPermissionInfo=function(n){var t=null;if(null!==n){var i=n;var r=PublicFolderPermissionInfoViewModel.sumAccessRights(i.AccessRights);t=new PublicFolderPermissionInfo;t.User=i.User;t.AccessRights=i.AccessRights;t.RawIdentity=t.User.DisplayName;t.UserName=t.User.DisplayName;t.Sid=i.Sid;t.PermissionLevelText=PublicFolderPermissionInfo.getPermissionName(r)}return t};PublicFolderPermissionInfo.copyToDictionary=function(n){var t={};t.__type="PublicFolderPermissionInfo:ECP";t.User=n.User;t.Sid=n.Sid;t.AccessRights=n.AccessRights;return t};PublicFolderPermissionInfo.getPermissionName=function(n){var t=null;switch(Number.parseInvariant(n)){case 1051:t=Strings.get_Author();break;case 1026:t=Strings.get_Contributor();break;case 1147:t=Strings.get_Editor();break;case 1043:t=Strings.get_NonEditingAuthor();break;case 2043:t=Strings.get_Owner();break;case 1243:t=Strings.get_PublishingAuthor();break;case 1275:t=Strings.get_PublishingEditor();break;case 1025:t=Strings.get_Reviewer();break;default:t=Strings.get_Custom();break}return t};PublicFolderPermissionInfo.prototype={RawIdentity:null,UserName:null,Sid:null,User:null,AccessRights:null,PermissionLevelText:null};function CrossSlabRefresher(n,t,i){this.$U_0=n;this.$1h_0=t;this.$1L_0=i}CrossSlabRefresher.createRefresher=function(n,t,i,r){var f=EcpApplication.get_instance();var u=null;if(f&&f.get_Navigation()){u=new CrossSlabRefresher(f.get_Navigation(),n,t);u.$g_0=i;u.$v_0=r}return u};CrossSlabRefresher.prototype={$1h_0:null,$1L_0:!1,$U_0:null,$g_0:null,$v_0:null,get_confirmationText:function(){return this.$g_0},set_confirmationText:function(n){this.$g_0=n;return n},get_failedMessage:function(){return this.$v_0},set_failedMessage:function(n){this.$v_0=n;return n},refresh:function(){throw Error.notImplemented();},refreshObject:function(n){if(this.$U_0.get_mainFrameVisible())if(this.$1L_0){var t=this;this.$U_0.checkActionAvailable(25,function(i,r){i&&r&&t.$2E_0(n)})}else this.$2E_0(n)},removeObject:function(n){throw Error.notImplemented();},$2E_0:function(n){var t=new Info;t.Message=this.$g_0;t.MessageType=MessageBoxType.information;t.set_Title(Strings.get_Information());var i=this;MessageBox.show(t,2,function(t,r){if(t===ModalDialogResult.yes){var u=i.$2k_0(n);i.$2x_0(u?u.RawIdentity:null)}},null)},$2x_0:function(n){this.$1L_0?this.$U_0.jumpToCrossSite(this.$1h_0,n,this.$v_0):this.$U_0.jumpTo(this.$1h_0,!1,n)},$2k_0:function(n){return _PowerShellResults.hasOutput(n)?DataBinder.getPropertyValue(n.Output[0],"Identity"):null},mergeRefresh:function(n){throw Error.notImplemented();},get_refreshing:function(){throw Error.notImplemented();},get_returnObjectType:function(){return 1},get_warnings:function(){throw Error.notImplemented();},add_refreshStarted:function(n){throw Error.notImplemented();},remove_refreshStarted:function(n){throw Error.notImplemented();},add_refreshCompleted:function(n){throw Error.notImplemented();},remove_refreshCompleted:function(n){throw Error.notImplemented();}};function PSTMailboxMoveViewModel(){PSTMailboxMoveViewModel.initializeBase(this)}PSTMailboxMoveViewModel.prototype={initialize:function(){WizardViewModel.prototype.initialize.call(this);var n=PopupWindowManager.getPopupWindowArguments();n&&!_Object.isNullOrUndefined(n.Identity)&&this.setValue("Mailbox",[n.Identity]);var t=this.get_AdhocValues().getProperty("UserPrimarySmtpAddress");var i=this.get_AdhocValues().getProperty("UserDisplayName");_Object.isNullOrUndefined(t)||_Object.isNullOrUndefined(i)||this.setValue("NotificationEmails",[new Identity(t,i)])}};function NewSharedMailboxViewModel(){NewSharedMailboxViewModel.initializeBase(this)}NewSharedMailboxViewModel.prototype={saveConfirm:function(n,t){var i=new Info;i.MessageType=MessageBoxType.information;i.set_Title(Strings.get_MailboxDelegation());i.Message=Strings.get_MailboxDelegationDetail();var r=this;MessageBox.show(i,4,function(i,r){i===ModalDialogResult.OK?n():t()},null)}};function AcceptedDomainViewModel(){AcceptedDomainViewModel.initializeBase(this)}AcceptedDomainViewModel.prototype={get_DomainTypeVM:function(){this.makeDirty("DomainType");return this.getValue("DomainType")},set_DomainTypeVM:function(n){if(n==="Authoritative"&&this.getValue("DomainType")!=="Authoritative"){var t=new Info;t.MessageType=MessageBoxType.warning;t.Message=Strings.get_AcceptedDomainAuthoritativeWarning();this.setValue("MatchSubDomains",!1);var i=this;MessageBox.showCustom(t,1,function(t,r){t===ModalDialogResult.OK?i.setValue("DomainType",n):i.raisePropertyChanged("DomainTypeVM")},null)}else this.setValue("DomainType",n);return n}};function AddressSpaceEntryViewModel(){AddressSpaceEntryViewModel.initializeBase(this)}AddressSpaceEntryViewModel.prototype={get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.Cost=Number.parseInvariant(n.Cost).toString();n.AddressSpaceKey=n.Type+":"+n.Address+";"+n.Cost;return n},initDefaultValue:function(){if(this.get_IsForNew()){this.setValue("Type","SMTP");this.setValue("Cost",1)}}};function InboundConnectorViewModel(){this.$$d_$2s_4=Function.createDelegate(this,this.$2s_4);this.$17_4=new RequiredFieldValidator(new ValidatorInfo);InboundConnectorViewModel.initializeBase(this)}InboundConnectorViewModel.prototype={initialize:function(){PropertyPageViewModel.prototype.initialize.call(this);this.add_propertyChanged(this.$$d_$2s_4)},dispose:function(){this.remove_propertyChanged(this.$$d_$2s_4);PropertyPageViewModel.prototype.dispose.call(this)},get_SenderIPAddressListVM:function(){return this.getValue("senderIPAddressList")},set_SenderIPAddressListVM:function(n){this.setValue("senderIPAddressList",n);(this.getValue("TLSOpportunistic")||this.getValue("RestrictDomainsToIPAddresses"))&&this.$17_4.validate(n);return n},get_EnableCertEditVM:function(){var n;n=this.getValue("TLSForced")&&this.getValue("ConnectorType")==="Partner"&&this.getValue("RestrictDomainsToCertificate")||this.getValue("TLSForced")&&this.getValue("ConnectorType")!=="Partner"?!0:!1;this.setValue("EnableCertEditVM",n);this.makeDirty("EnableCertEditVM");return n},set_EnableCertEditVM:function(n){return n},get_EnableIPAddressEditVM:function(){return this.getValue("TLSForced")&&this.getValue("ConnectorType")==="Partner"&&this.getValue("RestrictDomainsToCertificate")?!1:!0},set_EnableIPAddressEditVM:function(n){return n},$2s_4:function(n,t){if(t.get_propertyName()==="ConnectorType"||t.get_propertyName()==="TLSForced"||t.get_propertyName()==="RestrictDomainsToCertificate"){this.raisePropertyChanged("EnableCertEditVM");this.raisePropertyChanged("EnableIPAddressEditVM")}}};function IPBindingEntryViewModel(){IPBindingEntryViewModel.initializeBase(this)}IPBindingEntryViewModel.prototype={get_AllIPv4:function(){return this.getValue("AllIPv4")},set_AllIPv4:function(n){this.setValue("AllIPv4",n);if(n){this.setValue("Address",null);this.setValue("DisplayAddress",Strings.get_ConnectorAllAvailableIPv4())}return n},get_AllIPv6:function(){return this.getValue("AllIPv6")},set_AllIPv6:function(n){this.setValue("AllIPv6",n);if(n){this.setValue("Address",null);this.setValue("DisplayAddress",Strings.get_ConnectorAllAvailableIPv6())}return n},get_Address:function(){return this.getValue("Address")},set_Address:function(n){this.setValue("Address",n);this.setValue("DisplayAddress",n);return n},get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);if(this.getValue("AllIPv4")){n.Address="0.0.0.0";n.DisplayAddress=Strings.get_ConnectorAllAvailableIPv4()}else if(this.getValue("AllIPv6")){n.Address="::";n.DisplayAddress=Strings.get_ConnectorAllAvailableIPv6()}else n.DisplayAddress=n.Address;n.Port=Number.parseInvariant(n.Port).toString();n.IPBindingKey=n.Address+":"+n.Port;return n},initDefaultValue:function(){if(this.get_IsForNew()){this.setValue("AllIPv4",!0);this.setValue("AllIPv6",!1);this.setValue("IPv4OrIPv6",!1);this.setValue("Port",25)}else{var n=this.getValue("Address");if(n==="0.0.0.0"){this.setProperty("AllIPv4",!0);this.setProperty("AllIPv6",!1);this.setProperty("IPv4OrIPv6",!1)}else if(n==="::"){this.setProperty("AllIPv4",!1);this.setProperty("AllIPv6",!0);this.setProperty("IPv4OrIPv6",!1)}else{this.setProperty("AllIPv4",!1);this.setProperty("AllIPv6",!1);this.setProperty("IPv4OrIPv6",!0)}}}};function NewReceiveConnectorViewModel(){NewReceiveConnectorViewModel.initializeBase(this)}NewReceiveConnectorViewModel.prototype={$C_5:null,get_ReceiveConnectorType:function(){return this.getValue("ReceiveConnectorType")},set_ReceiveConnectorType:function(n){this.setValue("ReceiveConnectorType",n);_Object.isNullOrUndefined(n)||(n==="Custom"||n==="Partner"?this.$1K_5("Full"):n==="Internet"?this.$1K_5("Local"):this.$1K_5("Remote"));return n},initialize:function(){WizardViewModel.prototype.initialize.call(this);this.$C_5=this.findViewModelWithID("ChooseType");this.set_ReceiveConnectorType("Custom");var t=UrlUtil.getParameter("ssid");var i=UrlUtil.getParameter("sstype");if(!_Object.isNullOrUndefined(t)&&!_Object.isNullOrUndefined(i)){this.setValue("Server",decodeURIComponent(t));var n=i.toLowerCase();if(n===ServerRoleType.toString(1).toLowerCase()){this.setValue("EnabledTransportRole",!0);this.setValue("RoleType","HubTransport")}else if(n===ServerRoleType.toString(2).toLowerCase()){this.setValue("EnabledTransportRole",!1);this.setValue("RoleType","FrontendTransport")}else if(n===ServerRoleType.toString(3).toLowerCase()){this.setValue("EnabledTransportRole",!1);this.setValue("RoleType","HubTransport")}else if(n===ServerRoleType.toString(4).toLowerCase()){this.setValue("EnabledTransportRole",!1);this.setValue("RoleType","HubTransport")}}},$1K_5:function(n){if(n==="Full"){var f=this.$C_5;var t=this.findViewModelWithID("SetLocalBinding");f.set_NextViewModelID(t.get_ViewModelID());var i=this.findViewModelWithID("SetRemoteIpRange");t.set_NextViewModelID(i.get_ViewModelID());i.set_NextViewModelID(null)}else if(n==="Local"){var e=this.$C_5;var r=this.findViewModelWithID("SetLocalBinding");e.set_NextViewModelID(r.get_ViewModelID());r.set_NextViewModelID(null)}else{var o=this.$C_5;var u=this.findViewModelWithID("SetRemoteIpRange");o.set_NextViewModelID(u.get_ViewModelID());u.set_NextViewModelID(null)}}};function OrgSettingsContentPage(n){OrgSettingsContentPage.initializeBase(this,[n])}function OutboundConnectorViewModel(){this.$$d_$35_4=Function.createDelegate(this,this.$35_4);this.$17_4=new RequiredFieldValidator(new ValidatorInfo);OutboundConnectorViewModel.initializeBase(this)}OutboundConnectorViewModel.prototype={initialize:function(){PropertyPageViewModel.prototype.initialize.call(this);this.add_propertyChanged(this.$$d_$35_4)},dispose:function(){this.remove_propertyChanged(this.$$d_$35_4);PropertyPageViewModel.prototype.dispose.call(this)},get_RecipientDomainsListVM:function(){return this.getValue("RecipientDomainsList")},set_RecipientDomainsListVM:function(n){this.setValue("RecipientDomainsList",n);this.getValue("ConnectorType")!=="Partner"&&this.getValue("AllAcceptedDomains")||this.$17_4.validate(n);return n},get_MxRecordEnabled:function(){return this.getValue("ConnectorType")==="Partner"},$35_4:function(n,t){if(t.get_propertyName()==="ConnectorType"){this.get_MxRecordEnabled()||this.setValue("SmartHostsOn",!0);this.raisePropertyChanged("MxRecordEnabled");this.getProperty("AllAcceptedDomains")&&this.$1r_4()}t.get_propertyName()==="AllAcceptedDomains"&&this.$1r_4()},$1r_4:function(){var n=this.getProperty("RecipientDomainsListVM");n.length||this.raisePropertyChanged("RecipientDomainsListVM")}};function ReceiveConnectorViewModel(){ReceiveConnectorViewModel.initializeBase(this)}ReceiveConnectorViewModel.prototype={$29_4:null,$28_4:null,get_valuesToSave:function(){var r=PropertyPageViewModel.prototype.get_valuesToSave.call(this);if(this.get_CanSet().getProperty("PermissionGroups")){var u="";var i=!0;var f,e;u=(e=this.$4_4(u,r.PermissionGroupsExchangeServers,"ExchangeServers",i,f={val:i}),i=f.val,e);var o,s;u=(s=this.$4_4(u,r.PermissionGroupsExchangeLegacyServers,"ExchangeLegacyServers",i,o={val:i}),i=o.val,s);var h,c;u=(c=this.$4_4(u,r.PermissionGroupsPartners,"Partners",i,h={val:i}),i=h.val,c);var l,a;u=(a=this.$4_4(u,r.PermissionGroupsExchangeUsers,"ExchangeUsers",i,l={val:i}),i=l.val,a);var v,y;u=(y=this.$4_4(u,r.PermissionGroupsAnonymousUsers,"AnonymousUsers",i,v={val:i}),i=v.val,y);u===""&&(u="None");this.$1q_4(this.$29_4,u)||(r.PermissionGroups=u)}if(this.get_CanSet().getProperty("AuthMechanism")){var t="";var n=!0;var p,w;t=(w=this.$4_4(t,r.AuthMechanismTls,"Tls",n,p={val:n}),n=p.val,w);var b,k;t=(k=this.$4_4(t,r.AuthMechanismBasicAuth,"BasicAuth",n,b={val:n}),n=b.val,k);var d,g;t=(g=this.$4_4(t,r.AuthMechanismBasicAuthRequireTLS,"BasicAuthRequireTLS",n,d={val:n}),n=d.val,g);var nt,tt;t=(tt=this.$4_4(t,r.AuthMechanismIntegrated,"Integrated",n,nt={val:n}),n=nt.val,tt);var it,rt;t=(rt=this.$4_4(t,r.AuthMechanismExchangeServer,"ExchangeServer",n,it={val:n}),n=it.val,rt);var ut,ft;t=(ft=this.$4_4(t,r.AuthMechanismExternalAuthoritative,"ExternalAuthoritative",n,ut={val:n}),n=ut.val,ft);t===""&&(t="None");this.$1q_4(this.$28_4,t)||(r.AuthMechanism=t)}return r},get_AuthMechanismTls:function(){return this.getValue("AuthMechanismTls")},set_AuthMechanismTls:function(n){this.setValue("AuthMechanismTls",n);n||this.setValue("DomainSecureEnabled",!1);return n},get_AuthMechanismBasicAuth:function(){return this.getValue("AuthMechanismBasicAuth")},set_AuthMechanismBasicAuth:function(n){this.setValue("AuthMechanismBasicAuth",n);n||this.setValue("AuthMechanismBasicAuthRequireTLS",!1);return n},get_MaxMessageSizeOptions:function(){return["10","25","100"]},initialize:function(){var i=this.getValue("PermissionGroups");this.$29_4=i;var e=i.split(",");this.setValue("PermissionGroupsExchangeServers",!1);this.setValue("PermissionGroupsExchangeLegacyServers",!1);this.setValue("PermissionGroupsPartners",!1);this.setValue("PermissionGroupsExchangeUsers",!1);this.setValue("PermissionGroupsAnonymousUsers",!1);for(var r=e,o=r.length,n=0;n<o;++n){var s=r[n];switch(s.trim()){case"ExchangeServers":this.setValue("PermissionGroupsExchangeServers",!0);break;case"ExchangeLegacyServers":this.setValue("PermissionGroupsExchangeLegacyServers",!0);break;case"Partners":this.setValue("PermissionGroupsPartners",!0);break;case"ExchangeUsers":this.setValue("PermissionGroupsExchangeUsers",!0);break;case"AnonymousUsers":this.setValue("PermissionGroupsAnonymousUsers",!0);break;default:break}}var u=this.getValue("AuthMechanism");this.$28_4=u;var h=u.split(",");this.setValue("AuthMechanismTls",!1);this.setValue("AuthMechanismBasicAuth",!1);this.setValue("AuthMechanismBasicAuthRequireTLS",!1);this.setValue("AuthMechanismIntegrated",!1);this.setValue("AuthMechanismExchangeServer",!1);this.setValue("AuthMechanismExternalAuthoritative",!1);for(var f=h,c=f.length,t=0;t<c;++t){var l=f[t];switch(l.trim()){case"Tls":this.setValue("AuthMechanismTls",!0);break;case"BasicAuth":this.setValue("AuthMechanismBasicAuth",!0);break;case"BasicAuthRequireTLS":this.setValue("AuthMechanismBasicAuthRequireTLS",!0);break;case"Integrated":this.setValue("AuthMechanismIntegrated",!0);break;case"ExchangeServer":this.setValue("AuthMechanismExchangeServer",!0);break;case"ExternalAuthoritative":this.setValue("AuthMechanismExternalAuthoritative",!0);break;default:break}}this.setValue("ServerVersion",this.getProperty("Server").ServerVersion);PropertyPageViewModel.prototype.initialize.call(this)},$4_4:function(n,t,i,r,u){if(t)if(r){n+=i;r=!1}else n+=", "+i;u.val=r;return n},$1q_4:function(n,t){var u=n.split(",");var f=t.split(",");if(u.length!==f.length)return!1;else{for(var e=u,h=e.length,i=0;i<h;++i){for(var c=e[i],o=!1,s=f,l=s.length,r=0;r<l;++r){var a=s[r];if(a.trim()===c.trim()){o=!0;break}}if(!o)return!1}return!0}}};function SendConnectorViewModel(){SendConnectorViewModel.initializeBase(this)}SendConnectorViewModel.prototype={get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.DNSRoutingEnabled||NewSendConnectorViewModel.composeAuthMechanism(n);return n},get_SmartHostAuthMechanismBasicAuth:function(){return this.getValue("SmartHostAuthMechanismBasicAuth")},set_SmartHostAuthMechanismBasicAuth:function(n){this.setValue("SmartHostAuthMechanismBasicAuth",n);n||this.setValue("SmartHostAuthMechanismBasicAuthRequireTLS",!1);return n},get_Username:function(){return this.getValue("Username")},set_Username:function(n){this.setValue("Username",n);this.makeDirty("PlainPassword");return n},get_PlainPassword:function(){return this.getValue("PlainPassword")},set_PlainPassword:function(n){this.setValue("PlainPassword",n);this.makeDirty("Username");return n},get_MaxMessageSizeOptions:function(){return["10","25","100",ByteQuotaConverter.unlimited]},initialize:function(){var n=this.getValue("SmartHostAuthMechanism");this.setValue("SmartHostAuthMechanismNone",!1);this.setValue("SmartHostAuthMechanismBasicAuth",!1);this.setValue("SmartHostAuthMechanismBasicAuthRequireTLS",!1);this.setValue("SmartHostAuthMechanismExchangeServer",!1);this.setValue("SmartHostAuthMechanismExternalAuthoritative",!1);if(!_Object.isNullOrUndefined(n))switch(n.trim()){case"None":this.setValue("SmartHostAuthMechanismNone",!0);break;case"BasicAuth":this.setValue("SmartHostAuthMechanismBasicAuth",!0);break;case"BasicAuthRequireTLS":this.setValue("SmartHostAuthMechanismBasicAuthRequireTLS",!0);this.setValue("SmartHostAuthMechanismBasicAuth",!0);break;case"ExchangeServer":this.setValue("SmartHostAuthMechanismExchangeServer",!0);break;case"ExternalAuthoritative":this.setValue("SmartHostAuthMechanismExternalAuthoritative",!0);break}PropertyPageViewModel.prototype.initialize.call(this)}};function NewSendConnectorViewModel(){NewSendConnectorViewModel.initializeBase(this)}NewSendConnectorViewModel.composeAuthMechanism=function(n){var t="";n.SmartHostAuthMechanismNone?t="None":n.SmartHostAuthMechanismBasicAuthRequireTLS?t="BasicAuthRequireTLS":n.SmartHostAuthMechanismBasicAuth?t="BasicAuth":n.SmartHostAuthMechanismExchangeServer?t="ExchangeServer":n.SmartHostAuthMechanismExternalAuthoritative&&(t="ExternalAuthoritative");t!==""&&(n.SmartHostAuthMechanism=t)};NewSendConnectorViewModel.prototype={get_SendConnectorType:function(){return this.getValue("SendConnectorType")},set_SendConnectorType:function(n){if(n!==this.getValue("SendConnectorType")){this.setValue("SendConnectorType",n);if(n==="Custom"||n==="Internet"){this.setValue("DNSRoutingEnabled",!0);this.setValue("DNSRoutingStatus",!0);this.setValue("SmartHostStatus",!0)}else if(n==="Internal"){this.setValue("DNSRoutingEnabled",!1);this.setValue("DNSRoutingStatus",!1);this.setValue("SmartHostStatus",!0)}else{this.setValue("DNSRoutingEnabled",!0);this.setValue("DNSRoutingStatus",!0);this.setValue("SmartHostStatus",!1)}}return n},get_Username:function(){return this.getValue("Username")},set_Username:function(n){this.setValue("Username",n);this.makeDirty("PlainPassword");return n},get_PlainPassword:function(){return this.getValue("PlainPassword")},set_PlainPassword:function(n){this.setValue("PlainPassword",n);this.makeDirty("Username");return n},get_SmartHostAuthMechanismBasicAuth:function(){return this.getValue("SmartHostAuthMechanismBasicAuth")},set_SmartHostAuthMechanismBasicAuth:function(n){this.setValue("SmartHostAuthMechanismBasicAuth",n);n||this.setValue("SmartHostAuthMechanismBasicAuthRequireTLS",!1);return n},get_DNSRoutingEnabled:function(){return this.getValue("DNSRoutingEnabled")},set_DNSRoutingEnabled:function(n){this.setValue("DNSRoutingEnabled",n);var t=this.findViewModelWithID("NetworkSetting");n?t.set_NextViewModelID(this.findViewModelWithID("AddressSpaceSetting").get_ViewModelID()):t.set_NextViewModelID(this.findViewModelWithID("AuthenticationSetting").get_ViewModelID());return n},get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);NewSendConnectorViewModel.composeAuthMechanism(n);return n},initialize:function(){WizardViewModel.prototype.initialize.call(this);this.set_SendConnectorType("Custom");this.setValue("SmartHostAuthMechanismNone",!0);this.setValue("SmartHostAuthMechanismBasicAuth",!1);this.setValue("SmartHostAuthMechanismBasicAuthRequireTLS",!1);this.setValue("SmartHostAuthMechanismExchangeServer",!1);this.setValue("SmartHostAuthMechanismExternalAuthoritative",!1)}};function OWAECPBulkEditViewModel(){OWAECPBulkEditViewModel.initializeBase(this)}OWAECPBulkEditViewModel.prototype={get_IsOWAVDir:function(){var n=EcpUrl.GetCurrWindowQuery("schema");return!_String.isNullOrEmpty(n)&&n.indexOf("OWA")>=0},get__FormsAuthentication:function(){return this.getValue("_FormsAuthentication")},set__FormsAuthentication:function(n){if(this.get__FormsAuthentication()!==n){if(n==="Form"){this.setProperty("_WindowsAuthentication","false");this.setProperty("_DigestAuthentication","false");this.setProperty("_BasicAuthentication","true");this.setProperty("FormsAuthentication","true")}else if(n==="Standard"){this.setProperty("_BasicAuthentication","false");this.setProperty("_WindowsAuthentication","false");this.setProperty("_DigestAuthentication","false");this.setProperty("FormsAuthentication","false")}else{this.setProperty("_WindowsAuthentication","nochange");this.setProperty("_DigestAuthentication","nochange");this.setProperty("_BasicAuthentication","nochange");this.setProperty("_LogonFormat","nochange");this.setProperty("DefaultDomain",null);this.setProperty("FormsAuthentication",null)}this.setValue("_FormsAuthentication",n)}return n},get_values:function(){this.$h_6("BasicAuthentication");this.$h_6("DigestAuthentication");this.$h_6("WindowsAuthentication");this.$h_6("LogonFormat");return NotifyPropertyChangedJson.prototype.get_values.call(this)},initialize:function(){BulkEditPopupViewModel.prototype.initialize.call(this);this.setProperty("_BasicAuthentication","nochange");this.setProperty("_DigestAuthentication","nochange");this.setProperty("_WindowsAuthentication","nochange");this.setProperty("_LogonFormat","nochange")},saveConfirm:function(n,t){this.getProperty("_BasicAuthentication")==="nochange"&&this.getProperty("_DigestAuthentication")==="nochange"&&this.getProperty("_WindowsAuthentication")==="nochange"&&this.get__FormsAuthentication()===_String.empty||this.get_IsOWAVDir()?this.set_SaveConfirmationText(null):this.set_SaveConfirmationText(Strings.get_SetECPAuthConfirmText());PropertyPageViewModel.prototype.saveConfirm.call(this,n,t)},$h_6:function(n){var t=this.getProperty("_"+n);(t!=="nochange"||_String.isNullOrEmpty(t))&&this.setProperty(n,t)}};function OWAECPPropertyPageViewModel(){OWAECPPropertyPageViewModel.initializeBase(this)}OWAECPPropertyPageViewModel.prototype={$1j_4:!1,get_FormsAuthentication:function(){return this.getValue("FormsAuthentication")},set_FormsAuthentication:function(n){if(this.get_FormsAuthentication()!==n){if(n){this.setProperty("WindowsAuthentication",!1);this.setProperty("DigestAuthentication",!1);this.setProperty("BasicAuthentication",!0)}else this.setProperty("BasicAuthentication",!1);this.setValue("FormsAuthentication",n)}return n},onSelectedSectionChanged:function(n){PropertyPageViewModel.prototype.onSelectedSectionChanged.call(this,n);this.selectedSection.workflow==="GetAllVDirProperties"&&(this.$1j_4=!0)},saveConfirm:function(n,t){if(!this.$1j_4||!this.getProperty("VDirType")||this.getProperty("VDirType")!=="ECP"){PropertyPageViewModel.prototype.saveConfirm.call(this,n,t);return}this.set_SaveConfirmationText(null);for(var r=OWAECPPropertyPageViewModel.$c,u=r.length,i=0;i<u;++i){var f=r[i];if(f in this.get_updatedValues()){this.set_SaveConfirmationText(Strings.get_SetECPAuthConfirmText());break}}PropertyPageViewModel.prototype.saveConfirm.call(this,n,t)},get_valuesToSave:function(){if(this.getProperty("VDirType")==="ECP")for(var i=OWAECPPropertyPageViewModel.$c,u=i.length,n=0;n<u;++n){var f=i[n];if(f in this.get_updatedValues()){for(var r=OWAECPPropertyPageViewModel.$c,e=r.length,t=0;t<e;++t){var o=r[t];this.makeDirty(o)}break}}return PropertyPageViewModel.prototype.get_valuesToSave.call(this)}};function VDirDetailsPane(n){VDirDetailsPane.initializeBase(this,[n])}VDirDetailsPane.prototype={supportBulkEdit:function(n,t){var i=n.MajorVersion;var r=t.MajorVersion;return i!==r||i<=12||r<=12?!1:DetailsPane.prototype.supportBulkEdit.call(this,n,t)}};function VDirListView(n){this.$$d_$3I_4=Function.createDelegate(this,this.$3I_4);VDirListView.initializeBase(this,[n])}VDirListView.prototype={$L_4:null,$1i_4:null,$19_4:null,get_VDirTypeDropDown:function(){return this.$L_4},set_VDirTypeDropDown:function(n){this.$L_4=n;return n},get_ServerListResult:function(){return this.$19_4},set_ServerListResult:function(n){this.$19_4=n;return n},initialize:function(){this.$1i_4=this.$$d_$3I_4;this.$L_4.add_filterDropDownChanged(this.$1i_4);ListView.prototype.initialize.call(this);this.$19_4&&ErrorHandling.showPowerShellErrors(this.$19_4)},dispose:function(){this.$L_4.remove_filterDropDownChanged(this.$1i_4);ListView.prototype.dispose.call(this)},setEnabled:function(n){this.$L_4.set_enabled(n);ListView.prototype.setEnabled.call(this,n)},$3I_4:function(n,t){this.$L_4.get_filterValue()&&(this.ignoreRestoreState=!0);this.get_DataSource().filter()}};AddressListSDOViewModel.registerClass("AddressListSDOViewModel",SDOViewModel);BulkEditPaneViewModel.registerClass("BulkEditPaneViewModel",PropertyPageViewModel);BulkEditPopupViewModel.registerClass("BulkEditPopupViewModel",PopupFormViewModel);BulkEnableArchiveViewModel.registerClass("BulkEnableArchiveViewModel",BulkEditPopupViewModel);BulkEditHelper.registerClass("BulkEditHelper");BulkEditCustomAttributesPopupViewModel.registerClass("BulkEditCustomAttributesPopupViewModel",BulkEditPopupViewModel);BulkEditErrorDlg.registerClass("BulkEditErrorDlg",Dialog);MailboxBulkEditPaneViewModel.registerClass("MailboxBulkEditPaneViewModel",BulkEditPaneViewModel);NewCertificateViewModel.registerClass("NewCertificateViewModel",WizardViewModel);ImportCertificateViewModel.registerClass("ImportCertificateViewModel",WizardViewModel);RenewCertificateViewModel.registerClass("RenewCertificateViewModel",PropertyPageViewModel);CompleteCertificateViewModel.registerClass("CompleteCertificateViewModel",PropertyPageViewModel);EditCertificateViewModel.registerClass("EditCertificateViewModel",PropertyPageViewModel);CertificateViewModelDomain.registerClass("CertificateViewModelDomain",WebServiceWizardStepViewModel);CertificateViewModelDomain.prototype.toString=WizardStepViewModel.prototype.toString;CertificateKnownViewModel.registerClass("CertificateKnownViewModel",WebServiceWizardStepViewModel);CertificateKnownViewModel.prototype.toString=WizardStepViewModel.prototype.toString;DomainEditorViewModel.registerClass("DomainEditorViewModel",PopupFormViewModel);DatabasesWebServiceListSource.registerClass("DatabasesWebServiceListSource",WebServiceListSource);DatabaseSDOViewModel.registerClass("DatabaseSDOViewModel",SDOViewModel);DBConverters.registerClass("DBConverters");EditDatabaseViewModel.registerClass("EditDatabaseViewModel",PropertyPageViewModel);NewDatabaseViewModel.registerClass("NewDatabaseViewModel",PropertyPageViewModel);DAGNetworkViewModel.registerClass("DAGNetworkViewModel",PropertyPageViewModel);DAGSDOViewModel.registerClass("DAGSDOViewModel",SDOViewModel);AddressTemplateConverter.registerClass("AddressTemplateConverter",null,IConverter);EmailAddressViewModelBase.registerClass("EmailAddressViewModelBase",PopupFormViewModel);AddressTemplateViewModel.registerClass("AddressTemplateViewModel",EmailAddressViewModelBase);EAPHelper.registerClass("EAPHelper");EmailAddressPolicySDOViewModel.registerClass("EmailAddressPolicySDOViewModel",SDOViewModel);RecipientConditionViewModel.registerClass("RecipientConditionViewModel",PropertyPageViewModel);EmailAddressPolicyViewModel.registerClass("EmailAddressPolicyViewModel",RecipientConditionViewModel);DenyIsAnyDomainValidator.registerClass("DenyIsAnyDomainValidator",Validator.$$(ValidatorInfo));DenySpecifiedDomainsValidator.registerClass("DenySpecifiedDomainsValidator",Validator.$$(DenySpecifiedDomainsValidatorInfo));DenySpecifiedDomainsValidatorInfo.registerClass("DenySpecifiedDomainsValidatorInfo",ValidatorInfo);EditSharingEnabledDomainsViewModel.registerClass("EditSharingEnabledDomainsViewModel",PropertyPageViewModel);SharingPolicyViewModelBase.registerClass("SharingPolicyViewModelBase",PropertyPageViewModel);NewSharingPolicyViewModel.registerClass("NewSharingPolicyViewModel",SharingPolicyViewModelBase);EditSharingPolicyViewModel.registerClass("EditSharingPolicyViewModel",SharingPolicyViewModelBase);FederationViewModel.registerClass("FederationViewModel",PropertyPageViewModel);OrgRelPropertyPageViewModel.registerClass("OrgRelPropertyPageViewModel",PropertyPageViewModel);SharingRuleEntry.registerClass("SharingRuleEntry");SharingRuleEntryConverter.registerClass("SharingRuleEntryConverter",null,IConverter);SharingRuleEntryListConverter.registerClass("SharingRuleEntryListConverter",null,IValueConverter);SharingRuleEntryViewModel.registerClass("SharingRuleEntryViewModel",PopupFormViewModel);GroupUtil.registerClass("GroupUtil");CloseAndForwardCommand.registerClass("CloseAndForwardCommand",Command);HybridSelectCertControl.registerClass("HybridSelectCertControl",ContainerControl);HCWHelper.registerClass("HCWHelper");HCWIntroductionViewModel.registerClass("HCWIntroductionViewModel",WebServiceWizardStepViewModel);HCWIntroductionViewModel.prototype.toString=WizardStepViewModel.prototype.toString;HCWPrepareCertViewModel.registerClass("HCWPrepareCertViewModel",WebServiceWizardStepViewModel);HCWPrepareCertViewModel.prototype.toString=WizardStepViewModel.prototype.toString;HybridConfigurationSlab.registerClass("HybridConfigurationSlab",ContainerControl);HybridConfigurationViewModel.registerClass("HybridConfigurationViewModel",PropertyPageViewModel);HybridConfigurationWizardViewModel.registerClass("HybridConfigurationWizardViewModel",WizardViewModel);OwaMailboxPolicySDOViewModel.registerClass("OwaMailboxPolicySDOViewModel",SDOViewModel);OwaMailboxPolicyViewModel.registerClass("OwaMailboxPolicyViewModel",PropertyPageViewModel);EditServerViewModel.registerClass("EditServerViewModel",PropertyPageViewModel);ExpiringServerDialog.registerClass("ExpiringServerDialog",MessageBoxDialog);IPAddrEditorViewModel.registerClass("IPAddrEditorViewModel",PopupFormViewModel);ServerListView.registerClass("ServerListView",ListView);EditGlobalSettingsViewModel.registerClass("EditGlobalSettingsViewModel",PropertyPageViewModel);SimpleIPEditorViewModel.registerClass("SimpleIPEditorViewModel",PopupFormViewModel);NewLinkedMailboxViewModel.registerClass("NewLinkedMailboxViewModel",WizardViewModel);ConnectMailboxWizardViewModel.registerClass("ConnectMailboxWizardViewModel",NewLinkedMailboxViewModel);ConnectMBXSelectUserVM.registerClass("ConnectMBXSelectUserVM",WizardStepViewModel);ConnectMBXSelectUserVM.prototype.toString=WizardStepViewModel.prototype.toString;DurationConverter.registerClass("DurationConverter",null,IValueConverter);EmailAddressViewModel.registerClass("EmailAddressViewModel",EmailAddressViewModelBase);EmailAddressConverter.registerClass("EmailAddressConverter",null,IConverter);LinkedMailboxWizardInputCredentialVM.registerClass("LinkedMailboxWizardInputCredentialVM",WebServiceWizardStepViewModel);LinkedMailboxWizardInputCredentialVM.prototype.toString=WizardStepViewModel.prototype.toString;LinkedMailboxWizardSelectTrustVM.registerClass("LinkedMailboxWizardSelectTrustVM",WebServiceWizardStepViewModel);LinkedMailboxWizardSelectTrustVM.prototype.toString=WizardStepViewModel.prototype.toString;RecipientViewModel.registerClass("RecipientViewModel",PropertyPageViewModel);MailUserPageViewModelBase.registerClass("MailUserPageViewModelBase",RecipientViewModel);MailUserPropertyPageViewModel.registerClass("MailUserPropertyPageViewModel",MailUserPageViewModelBase);NewMailboxOnPremisePageViewModel.registerClass("NewMailboxOnPremisePageViewModel",MailUserPageViewModelBase);NewTeamMailboxControl.registerClass("NewTeamMailboxControl",EcpControl);SmtpAddressControl.registerClass("SmtpAddressControl",EcpControl);TeamMailboxPage.registerClass("TeamMailboxPage",BaseForm);TeamMailboxPropertyPageViewModel.registerClass("TeamMailboxPropertyPageViewModel",SDOViewModel);TeamMailboxViewModel.registerClass("TeamMailboxViewModel",PropertyPageViewModel);ViewUserMailboxDetailsPageViewModel.registerClass("ViewUserMailboxDetailsPageViewModel",SDOViewModel);UniversalGroupsViewModel.registerClass("UniversalGroupsViewModel",RecipientConditionViewModel);PublicFolderColumnHeader.registerClass("PublicFolderColumnHeader",ColumnHeader);PublicFoldersListView.registerClass("PublicFoldersListView",ListView);PublicFolderPermissionInfoViewModel.registerClass("PublicFolderPermissionInfoViewModel",PopupFormViewModel);PublicFolderPermissionInfoConverter.registerClass("PublicFolderPermissionInfoConverter",null,IConverter);PublicFolderPermissionInfoListConverter.registerClass("PublicFolderPermissionInfoListConverter",null,IValueConverter);PublicFolderPermissionInfo.registerClass("PublicFolderPermissionInfo");CrossSlabRefresher.registerClass("CrossSlabRefresher",null,IRefreshable);PSTMailboxMoveViewModel.registerClass("PSTMailboxMoveViewModel",WizardViewModel);NewSharedMailboxViewModel.registerClass("NewSharedMailboxViewModel",MailUserPageViewModelBase);AcceptedDomainViewModel.registerClass("AcceptedDomainViewModel",PropertyPageViewModel);AddressSpaceEntryViewModel.registerClass("AddressSpaceEntryViewModel",PopupFormViewModel);InboundConnectorViewModel.registerClass("InboundConnectorViewModel",PropertyPageViewModel);IPBindingEntryViewModel.registerClass("IPBindingEntryViewModel",PopupFormViewModel);NewReceiveConnectorViewModel.registerClass("NewReceiveConnectorViewModel",WizardViewModel);OrgSettingsContentPage.registerClass("OrgSettingsContentPage",EcpSdoBaseContentPage);OutboundConnectorViewModel.registerClass("OutboundConnectorViewModel",PropertyPageViewModel);ReceiveConnectorViewModel.registerClass("ReceiveConnectorViewModel",PropertyPageViewModel);SendConnectorViewModel.registerClass("SendConnectorViewModel",PropertyPageViewModel);NewSendConnectorViewModel.registerClass("NewSendConnectorViewModel",WizardViewModel);OWAECPBulkEditViewModel.registerClass("OWAECPBulkEditViewModel",BulkEditPopupViewModel);OWAECPPropertyPageViewModel.registerClass("OWAECPPropertyPageViewModel",PropertyPageViewModel);VDirDetailsPane.registerClass("VDirDetailsPane",DetailsPane);VDirListView.registerClass("VDirListView",ListView);EAPHelper.$6=null;HCWIntroductionViewModel.wwOAuth=!1;HCWIntroductionViewModel.serviceInstance=UrlUtil.getParameter("ServiceInstance");ConnectMailboxWizardViewModel.targetMailboxTypeProperty="TargetMailboxType";PublicFolderPermissionInfoViewModel.permissionSets={"1026":["2","1024"],"1025":["1","1024"],"1043":["1","2","1024","16"],"1051":["1","2","1024","8","16"],"1243":["1","2","128","1024","8","16","64"],"1147":["1","2","1024","8","32","16","64"],"1275":["1","2","128","1024","8","32","16","64"],"2043":["1","2","8","16","32","64","128","256","512","1024"],"0":[]};NewSendConnectorViewModel.smartHostAuthMechanismNoneName="SmartHostAuthMechanismNone";NewSendConnectorViewModel.smartHostAuthMechanismBasicAuthName="SmartHostAuthMechanismBasicAuth";NewSendConnectorViewModel.smartHostAuthMechanismBasicAuthRequireTLSName="SmartHostAuthMechanismBasicAuthRequireTLS";NewSendConnectorViewModel.smartHostAuthMechanismExchangeServerName="SmartHostAuthMechanismExchangeServer";NewSendConnectorViewModel.smartHostAuthMechanismExternalAuthoritativeName="SmartHostAuthMechanismExternalAuthoritative";OWAECPPropertyPageViewModel.$c=["FormsAuthentication","WindowsAuthentication","DigestAuthentication","BasicAuthentication"]