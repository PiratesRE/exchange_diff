Type.registerNamespace("ECP");function RefreshPolicyListView(){try{var n=ControlHelper.findControlById("complianceProgramListView");var t=n.get_DataSource();t.refresh()}catch(i){}}function EditPolicy(n){this.$$d_$T_4=Function.createDelegate(this,this.$T_4);EditPolicy.initializeBase(this,[n])}EditPolicy.prototype={$6_4:null,$3_4:null,$G_4:null,get_RulesListView:function(){return this.$6_4},set_RulesListView:function(n){this.$6_4=n;return n},get_DLPPolicyParameterName:function(){return this.$G_4},set_DLPPolicyParameterName:function(n){this.$G_4=n;return n},get_RulesDataSourceRefreshMethod:function(){return this.$3_4},set_RulesDataSourceRefreshMethod:function(n){this.$3_4=n;return n},get_$F_4:function(){var n=this.get_DataContext();return n.getProperty("Name").toString()},get_$S_4:function(){var n=this.get_DataContext();return n.getProperty("Mode").toString()},initialize:function(){BaseForm.prototype.initialize.call(this);this.$3_4.add_Invoking(this.$$d_$T_4)},dispose:function(){this.$3_4.remove_Invoking(this.$$d_$T_4);BaseForm.prototype.dispose.call(this)},onDataContextUpdated:function(){var i=this.get_DataContext();this.$U_4(this.get_$S_4(),this.get_$F_4());var n={};n[this.$G_4]=new StaticBinding(this.get_$F_4());this.$3_4.get_Parameters()[0]=new DataContractBinding(null,n);var t=this.$6_4.get_DataSource();t.filter();EcpControl.prototype.onDataContextUpdated.call(this)},$T_4:function(n,t){t.set_cancel(_String.isNullOrEmpty(this.get_$F_4()))},$U_4:function(n,t){for(var e=["NotifySender","RejectWithOverride","OutlookNotificationRule","RejectNoOverride","RejectMessageAllowOverrides","NewRule"],f=e,o=f.length,r=0;r<o;++r){var s=f[r];var h=this;var u=this.$6_4.get_ToolBar().findItemByCondition(function(n){return n.name===s});if(null!==u){var i=CommandUtil.generateNavigateUrl(u);i=UrlUtil.appendParameter(i,"mode",n);i=UrlUtil.appendParameter(i,"name",encodeURIComponent(t));u.navigateUrl=i}}}};function ExtendedListView(n){ExtendedListView.initializeBase(this,[n])}ExtendedListView.prototype={renderRowContent:function(n,t,i){var f=this.get_DataSource().getAt(t);i.append('<td class="ExtendedListViewParent" colspan="');i.append(this.get_Columns().length.toString());i.append('"/>');i.append('<table class="ExtendedListView" cellpadding="0" cellspacing="0" border="0">');i.append("<colgroup>");for(var r=0;r<this.get_Columns().length;r++){i.append("<col");if(this.get_colGroupWidths()[r]){i.append(' width="');i.append(this.get_colGroupWidths()[r]);i.append('"')}i.append(" />")}var e=DataBinder.getPropertyValue(f,"Name");i.append("</colgroup>");i.append('<tr class="ExtendedListViewRow">');i.append('<td  class="ExtendedListViewTitle" colspan="');i.append(this.get_Columns().length.toString());i.append('"/>');i.append(EcpUtil.htmlEncode(e));i.append("</td>");i.append("</tr>");i.append('<tr class="ExtendedListViewRow">');for(var u=0;u<this.get_Columns().length;u++){i.append('<td class="ExtendedListViewBody">');i.append(this.get_Columns()[u].renderItem(f,n,t));i.append("</td>")}i.append("</tr>");i.append("</table>");i.append("</td>")},findRow:function(n){for(var t=-1;n;){if(n.tagName==="TR")t=n.rowIndex;else if(n===this.get_divContent())break;n=n.parentNode}return t},getColumnCell:function(n,t){return n.childNodes[0].childNodes[0].childNodes[1].childNodes[1].childNodes[t]}};function RMSEncryptionViewModel(){RMSEncryptionViewModel.initializeBase(this)}RMSEncryptionViewModel.prototype={$H_4:null,get_testResultTitle:function(){return this.$H_4},set_testResultTitle:function(n){this.$H_4=n;return n},handleSaveResult:function(n){if(!n.ErrorRecords.length&&!n.Warnings.length&&n.Output.length===1){var i=n.Output[0].IRMTestResult.toString();if(!EcpUtil.isNullOrEmpty(i)){var r=String.format(RMSEncryptionViewModel.$J,i);var t=new Info;t.Message=r;t.MessageType=MessageBoxType.information;t.set_Title(this.$H_4);MessageBox.showCustom(t,4,null,null)}}PropertyPageViewModel.prototype.handleSaveResult.call(this,n)}};function DataClassificationViewModel(){this.$1_4={};this.$K_4=new RequiredFieldValidator(new ValidatorInfo);DataClassificationViewModel.initializeBase(this)}DataClassificationViewModel.prototype={get_FileObject:function(){return null},set_FileObject:function(n){if(!_Object.isNullOrUndefined(n)){var t=n.Value;this.$1_4[t]=n;this.resetChangeTracking("FileObject");this.raisePropertyChanged("ListViewdata")}return n},get_ListViewdata:function(){var t=[];var i=this.$1_4;for(var r in i){var u={key:r,value:i[r]};var n={};n.Description=u.value.Description;n.fingerprint=u.value;Array.add(t,n)}return t},set_ListViewdata:function(n){var r=[];this.$1_4={};for(var u=n,f=u.length,t=0;t<f;++t){var e=u[t];var i=e.fingerprint;Array.add(r,i.Value);this.$1_4[i.Value]=i}this.setValue("FingerprintNames",r);this.makeDirty("FingerprintNames");this.$K_4.validate(n);return n},initialize:function(){PropertyPageViewModel.prototype.initialize.call(this);if(!_Object.isNullOrUndefined(this.getValue("Fingerprints"))){for(var t=this.getValue("Fingerprints"),r=t.length,n=0;n<r;++n){var i=t[n];var u=i.Value;this.$1_4[u]=i}this.raisePropertyChanged("ListViewdata")}}};function NewDataClassification(n){NewDataClassification.initializeBase(this,[n])}NewDataClassification.prototype={$0_4:null,$8_4:null,$5_4:null,get_CollectionEditor:function(){return this.$0_4},set_CollectionEditor:function(n){this.$0_4=n;return n},get_Uploader:function(){return this.$8_4},set_Uploader:function(n){this.$8_4=n;return n},get_AjaxUploader:function(){return this.$5_4},set_AjaxUploader:function(n){this.$5_4=n;return n},initialize:function(){BaseForm.prototype.initialize.call(this);this.$0_4.$2_6="ResultPanePlaceHolder_DataClassification_contentContainer_fingerprintUploadHandler_uploader_iframe";var n=this;window.setInterval(function(){n.get_CommitButton().disabled=ClientUploadManager.get_instance().get_isUploading();ClientUploadManager.get_instance().get_isUploading()?UpdateProgressPopUp.showProgressImmediately(Strings.get_FileStillUploading()):UpdateProgressPopUp.progressCompleted();n.$0_4.get_ListView().get_ToolBar().findItemByName("Add")&&n.$0_4.get_ListView().get_ToolBar().findItemByName("Add").set_enabled(!ClientUploadManager.get_instance().get_isUploading());n.$0_4.get_ListView().get_ToolBar().findItemByName("Delete")&&n.$0_4.get_ListView().get_ToolBar().findItemByName("Delete").set_enabled(!ClientUploadManager.get_instance().get_isUploading())},1e3)},dispose:function(){BaseForm.prototype.dispose.call(this)}};function EditDataClassification(n){EditDataClassification.initializeBase(this,[n])}EditDataClassification.prototype={$0_4:null,$8_4:null,$5_4:null,get_CollectionEditor:function(){return this.$0_4},set_CollectionEditor:function(n){this.$0_4=n;return n},get_Uploader:function(){return this.$8_4},set_Uploader:function(n){this.$8_4=n;return n},get_AjaxUploader:function(){return this.$5_4},set_AjaxUploader:function(n){this.$5_4=n;return n},initialize:function(){BaseForm.prototype.initialize.call(this);this.$0_4.$2_6="ResultPanePlaceHolder_DataClassification_General_contentContainer_fingerprintUploadHandler_uploader_iframe";var n=this;window.setInterval(function(){n.get_CommitButton().disabled=ClientUploadManager.get_instance().get_isUploading();ClientUploadManager.get_instance().get_isUploading()?UpdateProgressPopUp.showProgressImmediately(Strings.get_FileStillUploading()):UpdateProgressPopUp.progressCompleted();n.$0_4.get_ListView().get_ToolBar().findItemByName("Add")&&n.$0_4.get_ListView().get_ToolBar().findItemByName("Add").set_enabled(!ClientUploadManager.get_instance().get_isUploading());n.$0_4.get_ListView().get_ToolBar().findItemByName("Delete")&&n.$0_4.get_ListView().get_ToolBar().findItemByName("Delete").set_enabled(!ClientUploadManager.get_instance().get_isUploading())},1e3)},dispose:function(){BaseForm.prototype.dispose.call(this)}};function FingerprintCollectionEditor(n){FingerprintCollectionEditor.initializeBase(this,[n])}FingerprintCollectionEditor.prototype={$2_6:null,$Q_6:null,get_iFrameId:function(){return this.$2_6},set_iFrameId:function(n){this.$2_6=n;return n},get_uploadFrameID:function(){return this.$Q_6},set_uploadFrameID:function(n){this.$Q_6=n;return n},addCommand:function(){var n=$get(this.$2_6);var t=n.contentDocument.getElementById(ClientUploadManager.uploadFileKey);t.click()}};function FingerprintUploader(n){FingerprintUploader.initializeBase(this,[n])}FingerprintUploader.prototype={get_iFrameId:function(){var n=this.get_UploaderImplementation();return n.get_Iframe().id},handleSuccessfulUpload:function(){var n=this;window.setTimeout(function(){EcpUtil.safeFocus(n.get_DeleteBtn());n.get_DeleteBtn().click()},0)}};function NewPolicyFromTemplate(n){this.$$d_$R_4=Function.createDelegate(this,this.$R_4);NewPolicyFromTemplate.initializeBase(this,[n])}NewPolicyFromTemplate.prototype={$0_4:null,$E_4:null,$B_4:null,$D_4:null,$C_4:null,$A_4:null,get_ListView:function(){return this.$0_4},set_ListView:function(n){this.$0_4=n;return n},get_DistributionGroupPanel:function(){return this.$B_4},set_DistributionGroupPanel:function(n){this.$B_4=n;return n},get_IncidentManagementPanel:function(){return this.$D_4},set_IncidentManagementPanel:function(n){this.$D_4=n;return n},get_IncidentMailboxPicker:function(){return this.$C_4},set_IncidentMailboxPicker:function(n){this.$C_4=n;return n},get_DistibutionGroupPicker:function(){return this.$A_4},set_DistibutionGroupPicker:function(n){this.$A_4=n;return n},initialize:function(){BaseForm.prototype.initialize.call(this);this.$E_4=this.$$d_$R_4;this.$0_4.add_selectionChanged(this.$E_4)},dispose:function(){this.$0_4.remove_selectionChanged(this.$E_4);BaseForm.prototype.dispose.call(this)},$R_4:function(n,t){var i;if(this.$0_4.get_items().length){i=this.$0_4.get_selectedObjects().length?this.$0_4.get_selectedObjects()[0]:this.$0_4.get_items()[0].get_dataObject();var r=this.get_DataContext();r.$7_4=DataBinder.getPropertyValue(i,"Name").toString();_DomElement.toggelCssClass(this.$B_4,!DataBinder.getPropertyValue(i,"SupportsDistributionGroup"),CssClasses.hiddenCSS);_DomElement.toggelCssClass(this.$D_4,!DataBinder.getPropertyValue(i,"SupportsIncidentManagementMailbox"),CssClasses.hiddenCSS);this.$A_4.set_enabled(DataBinder.getPropertyValue(i,"SupportsDistributionGroup"));this.$C_4.set_enabled(DataBinder.getPropertyValue(i,"SupportsIncidentManagementMailbox"))}}};function NewPolicyFromTemplateViewModel(){NewPolicyFromTemplateViewModel.initializeBase(this)}NewPolicyFromTemplateViewModel.prototype={$7_4:null,get_template:function(){return this.$7_4},set_template:function(n){this.$7_4=n;return n},get_valuesToSave:function(){var n=PropertyPageViewModel.prototype.get_valuesToSave.call(this);n.Template=this.$7_4;return n}};function TrendColumnHeader(n,t,i,r,u,f,e,o,s,h,c){TrendColumnHeader.initializeBase(this,[n,t,i,r,u,o,s,h,c]);this.$I_1=f;this.$9_1=e;this.isImgColumn=!0}TrendColumnHeader.prototype={$I_1:null,$9_1:null,renderItem:function(n,t,i){var u=null;this.get_name()&&(u=EcpUtil.htmlEncode(DataBinder.getPropertyValue(n,this.get_name())));var f=0;this.$I_1&&(f=DataBinder.getPropertyValue(n,this.$I_1));var e=null;this.$9_1&&(e=DataBinder.getPropertyValue(n,this.$9_1));var o;o=f>0?TrendColumnHeader.$P:f<0?TrendColumnHeader.$L:TrendColumnHeader.$O;var r=new Sys.StringBuilder;r.append(SpriteImage.createSpriteImageString(TrendColumnHeader.$M+o,e,null,TrendColumnHeader.$N));if(u){r.append(" ");r.append(u)}return r.toString()}};EditPolicy.registerClass("EditPolicy",BaseForm);ExtendedListView.registerClass("ExtendedListView",ListView);RMSEncryptionViewModel.registerClass("RMSEncryptionViewModel",PropertyPageViewModel);DataClassificationViewModel.registerClass("DataClassificationViewModel",PropertyPageViewModel);NewDataClassification.registerClass("NewDataClassification",BaseForm);EditDataClassification.registerClass("EditDataClassification",BaseForm);FingerprintCollectionEditor.registerClass("FingerprintCollectionEditor",EcpCollectionEditor);FingerprintUploader.registerClass("FingerprintUploader",AjaxUploader);NewPolicyFromTemplate.registerClass("NewPolicyFromTemplate",BaseForm);NewPolicyFromTemplateViewModel.registerClass("NewPolicyFromTemplateViewModel",PropertyPageViewModel);TrendColumnHeader.registerClass("TrendColumnHeader",ColumnHeader);RMSEncryptionViewModel.$J='<span class="dspBlock breakWord"><div id="irm_rpt"><textarea id="irmresult" class="errBdy" readonly="true">{0}</textarea></div></span>';TrendColumnHeader.$O="TrendingNeutral";TrendColumnHeader.$P="TrendingUp";TrendColumnHeader.$L="TrendingDown";TrendColumnHeader.$N="padding: 0px;";TrendColumnHeader.$M="ListViewImgColumn CommonSprite "