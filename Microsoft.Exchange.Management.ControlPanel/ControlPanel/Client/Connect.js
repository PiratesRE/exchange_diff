Type.registerNamespace("ECP");function ConnectionNames(){}function ConnectStates(){}function ConnectSubscription(n){this.$$d_$i_3=Function.createDelegate(this,this.$i_3);this.$$d_executeCommandCompleted=Function.createDelegate(this,this.executeCommandCompleted);this.$$d_onLoad=Function.createDelegate(this,this.onLoad);ConnectSubscription.initializeBase(this,[n])}ConnectSubscription.prototype={$0_3:null,$E_3:null,$A_3:null,$F_3:null,get_AppAuthorizationCode:function(){return this.$A_3},set_AppAuthorizationCode:function(n){this.$A_3=n;return n},get_RedirectUri:function(){return this.$F_3},set_RedirectUri:function(n){this.$F_3=n;return n},get_executeCommand:function(){return this.$0_3},set_executeCommand:function(n){this.$0_3=n;return n},initialize:function(){EcpControl.prototype.initialize.call(this);this.initializeSubscription();this.$E_3=this.$$d_onLoad;Sys.Application.add_load(this.$E_3)},dispose:function(){this.$E_3&&Sys.Application.remove_load(this.$E_3);this.$0_3&&this.$0_3.remove_completed(this.$$d_executeCommandCompleted);EcpControl.prototype.dispose.call(this)},executeCommandCompleted:function(n,t){var i=this.$0_3.get_LastResults();if(!i){ErrorHandling.showKnownError(Strings.get_WebServiceRequestInetError());return}this.$t_3(i);if(i.ErrorRecords&&i.ErrorRecords.length>0){ErrorHandling.showPowerShellErrorsWithCallback(i,this.$$d_$i_3);return}window.close()},$i_3:function(n,t){window.close()},$t_3:function(n){window.opener&&PopupWindowManager.tryRefreshOpener(window.self,n)}};function FacebookUserConsentFormViewModel(){FacebookUserConsentFormViewModel.initializeBase(this)}FacebookUserConsentFormViewModel.prototype={$3_3:null,$M_3:null,$I_3:null,get_CloseCommand:function(){return this.$3_3},set_CloseCommand:function(n){if(this.$3_3!==n){this.$3_3=n;this.raisePropertyChanged("CloseCommand")}return n},get_FacebookAuthorizationCommand:function(){return this.$M_3},set_FacebookAuthorizationCommand:function(n){if(this.$M_3!==n){this.$M_3=n;this.raisePropertyChanged("FacebookAuthorizationCommand")}return n},get_AuthorizationUrl:function(){return this.$I_3},set_AuthorizationUrl:function(n){this.$I_3=n;return n},initialize:function(){this.$Z_3()},$Z_3:function(){this.$Y_3();this.$n_3()},$Y_3:function(){var n=this;this.set_CloseCommand(new BoundCommand(function(){NewConnectSubscription.$8("UserConsentForm","Reject");(new CloseCommand).execute()}))},$n_3:function(){var n=this;this.set_FacebookAuthorizationCommand(new BoundCommand(function(){NewConnectSubscription.$8("UserConsentForm","Accept");window.location.href=n.$I_3}))}};function NewConnectSubscription(n){this.$$d_executeCommandCompleted=Function.createDelegate(this,this.executeCommandCompleted);this.$$d_$W_4=Function.createDelegate(this,this.$W_4);NewConnectSubscription.initializeBase(this,[n])}NewConnectSubscription.$8=function(n,t){var i=UrlUtil.getParameter(EcpUrl.requestIdParam);var r=[EcpInstrumentationMarkers.peopleConnect,n,t];DatapointManager.addDatapoint(DatapointManager.constructDatapointString(r),window.self.location.pathname,i)};NewConnectSubscription.prototype={$C_4:!1,$D_4:!1,$J_4:!1,$Q_4:null,$P_4:null,$T_4:null,$9_4:null,get_CreateFacebook:function(){return this.$C_4},set_CreateFacebook:function(n){this.$C_4=n;return n},get_CreateLinkedIn:function(){return this.$D_4},set_CreateLinkedIn:function(n){this.$D_4=n;return n},get_CloseWindowWithoutCreatingSubscription:function(){return this.$J_4},set_CloseWindowWithoutCreatingSubscription:function(n){this.$J_4=n;return n},get_RequestToken:function(){return this.$Q_4},set_RequestToken:function(n){this.$Q_4=n;return n},get_RequestSecret:function(){return this.$P_4},set_RequestSecret:function(n){this.$P_4=n;return n},get_Verifier:function(){return this.$T_4},set_Verifier:function(n){this.$T_4=n;return n},onLoad:function(n,t){NewConnectSubscription.$8("NewConnectSubscription","OnLoad");if(this.$J_4){NewConnectSubscription.$8("NewConnectSubscription","CloseWindowWithoutCreatingSubscription");window.close();return}if(this.$x_4()){UpdateProgressPopUp.showProgress(Strings.get_PeopleConnectBusy());this.$0_3=new WebServiceCommand;this.$0_3.init("../DDI/DDIService.svc?schema=ConnectService","NewObject",this.$$d_$W_4);this.$0_3.get_webServiceMethod().set_ParameterNames(3);this.$0_3.add_completed(this.$$d_executeCommandCompleted);this.$0_3.execute()}},executeCommandCompleted:function(n,t){NewConnectSubscription.$8("NewConnectSubscription","CreateSubscriptionCompleted");UpdateProgressPopUp.progressCompleted();ConnectSubscription.prototype.executeCommandCompleted.call(this,n,t)},initializeSubscription:function(){if(this.$C_4&&this.$D_4)throw Error.invalidOperation("Can't specify CreateFacebook and CreateLinkedIn at the same time.");if(this.$C_4){this.$9_4="Facebook";return}if(this.$D_4){this.$9_4="LinkedIn";return}this.$9_4=""},$W_4:function(){switch(this.$9_4){case"Facebook":return this.$X_4();case"LinkedIn":return this.$j_4();case"":throw Error.invalidOperation("Can't get parameters when no subscription is to be created.");default:throw Error.invalidOperation("Unexpected subscription.");}},$X_4:function(){var n={};n.CreateFacebook="true";n.AppAuthorizationCode=this.$A_3;n.RedirectUri=this.$F_3;return[n]},$j_4:function(){var n={};n.CreateLinkedIn="true";n.RequestToken=this.$Q_4;n.RequestSecret=this.$P_4;n.OAuthVerifier=this.$T_4;return[n]},$x_4:function(){return this.$9_4!==""}};function PeopleConnection(n){PeopleConnection.initializeBase(this,[n])}PeopleConnection.prototype={get_Identity:function(){return this.getValue("IdentityString")},get_Name:function(){return this.getValue("Name")},set_Name:function(n){this.setValue("Name",n);return n},get_Connected:function(){return this.get_ConnectState()==="Connected"},get_ConnectedNeedsToken:function(){return this.get_ConnectState()==="ConnectedNeedsToken"},get_Disabled:function(){return this.get_ConnectState()==="Disabled"},get_Disconnected:function(){return this.get_ConnectState()==="Disconnected"},get_Delayed:function(){return this.get_ConnectState()==="Delayed"},get_ConnectState:function(){return this.getValue("ConnectState")},set_ConnectState:function(n){this.setValue("ConnectState",n);return n}};function PeopleConnectionsViewModel(){this.$$d_$r_3=Function.createDelegate(this,this.$r_3);this.$$d_$u_3=Function.createDelegate(this,this.$u_3);this.$$d_$f_3=Function.createDelegate(this,this.$f_3);this.$$d_$k_3=Function.createDelegate(this,this.$k_3);this.$$d_$g_3=Function.createDelegate(this,this.$g_3);this.$$d_$l_3=Function.createDelegate(this,this.$l_3);this.$$d_$h_3=Function.createDelegate(this,this.$h_3);this.$$d_$w_3=Function.createDelegate(this,this.$w_3);this.$$d_$v_3=Function.createDelegate(this,this.$v_3);PeopleConnectionsViewModel.initializeBase(this);this.$2_3=this.$4_3("LinkedIn");this.$1_3=this.$4_3("Facebook")}PeopleConnectionsViewModel.prototype={$B_3:null,$7_3:null,$6_3:null,$3_3:null,$5_3:null,$2_3:null,$1_3:null,add_refreshStarted:function(n){throw Error.notImplemented();},remove_refreshStarted:function(n){throw Error.notImplemented();},add_refreshCompleted:function(n){throw Error.notImplemented();},remove_refreshCompleted:function(n){throw Error.notImplemented();},get_FacebookConnectUrl:function(){return this.getValue("FacebookConnectUrl")},set_FacebookConnectUrl:function(n){this.setValue("FacebookConnectUrl",n);this.raisePropertyChanged("FacebookConnectUrl");return n},get_FacebookConnectWindowWidth:function(){return this.getValue("FacebookConnectWindowWidth")},set_FacebookConnectWindowWidth:function(n){this.setValue("FacebookConnectWindowWidth",n);this.raisePropertyChanged("FacebookConnectWindowWidth");return n},get_FacebookConnectWindowHeight:function(){return this.getValue("FacebookConnectWindowHeight")},set_FacebookConnectWindowHeight:function(n){this.setValue("FacebookConnectWindowHeight",n);this.raisePropertyChanged("FacebookConnectWindowHeight");return n},get_FacebookConnectionDescription:function(){switch(this.$1_3.get_ConnectState()){case"Connected":return Strings.get_RemoveFacebookSupportingText();case"ConnectedNeedsToken":return Strings.get_ReconnectToFacebookMessage();case"Disabled":return Strings.get_RemoveDisabledFacebookConnectionText();case"Delayed":return Strings.get_FacebookDelayed();default:return Strings.get_ConnectToFacebookMessage()}},get_FacebookDisconnected:function(){return this.$1_3.get_Disconnected()},get_FacebookConnectionStatus:function(){switch(this.$1_3.get_ConnectState()){case"Connected":return Strings.get_ProviderConnected();case"ConnectedNeedsToken":return Strings.get_ProviderConnectedWithError();case"Delayed":return Strings.get_ProviderDelayed();case"Disabled":return Strings.get_ProviderDisabled();default:return""}},get_ConnectToFacebookCommand:function(){var n=this.get_FacebookConnectUrl();this.$1_3.get_ConnectedNeedsToken()&&(n=EcpUrl.setUrlParameter(this.get_FacebookConnectUrl(),"Action","Reconnect"));return this.$V_3(this.$L_3(n),this.get_FacebookConnectWindowWidth(),this.get_FacebookConnectWindowHeight())},get_FacebookConnectCommandText:function(){switch(this.$1_3.get_ConnectState()){case"ConnectedNeedsToken":return Strings.get_ReconnectProviderCommandText();default:return Strings.get_ConnectProviderCommandText()}},get_FacebookConnectedNeedsToken:function(){return this.$1_3.get_ConnectedNeedsToken()},get_RemoveFacebookCommand:function(){return this.$6_3},set_RemoveFacebookCommand:function(n){if(this.$6_3!==n){this.$6_3=n;this.raisePropertyChanged("RemoveFacebookCommand")}return n},get_LinkedInConnectUrl:function(){return this.getValue("LinkedInConnectUrl")},set_LinkedInConnectUrl:function(n){this.setValue("LinkedInConnectUrl",n);this.raisePropertyChanged("LinkedInConnectUrl");return n},get_LinkedInConnectWindowWidth:function(){return this.getValue("LinkedInConnectWindowWidth")},set_LinkedInConnectWindowWidth:function(n){this.setValue("LinkedInConnectWindowWidth",n);this.raisePropertyChanged("LinkedInConnectWindowWidth");return n},get_LinkedInConnectWindowHeight:function(){return this.getValue("LinkedInConnectWindowHeight")},set_LinkedInConnectWindowHeight:function(n){this.setValue("LinkedInConnectWindowHeight",n);this.raisePropertyChanged("LinkedInConnectWindowHeight");return n},get_LinkedInConnectionDescription:function(){switch(this.$2_3.get_ConnectState()){case"Connected":return Strings.get_RemoveLinkedInSupportingText();case"Disabled":return Strings.get_RemoveDisabledLinkedInConnectionText();case"Delayed":return Strings.get_LinkedInDelayed();default:return Strings.get_ConnectToLinkedInMessage()}},get_LinkedInDisconnected:function(){return this.$2_3.get_Disconnected()},get_LinkedInConnectionStatus:function(){switch(this.$2_3.get_ConnectState()){case"Connected":return Strings.get_ProviderConnected();case"ConnectedNeedsToken":return Strings.get_ProviderConnectedWithError();case"Delayed":return Strings.get_ProviderDelayed();case"Disabled":return Strings.get_ProviderDisabled();default:return""}},get_ConnectToLinkedInCommand:function(){return this.$B_3},set_ConnectToLinkedInCommand:function(n){if(this.$B_3!==n){this.$B_3=n;this.raisePropertyChanged("ConnectToLinkedInCommand")}return n},get_LinkedInConnectCommandText:function(){return Strings.get_ConnectProviderCommandText()},get_RemoveLinkedInCommand:function(){return this.$7_3},set_RemoveLinkedInCommand:function(n){if(this.$7_3!==n){this.$7_3=n;this.raisePropertyChanged("RemoveLinkedInCommand")}return n},get_CloseCommand:function(){return this.$3_3},set_CloseCommand:function(n){if(this.$3_3!==n){this.$3_3=n;this.raisePropertyChanged("CloseCommand")}return n},get_LoadCommand:function(){return this.$5_3},set_LoadCommand:function(n){if(this.$5_3!==n){this.$5_3=n;this.raisePropertyChanged("LoadCommand")}return n},get_refreshing:function(){throw Error.notImplemented();},get_returnObjectType:function(){return 1},get_warnings:function(){throw Error.notImplemented();},initialize:function(){this.$Z_3();this.$O_3()},refresh:function(){throw Error.notImplemented();},refreshObject:function(n){throw Error.notImplemented();},removeObject:function(n){throw Error.notImplemented();},mergeRefresh:function(n){this.$s_3(n)},setRemoveFacebookCommand:function(n){n.remove_completed(this.$$d_$v_3);n.add_completed(this.$$d_$v_3);this.set_RemoveFacebookCommand(n)},setRemoveLinkedInCommand:function(n){n.remove_completed(this.$$d_$w_3);n.add_completed(this.$$d_$w_3);this.set_RemoveLinkedInCommand(n)},$Z_3:function(){this.$o_3();this.$m_3();this.$q_3();this.$p_3();this.$Y_3()},$m_3:function(){_Object.isNullOrUndefined(this.$B_3)&&this.set_ConnectToLinkedInCommand(this.$V_3(this.$L_3(this.get_LinkedInConnectUrl()),this.get_LinkedInConnectWindowWidth(),this.get_LinkedInConnectWindowHeight()))},$Y_3:function(){this.set_CloseCommand(new CloseCommand)},$V_3:function(n,t,i){var r=new PropertyCommand;r.set_navigateUrl(n);r.set_ParameterGetter(this.$$d_$h_3);r.set_showAddressBar(!1);r.set_showMenuBar(!1);r.set_showStatusBar(!1);r.set_showToolBar(!1);r.set_RefreshAction(5);r.set_ownerControl(this);r.set_width(t);r.set_height(i);return r},$q_3:function(){if(_Object.isNullOrUndefined(this.$7_3)){var n=new WebServiceCommand;n.get_webServiceMethod().set_ParameterNames(6);n.init(this.$N_3(),"RemoveObjects",this.$$d_$l_3);n.set_ConfirmationText(Strings.get_ConfirmRemoveLinkedIn());n.set_confirm(this.$$d_$g_3);this.setRemoveLinkedInCommand(n)}},$p_3:function(){if(_Object.isNullOrUndefined(this.$6_3)){var n=new WebServiceCommand;n.get_webServiceMethod().set_ParameterNames(6);n.init(this.$N_3(),"RemoveObjects",this.$$d_$k_3);n.set_ConfirmationText(Strings.get_ConfirmRemoveFacebook());n.set_confirm(this.$$d_$f_3);this.setRemoveFacebookCommand(n)}},$g_3:function(n,t){this.$U_3(this.$2_3,Strings.get_ConfirmRemoveLinkedIn(),n,t)},$f_3:function(n,t){this.$U_3(this.$1_3,Strings.get_ConfirmRemoveFacebook(),n,t)},$U_3:function(n,t,i,r){if(n&&!n.get_Disconnected()){this.$7_3.set_LastResults(null);this.$6_3.set_LastResults(null);var u=new Info;u.set_Title(Strings.get_ConfirmRemoveConnectionTitle());u.Message=t;var f=this;MessageBox.showCustom(u,2,function(n,t){if(n===ModalDialogResult.yes){i();return}else{r();return}},null)}},$w_3:function(n,t){this.$c_3(n,"LinkedIn")},$v_3:function(n,t){this.$c_3(n,"Facebook")},$c_3:function(n,t){var i=n.get_LastResults();if(i){if(i.ErrorRecords&&i.ErrorRecords.length>0){ErrorHandling.showPowerShellErrorsWithCallback(i,this.$$d_$u_3);return}switch(t){case"Facebook":this.$z_3();return;case"LinkedIn":this.$10_3();return;default:return}}},$u_3:function(n,t){this.$O_3()},$o_3:function(){if(!_Object.isNullOrUndefined(this.$5_3)){this.$5_3.add_completed(this.$$d_$r_3);return}var n=new WebServiceCommand;n.get_webServiceMethod().set_ParameterNames(0);n.init(this.$N_3(),"GetList",this.$$d_$h_3);n.add_completed(this.$$d_$r_3);this.set_LoadCommand(n)},$O_3:function(){this.$5_3.execute()},$r_3:function(n,t){var i=n.get_LastResults();if(i){if(i.ErrorRecords&&i.ErrorRecords.length>0){ErrorHandling.showPowerShellErrors(i);return}var r={};r.LinkedIn=this.$4_3("LinkedIn");r.Facebook=this.$4_3("Facebook");var f=i.Output;if(f)for(var e=f,s=e.length,u=0;u<s;++u){var h=e[u];var o=new PeopleConnection(h);r[o.get_Name()]=o}this.$S_3(r.LinkedIn);this.$S_3(r.Facebook)}},$4_3:function(n){var t=new PeopleConnection;t.set_Name(n);t.set_ConnectState("Disconnected");return t},$S_3:function(n){switch(n.get_Name()){case"Facebook":this.$1_3=n;this.$a_3();break;case"LinkedIn":this.$2_3=n;this.$b_3();break;default:break}},$10_3:function(){this.$e_3()},$z_3:function(){this.$d_3()},$e_3:function(){this.$2_3=this.$4_3("LinkedIn");this.$b_3()},$d_3:function(){this.$1_3=this.$4_3("Facebook");this.$a_3()},$l_3:function(){return[[new Identity(this.$2_3.get_Identity(),this.$2_3.get_Name())],null]},$k_3:function(){return[[new Identity(this.$1_3.get_Identity(),this.$1_3.get_Name())],null]},$h_3:function(){return new Array(0)},$b_3:function(){this.raisePropertyChanged("LinkedInConnectionDescription");this.raisePropertyChanged("LinkedInDisconnected");this.raisePropertyChanged("LinkedInConnectionStatus");this.raisePropertyChanged("ConnectToLinkedInCommand");this.raisePropertyChanged("LinkedInConnectCommandText");this.raisePropertyChanged("LinkedInConnectedNeedsToken");this.raisePropertyChanged("RemoveLinkedInCommand")},$a_3:function(){this.raisePropertyChanged("FacebookConnectionDescription");this.raisePropertyChanged("FacebookDisconnected");this.raisePropertyChanged("FacebookConnectionStatus");this.raisePropertyChanged("ConnectToFacebookCommand");this.raisePropertyChanged("FacebookConnectCommandText");this.raisePropertyChanged("FacebookConnectedNeedsToken");this.raisePropertyChanged("RemoveFacebookCommand")},$N_3:function(){return this.$L_3(this.get_ServiceUrl())},$L_3:function(n){return EcpUrl.get_ecpFullUrl()+n},$s_3:function(n){if(n){if(n.ErrorRecords&&n.ErrorRecords.length>0){this.$O_3();return}}else return;n.Output&&n.Output.length&&this.$S_3(new PeopleConnection(n.Output[0]))}};function SetConnectSubscription(n){this.$$d_$W_4=Function.createDelegate(this,this.$W_4);SetConnectSubscription.initializeBase(this,[n])}SetConnectSubscription.prototype={$R_4:!1,$K_4:!1,$G_4:null,get_SetFacebook:function(){return this.$R_4},set_SetFacebook:function(n){this.$R_4=n;return n},get_CloseWindowWithoutUpdatingSubscription:function(){return this.$K_4},set_CloseWindowWithoutUpdatingSubscription:function(n){this.$K_4=n;return n},onLoad:function(n,t){if(this.$K_4){window.close();return}if(this.$y_4()){this.$0_3=new WebServiceCommand;this.$0_3.get_webServiceMethod().set_ParameterNames(8);this.$0_3.init("../DDI/DDIService.svc?schema=ConnectService&workflow=SetConnection","SetConnection",this.$$d_$W_4);this.$0_3.add_completed(this.$$d_executeCommandCompleted);this.$0_3.execute()}},initializeSubscription:function(){if(this.$R_4){this.$G_4="Facebook";return}this.$G_4=""},$W_4:function(){switch(this.$G_4){case"Facebook":return this.$X_4();case"":throw Error.invalidOperation("Can't get parameters when no subscription is to be updated.");default:throw Error.invalidOperation("Unexpected subscription.");}},$X_4:function(){var n={};n.SetFacebook="true";n.AppAuthorizationCode=this.$A_3;n.RedirectUri=this.$F_3;return[n]},$y_4:function(){return this.$G_4!==""}};ConnectionNames.registerClass("ConnectionNames");ConnectStates.registerClass("ConnectStates");ConnectSubscription.registerClass("ConnectSubscription",EcpControl);FacebookUserConsentFormViewModel.registerClass("FacebookUserConsentFormViewModel",ViewModelBase);NewConnectSubscription.registerClass("NewConnectSubscription",ConnectSubscription);PeopleConnection.registerClass("PeopleConnection",NotifyPropertyChangedJson);PeopleConnectionsViewModel.registerClass("PeopleConnectionsViewModel",ViewModelBase,IRefreshable);SetConnectSubscription.registerClass("SetConnectSubscription",ConnectSubscription);ConnectionNames.facebook="Facebook";ConnectionNames.linkedIn="LinkedIn";ConnectStates.connected="Connected";ConnectStates.disconnected="Disconnected";ConnectStates.connectedNeedsToken="ConnectedNeedsToken";ConnectStates.disabled="Disabled";ConnectStates.delayed="Delayed";ConnectSubscription.noSubscription=""