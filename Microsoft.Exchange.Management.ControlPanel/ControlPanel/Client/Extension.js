Type.registerNamespace("ECP");function InstallExtensionFromURLSlab(n){this.$$d_$Q_4=Function.createDelegate(this,this.$Q_4);this.$$d_getAppParameters=Function.createDelegate(this,this.getAppParameters);this.$$d_$R_4=Function.createDelegate(this,this.$R_4);this.$$d_getInstallParameters=Function.createDelegate(this,this.getInstallParameters);this.$$d_$S_4=Function.createDelegate(this,this.$S_4);this.$$d_getLoadParameters=Function.createDelegate(this,this.getLoadParameters);this.$$d_$U_4=Function.createDelegate(this,this.$U_4);InstallExtensionFromURLSlab.initializeBase(this,[n])}InstallExtensionFromURLSlab.prototype={$0_4:null,$B_4:null,$1_4:null,$E_4:null,$5_4:null,$4_4:null,$9_4:null,$8_4:null,$3_4:null,$7_4:null,$F_4:null,$A_4:null,$O_4:null,$D_4:null,$6_4:null,$L_4:!1,get_ServiceUrl:function(){return this.$5_4},set_ServiceUrl:function(n){this.$5_4=n;return n},get_InstallEtoken:function(){return this.$E_4},set_InstallEtoken:function(n){this.$E_4=n;return n},get_MarketplaceQueryMarket:function(){return this.$4_4},set_MarketplaceQueryMarket:function(n){this.$4_4=n;return n},get_InstallMarketplaceAssetID:function(){return this.$3_4},set_InstallMarketplaceAssetID:function(n){this.$3_4=n;return n},get_DeploymentID:function(){return this.$7_4},set_DeploymentID:function(n){this.$7_4=n;return n},get_MarketplaceServicesUrl:function(){return this.$F_4},set_MarketplaceServicesUrl:function(n){this.$F_4=n;return n},get_MarketplacePageBaseUrl:function(){return this.$A_4},set_MarketplacePageBaseUrl:function(n){this.$A_4=n;return n},get_Scope:function(){return this.$O_4},set_Scope:function(n){this.$O_4=n;return n},get_MarketplaceClid:function(){return this.$9_4},set_MarketplaceClid:function(n){this.$9_4=n;return n},get_FullVersion:function(){return this.$8_4},set_FullVersion:function(n){this.$8_4=n;return n},getLoadParameters:function(){var n=this.$J_4(!0);return[n]},getInstallParameters:function(){var n=this.$J_4(!1);return[n]},getAppParameters:function(){var n={};n.RawIdentity=this.$D_4;return[n]},initialize:function(){EcpControl.prototype.initialize.call(this);this.$B_4=this.$$d_$U_4;Sys.Application.add_load(this.$B_4)},dispose:function(){this.$B_4&&Sys.Application.remove_load(this.$B_4);this.$1_4&&this.$0_4.remove_completed(this.$1_4);EcpControl.prototype.dispose.call(this)},$J_4:function(n){var t={};t.InstallMarketplaceAssetID=this.$3_4;t.MarketplaceQueryMarket=this.$4_4;t.MarketplaceServicesUrl=this.$F_4;t.InstallEtoken=this.$E_4;n&&(t.DownloadOnly=!0);return t},$S_4:function(n,t){UpdateProgressPopUp.progressCompleted();var r=this.$0_4.get_LastResults();var u=String.format("{0}?app=outlook.exe&ver=15&clid={1}&p1={2}&p2=0&p3=0&p4={3}&p5={4}&DeployId={5}",this.$A_4,this.$9_4,this.$8_4,"AF",this.$4_4+"\\"+this.$3_4,this.$7_4);var e=_String.empty;var o=_String.empty;var s=_String.empty;var h=_String.empty;this.$6_4=_String.empty;if(r&&r.Output&&r.Output.length>0){var c=r.Output[0];for(var l in c){var i={key:l,value:c[l]};i.key.toLowerCase()==="displayname"&&(e=i.value);i.key.toLowerCase()==="providername"&&(o=i.value);i.key.toLowerCase()==="requirementsvalue"&&(s=i.value);i.key.toLowerCase()==="requirementsdescription"&&(h=i.value);i.key.toLowerCase()==="appversion"&&(this.$6_4=i.value);i.key.toLowerCase()==="appid"&&(this.$D_4=i.value)}var f=new Info;f.set_Title(OwaOptionStrings.get_AgaveInstallTitle());f.Message=String.format("{0} <br><br> {1} <br> {2} <br> {3} <br> {4} <br> {5} ",OwaOptionStrings.get_PleaseConfirm(),OwaOptionStrings.AgaveDisplayName(e),OwaOptionStrings.AgaveProvider(o),OwaOptionStrings.AgaveVersion(this.$6_4),OwaOptionStrings.AgaveRequirementsValue(s),h);var a=this;MessageBox.showCustom(f,2,function(n,t){n===ModalDialogResult.yes?a.$T_4():PopupWindowManager.OpenWindow(u,"_self"," ")},null)}else if(null!==r&&r.ErrorRecords&&r.ErrorRecords.length>0){var v=this;ErrorHandling.showPowerShellErrorsWithCallback(r,function(n,t){PopupWindowManager.OpenWindow(u,"_self"," ")})}else PopupWindowManager.OpenWindow(u,"_self"," ")},$R_4:function(n,t){UpdateProgressPopUp.progressCompleted();var i=this.$0_4.get_LastResults();var r=null!==i&&!!i.ErrorRecords&&i.ErrorRecords.length>0;var u=String.format("{0}?app=outlook.exe&ver=15&clid={1}&p1={2}&p2=0&p3=0&p4={3}&p5={4}&DeployId={5}",this.$A_4,this.$9_4,this.$8_4,r?this.$L_4?"AO":"AF":"AC",this.$4_4+"\\"+this.$3_4,this.$7_4);if(r){var f=this;ErrorHandling.showPowerShellErrorsWithCallback(i,function(n,t){PopupWindowManager.OpenWindow(u,"_self"," ")})}else{localStorage.RefreshExtensionListViewFlag="true";PopupWindowManager.OpenWindow(u,"_self"," ")}},$Q_4:function(n,t){UpdateProgressPopUp.progressCompleted();var i=this.$0_4.get_LastResults();var o=null!==i&&!!i.ErrorRecords&&i.ErrorRecords.length>0;if(!o&&null!==i&&i.Output&&i.Output.length>0){var r=_String.empty;var u=i.Output[0];for(var f in u){var e={key:f,value:u[f]};e.key.toLowerCase()==="appversion"&&(r=e.value)}this.$L_4=this.$P_4(r,this.$6_4)>0}this.$K_4()},$P_4:function(n,t){for(var i=n.split("."),r=t.split("."),o=i.length<r.length?i.length:r.length,u=0;u<o;u++){var f=Number.parseInvariant(i[u]);var e=Number.parseInvariant(r[u]);if(f!==e)return f<e?-1:1}return i.length===r.length?0:i.length<r.length?-1:1},$U_4:function(n,t){var i=new WebServiceCommand;i.init(this.$5_4,"NewObject",this.$$d_getLoadParameters);i.get_webServiceMethod().set_ParameterNames(3);this.$0_4=i;this.$1_4=this.$$d_$S_4;this.$0_4.add_completed(this.$1_4);this.$0_4.execute();UpdateProgressPopUp.showProgress(OwaOptionStrings.get_RetrieveInfo())},$K_4:function(){var n=new WebServiceCommand;n.init(this.$5_4,"NewObject",this.$$d_getInstallParameters);n.get_webServiceMethod().set_ParameterNames(3);this.$0_4=n;this.$1_4=this.$$d_$R_4;this.$0_4.add_completed(this.$1_4);this.$0_4.execute();UpdateProgressPopUp.showProgress(OwaOptionStrings.get_Install())},$T_4:function(){_String.isNullOrEmpty(this.$D_4)&&this.$K_4();var n=new WebServiceCommand;n.init(this.$5_4,"GetObject",this.$$d_getAppParameters);n.get_webServiceMethod().set_ParameterNames(5);this.$0_4=n;this.$1_4=this.$$d_$Q_4;this.$0_4.add_completed(this.$1_4);this.$0_4.execute();UpdateProgressPopUp.showProgress(OwaOptionStrings.get_RetrieveInfo())}};function UploadPackageStep(n){this.$$d_$V_6=Function.createDelegate(this,this.$V_6);UploadPackageStep.initializeBase(this,[n])}UploadPackageStep.prototype={$N_6:null,$H_6:null,$2_6:null,$G_6:null,$I_6:null,get_Properties:function(){return this.$N_6},set_Properties:function(n){this.$N_6=n;return n},get_UploaderImplementation:function(){return this.$2_6},set_UploaderImplementation:function(n){this.$2_6=n;return n},get_ProgressDescription:function(){return this.$G_6},set_ProgressDescription:function(n){this.$G_6=n;return n},get_FileLocationLbl:function(){return this.$I_6},set_FileLocationLbl:function(n){this.$I_6=n;return n},isFinalStep:function(){return!1},dispose:function(){EcpControl.prototype.dispose.call(this);this.$2_6.remove_uploadCompleted(this.$H_6)},initialize:function(){WizardStep.prototype.initialize.call(this);this.$H_6=this.$$d_$V_6;this.$2_6.add_uploadCompleted(this.$H_6)},getNextStep:function(n){var t=this.$2_6.get_ErrorLbl().innerHTML;if(t&&t!==""){this.get_Form().get_CancelButton().disabled=this.get_Form().get_NextButton().disabled=!1;return}this.$2_6.tryUpload();UpdateProgressPopUp.showProgress(this.$G_6)},$V_6:function(n){UpdateProgressPopUp.progressCompleted();switch(n.get_resultStatus()){case 2:ErrorHandling.showPowerShellErrors(n.get_results());this.get_Form().get_CancelButton().disabled=this.get_Form().get_NextButton().disabled=!1;break;case 1:PopupWindowManager.tryRefreshOpener(window.self,n.get_results());window.close();break}}};function ExtensionWizardForm(n){ExtensionWizardForm.initializeBase(this,[n])}function ExtensionWizardProperties(n){ExtensionWizardProperties.initializeBase(this,[n])}ExtensionWizardProperties.prototype={$M_5:null,get_extensionName:function(){return this.getContentElementByServerId("extName")},get_extensionVersion:function(){return this.getContentElementByServerId("extVersion")},get_extensionId:function(){return this.getContentElementByServerId("extId")},get_newIdentityBinding:function(){return this.$M_5},set_newIdentityBinding:function(n){this.$M_5=n;return n}};function ConfirmationStep(n){ConfirmationStep.initializeBase(this,[n])}ConfirmationStep.prototype={show:function(){this.get_Form().get_BackButton().style.display="none";this.get_Form().get_CancelButton().style.display="none";WizardStepBase.prototype.show.call(this)}};InstallExtensionFromURLSlab.registerClass("InstallExtensionFromURLSlab",ContainerControl);UploadPackageStep.registerClass("UploadPackageStep",WizardStep);ExtensionWizardForm.registerClass("ExtensionWizardForm",WizardForm);ExtensionWizardProperties.registerClass("ExtensionWizardProperties",PropertyPage);ConfirmationStep.registerClass("ConfirmationStep",WebServiceWizardStep)