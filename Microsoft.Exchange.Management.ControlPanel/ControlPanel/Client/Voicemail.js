Type.registerNamespace("ECP");function PlayOnPhoneViewModel(n){this.$$d_disconnect_PreExecute=Function.createDelegate(this,this.disconnect_PreExecute);this.$$d_dial_PreExecute=Function.createDelegate(this,this.dial_PreExecute);this.$$d_dial_Completed=Function.createDelegate(this,this.dial_Completed);this.$$d_dial_Progress=Function.createDelegate(this,this.dial_Progress);this.$$d_$d_3=Function.createDelegate(this,this.$d_3);PlayOnPhoneViewModel.initializeBase(this);this.$T_3=n;this.$3_3=new WebServiceCommand;this.$3_3.set_parameterNames(3);this.$3_3.init("../DDI/DDIService.svc?schema=PlayOnPhoneService","Dial",this.$$d_$d_3);this.$3_3.get_webServiceMethod().add_Progress(this.$$d_dial_Progress);this.$3_3.add_completed(this.$$d_dial_Completed);this.$3_3.add_preExecute(this.$$d_dial_PreExecute);var t=this;this.$F_3=new BoundCommand(function(){t.$3_3.get_webServiceMethod().stop()});this.$F_3.add_preExecute(this.$$d_disconnect_PreExecute);var i=this;this.$X_3=new BoundCommand(function(){i.set_IsVisible(!0);var n=window.self.popupOpenerSourceElement;if(!_Object.isNullOrUndefined(n)){n.style.display="none";AccUtil.setFoucsToPopupOpenerSourceElement(window.self)}});this.set_IsVisible(!1);this.set_IsRunning(!1)}PlayOnPhoneViewModel.prototype={$3_3:null,$X_3:null,$F_3:null,$T_3:null,get_CallState:function(){return this.getValue("CallState")},set_CallState:function(n){this.setValue("CallState",n);return n},get_IsVisible:function(){return this.getValue("IsVisible")},set_IsVisible:function(n){this.setValue("IsVisible",n);return n},get_IsRunning:function(){return this.getValue("IsRunning")},set_IsRunning:function(n){this.setValue("IsRunning",n);return n},get_DefaultVoicemailGreeting:function(){return this.$T_3.getProperty("Greeting")==="Voicemail"},get_CallAnsweringRuleId:function(){return this.getValue("CallAnsweringRuleId")},set_CallAnsweringRuleId:function(n){this.setValue("CallAnsweringRuleId",n);return n},get_PhoneNumberToDial:function(){return this.getValue("PhoneNumberToDial")},set_PhoneNumberToDial:function(n){EcpUtil.isNullOrEmpty(n)||this.setValue("PhoneNumberToDial",n);return n},get_ShowCommand:function(){return this.$X_3},get_DialCommand:function(){return this.$3_3},get_DisconnectCommand:function(){return this.$F_3},dial_Progress:function(n,t){this.set_CallState(this.$9_3(t.status))},dial_PreExecute:function(n,t){this.set_CallState(this.$9_3("Connecting"));this.set_IsRunning(!0)},disconnect_PreExecute:function(n,t){this.set_CallState(this.$9_3("Disconnecting"))},dial_Completed:function(n,t){this.set_CallState(this.$9_3("Disconnected"));this.set_IsRunning(!1);var i=this.$3_3.get_LastResults();i&&i.ErrorRecords&&i.ErrorRecords.length>0&&ErrorHandling.showPowerShellErrors(i)},$9_3:function(n){if(n==="Idle"||n==="Connecting")return Strings.get_PlayOnPhoneDialing();else if(n==="Connected")return Strings.get_PlayOnPhoneConnected();else if(n==="Disconnecting")return Strings.get_PlayOnPhoneDisconnecting();return _String.empty},$d_3:function(){var n={};n.PhoneNumber=this.get_PhoneNumberToDial();var t=this.get_CallAnsweringRuleId();if(_String.isNullOrEmpty(t)){var i=this.get_DefaultVoicemailGreeting()?"DefaultVoicemailGreeting":"AwayVoicemailGreeting";n[i]=!0}else n.CallAnsweringRuleId=t;return[n]}};function VoicemailConfigurationProperties(n){this.$$d_$i_6=Function.createDelegate(this,this.$i_6);this.$$d_$o_6=Function.createDelegate(this,this.$o_6);this.$$d_$l_6=Function.createDelegate(this,this.$l_6);this.$$d_$k_6=Function.createDelegate(this,this.$k_6);this.$$d_$j_6=Function.createDelegate(this,this.$j_6);VoicemailConfigurationProperties.initializeBase(this,[n])}VoicemailConfigurationProperties.prototype={$C_6:null,$M_6:null,get_$P_6:function(){return this.get_output().CallForwardingPilotNumber},get_$H_6:function(){return this.get_output().RequiredPINLength},get_$L_6:function(){return this.get_output().VerificationCodeRequired},get_OperatorIds:function(){return this.$C_6},set_OperatorIds:function(n){this.$C_6=n;return n},get_VoiceMailCarrierDictionary:function(){return this.$M_6},set_VoiceMailCarrierDictionary:function(n){this.$M_6=n;return n},get_TestDoneCheckBox:function(){return this.getContentElementByServerId("cbxTestDone")},get_SendPasscodeLink:function(){return this.getContentElementByServerId("lnkSendPasscode")},showClickFinishLabel:function(){this.showElementById("lblClickFinish",this.get_TestDoneCheckBox().checked)},initialize:function(){PropertyPage.prototype.initialize.call(this);if(this.get_hasOutput()){for(var n=this.getContentElementByServerId("OperatorList"),u=0;u<this.$C_6.length;u++){var e=this.$C_6[u];var s=this.$S_6(e);this.addOption(n,s.Name,e)}var f=this.getContentElementByServerId("txtPhoneProviderId");this.selectValue(n,f.value);var i=this.getContentElementByServerId("txtPhoneNumber");var r=this.getContentElementByServerId("txtPin");var o=this.getContentElementByServerId("txtPinConfirm");var h=String.format(Strings.get_VoicemailWizardEnterPinText(),this.get_$H_6());this.setInnerText("lblEnterNDigitPin",h);r.setAttribute("maxLength",this.get_$H_6());o.setAttribute("maxLength",this.get_$H_6());this.get_isConfigured()||(r.value="");o.value=r.value;$addHandler(n,"change",this.$$d_$j_6);$addHandler(i,"change",this.$$d_$k_6);$addHandler(r,"change",this.$$d_$l_6);$addHandler(window,"unload",this.$$d_$o_6);$addHandler(this.get_Form().get_CancelButton(),"click",this.$$d_$i_6);n.disabled=i.disabled=!0;var t=this;window.setTimeout(function(){if(!t.get_isConfigured()){t.$E_6(f,"txtSMSNotificationPhoneProviderId");t.selectValue(n,f.value);n.selectedIndex>0&&t.$E_6(i,"txtSMSNotificationPhoneNumber");var r=t.getContentElementByServerId("txtSMSOption");r.value="VoiceMail"}t.$K_6();t.updateVerificationCodeElements();n.disabled=i.disabled=!1},100)}},updateVerificationCodeElements:function(){this.showElementById("EnterVerificationCodeDiv",this.get_$L_6());this.showElementById("VerificationCodeRequiredDiv",this.get_$L_6());this.showElementById("VerificationCodeNotRequiredDiv",!this.get_$L_6())},dispose:function(){$removeHandler(this.getContentElementByServerId("OperatorList"),"change",this.$$d_$j_6);$removeHandler(this.getContentElementByServerId("txtPin"),"change",this.$$d_$l_6);$removeHandler(this.getContentElementByServerId("txtPhoneNumber"),"change",this.$$d_$k_6);$removeHandler(window,"unload",this.$$d_$o_6);VoicemailPropertiesBase.prototype.dispose.call(this)},$j_6:function(n){var i=this.getContentElementByServerId("OperatorList");var t=this.getContentElementByServerId("txtPhoneProviderId");t.value=i.value;var r=this.getContentElementByServerId("txtSMSNotificationPhoneProviderId");r.value=t.value;this.$K_6();this.raisePropertyChanged("PhoneProviderId")},$l_6:function(n){var t=this.getContentElementByServerId("txtPinConfirm");t.value=""},$k_6:function(n){var t=this.getContentElementByServerId("txtSMSNotificationPhoneNumber");this.$E_6(t,"txtPhoneNumber");this.$K_6();this.raisePropertyChanged("PhoneNumber")},$o_6:function(n){PopupWindowManager.tryRefreshOpener()},$S_6:function(n){return this.$M_6[n]},$i_6:function(n){n.preventDefault();var t=new Info;t.MessageType=MessageBoxType.warning;t.set_Title(Strings.get_VoicemailConfigurationTitle());t.Message=Strings.get_VoicemailConfigurationConfirmationMessage();t.Details=this.get_isConfigured()?Strings.get_VoicemailConfigurationDetails():null;var i=this;MessageBox.show(t,2,function(n,t){n===ModalDialogResult.yes&&window.close()},null)},$E_6:function(n,t){var i=this.getContentElementByServerId(t);n.value=i.value},$K_6:function(){var n="";var t=this.getContentElementByServerId("OperatorList");if(t.selectedIndex>0){var i=this.$S_6(t.value);var r=i.UnifiedMessagingInfo.EnableTemplate;if(r){var u=String.format(r,this.get_$P_6());this.setInnerText("lblCallForwardingSequence",u);this.showElementById("ForwardSequenceAvailableDiv",!0);this.showElementById("ForwardSequenceNotAvailableDiv",!1)}else{var f=String.format(Strings.get_VoicemailCallFwdContactOperator(),i.Name,this.get_$P_6());this.setInnerHtml("lblCallForwardingContactOperator",f);this.showElementById("ForwardSequenceAvailableDiv",!1);this.showElementById("ForwardSequenceNotAvailableDiv",!0)}}var e=this.getContentElementByServerId("txtPhoneNumber");n=String.format(Strings.get_VoicemailPostFwdRecordGreeting(),e.value);this.setInnerHtml("lblCallYourself",n)}};function VoicemailCallForwardingStep(n){VoicemailCallForwardingStep.initializeBase(this,[n])}VoicemailCallForwardingStep.prototype={getNextStep:function(n){var t=this.get_PropertyPage().get_Bindings();var i=t.getControlIdGivenPropertyName("VerifyGlobalRoutingEntry");var r=$get(i);r.checked=!0;WebServiceWizardStep.prototype.getNextStep.call(this,n)}};function VoicemailGreetingRecordingStep(n){this.$$d_$U_7=Function.createDelegate(this,this.$U_7);VoicemailGreetingRecordingStep.initializeBase(this,[n])}VoicemailGreetingRecordingStep.prototype={$A_7:!1,get_$6_7:function(){return this.get_PropertyPage()},dispose:function(){this.$W_7();WebServiceWizardStep.prototype.dispose.call(this)},show:function(){WizardStepBase.prototype.show.call(this);this.$U_7(null);$addHandler(this.get_$6_7().get_TestDoneCheckBox(),"click",this.$$d_$U_7);this.$A_7=!0},hide:function(){this.$W_7();WizardStepBase.prototype.hide.call(this)},$U_7:function(n){var t=this.get_$6_7().get_TestDoneCheckBox().checked;this.get_$6_7().showClickFinishLabel();this.get_Form().get_CommitButton().disabled=!t;this.get_$6_7().get_TestDoneCheckBox().disabled=t},$W_7:function(){this.$A_7&&$removeHandler(this.get_$6_7().get_TestDoneCheckBox(),"click",this.$$d_$U_7)}};function VoiceMailOptionsViewModel(){VoiceMailOptionsViewModel.initializeBase(this);this.$5_4=new PlayOnPhoneViewModel(this)}VoiceMailOptionsViewModel.prototype={$5_4:null,initialize:function(){PropertyPageViewModel.prototype.initialize.call(this);var t=EcpUrl.getUrlParameter(window.location.href,"PlayOnPhoneVisible");var i=EcpUrl.getUrlParameter(window.location.href,"CallAnsweringRuleId");i&&this.$5_4.set_CallAnsweringRuleId(i);t&&Boolean.parse(t)&&this.$5_4.set_IsVisible(!0);var r=this;var u=new BoundCommand(function(){var n=new RulesFolderPicker;n.showDialog(_String.empty,r.getValue("FolderToReadEmailsFrom"),function(n,t){if(t){n.__type="Identity:ECP";r.setValue("FolderToReadEmailsFrom",n)}})});this.get_Commands().setProperty("PickFolderCommand",u);var n=new WebServiceCommand;n.set_RefreshAction(2);n.set_parameterNames(0);var f=this;n.init(this.get_ServiceUrl(),"ResetPIN",function(){return[]});var e=this;n.set_confirm(function(n,t){var i=new Info;i.MessageType=MessageBoxType.warning;i.set_Title(Strings.get_ResetPinMessageTitle());i.Message=Strings.get_ResetPinMessage();MessageBox.show(i,2,function(i,r){i===ModalDialogResult.yes?n():t()},null)});var o=this;n.add_completed(function(t,i){var r=n.get_LastResults();r&&r.ErrorRecords&&r.ErrorRecords.length>0&&ErrorHandling.showPowerShellErrors(r)});this.$5_4.set_PhoneNumberToDial(this.getValue("DefaultPlayOnPhoneNumber"));this.get_Commands().setProperty("CallResetPin",n)},get_HasAccessTelephoneNumbers:function(){return!EcpUtil.isNullOrEmpty(this.getValue("AccessTelephoneNumbers"))},get_IsTextMessagingEnabled:function(){return!this.getValue("IsPersonToPersonTextMessagingEnabled")&&this.getValue("IsMachineToPersonTextMessagingEnabled")},get_IsTextMessagingConfigured:function(){return this.get_IsTextMessagingEnabled()&&!EcpUtil.isNullOrEmpty(this.getValue("NotificationPhoneNumber"))&&this.getValue("NotificationPhoneNumberVerified")},get_TextMessagingNotificationSetupText:function(){return this.get_IsTextMessagingConfigured()?Strings.get_TextMessagingNotificationSetupText():Strings.get_TextMessagingNotificationNotSetupText()},get_TextMessagingNotificationSetupLinkText:function(){return this.get_IsTextMessagingConfigured()?Strings.get_TextMessagingNotificationSetupLinkText():Strings.get_TextMessagingNotificationNotSetupLinkText()},get_PlayOnPhone:function(){return this.$5_4}};function VoicemailPhoneRegistrationStep(n){this.$$d_$G_8=Function.createDelegate(this,this.$G_8);VoicemailPhoneRegistrationStep.initializeBase(this,[n])}VoicemailPhoneRegistrationStep.prototype={$0_8:null,$N_8:!0,internalWebServiceMethodSucceeded:function(n,t){VoicemailPhoneRegistrationStepBase.prototype.internalWebServiceMethodSucceeded.call(this,n,t);this.get_hasResults()&&(this.$N_8=!1)},getNextStep:function(n){this.$N_8?WebServiceWizardStep.prototype.getNextStep.call(this,n):n(this.get_NextStepID())},addEventHandlers:function(){this.$0_8=this.$$d_$G_8;this.get_properties().add_propertyChanged(this.$0_8)},removeEventHandlers:function(){if(this.$0_8){this.get_properties().remove_propertyChanged(this.$0_8);this.$0_8=null}},$G_8:function(n,t){if(t.get_propertyName()==="PhoneNumber"||t.get_propertyName()==="PhoneProviderId"){this.$N_8=!0;var i=this.get_properties().get_Bindings().getBinding(t.get_propertyName());var r=i.get_value();i.set_value("");i.resetIsDirty();i.set_value(r)}}};function VoicemailPhoneRegistrationStepBase(n){VoicemailPhoneRegistrationStepBase.initializeBase(this,[n])}VoicemailPhoneRegistrationStepBase.prototype={get_properties:function(){return this.get_PropertyPage()},get_hasResults:function(){return!!this.results&&!!this.results.Output&&this.results.Output.length>0},dispose:function(){this.removeEventHandlers();WebServiceWizardStep.prototype.dispose.call(this)},internalWebServiceMethodSucceeded:function(n,t){WebServiceWizardStep.prototype.internalWebServiceMethodSucceeded.call(this,n,t);this.clearVerificationCodeField();if(this.get_hasResults()){var i="VerificationCodeRequired";this.get_properties().get_Results().Output[0][i]=this.results.Output[0][i];this.get_properties().updateVerificationCodeElements()}},show:function(){WizardStepBase.prototype.show.call(this);this.addEventHandlers()},hide:function(){WizardStepBase.prototype.hide.call(this);this.clearVerificationCodeField();this.removeEventHandlers()},clearVerificationCodeField:function(){var n=this.get_properties().get_Bindings().getBinding("VerificationCode");n.set_value("");n.resetIsDirty()}};function VoicemailPhoneVerificationStep(n){this.$$d_$m_8=Function.createDelegate(this,this.$m_8);this.$$d_$r_8=Function.createDelegate(this,this.$r_8);VoicemailPhoneVerificationStep.initializeBase(this,[n])}VoicemailPhoneVerificationStep.prototype={$A_8:!1,$m_8:function(n){this.clearVerificationCodeField();this.getNextStep(this.$$d_$r_8)},$r_8:function(n){if(this.results&&(!this.results.ErrorRecords||!this.results.ErrorRecords.length)){var t=this.get_properties().get_Bindings().getBinding("PhoneNumber");MessageBox.showMessage(Strings.SendPasscodeSucceededFormat(t.get_value().toString()),MessageBoxType.information)}},addEventHandlers:function(){$addHandler(this.get_properties().get_SendPasscodeLink(),"click",this.$$d_$m_8);this.$A_8=!0},removeEventHandlers:function(){this.$A_8&&$removeHandler(this.get_properties().get_SendPasscodeLink(),"click",this.$$d_$m_8)}};function VoicemailProperties(n){this.$$d_$G_6=Function.createDelegate(this,this.$G_6);this.$$d_$e_6=Function.createDelegate(this,this.$e_6);this.$$d_$g_6=Function.createDelegate(this,this.$g_6);this.$$d_$f_6=Function.createDelegate(this,this.$f_6);this.$$d_$a_6=Function.createDelegate(this,this.$a_6);VoicemailProperties.initializeBase(this,[n]);this.$8_6=this.$$d_$a_6}VoicemailProperties.prototype={$0_6:null,$4_6:null,$8_6:null,$B_6:"",get_LCID:function(){return this.$B_6},set_LCID:function(n){this.$B_6=n;return n},get_ClearSettingsWebServiceMethod:function(){return this.$4_6},set_ClearSettingsWebServiceMethod:function(n){this.$4_6&&this.$4_6.remove_Completed(this.$8_6);this.$4_6=n;this.$4_6&&this.$4_6.add_Completed(this.$8_6);return n},get_$v_6:function(){return this.get_output().VoiceMailAccessNumbers},get_$Z_6:function(){return this.get_output().CallForwardingDisableDigits},initialize:function(){PropertyPage.prototype.initialize.call(this);this.$J_6();$addHandler(this.getContentElementByServerId("btnConfigureVoicemail"),"click",this.$$d_$f_6);$addHandler(this.getContentElementByServerId("MediaPlayerImage"),"click",this.$$d_$g_6);$addHandler(this.getContentElementByServerId("btnClearVoicemail"),"click",this.$$d_$e_6);this.$0_6=this.$$d_$G_6;this.add_propertyChanged(this.$0_6);this.$4_6.set_Parameters([this.get_identityBinding()])},dispose:function(){$removeHandler(this.getContentElementByServerId("btnConfigureVoicemail"),"click",this.$$d_$f_6);$removeHandler(this.getContentElementByServerId("btnClearVoicemail"),"click",this.$$d_$e_6);if(this.$0_6){this.remove_propertyChanged(this.$0_6);this.$0_6=null}this.set_ClearSettingsWebServiceMethod(null);this.$8_6=null;VoicemailPropertiesBase.prototype.dispose.call(this)},$f_6:function(n){var t=BuildCenteredWindowFeatureString(380,600,"location=no,menubar=no,status=no,toolbar=no,resizable=yes,scrollbars=no");PopupWindowManager.showPropertiesDialog("VoicemailConfiguration.aspx",this,t,null)},$g_6:function(n){this.showElementById("MediaPlayerImage",!1);this.$s_6()},$b_6:function(){var n=this.getContentElementByServerId("MediaPlayerDiv");n.innerHTML=""},$s_6:function(){var r="http://go.microsoft.com/fwlink/?LinkId=130650&clcid={0}";var u="width='350px' height='326px'";var n="<OBJECT id='mediaPlayer' {0} classid='CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6'>    codebase='http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,7,1112'>    <param name='autostart' value='true'>    <param name='url' value='{1}'> </OBJECT> ";var f="<OBJECT id='mediaPlayer' {0} type='application/x-ms-wmp'>   <param name='autostart' value='true'>   <param name='src' value='{1}'> </OBJECT> ";var t="<OBJECT id='mediaPlayer' classid='CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95'>  <EMBED type='application/x-mplayer2' {0}      pluginspage='http://go.microsoft.com/fwlink/?LinkId=6058&clcid={2}'       src='{1}' autostart='1'>   </EMBED> </OBJECT>";var i=null;i=EcpUtil.isIE()?n:EcpUtil.isFirefox()?EcpUtil.isBrowserOnMAC()?t:f:EcpUtil.isSafari()?t:n;var e=this.getContentElementByServerId("MediaPlayerDiv");var o=String.format(r,this.$B_6);e.innerHTML=String.format(i,u,o,this.$B_6)},$e_6:function(n){var i=this.get_$Z_6();var t=new Info;t.set_Title(Strings.get_VoicemailClearSettingsTitle());t.Message=Strings.get_VoicemailClearSettingsConfirmationMessage();t.MessageType=MessageBoxType.warning;t.Details=i?Strings.VoicemailClearSettingsDetails(i):Strings.get_VoicemailClearSettingsDetailsContactOperator();var r=this;MessageBox.show(t,2,function(n,t){if(n===ModalDialogResult.yes){UpdateProgressPopUp.showProgress(r.get_progressDescription());r.$4_6.invoke(null)}},null)},$G_6:function(n,t){t.get_propertyName()==="Results"&&this.$V_6()},$V_6:function(){this.reloadPage("Voicemail",!1)},$J_6:function(){if(!this.get_hasOutput()){this.$R_6();this.showElementById("VoicemailNotAvailableDiv",!0);return}if(!EcpUtil.isIE()&&!this.get_isConsumerSubscriber()){this.$R_6();this.showElementById("BrowserNotSupportedDiv",!EcpUtil.isIE());return}EcpUtil.showElement(this.get_slabFrame(),this.get_isConsumerSubscriber());var n=String.format(Strings.get_VoicemailSummaryAccessNumber(),RtlUtil.convertNumberToBidi(this.get_$v_6()));this.setInnerHtml("lblVoicemailSummaryAccessNumber",n);var t=this.get_isConfigured()?Strings.get_EditVoicemailButtonText():Strings.get_ConfigureVoicemailButtonText();this.setInnerText("btnConfigureVoicemail",t);this.showElementById("btnClearVoicemail",this.get_isConfigured()&&this.get_isConsumerSubscriber());this.showElementById("btnConfigureVoicemail",this.get_isConsumerSubscriber());this.showElementById("VoicemailConfiguredDiv",this.get_isConfigured());this.showElementById("VoicemailNotAvailableDiv",!1);this.showElementById("BrowserNotSupportedDiv",!1);this.showElementById("VoicemailNotConfiguredDiv",!this.get_isConfigured());this.showElementById("lblMobileOperator",this.get_isConsumerSubscriber());this.showElementById("txtMobileOperator",this.get_isConsumerSubscriber());this.showElementById("MediaPlayerContainerDiv",!this.get_isConfigured());this.showElementById("MediaPlayerImage",!this.get_isConfigured());this.get_isConfigured()&&this.$b_6()},$R_6:function(){this.showElementById("btnClearVoicemail",!1);this.showElementById("btnConfigureVoicemail",!1);this.showElementById("VoicemailConfiguredDiv",!1);this.showElementById("BrowserNotSupportedDiv",!1);this.showElementById("VoicemailNotAvailableDiv",!1);this.showElementById("VoicemailNotConfiguredDiv",!1);this.showElementById("MediaPlayerContainerDiv",!1)},$a_6:function(n,t){UpdateProgressPopUp.progressCompleted();this.$V_6()}};function VoicemailPropertiesBase(n){this.voiceMailPageUrl=EcpUrl.get_ecpFullUrl()+"?p=Customize/Voicemail.aspx";this.owaVoiceMailOptionsUrl=EcpUrl.get_owaVDir()+"?ae=Options&opturl=VoiceMail";VoicemailPropertiesBase.initializeBase(this,[n])}VoicemailPropertiesBase.prototype={$7_5:null,get_output:function(){return this.get_Results().Output[0]},get_slabFrame:function(){return this.findParentWithClass(this.$7_5,"slbFrm")},get_isConfigured:function(){return this.get_output().IsConfigured},get_isConsumerSubscriber:function(){return this.get_output().SubscriberType==="Consumer"},get_progressDescription:function(){return Strings.get_PleaseWait()},get_CaptionLabel:function(){return this.$7_5},set_CaptionLabel:function(n){this.$7_5=n;return n},dispose:function(){this.$7_5=null;PropertyPage.prototype.dispose.call(this)},findParentWithClass:function(n,t){for(var i=null,i=n.parentNode;i;i=i.parentNode)if(Sys.UI.DomElement.containsCssClass(i,t))return i;return null},showElementById:function(n,t){var i=this.getContentElementByServerId(n);EcpUtil.showElement(i,t)},addOption:function(n,t,i){var r=document.createElement("option");r.text=t;r.value=i;EcpUtil.appendOption(n,r)},selectValue:function(n,t){n.selectedIndex=0;for(var i=0;i<n.options.length;i++){var r=n.options[i];if(r.value===t){n.selectedIndex=i;break}}},setInnerHtml:function(n,t){var i=this.getContentElementByServerId(n);i.innerHTML=t},setInnerText:function(n,t){var i=this.getContentElementByServerId(n);EcpUtil.setInnerText(i,t)}};function VoicemailSetPINStep(n){VoicemailSetPINStep.initializeBase(this,[n])}VoicemailSetPINStep.prototype={internalWebServiceMethodSucceeded:function(n,t){WebServiceWizardStep.prototype.internalWebServiceMethodSucceeded.call(this,n,t);this.results&&this.results.Output&&this.results.Output.length>0&&this.get_PropertyPage().set_Results(this.results)}};function VoicemailSettingsProperties(n){this.$$d_$G_6=Function.createDelegate(this,this.$G_6);this.$$d_$n_6=Function.createDelegate(this,this.$n_6);this.$$d_$h_6=Function.createDelegate(this,this.$h_6);this.$$d_$q_6=Function.createDelegate(this,this.$q_6);this.$$d_$p_6=Function.createDelegate(this,this.$p_6);VoicemailSettingsProperties.initializeBase(this,[n]);this.$D_6=this.$$d_$p_6;this.$I_6=this.$$d_$q_6}VoicemailSettingsProperties.prototype={$0_6:null,$2_6:null,$D_6:null,$I_6:null,get_ResetPINWebServiceMethod:function(){return this.$2_6},set_ResetPINWebServiceMethod:function(n){if(this.$2_6){this.$2_6.remove_Succeeded(this.$I_6);this.$2_6.remove_Completed(this.$D_6)}this.$2_6=n;if(this.$2_6){this.$2_6.add_Succeeded(this.$I_6);this.$2_6.add_Completed(this.$D_6)}return n},get_$O_6:function(){return this.get_output().AvailableSMSOptionNames},get_$Y_6:function(){return this.get_output().AvailableSMSOptionValues},get_$u_6:function(){return this.get_output().SMSNotificationOption},get_$t_6:function(){return this.get_output().SMSNotificationConfigured},initialize:function(){PropertyPage.prototype.initialize.call(this);this.$J_6();this.$2_6.set_Parameters([this.get_identityBinding()]);$addHandler(this.getContentElementByServerId("btnResetPIN"),"click",this.$$d_$h_6);$addHandler(this.getContentElementByServerId("lnkSetupNotifications"),"click",this.$$d_$n_6);this.$0_6=this.$$d_$G_6;this.add_propertyChanged(this.$0_6)},dispose:function(){$removeHandler(this.getContentElementByServerId("btnResetPIN"),"click",this.$$d_$h_6);$removeHandler(this.getContentElementByServerId("lnkSetupNotifications"),"click",this.$$d_$n_6);if(this.$0_6){this.remove_propertyChanged(this.$0_6);this.$0_6=null}this.set_ResetPINWebServiceMethod(null);this.$D_6=null;VoicemailPropertiesBase.prototype.dispose.call(this)},$G_6:function(n,t){t.get_propertyName()==="Results"&&this.$J_6()},$J_6:function(){var i=this.get_hasOutput()&&this.get_isConfigured()&&this.get_isConsumerSubscriber();EcpUtil.showElement(this.get_slabFrame(),i);var r=this.$c_6();r&&EcpUtil.showElement(r,i);var n=this.getContentElementByServerId("SMSOptionList");n.innerHTML="";if(this.get_hasOutput()){for(var t=0;t<this.get_$O_6().length;t++)this.addOption(n,this.get_$O_6()[t],this.get_$Y_6()[t]);this.selectValue(n,this.get_$u_6())}n.disabled=!(this.get_hasOutput()&&this.get_$t_6());this.showElementById("lnkSetupNotifications",n.disabled)},$c_6:function(){for(var t=document.getElementsByTagName("DIV"),n=0;n<t.length;n++){var i=t[n];if(Sys.UI.DomElement.containsCssClass(i,"btnPane"))return i}return null},$h_6:function(n){var t=new Info;t.MessageType=MessageBoxType.warning;t.set_Title(Strings.get_VoicemailResetPINTitle());t.Message=Strings.get_VoicemailResetPINConfirmationMessage();var i=this;MessageBox.show(t,2,function(n,t){if(n===ModalDialogResult.yes){UpdateProgressPopUp.showProgress(i.get_progressDescription());i.$2_6.invoke(null)}},null)},$n_6:function(n){var t=BuildCenteredWindowFeatureString(380,600,VoicemailSettingsProperties.$Q);PopupWindowManager.showPropertiesDialog("../SMS/EditNotification.aspx",this,t,null)},$q_6:function(n,t){var i=new Info;i.MessageType=MessageBoxType.information;i.set_Title(Strings.get_VoicemailResetPINTitle());i.Message=Strings.get_VoicemailResetPINSuccessMessage();MessageBox.show(i,4,null,null)},$p_6:function(n,t){UpdateProgressPopUp.progressCompleted()}};PlayOnPhoneViewModel.registerClass("PlayOnPhoneViewModel",ViewModelBase);VoicemailPropertiesBase.registerClass("VoicemailPropertiesBase",PropertyPage);VoicemailConfigurationProperties.registerClass("VoicemailConfigurationProperties",VoicemailPropertiesBase);VoicemailCallForwardingStep.registerClass("VoicemailCallForwardingStep",WebServiceWizardStep);VoicemailGreetingRecordingStep.registerClass("VoicemailGreetingRecordingStep",WebServiceWizardStep);VoiceMailOptionsViewModel.registerClass("VoiceMailOptionsViewModel",PropertyPageViewModel);VoicemailPhoneRegistrationStepBase.registerClass("VoicemailPhoneRegistrationStepBase",WebServiceWizardStep);VoicemailPhoneRegistrationStep.registerClass("VoicemailPhoneRegistrationStep",VoicemailPhoneRegistrationStepBase);VoicemailPhoneVerificationStep.registerClass("VoicemailPhoneVerificationStep",VoicemailPhoneRegistrationStepBase);VoicemailProperties.registerClass("VoicemailProperties",VoicemailPropertiesBase);VoicemailSetPINStep.registerClass("VoicemailSetPINStep",WebServiceWizardStep);VoicemailSettingsProperties.registerClass("VoicemailSettingsProperties",VoicemailPropertiesBase);VoicemailConfigurationProperties.phoneNumberProperty="PhoneNumber";VoicemailConfigurationProperties.phoneProviderProperty="PhoneProviderId";VoicemailConfigurationProperties.verificationCodeProperty="VerificationCode";VoicemailConfigurationProperties.verificationCodeRequiredProperty="VerificationCodeRequired";VoicemailPropertiesBase.slabFrameClass="slbFrm";VoicemailPropertiesBase.clickEventName="click";VoicemailPropertiesBase.changeEventName="change";VoicemailPropertiesBase.unloadEventName="unload";VoicemailPropertiesBase.loadEventName="load";VoicemailPropertiesBase.consumerSubscriberType="Consumer";VoicemailPropertiesBase.resultsPropertyName="Results";VoicemailSettingsProperties.$Q=GlobalVariables.FeaturesForPopups