var g_fModuleLoaded={};var __DEBUG_BUILD=!0;Type=Function;g_fModuleLoaded[".\\core/type.js".toLowerCase()]||function(){Type.Const={};Type.Const.Boolean="boolean";Type.Const.Function=typeof new Function;Type.Const.Number="number";Type.Const.Object="object";Type.Const.String="string";Type.Const.Undefined=typeof undefined;var n=function(n){this.__sTypeName=n};n.prototype={__fNamespace:!0,getName:function(){return this.__sTypeName}};Type.__sTypeName="Type";Type.prototype.createClass=function(n,t,i){this.prototype.constructor=this;this.__sTypeName=n;this.__fClass=!0;this.__oBaseType=t||Object;t&&(this.__fBasePrototypePending=!0);if(i){this.__rgInterfaces=[];for(var r=2;r<arguments.length;r++){i=arguments[r];this.__rgInterfaces[this.__rgInterfaces.length]=i}}};Type.prototype.createInterface=function(n){this.__sTypeName=n;this.__fInterface=!0};Type.prototype.constructBase=function(n,t){this.__fBasePrototypePending&&this._setupBase();t?this.__oBaseType.apply(n,t):this.__oBaseType.apply(n)};Type.prototype.callBase=function(n,t,i){var r=this.__oBaseType.prototype[t];return i?r.apply(n,i):r.apply(n)};Type.prototype.isInstance=function(n){if(n===null||n===undefined||!n.hasOwnProperty)return!1;if(this==Object||n instanceof this)return!0;var t=Type.getInstanceType(n);return this._isAssignableFrom(t)};Type.prototype._setupBase=function(){if(this.__fBasePrototypePending){var n=this.__oBaseType;n.__fBasePrototypePending&&n._setupBase();for(var t in n.prototype){var i=n.prototype[t];typeof this.prototype[t]==Type.Const.Undefined&&(this.prototype[t]=i)}delete this.__fBasePrototypePending}};Type.prototype._isAssignableFrom=function(n){if(this==Object||this==n||this.__sTypeName&&this.__sTypeName==n.__sTypeName)return!0;if(this.__fClass)for(var t=n.__oBaseType;t;){if(this==t||this.__sTypeName&&this.__sTypeName==t.__sTypeName)return!0;t=t.__oBaseType}else if(this.__fInterface){for(var r=n.__rgInterfaces,i=0,i=0;r&&i<r.length;++i)if(this.__sTypeName&&r[i].__sTypeName==this.__sTypeName||r[i]==this)return!0;for(var t=n.__oBaseType;t;){r=t.__rgInterfaces;for(i=0;r&&i<r.length;++i)if(this.__sTypeName&&r[i].__sTypeName==this.__sTypeName||r[i]==this)return!0;t=t.__oBaseType}}return!1};Type.createNamespace=function(t){window.__namespaces||(window.__namespaces={});window.__rootNamespaces||(window.__rootNamespaces=[]);if(!window.__namespaces[t]){for(var r=window,f=t.split("."),i=0;i<f.length;i++){var e=f[i];var u=r[e];if(!u){r[e]=u=new n(f.slice(0,i+1).join("."));i==0&&(window.__rootNamespaces[window.__rootNamespaces.length]=u)}r=u}window.__namespaces[t]=r}};Type.getInstanceType=function(n){var t=null;try{t=n.constructor}catch(i){}t&&t.__sTypeName||(t=Object);return t};Object.__sTypeName="Object";Object.__oBaseType=null;Array.__sTypeName="Array";Array.__oBaseType=null;Array.__fClass=!0;Boolean.__sTypeName="Boolean";Boolean.__oBaseType=null;Boolean.__fClass=!0;String.__sTypeName="String";String.__oBaseType=null;String.__fClass=!0;Number.__sTypeName="Number";Number.__oBaseType=null;Number.__fClass=!0}();g_fModuleLoaded[".\\core/type.js".toLowerCase()]=1;var urlEnc,urlDec,htmlEnc,htmlDec,jsEnc,toUTF8;(function(){Type.createNamespace("OwaEditor.Encoder");htmlEnc=OwaEditor.Encoder.htmlEnc=function(n){var t=document.createElement("DIV");t.innerText=t.textContent=n;var i=t.innerHTML;i=i.replace(new RegExp('"',"g"),"&quot;");return i};htmlDec=OwaEditor.Encoder.htmlDec=function(n){var t=OwaEditor.Dom.Document.get_Current().createElement("DIV");t.set_InnerHtml(n);return t.get_TextContent()};jsEnc=OwaEditor.Encoder.jsEnc=function(n){if(isDf(typeof n)&&n){for(var t=[],i,r=0;r<n.length;r++){i=n.charAt(r);switch(i){case'"':case"'":case"\\":case"/":t.push("\\");t.push(i);break;case"\r":t.push("\\");t.push("r");break;case"\n":t.push("\\");t.push("n");break;default:t.push(i);break}}return t.join("")}};toUTF8=OwaEditor.Encoder.toUTF8=function(t){if(t==null)return"";typeof t=="number"&&(t=""+t);for(var i=new OwaEditor.Text.StringBuilder,u=0,f=0;f<t.length;f++){var r=t.charCodeAt(f);if(!n(r)){u!=f&&i.append(t.substring(u,f));u=f+1;if(r&65408)if(r&63488){i.append("%");i.append((r>>12|224).toString(16));i.append("%");i.append((r>>6&63|128).toString(16));i.append("%");i.append((r&63|128).toString(16))}else{i.append("%");i.append((r>>6|192).toString(16));i.append("%");i.append((r&63|128).toString(16))}else{i.append("%");i.append(r.toString(16))}}}u!=0&&u!=t.length&&i.append(t.substring(u,t.length));return u==0?t:i.toString()};function n(n){return n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||n==33||n>=39&&n<=42||n==45||n==46||n==95||n==126}OwaEditor.Encoder.fromBase64String=function(n){var t=new Array(4);var r,o,i;var f=n.length;var u=0;if(f<=0||f%4!=0||u<0||u>f)return null;var h=f/4*3;if(n.charAt(u+f-1)=="="){h--;n.charAt(u+f-2)=="="&&h--}var s=new Array(h);o=0;for(;f>0;f-=4){for(r=0;r<4;r++,u++){i=n.charAt(u);if(i>="A"&&i<="Z"){var e="A";t[r]=0+(n.charCodeAt(u)-e.charCodeAt(0))}else if(i>="a"&&i<="z"){var e="a";t[r]=26+(n.charCodeAt(u)-e.charCodeAt(0))}else if(i>="0"&&i<="9"){var e="0";t[r]=52+(n.charCodeAt(u)-e.charCodeAt(0))}else if(i=="+"||i=="-")t[r]=62;else if(i=="/"||i=="_")t[r]=63;else if(i=="="&&r>=2)t[r]=64;else return null}s[o++]=t[0]<<2|t[1]>>4;if(t[2]!=64){s[o++]=(t[1]&15)<<4|t[2]>>2;t[3]!=64&&(s[o++]=(t[2]&3)<<6|t[3])}}return s};OwaEditor.Encoder.toBase64String=function(n,t){var e,r,u;var h,c,s,o;var f;var l="";var a=typeof n.charCodeAt=="undefined";f=isDf(typeof t)&&t?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(var i=0;i<n.length;){if(a){e=n[i];r=n[i+1];u=n[i+2]}else{e=n.charCodeAt(i);r=n.charCodeAt(i+1);u=n.charCodeAt(i+2)}h=e>>2;c=(e&3)<<4|r>>4;s=(r&15)<<2|u>>6;o=u&63;isNaN(r)?s=o=64:isNaN(u)&&(o=64);l+=f.charAt(h)+f.charAt(c)+f.charAt(s)+f.charAt(o);i+=3}return l}})();g_fModuleLoaded[".\\core/strings.js".toLowerCase()]||function(){(function(){Type.createNamespace("OwaEditor.Strings.Ids");var n=OwaEditor.Strings.Ids;n.HelpButtonId="lnkHelp";n.OptionsButtonId="lnkOptions";n.NewMailNotificationButtonId="lnkNwMl";n.NewVoiceMailNotificationButtonId="lnkNwVMl";n.NewFaxNotificationButtonId="lnkNwFx";n.BuddyRequestNotificationButtonId="lnkBr";n.ActiveChatsNotificationButtonId="lnkAc";n.NewChatNotificationButtonId="lnkNwCht";n.ReminderNotificationButtonId="lnkRm";n.ErrorNotificationButtonId="lnkNE";n.ComboDropDownList="divCmbList";n.DatePickerDropDown="divDP";n.ComboTextDisplaySpan="spanCmbSel";n.TimeTextBox="txtTime";n.InputTextBox="txtInput";n.Accept="accept";n.Decline="decline";n.Tentative="tentative";n.ShowCalendar="showcalendar";n.SendResponse="sndrsp";n.NoResponse="norsp";n.EditResponse="edrsp";n.Remove="remove";n.AddThisCalendar="addThisCalendar";n.ShareMyCalendar="shareMyCalendar";n.ViewThisCalendar="viewcal";n.FromSpan="spnFrom";n.RecipientSpan="spnR";n.AttachmentLink="lnkAtmt";n.BranchText="spnBrSn";n.ReplyIcon="imgReplyIcon";n.ReplyAllIcon="imgReplyAllIcon";n.ForwardIcon="imgForwardIcon";n.PostReplyIcon="imgPostReplyIcon";n.NotJunkText="spnNotJunk";n.ItemPartExpansionHeader="divExpHdr";n.ItemPartActionsButton="divActions";n.ItemPartExpansion="divExp";n.ItemPartDraftSpan="spnDraft";n.ItemPartItemNotSentSpan="spnItemNotSent"})();(function(){Type.createNamespace("OwaEditor.Strings.Attributes");var n=OwaEditor.Strings.Attributes;n.Id="id";n.Type="name";n.IsSticky="_stky";n.IsToolbarButton="_tbb";n.IsMenuItem="_mnuItm";n.IsNotificationButton="_ntf";n.IsOptionsSaveButton="_opt";n.HasBigButtonWrapper="_fBig";n.IsDisabled="fDsbl";n.SubMenuId="_sbMnu";n.ButtonPushed="_pushed";n.ButtonAlwaysPushed="_alwaysPushed";n.ToggleSiblingIds="_tgl";n.SwapSiblingIds="_swp";n.ComboMenuId="_twsy";n.Radio="_radio";n.ComboDropDownId="_ovr";n.AllowContextMenu="_fAllwCM";n.Value="oV";n.TimeValue="sTm";n.EndTimeValue="sEndTm";n.ShortTimeFormatString="sStf"})();(function(){Type.createNamespace("OwaEditor.Strings.Controls");var n=OwaEditor.Strings.Controls;n.Button="lnkB";n.Menu="mnu";n.Toolbar="tlb"})();(function(){Type.createNamespace("OwaEditor.Strings.Names");var n=OwaEditor.Strings.Names;n.LinkButton="lnkB";n.LinkNotificationButton="lnkNB"})();(function(){Type.createNamespace("OwaEditor.Strings.CssClass");var n=OwaEditor.Strings.CssClass;n.ButtonDisabled="btnDa";n.ButtonDown="btnDn";n.ButtonDefault="btnDf";n.ToolbarButtonDisabled="tbfD";n.ToolbarButtonDown="tbfP";n.ToolbarButtonHoverable="tbfHvr";n.ToolbarButtonShareHoverable="tbfShareHvr";n.MenuButtonDisabled="miDa";n.MenuButtonDown="miDn";n.MenuButtonDefault="miDf";n.NotificationButtonPushed="alertBtnPushed";n.NotificationButtonDown="alertBtnDn";n.NotificationButtonDefault="alertBtnDf";n.OptionsSaveButtonDisabled="optDa";n.OptionsSaveButtonDown="optDn";n.OptionsSaveButtonHoverable="optHvr";n.ComboDropDownSelectedItem="cmbSel";n.ComboBoxDisable="cmbDsbl";n.RightPipe="rightPipe";n.LeftPipe="leftPipe";n.RightStopSmall="rightStopS";n.LeftStopSmall="leftStopS";n.RightChildStopSmall="rightChildStopS";n.LeftChildStopSmall="leftChildStopS";n.AncestorPipe="ppAnc";n.AncestorStopSmall="psAncS";n.PipeBackground="pipeBkg"})();(function(){Type.createNamespace("OwaEditor.Strings.ObjectClass");var n=OwaEditor.Strings.ObjectClass;n.MeetingRequest="IPM.Schedule.Meeting.Request";n.MeetingCancellation="IPM.Schedule.Meeting.Canceled";n.SharingMessage="IPM.Sharing";n.MeetingResponsePrefix="IPM.Schedule.Meeting.Resp"})();(function(){Type.createNamespace("OwaEditor.Strings.Icons");var n=OwaEditor.Strings.Icons;n.Collapsed="plus.png";n.Expanded="minus.png";n.CollapsedRtl="plusrtl.png";n.ExpandedRtl="minusrtl.png";n.ReplyActive="replyActive.png";n.ReplyGhost="replyGhost.png";n.ReplyDisabled="replyDisabled.png";n.ReplyGhostDisabled="replyGhostDisabled.png";n.ReplyAllActive="replyAllActive.png";n.ReplyAllGhost="replyAllGhost.png";n.ReplyAllDisabled="replyAllDisabled.png";n.ReplyAllGhostDisabled="replyAllGhostDisabled.png";n.ForwardActive="forwardActive.png";n.ForwardGhost="forwardGhost.png";n.ForwardDisabled="forwardDisabled.png";n.ForwardGhostDisabled="forwardGhostDisabled.png";n.PostReplyActive="postRpActive.png";n.PostReplyGhost="postRpGhost.png";n.PostReplyDisabled="postRpDisabled.png";n.PostReplyGhostDisabled="postRpGhostDisabled.png"})()}();g_fModuleLoaded[".\\core/strings.js".toLowerCase()]=1;var MAX_ALLOWED_URL_LENGTH=1744;g_fModuleLoaded[".\\core/browserconstants.js".toLowerCase()]||function(){(function(){Type.createNamespace("OwaEditor.KeyCodes");var n=OwaEditor.KeyCodes;n.BACK_SPACE=8;n.DELETE=46;n.DOWN=40;n.END=35;n.ENTER=13;n.ESC=27;n.F9=120;n.HOME=36;n.LEFT=37;n.PAGE_DOWN=34;n.PAGE_UP=33;n.RIGHT=39;n.SPACEBAR=32;n.TAB=9;n.UP=38;n.Y=89;n.Z=90})()}();g_fModuleLoaded[".\\core/browserconstants.js".toLowerCase()]=1;g_fModuleLoaded[".\\core/browserdetection.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.Utility");var r=null;var u=null;var f=null;var e=null;var o=null;var s=null;var h=null;var c=null;var l=null;var n=null;var t=null;var i=null;OwaEditor.Utility.isMac=function(){r==null&&(r=navigator.appVersion.indexOf("Mac")!=-1);return r};OwaEditor.Utility.isWin=function(){u==null&&(u=navigator.appVersion.indexOf("Win")!=-1||navigator.appVersion.indexOf("NT")!=-1);return u};OwaEditor.Utility.isIE=function(){f==null&&(f=navigator.userAgent.indexOf("MSIE ")!=-1||navigator.userAgent.indexOf("Trident")!=-1);return f};OwaEditor.Utility.isEdge=function(){s==null&&(s=navigator.userAgent.indexOf("Edge")!=-1);return s};OwaEditor.Utility.isIE7=function(){e==null&&(e=navigator.userAgent.indexOf("MSIE 7")!=-1);return e};OwaEditor.Utility.isIE8=function(){o==null&&(o=navigator.userAgent.indexOf("MSIE 8")!=-1);return o};OwaEditor.Utility.get_IEVersion=function(){if(!OwaEditor.Utility.isIE())throw new Error("Assert fail ["+".\\core/browserdetection.js"+":"+99+"]: "+"Can't get IE version on a browser other than IE");n==null&&(n=/MSIE[\/\s](\d+\.\d+)/.test(navigator.userAgent)?new Number(RegExp.$1):/rv:(\d+\.\d+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1);return n};OwaEditor.Utility.get_IEDocumentMode=function(){return document.documentMode||-1};OwaEditor.Utility.getParentOlUl=function(n){for(var t=n;t&&t.tagName!=UL_TAGNAME&&t.tagName!=OL_TAGNAME&&t.tagName!=BODY_TAGNAME;)t=t.parentNode;return t&&(t.tagName==UL_TAGNAME||t.tagName==OL_TAGNAME)?t:null};OwaEditor.Utility.isFirefox=function(){h==null&&(h=navigator.userAgent.indexOf("Firefox/")!=-1&&navigator.userAgent.indexOf("Gecko/")!=-1&&navigator.userAgent.indexOf("Trident")==-1);return h};OwaEditor.Utility.get_FirefoxVersion=function(){do if(!OwaEditor.Utility.isFirefox())throw new Error("Assert fail ["+".\\core/browserdetection.js"+":"+99+"]: "+"Can't get Firefox version on a browser other than Firefox");while(0);t==null&&(t=/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1);return t};OwaEditor.Utility.get_SafariVersion=function(){do if(!OwaEditor.Utility.isSafari())throw new Error("Assert fail ["+".\\core/browserdetection.js"+":"+121+"]: "+"Can't get Safari version on a browser other than Safari");while(0);i==null&&(i=/Version\/(\d+\.\d+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1);return i};OwaEditor.Utility.isSafari=function(){c==null&&(c=navigator.userAgent.indexOf("Safari")!=-1&&navigator.userAgent.indexOf("WebKit")!=-1&&navigator.userAgent.indexOf("Edge")==-1);return c};OwaEditor.Utility.isChrome=function(){l==null&&(l=navigator.userAgent.indexOf("Chrome")!=-1&&navigator.userAgent.indexOf("Edge")==-1);return l};OwaEditor.Utility.isActiveXControlSupported=function(){if(OwaEditor.Utility.isIE())try{var n=new ActiveXObject("MSXML2.DomDocument");return!0}catch(t){}return!1}}();g_fModuleLoaded[".\\core/browserdetection.js".toLowerCase()]=1;Type.createNamespace("OwaEditor.Collection.Set");g_fModuleLoaded[".\\core/set.js".toLowerCase()]||function(){OwaEditor.Collection.Set=function(){this._rgObject=[]};var n=OwaEditor.Collection.Set.prototype;n.add=function(n){if(!this.contains(n)){this._rgObject.push(n);return!0}return!1};n._indexOf=function(n){for(var i=this._rgObject.length,t=0;t<i;t++)if(n.equals){if(n.equals(this._rgObject[t]))return t}else if(n===this._rgObject[t])return t;return-1};n.contains=function(n){return this._indexOf(n)!==-1};n.clear=function(){this._rgObject=[]};n.toArray=function(){return this._rgObject.clone()};n.remove=function(n){var t=this._indexOf(n);if(t>=0){this._rgObject.removeAt(t);return!0}return!1}}();g_fModuleLoaded[".\\core/set.js".toLowerCase()]=1;g_fModuleLoaded[".\\core/redoundomanager.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.RedoUndoManager");var t=1e7;OwaEditor.RedoUndoManager=function(){this._rgBuffer=[];this._index=0;this._totalMemoryFootprint=0};var n=OwaEditor.RedoUndoManager.prototype;n.CanUndo=function(){return this._index>0};n.CanRedo=function(){return this._rgBuffer.length>this._index+1};n._shouldAddForRedo=function(){return this._rgBuffer.length==this._index};n.ClearRedoStack=function(){this._assertTotalSize();while(this._rgBuffer.length>this._index){var n=this._rgBuffer.pop();this._totalMemoryFootprint-=n.length}this._assertTotalSize()};n.SaveCurrentState=function(n){this.ClearRedoStack();this._saveToBuffer(n,!0)};n._assertTotalSize=function(){if(this._totalMemoryFootprint<0)throw new Error("Assertion failure. _totalMemoryFootprint should >= 0. ");};n._saveToBuffer=function(n,i){if(!(this._rgBuffer.length>0)||n!=this._rgBuffer[this._rgBuffer.length-1]){this._assertTotalSize();while(this._totalMemoryFootprint>t&&this.CanUndo()){var r=this._rgBuffer.shift();this._totalMemoryFootprint-=r.length;--this._index}this._assertTotalSize();this._rgBuffer.push(n);this._totalMemoryFootprint+=n.length;i&&++this._index}};n.Undo=function(n){if(!n)throw new Error("Assertion failure: sStateHtml is null. ");if(!this.CanUndo())throw new Error("Undo is called on a non-undoable state. ");this._shouldAddForRedo()&&this._saveToBuffer(n,!1);return this._rgBuffer[--this._index]};n.Redo=function(){if(!this.CanRedo())throw new Error("Redo is called on a non-redoable state. ");return this._rgBuffer[++this._index]};n.Dispose=function(){this._rgBuffer=null;this._index=0}}();g_fModuleLoaded[".\\core/redoundomanager.js".toLowerCase()]=1;var g_iLgn=1;var UP=38;var DOWN=40;var g_fRtl=window.document.documentElement.getAttribute("dir")=="rtl";var g_sDE=g_fRtl?"&#x200F;":"&#x200E;";var g_ocmS;var OWACURSORSTARTMARKID="MSOWACursorMarkStart";var OWACURSORENDMARKID="MSOWACursorMarkEnd";var T_CAL="IPF.Appointment";var T_CON="IPF.Contact";var T_DOC="IPF.DocumentLibrary";var T_MSG="IPF.Note";var T_TSK="IPF.Task";var T_NTS="IPF.StickyNote";var T_JNL="IPF.Journal";var g_iMinVWW=163;var g_iMinRPW=50;var g_iMinRPH=50;var BTN_BIU=1;var BTN_JUSTIFY=2;var BTN_LISTS=4;var BTN_INDENT=8;var BTN_DIR=16;var BTN_FORE_COLOR=32;var BTN_BACK_COLOR=64;var BTN_REMOVE_FORMAT=128;var BTN_INSERT_RULE=256;var BTN_UNDO_REDO=512;var BTN_LINKS=1024;var BTN_SUBSCRIPT_SUPERSCRIPT=2048;var BTN_STRIKE=4096;var BTN_CUSTOMIZE=8192;var STYLETAGS=['<style style="display: none;" id="owaParaStyle" type="text/css">','<STYLE TYPE="TEXT/CSS" ID="OWAPARASTYLE" STYLE="DISPLAY: NONE;">','<STYLE ID="OWAPARASTYLE" STYLE="DISPLAY: NONE;">','<style style="display: none;" id="owaParaStyle">','<STYLE STYLE="DISPLAY: NONE" ID=OWAPARASTYLE>'];var FNTFLG_NORMAL=0;var FNTFLG_BOLD=1;var FNTFLG_ITALIC=2;var FNTFLG_UNDERLINE=4;var FONTNAME_COLUMN=0;var FONTFAMILY_COLUMN=1;var ENGLISHFONTNAME_COLUMN=0;var LOCALIZEDFONTNAME_COLUMN=1;var LOCALIZED_FONTNAME_TABLE=[["Batang","바탕"],["Dotum","돋움"],["FangSong","仿宋"],["Gulim","굴림"],["Malgun Gothic","맑은 고딕"],["Meiryo","メイリオ"],["Microsoft JhengHei","微軟正黑體"],["Microsoft YaHei","微软雅黑"],["MingLiU","細明體"],["MingLiU_HKSCS","細明體_HKSCS"],["MS Gothic","ＭＳ ゴシック"],["MS Mincho","ＭＳ 明朝"],["MS PGothic","ＭＳ Ｐゴシック"],["MS PMincho","ＭＳ Ｐ明朝"],["PMingLiU","新細明體"],["PMingLiU-ExtB","新細明體-ExtB"],["SimHei","黑体"],["SimSun","宋体"],["SimSun-ExtB","宋体-ExtB"],["KaiTi","楷体"]];var DEFAULT_FONT_TABLE=[["Angsana New","'Angsana New',Serif"],["Arial","Arial,Helvetica,sans-serif"],["바탕","Batang,'바탕',Serif"],["Calibri","Calibri,Arial,Helvetica,sans-serif"],["Cambria","Cambria,Serif"],["Candara","Candara,Sans-Serif"],["Comic Sans MS","'Comic Sans MS',Fantasy,cursive"],["Consolas","Consolas,monospace"],["Constantia","Constantia,Serif"],["Corbel","Corbel,Sans-Serif"],["Cordia New","'Cordia New',Sans-Serif"],["Courier New","'Courier New',monospace"],["DaunPenh","DaunPenh,Sans-Serif"],["돋움","Dotum,'돋움',Sans-Serif"],["仿宋","FangSong,'仿宋',Serif"],["Gautami","Gautami,Sans-Serif"],["Georgia","Georgia,serif"],["굴림","Gulim,'굴림',Sans-Serif"],["Gungsuh","Gungsuh,Serif"],["Helvetica","Helvetica, Sans-Serif"],["Iskoola Pota","'Iskoola Pota',Sans-Serif"],["楷体","KaiTi,'楷体'，Sans-Serif"],["Kalinga","Kalinga,Sans-Serif"],["Kartika","Kartika,Sans-Serif"],["Latha","Latha,Sans-Serif"],["Lucida Sans Unicode","'Lucida Sans Unicode', 'Lucida Grande', sans-serif"],["맑은 고딕","'Malgun Gothic','맑은 고딕',Sans-Serif"],["Mangal","Mangal,Sans-Serif"],["メイリオ","Meiryo,'メイリオ',Sans-Serif"],["微軟正黑體","'Microsoft JhengHei','微軟正黑體',Sans-Serif"],["微软雅黑","'Microsoft YaHei','微软雅黑',Sans-Serif"],["細明體","MingLiU,'細明體',Serif"],["細明體_HKSCS","MingLiU_HKSCS,'細明體_HKSCS',Serif"],["ＭＳ ゴシック","'MS Gothic','ＭＳ ゴシック',Sans-Serif"],["ＭＳ 明朝","'MS Mincho','ＭＳ 明朝',Serif"],["ＭＳ Ｐゴシック","'MS PGothic','ＭＳ Ｐゴシック',Sans-Serif"],["ＭＳ Ｐ明朝","'MS PMincho','ＭＳ Ｐ明朝',Serif"],["Nyala","Nyala,Sans-Serif"],["新細明體","PMingLiU,'新細明體',Serif"],["新細明體-ExtB","PMingLiU-ExtB,'新細明體-ExtB',Serif"],["Raavi","Raavi,Sans-Serif"],["Segoe UI","'Segoe UI',Sans-Serif"],["Shruti","Shruti,Sans-Serif"],["黑体","SimHei,'黑体',Sans-Serif"],["宋体","SimSun,'宋体',Serif"],["宋体-ExtB","SimSun-ExtB,Serif"],["Sylfaen","Sylfaen,Serif"],["Symbol","Symbol,'Segoe UI',Tahoma,Sans-Serif"],["Tahoma","Tahoma, Geneva, sans-serif"],["Times","Times,'Times New Roman',Serif"],["Times New Roman","'Times New Roman', Times, serif"],["Tunga","Tunga,Sans-Serif"],["Verdana","Verdana, Geneva, sans-serif"],["Vrinda","Vrinda,Sans-Serif"],["Wingdings","Wingdings,Zapf Dingbats"],["Impact","Impact, Charcoal, sans-serif"],["Lucida Console","'Lucida Console', Monaco, monospace"],["Palatino Linotype","'Palatino Linotype', 'Book Antiqua', Palatino, serif"],["Trebuchet MS","'Trebuchet MS', sans-serif"],["Segoe","Segoe,'Segoe UI', Sans-Serif"]];var P_TAGNAME="P";var UL_TAGNAME="UL";var OL_TAGNAME="OL";var BODY_TAGNAME="BODY";var FONT_TAGNAME="FONT";var IMG_TAGNAME="IMG";Type.createNamespace("OwaEditor.Collections");OwaEditor.Collections.IEnumerator=function(){};OwaEditor.Collections.IEnumerator.prototype.get_Current=null;OwaEditor.Collections.IEnumerator.prototype.moveNext=null;OwaEditor.Collections.IEnumerator.prototype.reset=null;OwaEditor.Collections.IEnumerator.createInterface("OwaEditor.Collections.IEnumerator");OwaEditor.Collections.IEnumerable=function(){};OwaEditor.Collections.IEnumerable.prototype.get_Enumerator=null;OwaEditor.Collections.IEnumerable.createInterface("OwaEditor.Collections.IEnumerable");OwaEditor.Collections.IList=function(){};OwaEditor.Collections.IList.prototype.get_Length=null;OwaEditor.Collections.IList.prototype.get_Item=null;OwaEditor.Collections.IList.createInterface("OwaEditor.Collections.IList");var isNoE,isRg,isDf,getInt;g_fModuleLoaded[".\\core/nativetypeextension.js".toLowerCase()]||function(){(function(){String.prototype.trimStart=function(){return this.replace(/^\s*/,"")};String.prototype.trimEnd=function(){return this.replace(/\s*$/,"")};String.prototype.startsWith=function(n){return this.indexOf(n)==0};String.prototype.trim=function(){return this.trimStart().trimEnd()};String.prototype.endsWith=function(n){var t=this.lastIndexOf(n);return t>=0&&t==this.length-n.length?!0:!1};String.prototype.contains=function(n){return this.indexOf(n)>=0};String.NormalizeDomString=function(n){return OwaEditor.Utility.isIE()?n:n?n.replace(/\xa0/g," "):n}})();(function(){Array.__rgInterfaces=[OwaEditor.Collections.IList,OwaEditor.Collections.IEnumerable];Array.prototype.get_Length=function(){return this.length};Array.prototype.get_Item=function(n){return this[n]};Array.prototype.indexOf=function(n){for(var t=0;t<this.length;t++)if(this[t]&&this[t]===n)return t;return-1};Array.prototype.remove=function(n){var t=this.indexOf(n);t>-1&&this.splice(t,1);return t>-1};Array.prototype.removeAt=function(n){if(n<this.length){this.splice(n,1);return!0}return!1};Array.prototype.add=function(n){this.push(n)};Array.prototype.clone=function(){return this.slice()}})();(function(){Type.createNamespace("OwaEditor.Type.Utility");isDf=OwaEditor.Type.Utility.isDefined=function(n){return n!=Type.Const.Undefined};getInt=OwaEditor.Type.Utility.getInt=function(n){return parseInt(n,10)}})()}();g_fModuleLoaded[".\\core/nativetypeextension.js".toLowerCase()]=1;(function(){Type.createNamespace("OwaEditor.Utility");OwaEditor.Utility.IntFromSize=function(n){var t=parseInt(n.trim(),10);return isNaN(t)?0:t};function n(n){return!!n&&this._oThis==n._oThis&&this._fnFunction&&this._fnFunction==n._fnFunction}OwaEditor.Utility.createContextDelegate=function(t,i,r,u,f){do if(i==null||i===undefined)throw new Error("Assert fail ["+".\\library/utility.js"+":"+98+"]: argument "+"fnFunction"+" can't be null or undefined");while(0);do if(i!==null&&i!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(i))throw new Error("Assert fail ["+".\\library/utility.js"+":"+99+"]: argument "+"fnFunction"+" is not of type "+"Function");while(0);var e=function(){return i.call(t,r,u,f)};e._oThis=t;e._fnFunction=i;e.equals=n;return e};OwaEditor.Utility.createArgumentContextDelegate=function(t,i,r,u){do if(i==null||i===undefined)throw new Error("Assert fail ["+".\\library/utility.js"+":"+132+"]: argument "+"fnFunctionToInvoke"+" can't be null or undefined");while(0);do if(i!==null&&i!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(i))throw new Error("Assert fail ["+".\\library/utility.js"+":"+133+"]: argument "+"fnFunctionToInvoke"+" is not of type "+"Function");while(0);if(u!=null){do if(u!==null&&u!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(u))throw new Error("Assert fail ["+".\\library/utility.js"+":"+137+"]: argument "+"fnFunctionIdentity"+" is not of type "+"Function");while(0)}else u=i;var f=function(n){return i.call(t,n,r)};f._oThis=t;f._fnFunction=u;f.equals=n;return f};OwaEditor.Utility.inherit=function(n,t){for(var i in t.prototype)n.prototype[i]=t.prototype[i];n.prototype.constructor=n;n.baseClass=t};OwaEditor.Utility.isArray=function(n){return n&&typeof n=="object"?typeof n.length!="undefined":0};OwaEditor.Utility.isDefined=function(n){return n!==Type.Const.Undefined};OwaEditor.Utility.isEqual=function(n,t){return n&&n.equals!==undefined?n.equals(t):n==t};OwaEditor.Utility.getVisiblePositionX=function(n,t,i){var u=n.get_ParentElement().get_OffsetWidth();var f=n.get_OffsetWidth();var e=n.get_PositionalParent().get_RelativeLeft(n.get_ParentElement());var r=e+t;if(i){r<0&&(r=0);r+f>u&&(r=u-f)}else{var o=r+f-u;o>0&&(r-=o);r<0&&(r=0)}return r-e};OwaEditor.Utility.getVisiblePositionY=function(n,t){var r=n.get_ParentElement();var e=n.get_OffsetHeight();var u=n.get_PositionalParent().get_RelativeTop(r);var i=u+t;var f=i+e-r.get_OffsetHeight()-r.get_ScrollTop();f>0&&(i-=f);i<0&&(i=0);return i-u};OwaEditor.Utility.OwaPrefixes={PublicStoreFolderPrefix:"PSF",PublicStoreItemPrefix:"PSI",ConversationIdPrefix:"CID",OtherUserMailboxObjectPrefix:"OUM",ArchiveMailboxObjectPrefix:"AMB",ArchiveConversationIdPrefix:"ACI",GSCalendarPrefix:"GS",SeparatorChar:"."}})();g_fModuleLoaded[".\\dom/event.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.Dom");OwaEditor.Dom.Event=function(n,t){this._oEvent=n;this._oCurrentTarget=t};OwaEditor.Dom.Event.prototype.isLeftButtonDown=function(){return typeof this._oEvent.which!="undefined"?OwaEditor.Utility.isMac()&&this._oEvent.ctrlKey?!1:this._oEvent.which==1:(this._oEvent.button&1)!=0};OwaEditor.Dom.Event.prototype.isCtrlKeyDown=function(){return OwaEditor.Utility.isMac()?this._oEvent.metaKey:this._oEvent.ctrlKey};OwaEditor.Dom.Event.prototype.isAltKeyDown=function(){return this._oEvent.altKey};OwaEditor.Dom.Event.prototype.isMacCtrlKeyDown=function(){return OwaEditor.Utility.isMac()&&this._oEvent.ctrlKey};OwaEditor.Dom.Event.prototype.isShiftKeyDown=function(){return this._oEvent.shiftKey};OwaEditor.Dom.Event.prototype.preventDefault=function(){this._oEvent.preventDefault?this._oEvent.preventDefault():this._oEvent.returnValue=!1};OwaEditor.Dom.Event.prototype.cancelBubble=function(){this._oEvent.cancelBubble=!0};OwaEditor.Dom.Event.prototype.get_ClientX=function(){return this._oEvent.clientX};OwaEditor.Dom.Event.prototype.get_ClientY=function(){return this._oEvent.clientY};OwaEditor.Dom.Event.prototype.get_OffsetY=function(){return this._oEvent.offsetY};OwaEditor.Dom.Event.prototype.get_CurrentTarget=function(){!this._oWrapCurrentTarget&&this._oCurrentTarget&&(this._oWrapCurrentTarget=this._oCurrentTarget?OwaEditor.Dom.EventTarget.wrapEventTarget(this._oCurrentTarget):null);return this._oWrapCurrentTarget};OwaEditor.Dom.Event.prototype.get_Target=function(){var n=this._oEvent.srcElement||this._oEvent.target;n&&typeof n.nodeType!="undefined"&&n.nodeType!=OwaEditor.NodeType.Element&&(n=n.parentNode);return n?OwaEditor.Dom.EventTarget.wrapEventTarget(n):null};OwaEditor.Dom.Event.prototype.get_KeyCodeForKeyUpDown=function(){if(this._oEvent.type!="keyup"&&this._oEvent.type!="keydown")throw"Cannot get keyCode for events other than keyup or keydown";return this._oEvent.keyCode};OwaEditor.Dom.Event.prototype.get_Type=function(){if(window.Components)switch(this._oEvent.type){case"draggesture":return"dragstart";case"dragdrop":return"drop";case"dragexit":return"dragleave";case"DOMMouseScroll":return"mousewheel";default:return this._oEvent.type}return this._oEvent.type};OwaEditor.Dom.Event.prototype.get_WheelDirection=function(){return this._oEvent.wheelDelta?this._oEvent.wheelDelta<0?1:-1:this._oEvent.detail>0?1:-1};OwaEditor.Dom.Event.createClass("OwaEditor.Dom.Event")}();g_fModuleLoaded[".\\dom/event.js".toLowerCase()]=1;Type.createNamespace("OwaEditor.Utility");g_fModuleLoaded[".\\core/eventhandlercollection.js".toLowerCase()]||function(){OwaEditor.Utility.EventHandlerCollection=function(){this._handlers=[];this._fLast=!1};OwaEditor.Utility.EventHandlerCollection.prototype.add=function(n,t){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\core/eventhandlercollection.js"+":"+36+"]: argument "+"fnDelegate"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(n))throw new Error("Assert fail ["+".\\core/eventhandlercollection.js"+":"+37+"]: argument "+"fnDelegate"+" is not of type "+"Function");while(0);if(this._fLast&&t)throw new Error('There can be only one "last" handler.');if(this._indexOf(n)==-1)if(this._fLast){var i=this._handlers.pop();this._handlers.push(n);this._handlers.push(i)}else{this._handlers.add(n);t&&(this._fLast=!0)}};OwaEditor.Utility.EventHandlerCollection.prototype.clear=function(){this._handlers=[]};OwaEditor.Utility.EventHandlerCollection.prototype.remove=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\core/eventhandlercollection.js"+":"+87+"]: argument "+"fnDelegate"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(n))throw new Error("Assert fail ["+".\\core/eventhandlercollection.js"+":"+88+"]: argument "+"fnDelegate"+" is not of type "+"Function");while(0);var t=this._indexOf(n);if(t>=0){this._handlers.removeAt(t);return!0}return!1};OwaEditor.Utility.EventHandlerCollection.prototype.get_IsEmpty=function(){return this._handlers.length==0};OwaEditor.Utility.EventHandlerCollection.prototype.dispatch=function(n,t){return this.dispatchWithThisArg(null,n,t)};OwaEditor.Utility.EventHandlerCollection.prototype.dispatchWithThisArg=function(n,t,i){for(var r=undefined,e=this._handlers.slice(0),u=0;u<e.length;++u){var f=e[u].call(n,t,i);f===!1||f===0?r=!1:r!==!1&&(r=f)}return r};OwaEditor.Utility.EventHandlerCollection.prototype._indexOf=function(n){for(var t=0;t<this._handlers.length;++t)if(n==this._handlers[t])return t;else if(n._fnFunction&&this._handlers[t]._fnFunction&&n._fnFunction==this._handlers[t]._fnFunction&&n._oThis==this._handlers[t]._oThis)return t;return-1}}();g_fModuleLoaded[".\\core/eventhandlercollection.js".toLowerCase()]=1;g_fModuleLoaded[".\\dom/eventtarget.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.Dom");OwaEditor.Dom.EventTarget=function(n){this._oTarget=n};OwaEditor.Dom.EventTarget.prototype.attachEvent=function(n,i,r){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/eventtarget.js"+":"+48+"]: argument "+"sEventName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/eventtarget.js"+":"+49+"]: argument "+"sEventName"+" is not of type "+"String");while(0);n=t(n);var f=this._get_Target();var u=f.__eventHandlers;if(!u){u={};f.__eventHandlers=u}if(!u[n]){u[n]=new OwaEditor.Utility.EventHandlerCollection;var e=f["on"+n];e&&u[n].add(e);typeof f.addEventListener!="undefined"?f.addEventListener(n,OwaEditor.Dom.EventTarget._dispatchEvent,!1):f["on"+n]=OwaEditor.Dom.EventTarget._dispatchEvent}u[n].add(i,r)};function i(n){var t=!0;for(var i in n)if(n[i]!=null){t=!1;break}return t}OwaEditor.Dom.EventTarget.prototype.detachEvent=function(n,r){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/eventtarget.js"+":"+117+"]: argument "+"sEventName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/eventtarget.js"+":"+118+"]: argument "+"sEventName"+" is not of type "+"String");while(0);var u=this._get_Target();n=t(n);if(u.__eventHandlers&&u.__eventHandlers[n]){u.__eventHandlers[n].remove(r);if(u.__eventHandlers[n].get_IsEmpty()){typeof u.removeEventListener=="undefined"?u["on"+n]=null:u.removeEventListener(n,OwaEditor.Dom.EventTarget._dispatchEvent,!1);u.__eventHandlers[n]=null}i(u.__eventHandlers)&&(u.__eventHandlers=null)}};OwaEditor.Dom.EventTarget.prototype.detachAllEvents=function(n){do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/eventtarget.js"+":"+160+"]: argument "+"sEventName"+" is not of type "+"String");while(0);var r=this._get_Target();n=t(n);if(n){if(r.__eventHandlers&&r.__eventHandlers[n]){r.__eventHandlers[n]=null;r["on"+n]=null;i(r.__eventHandlers)&&(r.__eventHandlers=null)}}else{for(var u in r.__eventHandlers){typeof r.removeEventListener=="undefined"?r["on"+u]=null:r.removeEventListener(u,OwaEditor.Dom.EventTarget._dispatchEvent,!1);r.__eventHandlers[u]=null}r.__eventHandlers=null}};OwaEditor.Dom.EventTarget.prototype.dispose=function(){this._internalDispose()};OwaEditor.Dom.EventTarget.prototype._internalDispose=function(){this.detachAllEvents()};OwaEditor.Dom.EventTarget._dispatchEvent=function(t){t=t||OwaEditor.Dom.EventTarget._getEvent(this);n&&n();if(this.__eventHandlers){var i=new OwaEditor.Dom.Event(t,this);if(this.__eventHandlers[t.type])return this.__eventHandlers[t.type].dispatchWithThisArg(this,i)}};OwaEditor.Dom.EventTarget.prototype._clearPropertiesForClone=function(){var n=this._get_Target();OwaEditor.Utility.isIE()?n.removeAttribute("__eventHandlers"):delete n.__eventHandlers};OwaEditor.Dom.EventTarget._getEvent=function(n){try{if(n.event)return n.event;n.ownerDocument&&(n=n.ownerDocument);return n.parentWindow.event}catch(t){OwaEditor.BrowserErrorHandler.handleFrameAccessError(t)}};OwaEditor.Dom.EventTarget.wrapEventTarget=function(n){return typeof n.navigator!="undefined"?new OwaEditor.Dom.Window(n):OwaEditor.Dom.Node.wrapDomNode(n)};OwaEditor.Dom.EventTarget.set_OnBeforeDispatchEvent=function(t){do if(t!==null&&t!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(t))throw new Error("Assert fail ["+".\\dom/eventtarget.js"+":"+326+"]: argument "+"cb"+" is not of type "+"Function");while(0);do if(t==null||t===undefined)throw new Error("Assert fail ["+".\\dom/eventtarget.js"+":"+327+"]: argument "+"cb"+" can't be null or undefined");while(0);n=t};var n=null;var r={mousewheel:"DOMMouseScroll"};function t(n){var t;OwaEditor.Utility.isFirefox()&&(t=r[n]);return t?t:n}OwaEditor.Dom.EventTarget.prototype._get_Target=function(){return this._oTarget};OwaEditor.Dom.EventTarget.createClass("OwaEditor.Dom.EventTarget")}();g_fModuleLoaded[".\\dom/eventtarget.js".toLowerCase()]=1;Type.createNamespace("OwaEditor.Dom");g_fModuleLoaded[".\\dom/window.js".toLowerCase()]||function(){OwaEditor.Dom.Window=function(n){this._domWindow=n;OwaEditor.Dom.Window.constructBase(this,[n])};var n;OwaEditor.Dom.Window.get_Current=function(){n||(n=new OwaEditor.Dom.Window(window));return n};OwaEditor.Dom.Window.dispose=function(){if(n){n.dispose();n=null}};OwaEditor.Dom.Window.prototype.get_Document=function(){return new OwaEditor.Dom.Document(this._domWindow.document)};OwaEditor.Dom.Window.prototype.get_FrameElement=function(){var n=null;try{n=this._domWindow.frameElement;n&&n.ownerDocument}catch(t){n=null}return n?new OwaEditor.Dom.Frame(n):null};OwaEditor.Dom.Window.prototype.setTimeout=function(n,t){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/window.js"+":"+255+"]: argument "+"delegate"+" can't be null or undefined");while(0);do if(t==null||t===undefined)throw new Error("Assert fail ["+".\\dom/window.js"+":"+256+"]: argument "+"iTimeoutInterval"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(n))throw new Error("Assert fail ["+".\\dom/window.js"+":"+257+"]: argument "+"delegate"+" is not of type "+"Function");while(0);do if(t!==null&&t!==undefined&&Number.isInstance!=undefined&&!Number.isInstance(t))throw new Error("Assert fail ["+".\\dom/window.js"+":"+258+"]: argument "+"iTimeoutInterval"+" is not of type "+"Number");while(0);return this._domWindow.setTimeout(n,t)};OwaEditor.Dom.Window.prototype.clearTimeout=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/window.js"+":"+268+"]: argument "+"iTimerId"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&Number.isInstance!=undefined&&!Number.isInstance(n))throw new Error("Assert fail ["+".\\dom/window.js"+":"+269+"]: argument "+"iTimerId"+" is not of type "+"Number");while(0);this._domWindow.clearTimeout(n)};OwaEditor.Dom.Window.prototype.open=function(n,t,i){do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/window.js"+":"+358+"]: argument "+"sUrl"+" is not of type "+"String");while(0);do if(t!==null&&t!==undefined&&String.isInstance!=undefined&&!String.isInstance(t))throw new Error("Assert fail ["+".\\dom/window.js"+":"+359+"]: argument "+"sName"+" is not of type "+"String");while(0);do if(i!==null&&i!==undefined&&String.isInstance!=undefined&&!String.isInstance(i))throw new Error("Assert fail ["+".\\dom/window.js"+":"+360+"]: argument "+"sFeatures"+" is not of type "+"String");while(0);n||(n="");t||(t="");i||(i="");var r;try{r=this._domWindow.open(n,t,i)}catch(u){return null}return new OwaEditor.Dom.Window(r)};OwaEditor.Dom.Window.prototype.equals=function(n){return n==null?!1:this._domWindow==null?!1:this._domWindow==n._domWindow};function t(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/window.js"+":"+440+"]: argument "+"sVariableName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/window.js"+":"+441+"]: argument "+"sVariableName"+" is not of type "+"String");while(0);switch(n){case"document":case"href":case"navigate":case"scrollBy":case"scrollTo":case"print":case"frameElement":case"length":case"name":case"parent":case"top":case"location":case"navigator":case"opener":case"screenX":case"screenY":case"setTimeout":case"clearTimeout":case"setInterval":case"clearInterval":case"open":case"close":case"moveTo":case"resizeTo":throw new Error("can't access dom functionlity");}if(n.contains("."))throw new Error("can't access nested variable");}OwaEditor.Dom.Window.prototype.setGlobalVariable=function(n,i){t(n);try{this._domWindow[n]=i}catch(r){}};OwaEditor.Dom.Window.createClass("OwaEditor.Dom.Window",OwaEditor.Dom.EventTarget)}();g_fModuleLoaded[".\\dom/window.js".toLowerCase()]=1;Type.createNamespace("OwaEditor.Dom");OwaEditor.NodeType={Element:1,Text:3,Comment:8,Document:9};OwaEditor.Dom.GetElement=function(n){return OwaEditor.Dom.Document.get_Current().getElementById(n)};g_fModuleLoaded[".\\dom/node.js".toLowerCase()]||function(){OwaEditor.Dom.Node=function(n){OwaEditor.Dom.Node._setupBase();this._oDomNode=n;this._oTarget=n};OwaEditor.Dom.Node.wrapDomNode=function(n){var i=null;if(n)switch(n.nodeType){case OwaEditor.NodeType.Element:var t=n.tagName;i=t=="IFRAME"?new OwaEditor.Dom.Frame(n):t=="INPUT"||t=="TEXTAREA"||t=="BUTTON"||t=="SELECT"?new OwaEditor.Dom.Input(n):new OwaEditor.Dom.Element(n);break;case OwaEditor.NodeType.Document:i=new OwaEditor.Dom.Document(n);break;default:i=new OwaEditor.Dom.NonSingletonNode(n);break}return i};OwaEditor.Dom.Node.prototype.get_NodeType=function(){return this._get_DomNode().nodeType};OwaEditor.Dom.Node.OwaExpandosName="__OwaExpandos";OwaEditor.Dom.Node.prototype.setExpando=function(n,t){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/node.js"+":"+185+"]: argument "+"sName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/node.js"+":"+186+"]: argument "+"sName"+" is not of type "+"String");while(0);var i=this._get_DomNode();(typeof i[OwaEditor.Dom.Node.OwaExpandosName]=="undefined"||i[OwaEditor.Dom.Node.OwaExpandosName]==null)&&(i[OwaEditor.Dom.Node.OwaExpandosName]={});i[OwaEditor.Dom.Node.OwaExpandosName][n]=t};OwaEditor.Dom.Node.prototype.getExpando=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/node.js"+":"+214+"]: argument "+"sName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/node.js"+":"+215+"]: argument "+"sName"+" is not of type "+"String");while(0);var t=this._get_DomNode()[OwaEditor.Dom.Node.OwaExpandosName];return!t?null:t[n]};OwaEditor.Dom.Node.prototype.clearAllExpandos=function(){this._get_DomNode()[OwaEditor.Dom.Node.OwaExpandosName]=null};OwaEditor.Dom.Node.prototype.equals=function(n){return n==null?!1:this._oDomNode==null?!1:this._oDomNode==n._oDomNode};OwaEditor.Dom.Node.prototype._wrapNode=function(n){return OwaEditor.Dom.Node.wrapDomNode(n)};OwaEditor.Dom.Node.prototype._get_DomNode=function(){return this._oDomNode};OwaEditor.Dom.Node.prototype._internalDispose=function(){var n=this._get_DomNode();if("__OwaExpandos"in n){for(var t in n[OwaEditor.Dom.Node.OwaExpandosName])n[OwaEditor.Dom.Node.OwaExpandosName][t]=null;n[OwaEditor.Dom.Node.OwaExpandosName]=null}OwaEditor.Dom.Node.callBase(this,"_internalDispose")};OwaEditor.Dom.Node.prototype._clearPropertiesForClone=function(){var n=this._get_DomNode();OwaEditor.Utility.isIE()?n.removeAttribute(OwaEditor.Dom.Node.OwaExpandosName):delete n[OwaEditor.Dom.Node.OwaExpandosName];OwaEditor.Dom.Node.callBase(this,"_clearPropertiesForClone")};OwaEditor.Dom.Node.createClass("OwaEditor.Dom.Node",OwaEditor.Dom.EventTarget)}();g_fModuleLoaded[".\\dom/node.js".toLowerCase()]=1;g_fModuleLoaded[".\\dom/documentbase.js".toLowerCase()]||function(){OwaEditor.Dom.DocumentBase=function(n){OwaEditor.Dom.DocumentBase.constructBase(this,[n])};OwaEditor.Dom.DocumentBase.prototype.get_DocumentElement=function(){var n=this._get_DomDocument().documentElement;return n?this._wrapNode(n):null};OwaEditor.Dom.DocumentBase.prototype.appendChild=function(n){throw"Cannot call an abstract method";};OwaEditor.Dom.DocumentBase.prototype.createElement=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/documentbase.js"+":"+63+"]: argument "+"sTagName"+" can't be null or undefined");while(0);return this._wrapNode(this._get_DomDocument().createElement(n))};OwaEditor.Dom.DocumentBase.prototype._get_DomDocument=function(){return this._get_DomNode()};OwaEditor.Dom.DocumentBase.createClass("OwaEditor.Dom.DocumentBase",OwaEditor.Dom.Node)}();g_fModuleLoaded[".\\dom/documentbase.js".toLowerCase()]=1;Type.createNamespace("OwaEditor.Dom");g_fModuleLoaded[".\\dom/stylesheet.js".toLowerCase()]||function(){OwaEditor.Dom.StyleSheet=function(n){this._oDomStyleSheet=n};OwaEditor.Dom.StyleSheet.prototype.get_OwnerNode=function(){return OwaEditor.Utility.isDefined(typeof this._oDomStyleSheet.ownerNode)?OwaEditor.Dom.Node.wrapDomNode(this._oDomStyleSheet.ownerNode):OwaEditor.Dom.Node.wrapDomNode(this._oDomStyleSheet.owningElement)};OwaEditor.Dom.StyleSheet.prototype.get_Id=function(){return this.get_OwnerNode().get_Id()};OwaEditor.Dom.StyleSheet.prototype.remove=function(){this.get_OwnerNode().remove(1)};OwaEditor.Dom.StyleSheet.prototype.addRule=function(n,t){if(typeof this._oDomStyleSheet.insertRule!="undefined"){sStyleRule=n+" {"+t+"}";var i;i=this._oDomStyleSheet.cssRules?this._oDomStyleSheet.cssRules.length:0;this._oDomStyleSheet.insertRule(sStyleRule,i);this._oDomStyleSheet.ownerNode.innerHTML=this._oDomStyleSheet.ownerNode.innerHTML+sStyleRule}else this._oDomStyleSheet.addRule(n,t)};OwaEditor.Dom.StyleSheet.prototype.removeRule=function(n){typeof this._oDomStyleSheet.removeRule!="undefined"?this._oDomStyleSheet.removeRule(n):this._oDomStyleSheet.deleteRule(n)};OwaEditor.Dom.StyleSheet.prototype.get_RulesCount=function(){var n=this._oDomStyleSheet;return n.cssRules?n.cssRules.length:n.rules.length};OwaEditor.Dom.StyleSheet.prototype.getRuleAt=function(n){var t=this._oDomStyleSheet;var i=t.cssRules?t.cssRules[n]:t.rules[n];return i?new OwaEditor.Dom.cssStyleRule(i):null}}();g_fModuleLoaded[".\\dom/stylesheet.js".toLowerCase()]=1;g_fModuleLoaded[".\\dom/document.js".toLowerCase()]||function(){OwaEditor.Dom.Document=function(n){this._oContainerWindow=null;OwaEditor.Dom.Document.constructBase(this,[n])};var n;OwaEditor.Dom.Document.get_Current=function(){n||(n=new OwaEditor.Dom.Document(document));return n};OwaEditor.Dom.Document.dispose=function(){if(n){n.dispose();n=null}};OwaEditor.Dom.Document.prototype.get_Title=function(){var n=this._get_DomDocument().title;n||(n="");return n};OwaEditor.Dom.Document.prototype.set_Title=function(n){this._get_DomDocument().title=n};OwaEditor.Dom.Document.prototype.get_ContainerWindow=function(){if(!this._oContainerWindow){var n=this._get_DomDocument();var t=typeof n.defaultView!="undefined"?n.defaultView:n.parentWindow;this._oContainerWindow=t==window?OwaEditor.Dom.Window.get_Current():new OwaEditor.Dom.Window(t)}return this._oContainerWindow};OwaEditor.Dom.Document.prototype.getElementById=function(n){var r=null;if(this._get_DomDocument().all){var t=this._get_DomDocument().all[n];if(t){OwaEditor.Utility.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++)if(t[i].id==n){r=t[i];break}}}else r=this._get_DomDocument().getElementById(n);return OwaEditor.Dom.Node.wrapDomNode(r)};OwaEditor.Dom.Document.prototype.getElementsByName=function(n){for(var i=this._get_DomDocument().getElementsByName(n),r=[],u=i.length,t=0;t<u;++t)r.add(OwaEditor.Dom.Node.wrapDomNode(i[t]));return r};OwaEditor.Dom.Document.prototype.appendChild=function(n){return OwaEditor.Dom.Node.wrapDomNode(this._get_DomDocument().body.appendChild(n._get_DomNode()))};OwaEditor.Dom.Document.prototype.get_StyleSheetCount=function(){return this._get_DomDocument().styleSheets.length};OwaEditor.Dom.Document.prototype.getStyleSheetAt=function(n){var t=this._get_DomDocument().styleSheets[n];return t?new OwaEditor.Dom.StyleSheet(t):null};OwaEditor.Dom.Document.prototype.getStyleSheetByAttribute=function(n,t){for(var r=this._get_DomDocument().styleSheets,i=0;i<r.length;i++){var u=new OwaEditor.Dom.StyleSheet(r[i]);var f=u.get_OwnerNode();if(f&&f.getAttribute(n)==t)return u}return 0};OwaEditor.Dom.Document.prototype.insertBlankStyleSheet=function(n,t){var i=this._get_DomDocument();var r;i.getElementsByTagName("head")&&i.getElementsByTagName("head").length!=0||i.body.parentNode.insertBefore(i.createElement("head"),i.body);if(typeof i.createStyleSheet!="undefined"){r=i.createStyleSheet();n!=null&&r.owningElement.setAttribute("id",n);t&&(r.media=t);r.owningElement.style.display="none"}else{var u=i.createElement("style");u.type="text/css";n!=null&&(u.id=n);t&&(u.media=t);u.style.display="none";i.getElementsByTagName("head")[0].appendChild(u);r=i.styleSheets[i.styleSheets.length-1]}return new OwaEditor.Dom.StyleSheet(r)};OwaEditor.Dom.Document.prototype.get_IsDesignMode=function(){return this._get_DomDocument().designMode.toLowerCase()=="on"};OwaEditor.Dom.Document.prototype.set_DesignMode=function(n){this._get_DomDocument().designMode=n?"on":"off"};OwaEditor.Dom.Document.prototype.set_IsRtl=function(n){var t=this._get_DomDocument();var i=t.getElementsByTagName(BODY_TAGNAME)[0];i.dir=n?"rtl":"ltr"};OwaEditor.Dom.Document.prototype.get_IsRtl=function(){var n=this._get_DomDocument();var t=n.getElementsByTagName(BODY_TAGNAME)[0];return t.dir.toLowerCase()=="rtl"};OwaEditor.Dom.Document.prototype.get_Body=function(){return OwaEditor.Dom.Node.wrapDomNode(this._get_DomDocument().body)};OwaEditor.Dom.Document.createClass("OwaEditor.Dom.Document",OwaEditor.Dom.DocumentBase)}();g_fModuleLoaded[".\\dom/document.js".toLowerCase()]=1;g_fModuleLoaded[".\\dom/nonsingletonnode.js".toLowerCase()]||function(){OwaEditor.Dom.NonSingletonNode=function(n){OwaEditor.Dom.NonSingletonNode._setupBase();this._oDomNode=n;this._oTarget=n};OwaEditor.Dom.NonSingletonNode.prototype.get_OwnerDocument=function(){var n=this._get_DomNode().ownerDocument;return n==document?OwaEditor.Dom.Document.get_Current():this._wrapNode(n)};OwaEditor.Dom.NonSingletonNode.prototype.get_FirstChild=function(){var t=n(this._oDomNode.firstChild,"nextSibling");return t==null?null:this._wrapNode(t)};OwaEditor.Dom.Node.prototype.get_ParentElement=function(){var n=this._get_DomNode().parentNode;var t=null;n&&n.nodeType==OwaEditor.NodeType.Element&&(t=n);return t?this._wrapNode(t):null};OwaEditor.Dom.NonSingletonNode.prototype.getAncestorByTag=function(n){var i=n.toUpperCase();var t=this._get_DomNode();do t=t.parentNode.nodeType==OwaEditor.NodeType.Element?t.parentNode:null;while(t&&t.tagName.toUpperCase()!=i);return t?this._wrapNode(t):null};OwaEditor.Dom.NonSingletonNode.prototype.getAncestorByClass=function(n,t){var i=this;do{if(t&&i.hasCssClass(t))return null;i=i.get_ParentElement()}while(i&&!i.hasCssClass(n));return i};OwaEditor.Dom.NonSingletonNode.prototype.get_TextContent=function(){return String.NormalizeDomString(this._get_DomNode().nodeValue)};OwaEditor.Dom.NonSingletonNode.prototype.remove=function(n){OwaEditor.Dom.NonSingletonNode._removeDomNode(this._get_DomNode(),n);return this};OwaEditor.Dom.NonSingletonNode._isIgnorableNode=function(n){return n.nodeType==OwaEditor.NodeType.Comment||t(n)};OwaEditor.Dom.NonSingletonNode._removeDomNode=function(n,t){if(typeof n.removeNode!="undefined")n.removeNode(t);else if(t||!n.hasChildNodes())n.parentNode&&n.parentNode.removeChild(n);else{var i=n.ownerDocument.createRange();i.selectNodeContents(n);n.parentNode&&n.parentNode.replaceChild(i.extractContents(),n)}};function n(n,t){for(;;)if(n==null)return null;else if(OwaEditor.Dom.NonSingletonNode._isIgnorableNode(n))n=n[t];else return n}function t(n){return n.nodeType==OwaEditor.NodeType.Text&&!/[^\t\n\r ]/.test(n.data)}OwaEditor.Dom.NonSingletonNode.createClass("OwaEditor.Dom.NonSingletonNode",OwaEditor.Dom.Node)}();g_fModuleLoaded[".\\dom/nonsingletonnode.js".toLowerCase()]=1;g_fModuleLoaded[".\\dom/elementbase.js".toLowerCase()]||function(){OwaEditor.Dom.ElementBase=function(n){OwaEditor.Dom.ElementBase._setupBase();this._oDomNode=n;this._oTarget=n};OwaEditor.Utility.inherit(OwaEditor.Dom.ElementBase,OwaEditor.Dom.NonSingletonNode);OwaEditor.Dom.ElementBase.prototype.get_TagName=function(){return this._get_DomNode().tagName};OwaEditor.Dom.ElementBase.prototype.setAttribute=function(n,t){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+65+"]: argument "+"sName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+66+"]: argument "+"sName"+" is not of type "+"String");while(0);do if(t!==null&&t!==undefined&&String.isInstance!=undefined&&!String.isInstance(t))throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+67+"]: argument "+"sValue"+" is not of type "+"String");while(0);typeof t=="undefined"||t==null?this._get_DomNode().removeAttribute(n):this._get_DomNode().setAttribute(n,t)};OwaEditor.Dom.ElementBase.prototype.getAttribute=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+91+"]: argument "+"sName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+92+"]: argument "+"sName"+" is not of type "+"String");while(0);var t=this._get_DomNode().getAttribute(n);if(typeof t=="undefined"||t==null)return null;else if(typeof t!="string")throw"Cannot get the attribute of none string type on IE";else return String.NormalizeDomString(t)};OwaEditor.Dom.ElementBase.prototype.removeAttribute=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+120+"]: argument "+"sName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+121+"]: argument "+"sName"+" is not of type "+"String");while(0);this._get_DomNode().removeAttribute(n)};OwaEditor.Dom.ElementBase.prototype.setIntAttribute=function(n,t){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+133+"]: argument "+"sName"+" can't be null or undefined");while(0);do if(t==null||t===undefined)throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+134+"]: argument "+"iValue"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+135+"]: argument "+"sName"+" is not of type "+"String");while(0);do if(t!==null&&t!==undefined&&Number.isInstance!=undefined&&!Number.isInstance(t))throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+136+"]: argument "+"iValue"+" is not of type "+"Number");while(0);this.setAttribute(n,t.toString(10))};OwaEditor.Dom.ElementBase.prototype.getIntAttribute=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+148+"]: argument "+"sName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+149+"]: argument "+"sName"+" is not of type "+"String");while(0);var t=this.getAttribute(n);t==null&&(t="");return parseInt(t,10)};OwaEditor.Dom.ElementBase.prototype.setBoolAttribute=function(n,t){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+165+"]: argument "+"sName"+" can't be null or undefined");while(0);do if(t==null||t===undefined)throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+166+"]: argument "+"fValue"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/elementbase.js"+":"+167+"]: argument "+"sName"+" is not of type "+"String");while(0);var i=Boolean.isInstance(t)||typeof t=="string"&&(t.toLowerCase()=="true"||t.toLowerCase()=="false")||parseInt(t,10)==1||parseInt(t,10)==0;if(!i)throw"fValue "+t+" is not a valid boolean value.";this.setAttribute(n,t.toString(10))};OwaEditor.Dom.ElementBase.prototype.getBoolAttribute=function(n){var t=this._get_DomNode().getAttribute(n);return typeof t=="string"&&t.toLowerCase()=="true"||parseInt(t,10)==1?!0:!1};OwaEditor.Dom.ElementBase.prototype.forEachChild=function(n,t){for(var r=this._get_DomNode().childNodes,i=0;i<r.length;i++){var u=r[i];if(!OwaEditor.Dom.NonSingletonNode._isIgnorableNode(u)){var f=this._wrapNode(u);if(n(f,t))return f}}return 0};OwaEditor.Dom.ElementBase.prototype.hasChildNodes=function(){var n=this._get_DomNode();var i=!1;if(n.hasChildNodes())for(var t=0;t<n.childNodes.length;t++){var r=n.childNodes[t];if(!OwaEditor.Dom.NonSingletonNode._isIgnorableNode(r)){i=!0;break}}return i};OwaEditor.Dom.ElementBase.prototype.appendChild=function(n){this._get_DomNode().appendChild(n._get_DomNode());return n};OwaEditor.Dom.ElementBase.prototype.removeChild=function(n){this._get_DomNode().removeChild(n._get_DomNode());return n};OwaEditor.Dom.ElementBase.prototype.removeAllChildNodes=function(){for(var n=this._get_DomNode();n.hasChildNodes();)n.removeChild(n.lastChild)};OwaEditor.Dom.ElementBase.prototype.replaceChild=function(n,t){this._get_DomNode().replaceChild(n._get_DomNode(),t._get_DomNode());return t};OwaEditor.Dom.ElementBase.prototype.swap=function(n){if(this._get_DomNode().swapNode)this._get_DomNode().swapNode(n._get_DomNode());else{var t=this.get_OwnerDocument().createElement("div");n.get_ParentElement().replaceChild(t,n);this.get_ParentElement().replaceChild(n,this);t.get_ParentElement().replaceChild(this,t)}};OwaEditor.Dom.ElementBase.createClass("OwaEditor.Dom.ElementBase",OwaEditor.Dom.NonSingletonNode)}();g_fModuleLoaded[".\\dom/elementbase.js".toLowerCase()]=1;g_fModuleLoaded[".\\dom/element.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.Style");OwaEditor.Style.Side={Top:"top",Right:"right",Bottom:"bottom",Left:"left"};OwaEditor.Style.Unit={Pixels:"px",Percent:"%",Points:"pt",Em:"em"};OwaEditor.Style.Positioning={Fixed:"fixed",Absolute:"absolute",Relative:"relative",Static:"static",Inherit:"inherit",Default:""};OwaEditor.Style.Overflow={Auto:"auto",Hidden:"hidden",Scroll:"scroll",Visible:"visible",Inherit:"inherit",Default:""};var n={None:"none",Inherit:"inherit",Default:""};OwaEditor.Style.Visibility={Visible:"visible",Hidden:"hidden",Collapse:"collapse",Inherit:"inherit",Default:""};OwaEditor.Style.FontWeight={Normal:"normal",Bold:"bold",Bolder:"bolder",Lighter:"lighter",i100:"100",i200:"200",i300:"300",i400:"400",i500:"500",i600:"600",i700:"700",i800:"800",i900:"900"};OwaEditor.ElementInsertionPoint={BeforeBegin:"beforeBegin",AfterBegin:"afterBegin",BeforeEnd:"beforeEnd",AfterEnd:"afterEnd"};OwaEditor.Dom.Element=function(n){if(!n)throw"the DOM object is null";OwaEditor.Dom.Element._setupBase();this._oDomNode=n;this._oTarget=n};OwaEditor.Dom.Element.prototype._internalDispose=function(){this._get_DomNode().oOriginalParent&&(this._get_DomNode().oOriginalParent=null);OwaEditor.Dom.Element.callBase(this,"_internalDispose")};var u=function(n){switch(n){case OwaEditor.Style.Unit.Pixels:case OwaEditor.Style.Unit.Percent:case OwaEditor.Style.Unit.Points:case OwaEditor.Style.Unit.Em:return n;break;default:throw n+" unknown unit type";}};var t=function(n){switch(n){case OwaEditor.Style.Overflow.Auto:case OwaEditor.Style.Overflow.Hidden:case OwaEditor.Style.Overflow.Scroll:case OwaEditor.Style.Overflow.Visible:case OwaEditor.Style.Overflow.Inherit:case OwaEditor.Style.Overflow.Default:return n;break;default:throw n+" unknown overflow type";}};OwaEditor.Dom.Element.prototype.get_Id=function(){return this._get_DomNode().id};OwaEditor.Dom.Element.prototype.set_Id=function(n){this._get_DomNode().id=n};OwaEditor.Dom.Element.prototype.set_Title=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+330+"]: argument "+"sValue"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+331+"]: argument "+"sValue"+" is not of type "+"String");while(0);this._get_DomNode().title=n};OwaEditor.Dom.Element.prototype.get_OffsetParent=function(){var n=this._get_DomNode().offsetParent;return OwaEditor.Dom.Node.wrapDomNode(n)};OwaEditor.Dom.Element.prototype.get_TextContent=function(){if(OwaEditor.Utility.isIE()&&OwaEditor.Utility.get_IEVersion()>=10){var n=this._get_DomNode().innerText;var t=new RegExp("\\r\\n([\\r\\n]+)","g");return n.replace(t,"$1")}else return OwaEditor.Utility.isChrome()||typeof this._get_DomNode().textContent=="undefined"?this._get_DomNode().innerText:String.NormalizeDomString(this._get_DomNode().textContent)};OwaEditor.Dom.Element.prototype.get_InnerHtml=function(){return this._get_DomNode().innerHTML};OwaEditor.Dom.Element.prototype.set_InnerHtml=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+419+"]: argument "+"sHTML"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+420+"]: argument "+"sHTML"+" is not of type "+"String");while(0);this._get_DomNode().innerHTML=n};OwaEditor.Dom.Element.prototype.set_InnerHtmlIEWorkaround=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+438+"]: argument "+"sHTML"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+439+"]: argument "+"sHTML"+" is not of type "+"String");while(0);if(!OwaEditor.Utility.isIE())throw"set_innerHtmlIEWorkaround is only supported for IE";var t=this.clone(1);t._get_DomNode().innerHTML=n;this.get_ParentElement().replaceChild(t,this)};OwaEditor.Dom.Element.prototype.get_OuterHtml=function(){if(typeof this._get_DomNode().outerHTML!="undefined")return this._get_DomNode().outerHTML;else{var t=this._get_DomNode().ownerDocument;var i=this._get_DomNode().cloneNode(!0);var n=t.createElement("div");t.documentElement.appendChild(n);n.appendChild(i);var r=n.innerHTML;OwaEditor.Dom.NonSingletonNode._removeDomNode(n,1);return r}};OwaEditor.Dom.Element.prototype.getDescendantById=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+494+"]: argument "+"sId"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+495+"]: argument "+"sId"+" is not of type "+"String");while(0);var i=this._get_DomNode().getElementsByTagName("*");var t=i[n];if(!OwaEditor.Utility.isArray(t)||t.tagName&&t.tagName=="SELECT"){if(t==null&&!OwaEditor.Utility.isIE())for(var r=0;r<i.length;r++)if(i[r].id==n){t=i[r];break}}else t=t[0];return OwaEditor.Dom.Node.wrapDomNode(t)};OwaEditor.Dom.Element.prototype.get_AllDecendantsEnumerator=function(){var n=this._get_DomNode().getElementsByTagName("*");return new OwaEditor.Dom.NodeEnumerator(n,OwaEditor.Dom.NonSingletonNode._isIgnorableNode)};OwaEditor.Dom.Element.prototype.getDescendantsByTagName=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+614+"]: argument "+"sTagName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+615+"]: argument "+"sTagName"+" is not of type "+"String");while(0);for(var i=[],r=this._get_DomNode().getElementsByTagName(n),t=0;t<r.length;t++)i.push(OwaEditor.Dom.Node.wrapDomNode(r[t]));return i};OwaEditor.Dom.Element.prototype.get_Enumerator=function(){return new OwaEditor.Dom.NodeEnumerator(this._get_DomNode().childNodes,OwaEditor.Dom.NonSingletonNode._isIgnorableNode)};OwaEditor.Dom.Element.prototype.forEachDescendant=function(n){for(var i=this._get_DomNode().getElementsByTagName("*"),t=0;t<i.length;t++){var r=i[t];if(!OwaEditor.Dom.NonSingletonNode._isIgnorableNode(r)&&n(OwaEditor.Dom.Node.wrapDomNode(r)))return}};OwaEditor.Dom.Element.prototype.clone=function(n){var t=this._wrapNode(this._get_DomNode().cloneNode(n));t._clearPropertiesForClone();n&&t.forEachDescendant(function(n){OwaEditor.Dom.Element.isInstance(n)&&n._clearPropertiesForClone()});return t};OwaEditor.Dom.Element.prototype.getChildrenSnapshot=function(){var n=[];this.forEachChild(function(t){n.push(t)});return n};OwaEditor.Dom.Element.prototype.insertAdjacentElement=function(n,t){var i=this._get_DomNode();var r=t._get_DomNode();if(t.get_NodeType()==OwaEditor.NodeType.Element&&typeof i.insertAdjacentElement!="undefined")i.insertAdjacentElement(n,r);else switch(n){case OwaEditor.ElementInsertionPoint.BeforeBegin:i.parentNode.insertBefore(r,i);break;case OwaEditor.ElementInsertionPoint.AfterBegin:i.insertBefore(r,i.firstChild);break;case OwaEditor.ElementInsertionPoint.BeforeEnd:i.appendChild(r);break;case OwaEditor.ElementInsertionPoint.AfterEnd:i.parentNode.insertBefore(r,i.nextSibling);break;default:throw n+" insertion point not supported";}return t};OwaEditor.Dom.Element.prototype.insertAdjacentHtml=function(n,t){var i=this._get_DomNode();if(typeof i.insertAdjacentHTML!="undefined")i.insertAdjacentHTML(n,t);else{var r=i.ownerDocument.createRange();i.tagName&&i.tagName==BODY_TAGNAME||r.setStartBefore(i);var u=r.createContextualFragment(t);var f=OwaEditor.Dom.Node.wrapDomNode(u);this.insertAdjacentElement(n,f)}};OwaEditor.Dom.Element.prototype.insertAdjacentText=function(n,t){var i=this._get_DomNode();var r=new OwaEditor.Dom.Element(i.ownerDocument.createTextNode(t));this.insertAdjacentElement(n,r)};function r(n,t){n=n.replace("\t"," ");if(t.length==0||n.length<t.length)return!1;else if(n==t)return!0;else if(n.startsWith(t+" "))return!0;else if(n.endsWith(" "+t))return!0;else if(n.contains(" "+t+" "))return!0;return!1}function i(n,t){var r=!1;n=n.replace("\t"," ");if(n==t)n="";else if(t.length!=0&&!(n.length<=t.length))if(n.startsWith(t+" ")){n=n.substr(t.length+1);r=!0}else if(n.endsWith(" "+t)){n=n.substr(0,n.length-(t.length+1));r=!0}else if(n.contains(" "+t+" ")){n=n.replace(" "+t+" "," ");r=!0}r&&(n=i(n,t));return n}OwaEditor.Dom.Element.prototype.get_CssClasses=function(){var t=this._get_DomNode().className;t=t.replace("\t"," ");for(var i=t.split(" "),r=[],n=0;n<i.length;n++)i[n]&&r.push(i[n]);return r};OwaEditor.Dom.Element.prototype.set_CssClasses=function(n){do if(n!==null&&n!==undefined&&Array.isInstance!=undefined&&!Array.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+990+"]: argument "+"rgClasses"+" is not of type "+"Array");while(0);var t="";n&&n.length&&(t=n.join(" "));this._get_DomNode().className=t};OwaEditor.Dom.Element.prototype.removeCssClass=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+1008+"]: argument "+"sCssClassName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+1009+"]: argument "+"sCssClassName"+" is not of type "+"String");while(0);var t=i(this._get_DomNode().className,n);t!=this._get_DomNode().className&&(this._get_DomNode().className=t)};OwaEditor.Dom.Element.prototype.addCssClass=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+1025+"]: argument "+"sCssClassName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+1026+"]: argument "+"sCssClassName"+" is not of type "+"String");while(0);this.hasCssClass(n)||(this._oDomNode.className=this._oDomNode.className.concat(" "+n))};OwaEditor.Dom.Element.prototype.replaceCssClass=function(n,t){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+1044+"]: argument "+"sCssClassName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+1045+"]: argument "+"sCssClassName"+" is not of type "+"String");while(0);do if(t==null||t===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+1046+"]: argument "+"sCssClassToReplace"+" can't be null or undefined");while(0);do if(t!==null&&t!==undefined&&String.isInstance!=undefined&&!String.isInstance(t))throw new Error("Assert fail ["+".\\dom/element.js"+":"+1047+"]: argument "+"sCssClassToReplace"+" is not of type "+"String");while(0);var f=this._get_DomNode().className;var u=i(f,t);if(u==f)throw"The CSS class to be replaced doesn't exist.";r(u,n)||(u=u.concat((u.length==0?"":" ")+n));u!=f&&(this._get_DomNode().className=u.trim())};OwaEditor.Dom.Element.prototype.hasCssClass=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+1077+"]: argument "+"sCssClassName"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+1078+"]: argument "+"sCssClassName"+" is not of type "+"String");while(0);return r(this._get_DomNode().className,n)};OwaEditor.Dom.Element.prototype.focus=function(n){var i=this._get_DomNode();function t(){try{i.focus()}catch(n){}}if(n)try{this.get_OwnerDocument().get_ContainerWindow().setTimeout(t,n)}catch(r){}else t()};OwaEditor.Dom.Element.prototype._getEffectivePadding=function(n,t){var i;switch(n){case OwaEditor.Style.Side.Top:i=this._getEffectiveStyle("padding-top","paddingTop");break;case OwaEditor.Style.Side.Right:i=this._getEffectiveStyle("padding-right","paddingRight");break;case OwaEditor.Style.Side.Bottom:i=this._getEffectiveStyle("padding-bottom","paddingBottom");break;case OwaEditor.Style.Side.Left:i=this._getEffectiveStyle("padding-left","paddingLeft");break;default:throw"INVALID_PROPERTY";}if(i.length==0)return 0;if(t&&!i.contains(OwaEditor.Style.Unit.Pixels))throw"Padding unit must be specified in pixels for getEffectivePadding()";return OwaEditor.Utility.IntFromSize(i,10)};OwaEditor.Dom.Element.prototype._getEffectiveBorderWidth=function(n,t){var i;switch(n){case OwaEditor.Style.Side.Top:i=this._getEffectiveStyle("border-top-width","borderTopWidth");break;case OwaEditor.Style.Side.Right:i=this._getEffectiveStyle("border-right-width","borderRightWidth");break;case OwaEditor.Style.Side.Bottom:i=this._getEffectiveStyle("border-bottom-width","borderBottomWidth");break;case OwaEditor.Style.Side.Left:i=this._getEffectiveStyle("border-left-width","borderLeftWidth");break;default:throw"INVALID_PROPERTY";}if(i.length==0)return 0;if(t&&!i.contains(OwaEditor.Style.Unit.Pixels))throw"Padding unit must be specified in pixels for getEffectiveBorderWidth()";return OwaEditor.Utility.IntFromSize(i)};OwaEditor.Dom.Element.prototype._getEffectiveMargin=function(n,t){var i;switch(n){case OwaEditor.Style.Side.Top:i=this._getEffectiveStyle("margin-top","marginTop");break;case OwaEditor.Style.Side.Right:i=this._getEffectiveStyle("margin-right","marginRight");break;case OwaEditor.Style.Side.Bottom:i=this._getEffectiveStyle("margin-bottom","marginBottom");break;case OwaEditor.Style.Side.Left:i=this._getEffectiveStyle("margin-left","marginLeft");break;default:throw"INVALID_PROPERTY";}if(i.length==0)return 0;if(t&&!i.contains(OwaEditor.Style.Unit.Pixels))throw"Padding unit must be specified in pixels for getEffectiveMargin()";return OwaEditor.Utility.IntFromSize(i)};OwaEditor.Dom.Element.prototype.get_OffsetHeight=function(){return this._oDomNode.offsetHeight};OwaEditor.Dom.Element.prototype.get_OffsetWidth=function(){return this._oDomNode.offsetWidth};OwaEditor.Dom.Element.prototype._get_OffsetLeft=function(){if(this.get_OwnerDocument().get_IsRtl()){var n=this.get_OffsetParent();if(n){var t=n.get_ScrollWidth()-n.get_ClientWidth();if(t>0)return this._get_DomNode().offsetLeft+t}}return this._get_DomNode().offsetLeft};OwaEditor.Dom.Element.prototype.get_OffsetTop=function(){return this._get_DomNode().offsetTop};OwaEditor.Dom.Element.prototype.get_ClientWidth=function(){var n=this._oDomNode.clientWidth;n=this._oDomNode.clientWidth;if(n==0&&OwaEditor.Utility.isIE()&&!this._oDomNode.hasLayout){this._oDomNode.style.zoom="1.0";n=this._oDomNode.clientWidth}return n};OwaEditor.Dom.Element.prototype.get_ClientHeight=function(){var n=this._oDomNode.clientHeight;if(n==0&&OwaEditor.Utility.isIE()&&!this._oDomNode.hasLayout){this._oDomNode.style.zoom="1.0";n=this._oDomNode.clientHeight}return n};OwaEditor.Dom.Element.prototype.get_ScrollWidth=function(){var n=this._oDomNode.scrollWidth;n=this._oDomNode.scrollWidth;if(OwaEditor.Utility.isFirefox()||OwaEditor.Utility.isSafari()){var t=this._getEffectiveBorderWidth(OwaEditor.Style.Side.Left,!1)+this._getEffectiveBorderWidth(OwaEditor.Style.Side.Right,!1);this._oDomNode.clientWidth+t==this._oDomNode.offsetWidth&&this._oDomNode.scrollWidth==this._oDomNode.offsetWidth&&(n=this._oDomNode.clientWidth)}return n};OwaEditor.Dom.Element.prototype.get_ScrollHeight=function(){return this._oDomNode.scrollHeight};OwaEditor.Dom.Element.prototype.set_Width=function(n,t){this._setStyleValue("width",n,t)};OwaEditor.Dom.Element.prototype.set_Height=function(n,t){this._setStyleValue("height",n,t)};OwaEditor.Dom.Element.prototype.set_Top=function(n,t){this._setStyleValue("top",n,t)};OwaEditor.Dom.Element.prototype.set_Left=function(n,t){this._setStyleValue("left",n,t)};OwaEditor.Dom.Element.prototype.get_FontSize=function(){var n=this._oDomNode.style.fontSize;return n.length>2?n:null};OwaEditor.Dom.Element.prototype._setStyleValue=function(n,t,i){if(t===null)this._oDomNode.style[n]="";else{i||(i=OwaEditor.Style.Unit.Pixels);this._oDomNode.style[n]=t+u(i)}};OwaEditor.Dom.Element.prototype.get_ScrollLeft=function(){return OwaEditor.Utility.isFirefox()&&this.get_OwnerDocument().get_IsRtl()?this.get_ScrollWidth()-this.get_ClientWidth()+this._get_DomNode().scrollLeft:this._get_DomNode().scrollLeft};OwaEditor.Dom.Element.prototype.get_ScrollTop=function(){return this._get_DomNode().scrollTop};OwaEditor.Dom.Element.prototype.set_ScrollTop=function(n){this._get_DomNode().scrollTop=n};OwaEditor.Dom.Element.prototype.get_OverflowX=function(){var n=this._getEffectiveStyle("overflow-x","overflowX");n==OwaEditor.Style.Overflow.Default&&(n=this._getEffectiveStyle("overflow","overflow"));return t(n)};OwaEditor.Dom.Element.prototype.get_OverflowY=function(){var n=this._getEffectiveStyle("overflow-y","overflowY");n==OwaEditor.Style.Overflow.Default&&(n=this._getEffectiveStyle("overflow","overflow"));return t(n)};OwaEditor.Dom.Element.prototype.set_OverflowY=function(n){this._oDomNode.style.overflowY=t(n)};OwaEditor.Dom.Element.prototype.get_IsShown=function(){var t=this._getEffectiveStyle("display","display");return n.None!=t};OwaEditor.Dom.Element.prototype.set_IsShown=function(t){this._oDomNode.style.display=t?n.Default:n.None};OwaEditor.Dom.Element.prototype.isPositionalElement=function(){var n=this._getEffectiveStyle("position","position").toLowerCase();return n==""||n=="static"?!1:!0};OwaEditor.Dom.Element.prototype.get_PositionalParent=function(){for(var n=this.get_OffsetParent();n&&!n.isPositionalElement();)n=n.get_OffsetParent();n==null&&(n=this.get_OwnerDocument()._get_DomNode().body.parentNode?new OwaEditor.Dom.Element(this.get_OwnerDocument()._get_DomNode().body.parentNode):null);return n};OwaEditor.Dom.Element.prototype.get_PositionalTop=function(){for(var t=this.get_OffsetTop(),n=this.get_OffsetParent();n&&!n.isPositionalElement();){n.get_OffsetParent()!=null&&(t+=n.get_OffsetTop());n=n.get_OffsetParent()}if(n==null){var i=this.get_OwnerDocument();var u=i.get_Body();var r=i.get_DocumentElement();t+=u._getEffectiveMargin(OwaEditor.Style.Side.Top);t+=r._getEffectivePadding(OwaEditor.Style.Side.Top);t+=r._getEffectiveBorderWidth(OwaEditor.Style.Side.Top)}return t};OwaEditor.Dom.Element.prototype.get_DocumentTop=function(){for(var t=this.get_OffsetTop(),n=this.get_OffsetParent();n;){var i=n.get_TagName();if(i==BODY_TAGNAME||i=="HTML")break;t+=n.get_OffsetTop()+n._get_DomNode().clientTop;t-=n.get_ScrollTop();n=n.get_OffsetParent()}var r=this.get_OwnerDocument();var f=r.get_Body();var u=r.get_DocumentElement();t+=f._getEffectiveMargin(OwaEditor.Style.Side.Top);t+=u._getEffectivePadding(OwaEditor.Style.Side.Top);t+=u._getEffectiveBorderWidth(OwaEditor.Style.Side.Top);return t};OwaEditor.Dom.Element.prototype.get_DocumentLeft=function(){for(var n=this._get_OffsetLeft(),t=this.get_OffsetParent();t;){n+=t._get_OffsetLeft()+t._get_DomNode().clientLeft;n-=t.get_ScrollLeft();t=t.get_OffsetParent()}var i=this.get_OwnerDocument();var u=i.get_Body();var r=i.get_DocumentElement();n+=u._getEffectiveMargin(OwaEditor.Style.Side.Left);n+=r._getEffectivePadding(OwaEditor.Style.Side.Left);n+=r._getEffectiveBorderWidth(OwaEditor.Style.Side.Left);return n};OwaEditor.Dom.Element.prototype.get_RelativeTop=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+2208+"]: argument "+"oRelativeElement"+" can't be null or undefined");while(0);return this.get_DocumentTop()-n.get_DocumentTop()};OwaEditor.Dom.Element.prototype.get_RelativeLeft=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+2219+"]: argument "+"oRelativeElement"+" can't be null or undefined");while(0);return this.get_DocumentLeft()-n.get_DocumentLeft()};OwaEditor.Dom.Element.prototype.set_PositionalLeft=function(n){var t=this.get_PositionalParent();var i=this.get_OffsetParent();var r=i.get_RelativeLeft(t);this.set_Left(n-r,OwaEditor.Style.Unit.Pixels)};OwaEditor.Dom.Element.prototype.set_PositionalTop=function(n){var t=this.get_PositionalParent();var i=this.get_OffsetParent();var r=i.get_RelativeTop(t);this.set_Top(n-r,OwaEditor.Style.Unit.Pixels)};OwaEditor.Dom.Element.prototype.set_PositionalParent=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/element.js"+":"+2257+"]: argument "+"oNewParent"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&OwaEditor.Dom.Element.isInstance!=undefined&&!OwaEditor.Dom.Element.isInstance(n))throw new Error("Assert fail ["+".\\dom/element.js"+":"+2258+"]: argument "+"oNewParent"+" is not of type "+"OwaEditor.Dom.Element");while(0);if(this._get_DomNode().oOriginalParent)throw"This element has already been reparented.";this.setExpando("_originalParent",this.get_ParentElement());this.setExpando("_originalOffsetX",this._get_OffsetLeft());this.setExpando("_originalOffsetY",this.get_OffsetTop());this._get_DomNode().oOriginalParent=this._get_DomNode().parentNode;this._get_DomNode().iOriginalY=this.get_OffsetTop();this._get_DomNode().iOriginalX=this._get_OffsetLeft();n.insertAdjacentElement(OwaEditor.ElementInsertionPoint.AfterBegin,this)};OwaEditor.Dom.Element.prototype.moveToTop=function(){for(var f=this._get_DomNode(),r=this._get_DomNode().parentNode,t=0,i=0;i<r.childNodes.length;i++){var u=r.childNodes[i];if(u.nodeType==OwaEditor.NodeType.Element){var n=getInt(OwaEditor.Dom.Node.wrapDomNode(u)._getEffectiveStyle("z-index","zIndex"));n=isNaN(n)?0:n;n>t&&(t=n)}}f.style.zIndex=t+1};var f=!!window.getComputedStyle;OwaEditor.Dom.Element.prototype._getEffectiveStyle=function(t,i){var r;if(f){var u=typeof this._oDomNode.ownerDocument.defaultView!="undefined"?this._oDomNode.ownerDocument.defaultView:this._oDomNode.ownerDocument.parentWindow;if(OwaEditor.Utility.isFirefox()&&u.getComputedStyle(this._oDomNode,"")==null)if(t.toLowerCase()=="display"){r=this._oDomNode.style.display;(r==null||r=="")&&(r=n.None)}else throw"Trying to compute "+t+', but the style object is null. Is the element "\'display: none"?';else r=u.getComputedStyle(this._oDomNode,"").getPropertyValue(t)}else this._oDomNode.currentStyle&&(r=this._oDomNode.currentStyle[i]);return r===undefined?"":r};OwaEditor.Dom.Element.createClass("OwaEditor.Dom.Element",OwaEditor.Dom.ElementBase,OwaEditor.Collections.IEnumerable)}();g_fModuleLoaded[".\\dom/element.js".toLowerCase()]=1;Type.createNamespace("OwaEditor.Components.CssSprites");g_fModuleLoaded[".\\components/csssprites.js".toLowerCase()]||function(){function n(n){return"image-"+n.replace(".","-")}function t(t){return"csimg btnimg "+n(t)}OwaEditor.Components.CssSprites.getImageMarkup=function(n,i,r,u){var e=u?u:getRsrcF;var f;f='<img src="';f+=e("clear1x1.gif");f+='" class="';n!="clear1x1.gif"&&(f+=t(n));if(r){f+=" ";f+=r}f+='" ';i&&(f+=i);f+=">";return f};OwaEditor.Components.CssSprites.updateImage=function(i,r){i.get_CssClasses||(i=OwaEditor.Dom.Node.wrapDomNode(i));for(var e=i.get_CssClasses(),u=null,f=0;f<e.length;f++)if(e[f].startsWith("image-")){u=e[f];break}if(r=="clear1x1.gif"){if(u){i.removeCssClass("csimg btnimg");i.removeCssClass(u)}}else u?i.replaceCssClass(n(r),u):i.addCssClass(t(r))}}();g_fModuleLoaded[".\\components/csssprites.js".toLowerCase()]=1;var UniqueIdGenerator;var UniqueIdHashSet;g_fModuleLoaded[".\\core/UniqueId.js".toLowerCase()]||function(){var i=1e9;var n=null;var t=null;UniqueIdGenerator=function(){this._sTick=(new Date).getTime();this._sSeed=Math.round(Math.random()*i)};UniqueIdGenerator.get_Instance=function(){n||(n=new UniqueIdGenerator);return n};UniqueIdGenerator.prototype.get_Next=function(){var n="_"+this._sTick+"_"+this._sSeed;this._sSeed+=Math.round(Math.random()*10)+1;return n};UniqueIdGenerator.createClass("UniqueIdGenerator");UniqueIdHashSet=function(){this._oObjectHashSet={}};UniqueIdHashSet.get_Instance=function(){t||(t=new UniqueIdHashSet);return t};UniqueIdHashSet.prototype.put=function(n,t){this._oObjectHashSet[n]=t};UniqueIdHashSet.prototype.get=function(n){return this._oObjectHashSet[n]};UniqueIdHashSet.prototype.remove=function(n){delete this._oObjectHashSet[n]};UniqueIdHashSet.prototype.clear=function(){this._oObjectHashSet={}};UniqueIdHashSet.createClass("UniqueIdHashSet")}();g_fModuleLoaded[".\\core/UniqueId.js".toLowerCase()]=1;Type.createNamespace("OwaEditor.Components");g_fModuleLoaded[".\\components/control.js".toLowerCase()]||function(){OwaEditor.Components.Control=function(){this._oResourceSet={};this.__fDisposed=!1;this.__fInitialized=!1;if(this._fSupportUniqueId){this._sUniqueId=UniqueIdGenerator.get_Instance().get_Next();UniqueIdHashSet.get_Instance().put(this._sUniqueId,this)}if(this._fClearTimeoutCallbackInDisposing){this._oTimeoutCallbackHashtable={};this._oIntervalCallbackHashtable={}}this._oEvents=null};var n=OwaEditor.Components.Control.prototype;n._fSupportUniqueId=!1;n._fClearTimeoutCallbackInDisposing=!1;n.initialize=function(){do if(!!this.__fInitialized)throw new Error("Assert fail ["+".\\components/control.js"+":"+71+"]: "+"Can't initialize object["+this.constructor.__sTypeName+"] twice");while(0);do if(!!this.__fDisposed)throw new Error("Assert fail ["+".\\components/control.js"+":"+72+"]: "+"Can't initialize object["+this.constructor.__sTypeName+"] which was already disposed");while(0);this.__fInitialized=!0};n.get_IsInitialized=function(){return this.__fInitialized};n.dispose=function(){do if(!!this.__fDisposed)throw new Error("Assert fail ["+".\\components/control.js"+":"+92+"]: "+"Can't dispose object["+this.constructor.__sTypeName+"] twice");while(0);if(OwaEditor.Components.Application.get_ShouldExplicitDisposeResource()){this._disposeAllResources();this._clearEventCollections()}this._fSupportUniqueId&&UniqueIdHashSet.get_Instance().remove(this._sUniqueId);this.__oResourceManager&&this.__oResourceManager.removeResource(this);if(this._fClearTimeoutCallbackInDisposing){var n=OwaEditor.Dom.Window.get_Current();for(var t in this._oTimeoutCallbackHashtable)n.clearTimeout(parseInt(t));for(var t in this._oIntervalCallbackHashtable)n.clearInterval(parseInt(t));this._fClearTimeoutCallbackInDisposing=null}this.__fDisposed=!0};n.get_IsDisposed=function(){return this.__fDisposed};n.get_UniqueId=function(){do if(!this._fSupportUniqueId)throw new Error("Assert fail ["+".\\components/control.js"+":"+164+"]: "+"Can't use get_UniqueId on an object["+this.constructor.__sTypeName+"] which doesn't support it!");while(0);return this._sUniqueId};n.getResourceManager=function(){return this.__oResourceManager};n.addResource=function(n){if(n){n.__oResourceManager&&n.__oResourceManager.removeResource(n);do if(!n.get_UniqueId)throw new Error("Assert fail ["+".\\components/control.js"+":"+195+"]: "+"Can't add a resouce which doesn't support unique Id");while(0);this._oResourceSet[n.get_UniqueId()]=n;n.__oResourceManager=this;return n}};n.removeResource=function(n){do if(!(n.__oResourceManager==this))throw new Error("Assert fail ["+".\\components/control.js"+":"+208+"]: "+"Can't remove a resource which isn't managed by this object");while(0);delete this._oResourceSet[n.get_UniqueId()];n.__oResourceManager=null;return n};n._clearEventCollections=function(){if(this._oEvents){for(var n in this._oEvents)this._oEvents[n].clear();this._oEvents=null}};n._disposeAllResources=function(){for(var n in this._oResourceSet)this._oResourceSet[n].__fDisposed||this._oResourceSet[n].dispose();this._oResourceSet={}};n._createCallback=function(n,t){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\components/control.js"+":"+267+"]: argument "+"fnFunction"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(n))throw new Error("Assert fail ["+".\\components/control.js"+":"+268+"]: argument "+"fnFunction"+" is not of type "+"Function");while(0);var i=function(){if(!this.get_IsDisposed())return n.apply(this,arguments)};return OwaEditor.Utility.createArgumentContextDelegate(this,i,t,n)};n._setTimeout=function(n,t,i){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\components/control.js"+":"+293+"]: argument "+"fnFunction"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(n))throw new Error("Assert fail ["+".\\components/control.js"+":"+294+"]: argument "+"fnFunction"+" is not of type "+"Function");while(0);if(this._fClearTimeoutCallbackInDisposing){var r={};var f=OwaEditor.Utility.createContextDelegate(this,n,i);var u=OwaEditor.Dom.Window.get_Current().setTimeout(OwaEditor.Utility.createContextDelegate(this,this._timeoutCallback,r),t);r.fnCallback=f;r.iId=u;r.fIsInterval=!1;this._oTimeoutCallbackHashtable[u]=!0;return u}else return OwaEditor.Dom.Window.get_Current().setTimeout(OwaEditor.Utility.createContextDelegate(this,n,i),t)};n._timeoutCallback=function(n){var t=n.iId;var i=n.fnCallback;n.fIsInterval||delete this._oTimeoutCallbackHashtable[t];this.get_IsDisposed()||i()};n.stTmout=function(n,t){for(var r=[],i=2;i<arguments.length;i++)r.push(arguments[i]);var u=this;var f=function(){u[n].apply(u,r)};return OwaEditor.Dom.Window.get_Current().setTimeout(f,t)};n._clearTimeout=function(n){this._fClearTimeoutCallbackInDisposing&&delete this._oTimeoutCallbackHashtable[n];OwaEditor.Dom.Window.get_Current().clearTimeout(n)};n._setInterval=function(n,t,i){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\components/control.js"+":"+387+"]: argument "+"fnFunction"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(n))throw new Error("Assert fail ["+".\\components/control.js"+":"+388+"]: argument "+"fnFunction"+" is not of type "+"Function");while(0);if(this._fClearTimeoutCallbackInDisposing){var r={};var f=OwaEditor.Utility.createContextDelegate(this,n,i);var u=OwaEditor.Dom.Window.get_Current().setInterval(OwaEditor.Utility.createContextDelegate(this,this._timeoutCallback,r),t);r.fnCallback=f;r.iId=u;r.fIsInterval=!0;this._oIntervalCallbackHashtable[u]=!0;return u}else return OwaEditor.Dom.Window.get_Current().setInterval(OwaEditor.Utility.createContextDelegate(this,n,i),t)};n._clearInterval=function(n){this._fClearTimeoutCallbackInDisposing&&delete this._oIntervalCallbackHashtable[n];OwaEditor.Dom.Window.get_Current().clearInterval(n)};n._getEventHandlerCollection=function(n){this._oEvents||(this._oEvents={});this._oEvents[n]||(this._oEvents[n]=new OwaEditor.Utility.EventHandlerCollection);return this._oEvents[n]};n._dispatchEvent=function(n,t,i){if(this._oEvents&&this._oEvents[n])return this._oEvents[n].dispatch(t,i)};OwaEditor.Components.Control.createClass("OwaEditor.Components.Control")}();g_fModuleLoaded[".\\components/control.js".toLowerCase()]=1;g_fModuleLoaded[".\\uicontrols/uicontrolbase.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.UIControls");var t=function(n,t,i){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\uicontrols/uicontrolbase.js"+":"+24+"]: argument "+"oElement"+" can't be null or undefined");while(0);do if(t==null||t===undefined)throw new Error("Assert fail ["+".\\uicontrols/uicontrolbase.js"+":"+25+"]: argument "+"sEventName"+" can't be null or undefined");while(0);do if(i==null||i===undefined)throw new Error("Assert fail ["+".\\uicontrols/uicontrolbase.js"+":"+26+"]: argument "+"oDelegate"+" can't be null or undefined");while(0);this._oElement=n;this._sEventName=t;this._oDelegate=i};t.prototype.equals=function(n){return!!n&&this._oElement===n._oElement&&this._sEventName===n._sEventName&&(this._oDelegate===n._oDelegate||this._oDelegate.equals&&this._oDelegate.equals(n._oDelegate))};OwaEditor.UIControls.UIControlBase=function(n,t){n&&this._initializeDomElement(n,t);this._oAttachedEventHandler=new OwaEditor.Collection.Set;OwaEditor.UIControls.UIControlBase.constructBase(this)};var n=OwaEditor.UIControls.UIControlBase.prototype;n._fRemoveElementInDisposing=!1;n._fDetachEventHandlersInDisposing=!0;n._fSupportUniqueId=!0;n._fClearTimeoutCallbackInDisposing=!0;n._fIsFirstShow=!0;n._fPendingResize=!1;n.set_RemoveElementInDisposing=function(n){this._fRemoveElementInDisposing=n};n.initialize=function(n){OwaEditor.UIControls.UIControlBase.callBase(this,"initialize")};n.dispose=function(){this._fDetachEventHandlersInDisposing&&this._detachAllEventHanders();this._oElement&&this._oElement.dispose();if(this.get_IsDomElementLoaded()){this._get_Element().dispose();this._fRemoveElementInDisposing&&this._get_Element().remove(!0)}this.get_SizeChanged().clear();this.get_IsVisibleChanged().clear();this.get_FirstShow().clear();this._oElement=null;this._oParent=null;OwaEditor.UIControls.UIControlBase.callBase(this,"dispose")};n._detachAllEventHanders=function(){for(var i=this._oAttachedEventHandler.toArray(),n=0;n<i.length;n++){var t=i[n];var r=t._oElement;var u=t._sEventName;var f=t._oDelegate;r.detachEvent(u,f)}this._oAttachedEventHandler.clear()};n.get_Id=function(){return this._sId};n.get_IsShown=function(){return this.get_IsDomElementLoaded()?this._get_Element().get_IsShown():!1};n.get_IsDomElementLoaded=function(){do if(!!this.__fDisposed)throw new Error("Assert fail ["+".\\uicontrols/uicontrolbase.js"+":"+181+"]: "+"Object["+this.constructor.__sTypeName+"] has been disposed");while(0);return this._get_Element()!=null};n._initializeDomElement=function(n,t){this._oElement=n;this._oParent=t;n.get_Id()&&(this._sId=n.get_Id())};n._get_Parent=function(){return this._oParent};n._get_Element=function(){do if(!!this.__fDisposed)throw new Error("Assert fail ["+".\\uicontrols/uicontrolbase.js"+":"+214+"]: "+"Object["+this.constructor.__sTypeName+"] has been disposed");while(0);return this._oElement};n._getDescendantByClassName=function(n){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";for(var i=this._get_Element().getDescendantsByTagName(n),t=0;t<i.length;t++)if(i[t].hasCssClass(n))return i[t];return null};n._getDescendant=function(n){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";return this._get_Element().getDescendantById(n)};n._getAttribute=function(n){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";return this._get_Element().getAttribute(n)};n._getIntAttribute=function(n){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";return this._get_Element().getIntAttribute(n)};n._setIntAttribute=function(n,t){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";this._get_Element().setIntAttribute(n,t)};n._attachEvent=function(n,i,r,u){var f=OwaEditor.Utility.createArgumentContextDelegate(this,r,u);n.attachEvent(i,f);this._oAttachedEventHandler.add(new t(n,i,f));return r};n._detachEvent=function(n,i,r){var u=OwaEditor.Utility.createArgumentContextDelegate(this,r);n.detachEvent(i,u);this._oAttachedEventHandler.remove(new t(n,i,u))};n._cancelBubbleEvent=function(n,t){this._attachEvent(n,t,e)};n._cancelEvent=function(n,t){this._attachEvent(n,t,f)};n.onFirstShow=function(){};n.onIsVisibleChanged=function(n){};n.onResize=function(){};var i="FirstShow";var r="IsVisibleChanged";var u="SizeChanged";n.get_FirstShow=function(){return this._getEventHandlerCollection(i)};n.get_IsVisibleChanged=function(){return this._getEventHandlerCollection(r)};n.get_SizeChanged=function(){return this._getEventHandlerCollection(u)};function f(n){n.preventDefault();n.cancelBubble()}function e(n){n.cancelBubble()}OwaEditor.UIControls.UIControlBase.createClass("OwaEditor.UIControls.UIControlBase",OwaEditor.Components.Control)}();g_fModuleLoaded[".\\uicontrols/uicontrolbase.js".toLowerCase()]=1;g_fModuleLoaded[".\\uicontrols/uicontrol.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.UIControls");OwaEditor.UIControls.UIControl=function(n,t){OwaEditor.UIControls.UIControl.constructBase(this,[n,t]);this._oSubPage?this._oSubPage.addResource(this):!OwaEditor.Components.Application||OwaEditor.Components.Application.get_GlobalResourceManager().addResource(this)};var n=OwaEditor.UIControls.UIControl.prototype;OwaEditor.UIControls.UIControl.prototype.set_SubPage=function(n){do if(!!this._oSubPage)throw new Error("Assert fail ["+".\\uicontrols/uicontrol.js"+":"+46+"]: "+"Can't set owner page twice");while(0);this._oSubPage=n;this._oSubPage&&this.getResourceManager()==OwaEditor.Components.Application.get_GlobalResourceManager()&&this._oSubPage.addResource(this)};OwaEditor.UIControls.UIControl.prototype.get_SubPage=function(){do if(!!this.__fDisposed)throw new Error("Assert fail ["+".\\uicontrols/uicontrol.js"+":"+61+"]: "+"Object has been disposed ["+this.constructor.__sTypeName+"]");while(0);if(!this._oSubPage){var n=OwaEditor.UIControls.SubPage&&OwaEditor.UIControls.SubPage.get_Instance();do if(!(!n||!n._fSupportHostedInSubPage))throw new Error("Assert fail ["+".\\uicontrols/uicontrol.js"+":"+67+"]: "+"A control which lives in a single doc environment must assign page object explicitly");while(0);this._oSubPage=n}return this._oSubPage};OwaEditor.UIControls.UIControl.prototype.dispose=function(){this._oSubPage=null;OwaEditor.UIControls.UIControl.callBase(this,"dispose")};n.setSubPageVariable=function(n,t){return this.get_SubPage().setSubPageVariable(n,t)};n.getSubPageVariable=function(n){return this.get_SubPage().getSubPageVariable(n)};OwaEditor.UIControls.UIControl.createClass("OwaEditor.UIControls.UIControl",OwaEditor.UIControls.UIControlBase)}();g_fModuleLoaded[".\\uicontrols/uicontrol.js".toLowerCase()]=1;g_fModuleLoaded[".\\dom/input.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.Dom");OwaEditor.Dom.Input=function(n){if(!n)throw"the DOM element is null";OwaEditor.Dom.Input.constructBase(this,[n])};OwaEditor.Dom.Input.Type={Button:"button",Checkbox:"checkbox",File:"file",Hidden:"hidden",Radio:"radio",SelectOne:"select-one",Text:"text",Textarea:"textarea",ButtonTag:"buttonTag",Password:"password"};OwaEditor.Dom.Input.prototype.get_Type=function(){return this.get_TagName().toLowerCase()=="button"?OwaEditor.Dom.Input.Type.ButtonTag:this.get_TagName().toLowerCase()=="textarea"?OwaEditor.Dom.Input.Type.Textarea:this._get_DomNode().type};OwaEditor.Dom.Input.prototype.set_Type=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/input.js"+":"+71+"]: argument "+"sInputType"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/input.js"+":"+72+"]: argument "+"sInputType"+" is not of type "+"String");while(0);this._get_DomNode().type=n};OwaEditor.Dom.Input.prototype.get_IsChecked=function(){n(this);return this._get_DomNode().checked};OwaEditor.Dom.Input.prototype.set_IsChecked=function(t){do if(t==null||t===undefined)throw new Error("Assert fail ["+".\\dom/input.js"+":"+99+"]: argument "+"fChecked"+" can't be null or undefined");while(0);n(this);this._get_DomNode().checked=t};OwaEditor.Dom.Input.prototype.get_IsDisabled=function(){return this._get_DomNode().disabled};OwaEditor.Dom.Input.prototype.set_IsDisabled=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/input.js"+":"+151+"]: argument "+"fDisabled"+" can't be null or undefined");while(0);this._get_DomNode().disabled=n};OwaEditor.Dom.Input.prototype.get_Value=function(){t(this);return this._get_DomNode().value};OwaEditor.Dom.Input.prototype.set_Value=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\dom/input.js"+":"+172+"]: argument "+"sValue"+" can't be null or undefined");while(0);do if(n!==null&&n!==undefined&&String.isInstance!=undefined&&!String.isInstance(n))throw new Error("Assert fail ["+".\\dom/input.js"+":"+173+"]: argument "+"sValue"+" is not of type "+"String");while(0);t(this);this._get_DomNode().value=n};function n(n){var t=n.get_Type();if(t!=OwaEditor.Dom.Input.Type.Checkbox&&t!=OwaEditor.Dom.Input.Type.Radio)throw new Error('Property "checked" is not supported for inputs of type: '+t);}function t(n){var t=n.get_Type();if(t!=OwaEditor.Dom.Input.Type.Text&&t!=OwaEditor.Dom.Input.Type.Textarea&&t!=OwaEditor.Dom.Input.Type.SelectOne&&t!=OwaEditor.Dom.Input.Type.Password&&t!=OwaEditor.Dom.Input.Type.Radio)throw new Error('Property "value" is not supported for inputs of type: '+t);}OwaEditor.Dom.Input.createClass("OwaEditor.Dom.Input",OwaEditor.Dom.Element)}();g_fModuleLoaded[".\\dom/input.js".toLowerCase()]=1;var UITest_Popup_Flag=2;g_fModuleLoaded[".\\uicontrols/popup.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.UIControls");var i="onDataBind";var r="onPreShow";var u="onClose";var n=null;OwaEditor.UIControls.Popup=function(n,t,i){OwaEditor.UIControls.Popup.constructBase(this,[n,t]);this.fIsOpen=0;this._fIsInitialized=0;this._fSuppressClose=0;this._fAutomaticEnableClose=1;this._fDisableOffscreenBox=i;t&&OwaEditor.UIControls.Popup.isInstance(t)&&(this._oParentPopup=t);this._fIsReparented=this._reparentPopup()};OwaEditor.UIControls.Popup.prototype._reparentPopup=function(){if(!this._get_Element())return!1;var n=this._get_Container();if(n)this._get_Element().set_PositionalParent(n);else{var t=this._get_Element().get_OwnerDocument();this._get_Element().set_PositionalParent(t.get_Body())}return!0};OwaEditor.UIControls.Popup.prototype.initialize=function(){n||e();this._attachEvent(this._get_Element(),"mousedown",this._onMouseDown);this._attachEvent(this._get_Element(),"selectstart",this._onSelectStart);this._attachEvent(this._get_Element(),"click",this._forwardEvent);this._fIsReparented||(this._fIsReparented=this._reparentPopup());this._fIsInitialized=1};OwaEditor.UIControls.Popup.prototype._get_Container=function(){for(var n=this._get_Element().get_ParentElement();n;)if(OwaEditor.Dom.Element.isInstance(n)&&(n.get_OverflowX()==OwaEditor.Style.Overflow.Scroll||n.get_OverflowX()==OwaEditor.Style.Overflow.Auto||n.get_OverflowY()==OwaEditor.Style.Overflow.Scroll||n.get_OverflowY()==OwaEditor.Style.Overflow.Auto||n.get_TagName()==BODY_TAGNAME))break;else n=n.get_ParentElement();return n};OwaEditor.UIControls.Popup.prototype.get_IsInitialized=function(){return this._fIsInitialized};OwaEditor.UIControls.Popup.prototype.dispose=function(){this.fIsOpen&&this.close();if(this.get_IsDomElementLoaded()){this._get_Element()._get_DomNode().oOriginalParent=null;this._get_Element().dispose()}OwaEditor.UIControls.Popup.callBase(this,"dispose")};OwaEditor.UIControls.Popup.prototype.get_OnDataBind=function(){return this._getEventHandlerCollection(i)};OwaEditor.UIControls.Popup.prototype.get_OnPreShow=function(){return this._getEventHandlerCollection(r)};OwaEditor.UIControls.Popup.prototype.get_OnClose=function(){return this._getEventHandlerCollection(u)};OwaEditor.UIControls.Popup.prototype.showRelative=function(n,t,i){var u=this._get_Element().getExpando("_originalParent");n+=u.get_DocumentLeft()+(g_fRtl?u.get_OffsetWidth():0);if(i&&i.get_OffsetY()){for(var o=this._get_Element().get_OffsetHeight(),e=i.get_ClientY(),f=0,r=i.get_Target();u&&r&&u._get_DomNode()!=r._get_DomNode();){r.get_TagName()==IMG_TAGNAME&&(f+=r.get_OffsetTop());r=r.get_OffsetParent()}t=e+(t-i.get_OffsetY()-f)}else t+=u.get_DocumentTop();this.show(n,t)};OwaEditor.UIControls.Popup.prototype.get_Width=function(){var n=this._get_Element();var t;if(n.get_IsShown())t=n.get_OffsetWidth();else{n.set_IsShown(!0);t=n.get_OffsetWidth();n.set_IsShown(!1)}return t};OwaEditor.UIControls.Popup.prototype.showUnder=function(n,t,i){var r=!g_fRtl&&i||g_fRtl&&!i;var u=n.get_DocumentLeft()+(r?n.get_OffsetWidth():0);var f=n.get_DocumentTop()+n.get_OffsetHeight()+(t||0);this.show(u,f,i)};OwaEditor.UIControls.Popup.prototype.show=function(n,t,r){this._dispatchEvent(i,this);var u={};u.iX=n;u.iY=t;u.fFarCorner=!!r;var f=this._get_Element().get_ParentElement();if(f){u.iY=u.iY-f.get_DocumentTop()+f.get_ScrollTop();u.iX=u.iX-f.get_DocumentLeft()+f.get_ScrollLeft()}UITest_Popup_Flag=1;this._iTShowTimer=this._setTimeout(this._tShow,1,u)};OwaEditor.UIControls.Popup.prototype._fireOnPreShow=function(){this._dispatchEvent(r,this)};OwaEditor.UIControls.Popup.prototype._tShow=function(n){this._iTShowTimer=0;var t=this._get_Element();t.set_IsShown(1);this.fIsOpen=1;this._fireOnPreShow();t.moveToTop();var i=n.fFarCorner^g_fRtl?n.iX-t.get_OffsetWidth():n.iX;var r=n.iY;t.set_PositionalLeft(OwaEditor.Utility.getVisiblePositionX(t,i,g_fRtl));t.set_PositionalTop(OwaEditor.Utility.getVisiblePositionY(t,r));this._addTextBoxEventHandlers();this._enableClose();this.fIsOpen&&this._attachEvent(OwaEditor.Dom.Window.get_Current(),"resize",this.close);UITest_Popup_Flag=2};OwaEditor.UIControls.Popup.prototype.close=function(){if(this._iTShowTimer){this._clearTimeout(this._iTShowTimer);this._iTShowTimer=0;UITest_Popup_Flag=2}if(this.fIsOpen){this._get_Element().set_IsShown(0);this.fIsOpen=0;this._removeTextBoxEventHandlers();this._detachEvent(OwaEditor.Dom.Window.get_Current(),"resize",this.close);this._dispatchEvent(u,this)}};OwaEditor.UIControls.Popup.prototype._suppressClose=function(n){this._fSuppressClose=1;this._fAutomaticEnableClose=this._fAutomaticEnableClose&&n;this._oParentPopup&&this._oParentPopup._suppressClose(n)};OwaEditor.UIControls.Popup.prototype._enableClose=function(){this._fSuppressClose=0;this._fAutomaticEnableClose=1;this._fDisableOffscreenBox||o()};OwaEditor.UIControls.Popup.prototype._onBlurTextBox=function(){this._closeOnBlur();f()};OwaEditor.UIControls.Popup.prototype._closeOnBlur=function(){this.fIsOpen&&!this._fSuppressClose&&this.close();this.fIsOpen&&this._fAutomaticEnableClose&&this._setTimeout(this._enableClose,1)};OwaEditor.UIControls.Popup.prototype._onMouseDown=function(n){this._suppressClose(!0);this._forwardEvent(n);n.cancelBubble()};OwaEditor.UIControls.Popup.prototype._onKeyDown=function(n){this._suppressClose(!0);this._forwardEvent(n);n.cancelBubble()};OwaEditor.UIControls.Popup.prototype._onSelectStart=function(n){n.preventDefault();n.cancelBubble()};OwaEditor.UIControls.Popup.prototype._forwardEvent=function(n){var t="on"+n.get_Type();this[t]&&this[t](n)};OwaEditor.UIControls.Popup.prototype._addTextBoxEventHandlers=function(){this._fnOnBlur=this._attachEvent(n,"blur",this._onBlurTextBox);this._fnOnKeyDown=this._attachEvent(n,"keydown",this._onKeyDown)};OwaEditor.UIControls.Popup.prototype._removeTextBoxEventHandlers=function(){if(this._fnOnBlur){this._detachEvent(n,"blur",this._fnOnBlur);this._fnOnBlur=null}if(this._fnOnKeyDown){this._detachEvent(n,"keydown",this._fnOnKeyDown);this._fnOnKeyDown=null}this._oParentPopup||f()};function e(){var t=OwaEditor.Dom.Document.get_Current();n=t.createElement("input");n.set_Type(OwaEditor.Dom.Input.Type.Text);n.addCssClass("offscreen");n._get_DomNode().tabIndex=-1;n._get_DomNode().setAttribute("aria-hidden","true");t.appendChild(n)}var t="_hasFocus";function o(){if(!n.getBoolAttribute(t)){var i=n.get_OwnerDocument().get_Body();n.set_Top(i.get_ScrollTop());n.set_Left(i.get_ScrollLeft());n.focus();n.focus();n.setBoolAttribute(t,!0);n.set_Top(null);n.set_Left(null)}}function f(){n.setBoolAttribute(t,!1)}OwaEditor.UIControls.Popup.createClass("OwaEditor.UIControls.Popup",OwaEditor.UIControls.UIControl)}();g_fModuleLoaded[".\\uicontrols/popup.js".toLowerCase()]=1;var SELECTED_MENU_ITEM_CLASS="cmHiLite";g_fModuleLoaded[".\\uicontrols/contextmenu.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.UIControls");var f="onSelect";var i="cmd";var t="_lnk";var e="_isMnuDvdr";var r="sSmId";var o="sSmScript";var s="ctxMnu";var h="cmLnk";var c="cmDsbld";var v="cstmCM";OwaEditor.UIControls.ContextMenu=function(n,t,i){OwaEditor.UIControls.ContextMenu.constructBase(this,[n,t]);i&&this.set_SubPage(i);this._oSubmenus={};this._oCurrentSubmenu=null;this._iCurrentSubmenuTimer=null};var n=OwaEditor.UIControls.ContextMenu.prototype;n._fRemoveElementInDisposing=!0;OwaEditor.UIControls.ContextMenu.create=function(n,t,i){var r=new OwaEditor.UIControls.ContextMenu(n,t,i);r.initialize();return r};OwaEditor.UIControls.ContextMenu.createFromHtml=function(n,t,i){var u=Owa.Dom.Document.get_Current().createElement("DIV");var r;Owa.Dom.Document.get_Current().get_Body().appendChild(u);u.set_InnerHtml(n);r=new OwaEditor.UIControls.ContextMenu(u.get_FirstChild(),null,i);r.set_RemoveElementInDisposing(t);r.initialize();return r};n.initialize=function(){OwaEditor.UIControls.ContextMenu.callBase(this,"initialize");this.setMenuItems();this._attachEvent(this._get_Element(),"mouseover",this._onMouseOver);this._attachEvent(this._get_Element(),"mouseout",this._onMouseOut);this._attachEvent(this._get_Element(),"click",this._onClick);if(this._get_Element().getAttribute("fScrl")&&this._rgMenuItems.length>10){this._get_Element().set_Height(230);this._fCallAdjustMenuWithScrollbarWidth=1}};OwaEditor.UIControls.ContextMenu.prototype._fireOnPreShow=function(){this._fCallAdjustMenuWithScrollbarWidth&&this._adjustMenuWithScrollbarWidth();this._adjustSpacerWidths();OwaEditor.UIControls.ContextMenu.callBase(this,"_fireOnPreShow")};n._getDescendant=function(n){var t=OwaEditor.UIControls.ContextMenu.callBase(this,"_getDescendant",[n]);if(t)return t;for(var i in this._oSubmenus){t=this._oSubmenus[i]._getDescendant(n);if(t)return t}};n.setMenuItems=function(){this._rgMenuItems=[];this._rgCustomMenuIds=[];for(var f=this._get_Element().get_AllDecendantsEnumerator();f.moveNext();){var n=f.get_Current();if((n.getBoolAttribute(t)||n.getBoolAttribute(e))&&n.getAncestorByClass(s).equals(this._get_Element())){this._rgMenuItems.push(n);var u=n.getAttribute(r);if(u){var h=this._get_Element().getDescendantById(u);this._oSubmenus[u]=this.addResource(this._createSubmenu(h));this._oSubmenus[u].get_OnSelect().add(this._createCallback(this._fireOnSelect))}if(n.getAttribute(i)==v){var o=n.get_Id();if(!o)throw"Customized menu item must have an Id.";this._rgCustomMenuIds.push(o)}}}this._rgAllMenuItems=this._getAllMenuItems()};n.dispose=function(){this.fIsOpen&&this.close();this._rgMenuItems=null;this._rgCustomMenuIds=null;OwaEditor.UIControls.ContextMenu.callBase(this,"dispose")};n.close=function(){this.fIsOpen&&this._oParentPopup&&OwaEditor.UIControls.ContextMenu.isInstance(this._oParentPopup)&&this._oParentPopup.selectMenuItemByAttribute("",0);this._hideSubmenu();OwaEditor.UIControls.ContextMenu.callBase(this,"close")};n.getRootMenu=function(){for(var n=this;n._oParentPopup;)n=n._oParentPopup;return n};n.getAllMenuItemIds=function(){for(var t=[],n=0;n<this._rgMenuItems.length;n++)t.push(this._rgMenuItems[n].get_Id());return t};n.showAtEvent=function(n){this.show(n.get_ClientX(),n.get_ClientY())};n._tShow=function(){OwaEditor.UIControls.ContextMenu.callBase(this,"_tShow",arguments);this._get_Element().getAttribute("fScrl")&&this._get_Element().hasCssClass("ctxMnuIco")&&this._getDescendant("cmpane").set_Height(this._get_Element().get_ScrollHeight())};n.show=function(n,t,i){this._normalizeMenuDivider();return OwaEditor.UIControls.ContextMenu.callBase(this,"show",arguments)};n.showMenuItems=function(n,t){for(var i=0;i<n.length;i++)this.showMenuItem(n[i],t)};n.showMenuItem=function(n,t){var i=this._getMenuItem(n);null!=i&&a(i,t)};n._normalizeMenuDivider=function(){for(var i=null,n=!1,r=0;r<this._rgMenuItems.length;r++){var t=this._rgMenuItems[r];if(t.getBoolAttribute(e)){a(t,n);n&&(i=t);n=!1}else t.get_IsShown()&&(n=!0)}!n&&i&&this.showMenuItem(i.get_Id(),!1)};n.enableMenuItems=function(n,t){for(var i=0;i<n.length;i++)this.enableMenuItem(n[i],t)};n.enableMenuItem=function(n,t){l(this._getMenuItem(n),t)};n.enableMenuItemByCommand=function(n,t){l(this._getMenuItemByCommand(n),t)};n.checkMenuItem=function(n,t){var r=this._getMenuItem(n);var i=r.getDescendantById("imgI");t?i.addCssClass(SELECTED_MENU_ITEM_CLASS):i.removeCssClass(SELECTED_MENU_ITEM_CLASS)};n.selectMenuItem=function(n,t){t?n.addCssClass(SELECTED_MENU_ITEM_CLASS):n.removeCssClass(SELECTED_MENU_ITEM_CLASS)};n.replaceMenuItemIcon=function(n,t){var i=this._getMenuItem(n);var r=i.getDescendantById("imgI");Owa.Components.CssSprites.updateImage(r,t)};n.get_CustomMenuIds=function(){return this._rgCustomMenuIds};n.getMenuItemAttribute=function(n,t){return this._getMenuItem(n).getAttribute(t)};n.selectMenuItemByAttribute=function(n,t){for(var i=0;i<this._rgMenuItems.length;i++)this.selectMenuItem(this._rgMenuItems[i],this._rgMenuItems[i].getAttribute(n)==t)};n.getMenuItem=function(n){return this._getMenuItem(n)};n.getAllMenuItems=function(){return this._rgAllMenuItems};OwaEditor.UIControls.Popup.prototype._get_Container=function(){return null};n.get_OnSelect=function(){return this._getEventHandlerCollection(f)};n._onMouseDown=function(n){this._oCurrentSubmenu&&this._oCurrentSubmenu._suppressClose(!0);OwaEditor.UIControls.ContextMenu.callBase(this,"_onMouseDown",[n])};n._clearMenuSelection=function(){for(var n=0;n<this._rgMenuItems.length;n++){var t=this._rgMenuItems[n];this.selectMenuItem(t,!1)}};n._onMouseOver=function(n){var i=u(n);if(i&&i.getBoolAttribute(t)){this._clearMenuSelection();this.selectMenuItem(i,!0);var e=i.getAttribute(r);if(e){var f=this._oSubmenus[e];this._showSubmenu(i,f)}else{var s=i.getAttribute(o);if(s){var h=new Function("return "+s);var f=h(this.get_SubPage());f._oParentPopup=this;this._showSubmenu(i,f)}else this._hideSubmenu()}}};n._onMouseOut=function(n){if(!this._oCurrentSubmenu||!this._oCurrentSubmenu.fIsOpen){this._clearMenuSelection();var t=u(n);t&&this.selectMenuItem(t,!1)}};n._onClick=function(n){var r=u(n);if(r&&r.getBoolAttribute(t)&&!this._hasSubmenu(r)){var e=r.getAttribute(i);var f={};f.sCommand=e;f.oMenuItem=r;f.oMenu=this;this._fireOnSelect(f)}};OwaEditor.UIControls.ContextMenu.prototype._hasSubmenu=function(n){return n.getAttribute(r)||n.getAttribute(o)};n._createSubmenu=function(n){return OwaEditor.UIControls.ContextMenu.create(n,this,this.get_SubPage())};n._adjustMenuWithScrollbarWidth=function(){this._get_Element().set_Width(this._get_Element().get_OffsetWidth()+10)};n._adjustSpacerWidths=function(){for(var n=0;n<this._rgMenuItems.length;n++){var t=this._rgMenuItems[n];this._hasSubmenu(t)&&t.get_IsShown()&&this._adjustSpacerWidth(t)}};n._adjustSpacerWidth=function(n){var t=n.get_OffsetWidth();t-=n.getEffectivePadding(Owa.Style.Side.Left);t-=n.getEffectivePadding(Owa.Style.Side.Right);t-=n.getEffectiveBorderWidth(Owa.Style.Side.Left);t-=n.getEffectiveBorderWidth(Owa.Style.Side.Right);var i=n.getDescendantById("spnImg");if(i){t-=i.get_OffsetWidth();t-=i.get_NextSibling().get_OffsetWidth()}var u=n.getDescendantById("spnT");t-=u.get_OffsetWidth();var r=n.getDescendantById("imgRA");t-=r.get_OffsetWidth();t-=r.getEffectiveMargin(Owa.Style.Side.Left);t-=r.getEffectiveMargin(Owa.Style.Side.Right);u.get_NextSibling().set_Width(t)};n._showSubmenu=function(n,t){if(this._oCurrentSubmenu!=t){this._hideSubmenu();var i={};i.oMenuItem=n;i.oSubmenu=t;this._iCurrentSubmenuTimer=this._setTimeout(this._cbShowSubmenu,300,i)}};OwaEditor.UIControls.ContextMenu.prototype._cbShowSubmenu=function(n){if(!this._iCurrentSubmenuTimer)throw"Hitting the timer callback without having the timer.";this._clearTimeout(this._iCurrentSubmenuTimer);this._iCurrentSubmenuTimer=null;var r=n.oMenuItem;var t=n.oSubmenu;if(this._oCurrentSubmenu==t)throw"Trying to show the submenu again.";var u=this._get_Element().get_OffsetWidth();var i=this._get_Element().get_DocumentLeft();var f=g_fRtl?i:i+u;var e=r.get_DocumentTop();t.show(this._adjustSubmenuPosX(t,this,f),e);this._oCurrentSubmenu=t};OwaEditor.UIControls.ContextMenu.prototype._adjustSubmenuPosX=function(n,t,i){var f=t._get_Element().get_OffsetWidth();var e=t._get_Element().get_DocumentLeft();var r=n._get_Element();if(r){r.set_IsShown(!0);var u=r.get_OffsetWidth();r.set_IsShown(!1);var o=r.get_ParentElement().get_OffsetWidth();g_fRtl&&e<u?i+=f+u:!g_fRtl&&i+u>o&&(i-=f+u)}return i};n._hideSubmenu=function(){if(this._iCurrentSubmenuTimer){this._clearTimeout(this._iCurrentSubmenuTimer);this._iCurrentSubmenuTimer=null}if(this._oCurrentSubmenu){this._oCurrentSubmenu.close();this._oCurrentSubmenu=null}};n._fireOnSelect=function(n){this._suppressClose(!0);this._removeTextBoxEventHandlers();var t=this._dispatchEvent(f,n);if(t){this._addTextBoxEventHandlers();this._enableClose()}else this.close();return t};n._getMenuItem=function(n){var t=this._getDescendant(n);if(t)return t;for(var i in this._oSubmenus){t=this._oSubmenus[i]._getMenuItem(n);if(t)return t}return null};n._getMenuItemByCommand=function(n){for(var t=0;t<this._rgAllMenuItems.length;t++){var r=this._rgAllMenuItems[t];if(r.getAttribute(i)==n)return r}return null};n._getAllMenuItems=function(){var n=this._rgMenuItems;for(var t in this._oSubmenus)n=n.concat(this._oSubmenus[t]._rgMenuItems);return n};n.changeShowerSubPage=function(n){this._oSubPage=n};function u(n){var t=n.get_Target();t.hasCssClass(h)||(t=t.getAncestorByClass(h,s));return t}function l(n,i){n.setIntAttribute(t,i?1:0);i?n.removeCssClass(c):n.addCssClass(c)}function a(n,t){n.set_IsShown(t)}OwaEditor.UIControls.ContextMenu.createClass("OwaEditor.UIControls.ContextMenu",OwaEditor.UIControls.Popup)}();g_fModuleLoaded[".\\uicontrols/contextmenu.js".toLowerCase()]=1;g_fModuleLoaded[".\\uicontrols/ComboDropDownList.js".toLowerCase()]||function(){var n="onChange";var t=OwaEditor.Strings.CssClass.ComboDropDownSelectedItem;OwaEditor.UIControls.ComboDropDownList=function(n,t,i,r){OwaEditor.UIControls.ComboDropDownList.constructBase(this,[n,t,i]);this._rgListItems=!1;this._oComboBox=t;this._iSelectedItemIndex=-1;this._fForceOnChangeHandlers=r};OwaEditor.UIControls.ComboDropDownList.prototype.initialize=function(){OwaEditor.UIControls.ComboDropDownList.callBase(this,"initialize");this._get_Element().addCssClass("dropDownListMaxHeight");this._get_Element().addCssClass("customScrollBar");this._get_Element().addCssClass("contextMenuDropShadow");this._initializeItems();this.get_OnPreShow().add(this._createCallback(this._onPreShow));this._attachEvent(this._get_Element(),"click",this._onClick)};OwaEditor.UIControls.ComboDropDownList.prototype.dispose=function(){var n=this._get_Element();n.detachAllEvents();for(var t=0;t<this._rgListItems.length;++t)this._rgListItems[t].oDomItem.detachAllEvents();n.get_ParentElement().removeChild(n);OwaEditor.UIControls.ComboDropDownList.callBase(this,"dispose")};OwaEditor.UIControls.ComboDropDownList.prototype.get_OnChange=function(){return this._getEventHandlerCollection(n)};OwaEditor.UIControls.ComboDropDownList.prototype._onClick=function(n){n.cancelBubble()};OwaEditor.UIControls.ComboDropDownList.prototype._onKeyDown=function(n){switch(n.get_KeyCodeForKeyUpDown()){case 9:this.close();break;case 40:this._arrowDown();break;case 38:this._arrowUp();break;case 13:this.close();break;case 36:this.set_SelectedItemIndex(0);break;case 35:this.set_SelectedItemIndex(this._rgListItems.length-1);break;case 34:this._pageDown();break;case 33:this._pageUp();break;default:return}n.cancelBubble()};OwaEditor.UIControls.ComboDropDownList.prototype._onPreShow=function(){var t=this._oComboBox._get_Element().get_OffsetWidth();var n=this._get_Element();var i=n.get_OffsetHeight()<n.get_ScrollHeight()?20:0;n.set_Width(null);n.get_OffsetWidth()+i<t?n.set_Width(t):n.set_Width(n.get_OffsetWidth()+i);this._ensureVisible()};OwaEditor.UIControls.ComboDropDownList.prototype._onItemClick=function(n,t){for(var i=0;i<this._rgListItems.length;++i)if(this._rgListItems[i].oDomItem==t){this.set_SelectedItemIndex(i,this._fForceOnChangeHandlers);break}this.close()};OwaEditor.UIControls.ComboDropDownList.prototype._pageDown=function(){var n=this.get_SelectedItemIndex()+this._get_PageSize();n>=this._rgListItems.length-1&&(n=this._rgListItems.length-1);this.set_SelectedItemIndex(n)};OwaEditor.UIControls.ComboDropDownList.prototype._pageUp=function(){var n=this.get_SelectedItemIndex()-this._get_PageSize();n<0&&(n=0);this.set_SelectedItemIndex(n)};OwaEditor.UIControls.ComboDropDownList.prototype._arrowDown=function(){this.get_SelectedItemIndex()<this._rgListItems.length-1&&this.set_SelectedItemIndex(this.get_SelectedItemIndex()+1)};OwaEditor.UIControls.ComboDropDownList.prototype._arrowUp=function(){this.get_SelectedItemIndex()>0&&this.set_SelectedItemIndex(this.get_SelectedItemIndex()-1)};OwaEditor.UIControls.ComboDropDownList.prototype.hasValue=function(n){return this._getValueIndex(n)>=0};OwaEditor.UIControls.ComboDropDownList.prototype.selectValue=function(n,t){var i=this._getValueIndex(n);if(i>=0)this.set_SelectedItemIndex(i,0,t);else throw new Error("value specified for selection not present");};OwaEditor.UIControls.ComboDropDownList.prototype.get_SelectedValue=function(){return this.get_SelectedItemIndex()>=0?this._rgListItems[this.get_SelectedItemIndex()].oValue:undefined};OwaEditor.UIControls.ComboDropDownList.prototype.get_SelectedItem=function(){return this.get_SelectedItemIndex()>=0?this._rgListItems[this.get_SelectedItemIndex()]:undefined};OwaEditor.UIControls.ComboDropDownList.prototype.addItem=function(n,t){if(this.hasValue(t))throw new Error("value already present in comboBoxList");var i=this._get_Element().get_OwnerDocument().createElement("DIV");var r=this._get_Element().get_OwnerDocument().createElement("SPAN");r.addCssClass("listItm");r.set_TextContent(n);i.insertAdjacentElement(OwaEditor.ElementInsertionPoint.BeforeEnd,r);this._get_Element().insertAdjacentElement(OwaEditor.ElementInsertionPoint.BeforeEnd,i);this._addDomItem(i,t)};OwaEditor.UIControls.ComboDropDownList.prototype.clearItems=function(){this.set_SelectedItemIndex(-1);for(var n=0;n<this._rgListItems.length;)this._remove(n)};OwaEditor.UIControls.ComboDropDownList.prototype.getDomItemByIndex=function(n){if(n<0||n>=this._rgListItems.length)throw new Error("Argument out of range");return this._rgListItems[n].oDomItem};OwaEditor.UIControls.ComboDropDownList.prototype.getValueByIndex=function(n){if(n<0||n>=this._rgListItems.length)throw new Error("Argument out of range");return this._rgListItems[n].oValue};OwaEditor.UIControls.ComboDropDownList.prototype.getItemCount=function(){return this._rgListItems.length};OwaEditor.UIControls.ComboDropDownList.prototype.get_SelectedItemIndex=function(){return this._iSelectedItemIndex};OwaEditor.UIControls.ComboDropDownList.prototype.set_SelectedItemIndex=function(i,r,u){if(i!=this._iSelectedItemIndex||r){if(i>=this._rgListItems.length)throw new Error("Argument out of range");this._iSelectedItemIndex>=0&&this._rgListItems[this._iSelectedItemIndex].oDomItem.removeCssClass(t);this._iSelectedItemIndex=i;if(this._iSelectedItemIndex>=0){this._rgListItems[this._iSelectedItemIndex].oDomItem.addCssClass(t);this._ensureVisible()}else{this._iSelectedItemIndex=-1;this._get_Element().set_ScrollTop(0)}u||this._dispatchEvent(n,this)}};OwaEditor.UIControls.ComboDropDownList.prototype._ensureVisible=function(){var n=this._get_Element().get_ScrollHeight()/this._rgListItems.length;var t=this._get_Element().get_ScrollTop()/n;if(this._iSelectedItemIndex<t)this._get_Element().set_ScrollTop(this._iSelectedItemIndex*n);else{var i=(this._get_Element().get_ScrollTop()+this._get_Element().get_OffsetHeight())/n-1;this._iSelectedItemIndex>i&&this._get_Element().set_ScrollTop((this._iSelectedItemIndex+1)*n-this._get_Element().get_OffsetHeight())}};OwaEditor.UIControls.ComboDropDownList.prototype._getValueIndex=function(n){for(var t=0;t<this._rgListItems.length;++t)if(OwaEditor.Utility.isEqual(this._rgListItems[t].oValue,n))return t;return-1};OwaEditor.UIControls.ComboDropDownList.prototype._remove=function(n){this.get_SelectedItemIndex()==n?this.set_SelectedItemIndex(-1):this.get_SelectedItemIndex()>n&&this._iSelectedItemIndex--;this._rgListItems[n].oDomItem.detachAllEvents();this._rgListItems[n].oDomItem.remove(!0);this._rgListItems.removeAt(n)};OwaEditor.UIControls.ComboDropDownList.prototype._get_PageSize=function(){var n=this._rgListItems.length*this._get_Element().get_OffsetHeight()/this._get_Element().get_ScrollHeight();return new Number(n.toFixed(0))};OwaEditor.UIControls.ComboDropDownList.prototype._initializeItems=function(){if(this._rgListItems)throw new Error("Invalid operation");this._rgListItems=[];for(var n=this._get_Element().get_Enumerator();n.moveNext();){var t=n.get_Current();this._addDomItem(t,t.getAttribute(OwaEditor.Strings.Attributes.Value))}};OwaEditor.UIControls.ComboDropDownList.prototype._addDomItem=function(n,t){this._rgListItems.add({oDomItem:n,oValue:t});this._attachEvent(n,"click",this._onItemClick,n)};OwaEditor.UIControls.ComboDropDownList.createClass("OwaEditor.UIControls.ComboDropDownList",OwaEditor.UIControls.Popup)}();g_fModuleLoaded[".\\uicontrols/ComboDropDownList.js".toLowerCase()]=1;g_fModuleLoaded[".\\uicontrols/ComboBox.js".toLowerCase()]||function(){var n="onShow";var t="onChange";OwaEditor.UIControls.ComboBox=function(n,t,i,r){OwaEditor.UIControls.ComboBox.constructBase(this,[n,t]);this._oDropDownList=null;this._oClientAction=null;this._oSelectedValue=null;this._oTextBox=null;this._fSelectedValueCanBeNull=!1;this._fDisableOffscreenBox=i;this._fForceOnChangeHandlers=r};OwaEditor.UIControls.ComboBox.prototype.initialize=function(){this._attachEvent(this._get_Element(),"mousedown",this._onMouseDown);this._attachEvent(this._get_Element(),"click",this._onClick);this._attachEvent(this._get_Element(),"keydown",this._onKeyDown);this._initializeDropDown();this._oDropDownList.get_OnDataBind().add(this._createCallback(this._onPreShow));this._oDropDownList.get_OnChange().add(this._createCallback(this._onChange));this._initializeSelection();this.set_IsEnabled(this._getIntAttribute("fEnbld"))};OwaEditor.UIControls.ComboBox.prototype.dispose=function(){this._oDropDownList.dispose();this._oDropDownList=null;OwaEditor.UIControls.ComboBox.prototype._isEditable()&&this._oTextBox.detachAllEvents();OwaEditor.UIControls.ComboBox.callBase(this,"dispose")};OwaEditor.UIControls.ComboBox.prototype.get_OnShow=function(){return this._getEventHandlerCollection(n)};OwaEditor.UIControls.ComboBox.prototype.get_OnChange=function(){return this._getEventHandlerCollection(t)};OwaEditor.UIControls.ComboBox.prototype._onChange=function(){var n=this._oDropDownList.get_SelectedValue();(isDf(typeof n)&&n!==null||this._fSelectedValueCanBeNull)&&this._selectValue(n)};OwaEditor.UIControls.ComboBox.prototype._onPreShow=function(){this._oDropDownList.hasValue(this._oSelectedValue)&&this._oDropDownList.selectValue(this._oSelectedValue);this._dispatchEvent(n,this)};OwaEditor.UIControls.ComboBox.prototype._onMouseDown=function(n){this.get_IsEnabled()&&n.isLeftButtonDown()&&(!this._isEditable()||this._isEditable()&&!n.get_Target().equals(this._oTextBox))&&this.showDropDown(n)};OwaEditor.UIControls.ComboBox.prototype._onClick=function(n){n.preventDefault()};OwaEditor.UIControls.ComboBox.prototype._onKeyDown=function(n){if(this.get_IsEnabled()){this._isEditable()&&n.get_KeyCodeForKeyUpDown()==9&&this.hideDropDown();n.get_KeyCodeForKeyUpDown()==13&&this.showDropDown()}};OwaEditor.UIControls.ComboBox.prototype.get_SelectedValue=function(){return this._oSelectedValue};OwaEditor.UIControls.ComboBox.prototype.set_SelectedValue=function(n,t){this._selectValue(n,t)};OwaEditor.UIControls.ComboBox.prototype.renderValue=function(n){var t=this._get_Element().getDescendantById(OwaEditor.Strings.Ids.ComboTextDisplaySpan);OwaEditor.Utility.isIE()?t.set_InnerHtmlIEWorkaround(n):t.set_InnerHtml(n);this._oDropDownList.set_SelectedItemIndex(-1);this._oSelectedValue=null};OwaEditor.UIControls.ComboBox.prototype.get_IsEnabled=function(){return this._getIntAttribute(OwaEditor.Strings.Attributes.IsDisabled)!=1};OwaEditor.UIControls.ComboBox.prototype.set_IsEnabled=function(n){this._setIntAttribute(OwaEditor.Strings.Attributes.IsDisabled,n?0:1);n?this._get_Element().removeCssClass(OwaEditor.Strings.CssClass.ComboBoxDisable):this._get_Element().addCssClass(OwaEditor.Strings.CssClass.ComboBoxDisable)};OwaEditor.UIControls.ComboBox.prototype.showDropDown=function(n){this._oDropDownList.showRelative(0,this._get_Element().get_OffsetHeight(),n)};OwaEditor.UIControls.ComboBox.prototype.hideDropDown=function(){this._oDropDownList.close()};OwaEditor.UIControls.ComboBox.prototype.get_DropDownList=function(){return this._oDropDownList};OwaEditor.UIControls.ComboBox.prototype.setWidthAccordingToSelectedValue=function(){var t=this._getDescendant("spanListItm");var n=t.get_OffsetWidth();n>0&&this._get_Element().set_Width(n+30)};OwaEditor.UIControls.ComboBox.prototype._selectValue=function(n,i){var r=this._oSelectedValue;if(!OwaEditor.Utility.isEqual(r,n)){this._oSelectedValue=n;this._oDropDownList.hasValue(n)&&this._oDropDownList.selectValue(n,i);this._renderSelectedValue()}if(!i&&(this._fForceOnChangeHandlers||!OwaEditor.Utility.isEqual(r,n))){this._dispatchEvent(t,this);this._oClientAction!=null&&this._oClientAction.get_ActionEventHandlers().dispatch({oValue:this._oSelectedValue})}};OwaEditor.UIControls.ComboBox.prototype._renderSelectedValue=function(){var n=this._get_Element().getDescendantById(OwaEditor.Strings.Ids.ComboTextDisplaySpan);var t=this._oDropDownList.get_SelectedItem().oDomItem.get_InnerHtml();OwaEditor.Utility.isIE()?n.set_InnerHtmlIEWorkaround(t):n.set_InnerHtml(t)};OwaEditor.UIControls.ComboBox.prototype._initializeDropDown=function(){this._oDropDownList=new OwaEditor.UIControls.ComboDropDownList(this._getDescendant(OwaEditor.Strings.Ids.ComboDropDownList),this,this._fDisableOffscreenBox,this._fForceOnChangeHandlers);this._oDropDownList.set_SubPage(this.get_SubPage());this._oDropDownList.initialize()};OwaEditor.UIControls.ComboBox.prototype._initializeSelection=function(){var n=this._getAttribute(OwaEditor.Strings.Attributes.Value);n?this._oDropDownList.selectValue(n):this._oDropDownList.getItemCount()>0&&this._oDropDownList.set_SelectedItemIndex(0)};OwaEditor.UIControls.ComboBox.createClass("OwaEditor.UIControls.ComboBox",OwaEditor.UIControls.UIControl);OwaEditor.UIControls.ComboBox.prototype._isEditable=function(){return!1}}();g_fModuleLoaded[".\\uicontrols/ComboBox.js".toLowerCase()]=1;Type.createNamespace("OwaEditor.Components");g_fModuleLoaded[".\\components/application.js".toLowerCase()]||function(){OwaEditor.Components.Application={};var n=null;var c=null;var l=!1;var u=null;var i={};var f=new OwaEditor.Collection.Set;window.onload=w;window._fIsWinFocused=!1;OwaEditor.Components.Application.get_IsWinLoaded=function(){return l};OwaEditor.Components.Application.get_RootSubPage=function(){return n};OwaEditor.Components.Application.set_ActiveSubPage=function(n){c=n};OwaEditor.Components.Application.get_ShouldExplicitDisposeResource=function(){return n&&(n._fSupportHostSubPages||n._fSupportHostedInSubPage)};function e(){e.constructBase(this)}e.createClass("GlobalResourceManager",OwaEditor.Components.Control);var o;OwaEditor.Components.Application.get_GlobalResourceManager=function(){o||(o=new e);return o};function w(){var n=OwaEditor.Dom.Window.get_Current();var t=n.get_Document();if(OwaEditor.Utility.isIE()){t.attachEvent("focusin",a);t.attachEvent("focusout",v)}else{u=document.activeElement;n.attachEvent("focus",a);n.attachEvent("blur",v)}r()}OwaEditor.Components.Application.start=function(){if(OwaEditor.Utility.isIE()&&!OwaEditor.Utility.isActiveXControlSupported()&&OwaEditor.PageHierarchy.getOwaTopWindow().equals(OwaEditor.Dom.Window.get_Current())){OwaEditor.Components.Application.failWithWarning(htmlEnc(L_ActiveXDisabled).format('<a href="logoff.owa">',"</a>"));return}stJS=k;b();var i=OwaEditor.Dom.Document.get_Current().get_Body();if(!n){var r=i.getAttribute("_PageType");if(i&&r){if(r=="NavigationPage"){stIMEnabFlg();if(!createMasterWindowCookies())return}var u=eval("OwaEditor.Pages."+r);n=new u(i)}else n=new OwaEditor.UIControls.SubPage(i)}OwaEditor.Components.Application.set_ActiveSubPage(n);d();if(OwaEditor.Utility.isDefined(typeof createGlobalVariables)){createGlobalVariables(n);createGlobalVariables=null}i.getBoolAttribute("_fIM")&&initIM();n.initialize();OwaEditor.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_IsShown()&&n.fireIsVisibleChanged(!0);t&&t.dispatch();gtMstr();OwaEditor.Component.PerfMarkers.initialize()};function b(){for(var n in window.oJS)i[n]=!0}function k(n){i[n]=!0;OwaEditor.Components.Application._notifyAllPendingController()}function d(){g();var n=OwaEditor.Dom.Window.get_Current();var t=n.get_Document();n.attachEvent("unload",it);n.attachEvent("resize",OwaEditor.Utility.createWindowResizeHandler(n,ft));n.attachEvent("beforeunload",ut);t.attachEvent("contextmenu",onEvtCanInpt);t.attachEvent("keydown",et);OwaEditor.Utility.isFirefox()&&t.attachEvent("keypress",OwaEditor.Components.Application.preventFirefoxDefaultKeyEvent);window.onerror=ot}function g(){var n=OwaEditor.Dom.Document.get_Current().get_Body();n.attachEvent("dragenter",canEvt);n.attachEvent("dragover",canEvt);n.attachEvent("drop",canEvt);n.attachEvent("dragend",nt)}function nt(n){var t=new OwaEditor.Components.Storage.DragDrop(n);t.clear();n.cancelBubble();n.preventDefault()}OwaEditor.Components.Application.preventFirefoxDefaultKeyEvent=function(n){var i=[78,110,114,82,107];if(OwaEditor.Utility.isFirefox()&&n.isCtrlKeyDown())for(var t=1;t<i.length;t++)i[t]==n.get_CharCodeForKeyPress()&&n.preventDefault()};function r(){for(var t=[],n=0;;n++){var i=OwaEditor.Dom.GetElement("_scr"+n);if(i)t.push(i);else break}if(t.length){for(var n=0;n<t.length;n++){var o=t[n];if(!tt(o)){setTimeout(r,50);return}}if(!OwaEditor.Dom.GetElement("divEOF")){setTimeout(r,50);return}var u=OwaEditor.Dom.Window.get_Current();var f=u.get_ParentWindow();var e=u.get_FrameElement();if(e&&f&&f.getGlobalVariable("g_fOwa")&&!e.getAttribute(PARENT_SUBPAGE_ID_ATTR)){setTimeout(r,50);return}l=!0;OwaEditor.Components.Application.start()}}function tt(n){var t=n._get_DomNode().readyState;var i=n.getAttribute("_sid");if(!isDf(typeof t)&&isJS(i))return 1;else if((t=="complete"||t=="loaded")&&isJS(i))return 1;return 0}function it(){var t=OwaEditor.Dom.Document.get_Current().get_Body();t.getBoolAttribute("_fIM")&&dispIM();isDf(typeof dispRecipContextMenus)&&dispRecipContextMenus();n.get_IsDisposed()||n.dispose();OwaEditor.Dom.AjaxRequest.disposeAjaxRequests();removeFromWindowManager();rt();UniqueIdHashSet.get_Instance().clear();OwaEditor.Dom.Document.dispose();OwaEditor.Dom.Window.dispose()}function rt(){OwaEditor.Dom.Document.get_Current().get_Body().detachAllEvents();OwaEditor.Dom.Document.get_Current().detachAllEvents();window.onload=window.onunload=window.onbeforeunload=window.onerror=null;OwaEditor.Dom.Window.get_Current().detachAllEvents();for(var t=["onbeforeunload","onafterprint","onerror","onresize","onblur","onload","onscroll","onfocus","onbeforeprint","onunload","onhelp"],n=0;n<t.length;n++)window[t[n]]=null}function ut(t){OwaEditor.Component.PerfMarkers.dispose();if(!n.get_IsDisposed())return n.onBeforeUnload(t)}function ft(t){if(!n.get_IsDisposed())return n.fireSizeChanged(t)}function a(n){window._fIsWinFocused=!0}function v(n){if(!OwaEditor.Utility.isIE()&&document.activeElement!=u){u=document.activeElement;return}window._fIsWinFocused=!1}function et(n){return c.fireKeyDownPageEvent(n)}function ot(n,t,i){h(Owa);try{n=n.trim();if(OwaEditor.BrowserErrorHandler.isAccessDeny(n)){shwErrDlg(0,L_ErrRfBrws);return!0}if(OwaEditor.BrowserErrorHandler.isNoMemoryError(n)){shwErrDlg(0,L_ErrOOM);return!0}else if(a_fSndClntErr)n==NO_DLG_OPNER&&(n="window.open failed: the opener window of this IE dialog window is closed. Try close this dialog and reopen it");else return!0;var s="";var c="";var e="";var l=null;if(arguments.caller)for(var r=arguments.caller.callee,o=0;r&&o<20;){var f=r.toString();var u=r.sFnNm;u||(u=y(r));u+=f.substring(f.indexOf("("),f.indexOf(")")+1);o==0?l="\n"+u:e+="\n";e+="\n"+u;var p=f.indexOf("(")+1;var w=f.indexOf(")");var b=st(f.substring(p,w),r.arguments);s+=htmlEnc(u)+"\r\n";c+=htmlEnc(u)+b+"\r\n";r=r.caller;++o}var a="";if(window.event)for(var v in event)a+="\r\n\t"+v.toString()+" = "+event[v];OwaEditor.Components.Application.handleClientError(n,t,i,null,l,e,s,c,a)}catch(k){window.status=k.message}return!0}OwaEditor.Components.Application.handleClientError=function(n,t,i,r,u,f,e,o,s){if(a_fSndClntErr)try{var h={};h.sMsg=n;h.sLn=i!=null?i:"";h.sCS=f!=null?f:"";h.sFn=u!=null?u:"";t==null&&(t=window.location.href);e==null&&f!=null&&(e=htmlEnc(f));h.sBdy="Client Information"+"\n------------------"+"\nUser Agent: "+htmlEnc(navigator.userAgent)+"\nCPU Class: "+htmlEnc(navigator.cpuClass)+"\nPlatform: "+htmlEnc(navigator.platform)+"\nSystem Language: "+htmlEnc(navigator.systemLanguage)+"\nUser Language: "+htmlEnc(navigator.userLanguage?navigator.userLanguage:navigator.language)+"\nCookieEnabled: "+htmlEnc(navigator.cookieEnabled)+"\nException Details"+"\n-----------------"+"\nDate: "+new Date+"\nMessage: "+htmlEnc(n);h.sBdy+="\nUrl: "+htmlEnc(t);i!=null&&(h.sBdy+="\nLine: "+i);r!=null&&(h.sBdy+="\nPosition: "+r);e!=null&&(h.sBdy+="\n\nCall Stack\n----------\n"+e+"\n\n");o!=null&&(h.sBdy+="Detailed Call Stack\n-------------------\n"+o);s!=null&&(h.sBdy+="\n\nDump Event\n----------"+s);var l=shwErrDlg(0,L_ScptErr,0,L_ScptErrDtls,htmlEnc(h.sBdy),h,0)}catch(c){window.status=c.message}};function st(n,t){var r=n.split(",");n="";if(r[0])for(var i=0;i<r.length;i++){n+="\r\n\t";var u=t[i];n+=r[i].trim()+" = "+s(u,!0)}for(var i=r.length;i<t.length;i++)n+="\r\n\targuments["+i+"] = "+s(t[i],!0);return n}function s(n,t){if(n===null)return"null";else if(n===undefined)return"undefined";var u=typeof n;if(u=="string")return"'"+n+"'";else if(u=="function")return"["+y(n)+"]";else if(u=="object"){var f="[object]";if(!t)return f;for(var i in n)if(i!="outerText"&&i!="innerText"&&i!="innerHTML"){var r;try{r=s(n[i],!1)}catch(e){r="error: ["+e.message+"]"}i=="outerHTML"&&r.length>500&&(r=r.substring(0,500)+"[...]");f+="\r\n\t\t"+i+" = "+r}return f}else return n}function y(n){var t=n.toString();var i=t.indexOf("(");return i<9?"anonymous":t.substring(9,t.indexOf("("))}function h(n,t){try{t||(t="OwaEditor.");for(var r in n){var i=n[r];if(typeof i=="function"){i.sFnNm||(i.sFnNm=t+r);i.prototype&&h(i.prototype,i.sFnNm+".")}else typeof i=="object"&&h(i,t+r+".")}}catch(u){}}OwaEditor.Components.Application.loadExternalScript=function(n){for(var t=0;t<n.length;t++){var f=p(n[t]);if(!i[f]){var u=document.getElementsByTagName("head")[0]||document.documentElement;var r=document.createElement("SCRIPT");r.type="text/javascript";r.src=n[t];u.insertBefore(r,u.firstChild)}}};OwaEditor.Components.Application.failWithWarning=function(n){OwaEditor.Dom.Document.get_Current().get_Body().set_InnerHtml('<body class="err"><table class="errDesc"><tr>'+'<td style="width:1%; vertical-align:top; padding-top:7px;">'+OwaEditor.Components.CssSprites.getImageMarkup("bdi_wrn.gif")+"</td>"+'<td id="errMsg">'+n+"</td>"+'</tr></table><hr class="line" size="2"></body>')};OwaEditor.Components.Application.isScriptLoaded=function(n){return!!i[p(n)]};function p(n){var t=n.split("/");return t[t.length-1]}OwaEditor.Components.Application._notifyAllPendingController=function(){for(var t=f.toArray(),n=0;n<t.length;n++)t[n].notifyScriptReady()};OwaEditor.Components.Application.addPendingController=function(n){f.add(n)};OwaEditor.Components.Application.removePendingController=function(n){f.remove(n)};var t;OwaEditor.Components.Application.get_OnApplicationStart=function(){t||(t=new OwaEditor.Utility.EventHandlerCollection);return t}}();g_fModuleLoaded[".\\components/application.js".toLowerCase()]=1;function insertSS(n,t,i){var r=getSS(n,t);var u=n.get_StyleSheetCount();r||(r=u<31?i?n.insertBlankStyleSheet(t,i):n.insertBlankStyleSheet(t):n.getStyleSheetAt(u-1));return r}function getSS(n,t){return n.getStyleSheetByAttribute("id",t)}function applyParagraphStylesToDocument(n,t){if(!n.get_Body().getIntAttribute("fPStyle")){if(OwaEditor.Utility.isIE())for(var f=n.get_StyleSheetCount(),i=0;i<f;i++){var r=n.getStyleSheetAt(i);if(r.get_OwnerNode()){var e=r.get_OwnerNode().get_InnerHtml();r._oDomStyleSheet.cssText=OwaEditor.UIControls.Editor.prototype.removePStyles(e)}}var u=getSS(n,"owaParaStyle");u||(u=insertSS(n,"owaParaStyle"));t||u.addRule("P","margin-top:0;margin-bottom:0;");n.get_Body().setIntAttribute("fPStyle",1)}}g_fModuleLoaded[".\\dom/frame.js".toLowerCase()]||function(){OwaEditor.Dom.Frame=function(n){OwaEditor.Dom.Frame.constructBase(this,[n])};OwaEditor.Dom.Frame.prototype.get_ContentWindow=function(){var n=null;try{n=this._oDomNode.contentWindow}catch(t){}return n?new OwaEditor.Dom.Window(n):null};OwaEditor.Dom.Frame.prototype.get_ContentDocument=function(){return this.get_ContentWindow().get_Document()};OwaEditor.Dom.Frame.createClass("OwaEditor.Dom.Frame",OwaEditor.Dom.Element)}();g_fModuleLoaded[".\\dom/frame.js".toLowerCase()]=1;g_fModuleLoaded[".\\dom/nodeenumerator.js".toLowerCase()]||function(){OwaEditor.Dom.NodeEnumerator=function(n,t){OwaEditor.Dom.NodeEnumerator.constructBase(this);this._oDomList=n;this._currentIndex=-1;this._fnIsIgnorable=t};OwaEditor.Dom.NodeEnumerator.prototype.moveNext=function(){for(this._currentIndex++;this._currentIndex<this._oDomList.length;this._currentIndex++)if(!this._fnIsIgnorable||!this._fnIsIgnorable(this._oDomList[this._currentIndex]))return!0};OwaEditor.Dom.NodeEnumerator.prototype.get_Current=function(){if(this._currentIndex<0||this._currentIndex>=this._oDomList.length)throw"invalid operation, current position in enumerator is invalid";return OwaEditor.Dom.Node.wrapDomNode(this._oDomList[this._currentIndex])};OwaEditor.Dom.NodeEnumerator.prototype.reset=function(){this._currentIndex=-1};OwaEditor.Dom.NodeEnumerator.createClass("OwaEditor.Dom.NodeEnumerator",OwaEditor.Collections.IEnumerator)}();g_fModuleLoaded[".\\dom/nodeenumerator.js".toLowerCase()]=1;function Point(n,t){this.iX=n;this.iY=t}function Bounds(n,t,i,r){this.iX=n;this.iY=t;this.iHeight=r;this.iWidth=i}function SelectionRange(n,t){this.w3c=window.getSelection?!0:!1;this.range=n;this.document=t}function createSelectionRange(n){n||(n=document);if(window.getSelection){var r=n.defaultView;var t=r.getSelection();if(t.rangeCount>0&&(OwaEditor.Utility.isFirefox()||OwaEditor.Utility.isIE()||OwaEditor.Utility.isEdge()))return new SelectionRange(t.getRangeAt(0),n);else{var i=n.createRange();if(t.anchorNode!=null&&t.focusNode!=null){i.setStart(t.anchorNode,t.anchorOffset);i.setEnd(t.focusNode,t.focusOffset);if(i.collapsed!=t.isCollapsed){i.setStart(t.extentNode,t.extentOffset);i.setEnd(t.baseNode,t.baseOffset)}}return new SelectionRange(i,n)}}else{var i=n.selection.createRange();return i.duplicate?new SelectionRange(i,n):null}}function createTextRange(n){n||(n=document);return document.createRange?new SelectionRange(n.createRange(),n):new SelectionRange(n.body.createTextRange(),n)}SelectionRange.prototype.getText=function(){return this.w3c?this.range.toString():this.range.text};SelectionRange.prototype.htmlText=function(){if(this.w3c){if(window.XMLSerializer)return(new XMLSerializer).serializeToString(this.range.cloneContents())}else return this.range.htmlText};SelectionRange.prototype.selectionExists=function(){return this.w3c?!this.range.collapsed:this.document.selection.type!="None"};SelectionRange.prototype.moveEnd=function(n){if(document.selection)this.range.moveEnd("character",n);else throw new Error("SelectionRange.moveEnd should be called in IE8 only.");};SelectionRange.prototype.collapse=function(n){return this.range.collapse(n)};SelectionRange.prototype.select=function(){if(this.w3c&&!this.range.select){var t=this.document.defaultView;var n=t.getSelection();if(n.removeAllRanges){try{n.removeAllRanges()}catch(i){}n.addRange(this.range)}else n.setBaseAndExtent(this.range.startContainer,this.range.startOffset,this.range.endContainer,this.range.endOffset);return this.range}else return this.range.select()};SelectionRange.prototype.parentElement=function(){return this.w3c?this.range.commonAncestorContainer:this.range.parentElement()};SelectionRange.prototype.duplicate=function(){return this.w3c?new SelectionRange(this.range.cloneRange(),this.document):new SelectionRange(this.range.duplicate(),this.document)};SelectionRange.prototype.pasteHtml=function(n){if(this.w3c&&!OwaEditor.Utility.isIE())OwaEditor.ExecCommand.execute(this.document,"inserthtml",!1,n);else{while(this.range.length>0)this.range.remove(0);this.range=this.document.selection.createRange();this.range.pasteHTML(n)}};SelectionRange.prototype.getStartContainer=function(){return this.w3c?this.range.startContainer:null};SelectionRange.prototype.getStartContainerText=function(){return this.w3c?this.range.startContainer.nodeValue:null};SelectionRange.prototype.getStartOffset=function(){return this.w3c?this.range.startOffset:null};SelectionRange.prototype.setStart=function(n,t){this.w3c&&this.range.setStart(n,t)};SelectionRange.prototype.setEnd=function(n,t){this.w3c&&this.range.setEnd(n,t)};SelectionRange.prototype.expandSelectionAroundAnchors=function(){if(!this.w3c)return null;var n=null;var t=null;var u=!this.selectionExists();n=this.getAnchorUrl(this.range.startContainer);n&&this.range.setStart(this.range.startContainer,0);t=this.getAnchorUrl(this.range.endContainer);t&&this.range.setEnd(this.range.endContainer,this.range.endContainer.nodeValue.length);var i=n?n:t;if(!i&&!u){var r=this.range.cloneContents();r&&(i=this.getAnchorUrl(r.firstChild))}this.select();return i};SelectionRange.prototype.getAnchorUrl=function(n){if(!n)return null;if(n.nodeName.toUpperCase()=="A")return n.getAttribute("href");else if(n.nodeType==OwaEditor.NodeType.Text&&n.parentNode.nodeName.toUpperCase()=="A")return n.parentNode.getAttribute("href");return null};OwaEditor==null&&(OwaEditor={});(function(){OwaEditor.ExecCommand={};OwaEditor.ExecCommand.execute=function(n,t,i,r,u){t=t.toLowerCase();switch(t){case"createlink":if(OwaEditor.Utility.isIE())n&&n.selection&&n.selection.type&&n.selection.type!="None"&&n.execCommand(t,!0,r);else{var w=isDf(typeof L_Hyprlnk)?L_Hyprlnk:"";var c=r?r:"http://";var e=prompt(w,c);if(e&&e!=c){var o=createSelectionRange(n);if(!o)break;o.selectionExists()&&n.execCommand("unlink",!1,null);!o.selectionExists()&&OwaEditor.Utility.isFirefox()?o.pasteHtml(OwaEditor.UIControls.Editor.prototype._applyLink(e)):n.execCommand(t,!1,e)}}break;case"backcolor":r="#"+r;n.execCommand(t,i,r);break;case"forecolor":if(OwaEditor.Utility.isSafari()){r="#"+r;n.execCommand(t,i,r)}else n.execCommand(t,i,r);break;case"insertorderedlist":case"insertunorderedlist":if(OwaEditor.Utility.isIE()){var l=createSelectionRange(n);if(!l)break;var f=OwaEditor.Utility.getParentOlUl(l.parentElement());if(f&&(f.tagName==UL_TAGNAME&&t=="insertunorderedlist"||f.tagName==OL_TAGNAME&&t=="insertorderedlist")){u._markFocus();for(var s=0;s<f.childNodes.length;s++){for(var h=n.createElement(P_TAGNAME),a=f.childNodes[s];a.childNodes.length>0;)h.appendChild(a.childNodes[0]);if(!OwaEditor.Dom.NonSingletonNode._isIgnorableNode(h)){var v=OwaEditor.Dom.Node.wrapDomNode(f);var y=OwaEditor.Dom.Node.wrapDomNode(h);var p=v.getAttribute("dir");p&&y.setAttribute("dir",p);v.insertAdjacentElement(OwaEditor.ElementInsertionPoint.BeforeBegin,y)}}f.parentNode.removeChild(f);u._focusOnFocusMark();break}}n.execCommand(t,i,r);break;default:n.execCommand(t,i,r);break}}})();g_fModuleLoaded[".\\uicontrols/colorpicker.js".toLowerCase()]||function(){var n="onColorSelected";var t='<a onclick="event.returnValue=false;" href="#" unselectable="on">';var i="</a>";OwaEditor.UIControls.ColorPicker=function(n,t,i,r,u,f,e,o,s,h){var c=this._generatePickerElement(t,i,r,u,f,e,s,h);OwaEditor.UIControls.ColorPicker.constructBase(this,[c,t]);this.set_SubPage(n);this.sDefaultColorValue=o;this.sColorValue=o;this.oDialogHelper=h;OwaEditor.UIControls.ColorPicker.callBase(this,"initialize");this._attachEvent(this._get_Element(),"click",this._onClick)};OwaEditor.UIControls.ColorPicker.prototype.dispose=function(){this._get_Element().detachAllEvents();this._get_Element().remove(!0);OwaEditor.UIControls.ColorPicker.callBase(this,"dispose")};OwaEditor.UIControls.ColorPicker.prototype._onClick=function(t){var i=t.get_Target();i.hasCssClass("colorCell")&&(i=i.get_ParentElement());if(i.hasCssClass("colorPickerCell")||i.hasCssClass("colorPickerButton")){if(i.get_Id()=="spanColorPickerMoreCell"){var r=this.oDialogHelper.ChooseColorDlg(this.sColorValue);r=r.toString(16);if(r.length<6){var u="000000".substring(0,6-r.length);r=u.concat(r)}this.sColorValue=r}else this.sColorValue=i.get_Id()=="spanColorPickerNoneCell"?this.sDefaultColorValue:i.getAttribute("sV");this._dispatchEvent(n,this)}};OwaEditor.UIControls.ColorPicker.prototype.get_OnColorSelected=function(){return this._getEventHandlerCollection(n)};OwaEditor.UIControls.ColorPicker.prototype._generatePickerElement=function(n,r,u,f,e,o,s,h){var v=OwaEditor.Utility.isIE()?t:"";var y=OwaEditor.Utility.isIE()?i:"";var c="";c+='<DIV id="divColors">';for(var p=0;p<u;p++){for(var w=0;w<f;w++){var l=e(p,w,u,f);c+=v;c+='<DIV class="fltBefore colorPickerCell"';c+=l.sValue!=null?" sV="+l.sValue:"";c+="><DIV";c+=' class="colorCell ';c+=l.sClass?l.sClass:"";c+='"';c+=l.sStyle?" style="+l.sStyle:"";c+="></DIV></DIV>";c+=y}c+='<DIV class="clear"></DIV>'}c+="</DIV>";if(s){c+=v;c+='<DIV class="colorPickerActions">';if(s){c+=v;c+='<SPAN class="colorPickerButton" id="spanColorPickerNoneCell">'+o+"</SPAN>";c+=y}c+="</DIV>";c+=y}var k=n?n.get_OwnerDocument():OwaEditor.Dom.Document.get_Current();var a=k.createElement("div");a.set_Id(r);a.set_CssClasses(["colorPicker","contextMenuDropShadow"]);a.set_InnerHtml(c);var b=a.getDescendantById("divColors");b.set_Width(f*20);b.set_Height(u*20);return a};OwaEditor.UIControls.ColorPicker.createClass("OwaEditor.UIControls.ColorPicker",OwaEditor.UIControls.UIControl)}();g_fModuleLoaded[".\\uicontrols/colorpicker.js".toLowerCase()]=1;g_fModuleLoaded[".\\uicontrols/colorpickerpopup.js".toLowerCase()]||function(){OwaEditor.UIControls.ColorPickerPopup=function(n,t,i,r,u,f,e,o,s,h,c,l){this.fnOnPick=e;this.oColorPicker=new OwaEditor.UIControls.ColorPicker(n,t,i,r,u,f,o,s,h,c);var a=this.oColorPicker._get_Element();var v=t.get_OwnerDocument();v.get_Body().insertAdjacentElement(OwaEditor.ElementInsertionPoint.BeforeEnd,a);a.addCssClass("pu");a.set_IsShown(!1);OwaEditor.UIControls.ColorPickerPopup.constructBase(this,[a,t,l]);this.set_SubPage(n);this.oColorPicker.get_OnColorSelected().add(this._createCallback(this._onPickInternal));OwaEditor.UIControls.ColorPickerPopup.callBase(this,"initialize")};OwaEditor.UIControls.ColorPickerPopup.prototype.dispose=function(){this.oColorPicker.dispose();OwaEditor.UIControls.ColorPickerPopup.callBase(this,"dispose")};OwaEditor.UIControls.ColorPickerPopup.prototype._onPickInternal=function(n){this.sColorValue=n.sColorValue;this.fnOnPick&&this.fnOnPick(this);this.close()};OwaEditor.UIControls.ColorPickerPopup.prototype.showUnderParent=function(){this.showUnder(this._get_Parent(),0)};OwaEditor.UIControls.ColorPickerPopup.createClass("OwaEditor.UIControls.ColorPickerPopup",OwaEditor.UIControls.Popup)}();g_fModuleLoaded[".\\uicontrols/colorpickerpopup.js".toLowerCase()]=1;g_fModuleLoaded[".\\uicontrols/editor.js".toLowerCase()]||function(){Type.createNamespace("OwaEditor.UIControls");var y=80;var s="fitToWindow";var c="100";var b="25";var k="50";var d="200";var p=0;var l=5;var g=BTN_BIU|BTN_LISTS|BTN_FORE_COLOR|BTN_BACK_COLOR|BTN_CUSTOMIZE;var nt="Calibri";var tt=3;var t=[["divBiu",BTN_BIU],["divStrkThr",BTN_STRIKE],["divJstfy",BTN_JUSTIFY],["divLsts",BTN_LISTS],["divIndntg",BTN_INDENT],["divBkClr",BTN_BACK_COLOR],["divFrClr",BTN_FORE_COLOR],["divRmvFmt",BTN_REMOVE_FORMAT],["divInsRl",BTN_INSERT_RULE],["divUndng",BTN_UNDO_REDO],["divHLkng",BTN_LINKS],["divSprSb",BTN_SUBSCRIPT_SUPERSCRIPT],["divDir",BTN_DIR]];var w=["","10px","13px","16px","18px","24px","32px","48px"];var i=["","8pt","10pt","12pt","14pt","18pt","24pt","36pt"];var h="fbBtnMsDn";var a="fbBtnPushed";var r="fbBtnDa";var it=[["000000","993300","333300","003300","003366","000080","333399","333333"],["800000","FF6600","808000","008000","008080","0000FF","666699","808080"],["FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","999999"],["FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0"],["FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","99CCFF","CC99FF","FFFFFF"]];var u='<a onclick="event.returnValue=false;" href="#" unselectable="on" tabindex="-1">';var f="</a>";var v=["www.","http://","https://","file://","ftp://","gopher://","mailto:","news:","telnet:","wais:"];var e=[["<",">"],["(",")"],['"','"']];var o="divtagdefaultwrapper";var rt=/(<body[^>]*>)/i;var ut=/(<\/body[^>]*>)/i;var ft='$1<div name="'+o+'" id="'+o+'" style="';var et="</div>$1";OwaEditor.UIControls.Editor=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,it,rt,ut,et,ot,st,ht){this._fIsInECP=b?b:0;var at=null;if(this._isResizeMenuSupported()){if(i==null||i===undefined)throw new Error("Argument oResizeMenuDom can't be null or undefined");if(s==null||s===undefined)throw new Error("Argument rgsResizeImageMenuItems can't be null or undefined");if(s!==null&&s!==undefined&&Array.isInstance!=undefined&&!Array.isInstance(s))throw new Error("Argument rgsResizeImageMenuItems is not of type Array");at=OwaEditor.Dom.Node.wrapDomNode(i)}var ct=OwaEditor.Dom.Node.wrapDomNode(n);var lt=OwaEditor.Dom.Node.wrapDomNode(t).get_ContentDocument();do if(ct==null||ct===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+183+"]: argument "+"oEm"+" can't be null or undefined");while(0);do if(lt==null||lt===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+184+"]: argument "+"oD"+" can't be null or undefined");while(0);do if(r==null||r===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+185+"]: argument "+"rgsBIU"+" can't be null or undefined");while(0);do if(u==null||u===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+186+"]: argument "+"rgsButtonTooltips"+" can't be null or undefined");while(0);do if(f==null||f===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+187+"]: argument "+"rgsCustomizeTooltips"+" can't be null or undefined");while(0);do if(e==null||e===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+188+"]: argument "+"sNoneButtonString"+" can't be null or undefined");while(0);do if(h==null||h===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+189+"]: argument "+"fnGetImagePath"+" can't be null or undefined");while(0);if(!this._fIsInECP)do if(o==null||o===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+187+"]: argument "+"rgsLinkAndImageTooltips"+" can't be null or undefined");while(0);do if(ct!==null&&ct!==undefined&&OwaEditor.Dom.Element.isInstance!=undefined&&!OwaEditor.Dom.Element.isInstance(ct))throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+193+"]: argument "+"oEm"+" is not of type "+"OwaEditor.Dom.Element");while(0);do if(lt!==null&&lt!==undefined&&OwaEditor.Dom.Node.isInstance!=undefined&&!OwaEditor.Dom.Node.isInstance(lt))throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+194+"]: argument "+"oD"+" is not of type "+"OwaEditor.Dom.Node");while(0);do if(r!==null&&r!==undefined&&Array.isInstance!=undefined&&!Array.isInstance(r))throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+195+"]: argument "+"rgsBIU"+" is not of type "+"Array");while(0);do if(u!==null&&u!==undefined&&Array.isInstance!=undefined&&!Array.isInstance(u))throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+196+"]: argument "+"rgsButtonTooltips"+" is not of type "+"Array");while(0);do if(f!==null&&f!==undefined&&Array.isInstance!=undefined&&!Array.isInstance(f))throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+197+"]: argument "+"rgsCustomizeTooltips"+" is not of type "+"Array");while(0);do if(e!==null&&e!==undefined&&String.isInstance!=undefined&&!String.isInstance(e))throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+198+"]: argument "+"sNoneButtonString"+" is not of type "+"String");while(0);do if(h!==null&&h!==undefined&&Function.isInstance!=undefined&&!Function.isInstance(h))throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+199+"]: argument "+"fnGetImagePath"+" is not of type "+"Function");while(0);if(!this._fIsInECP)do if(o!==null&&o!==undefined&&Array.isInstance!=undefined&&!Array.isInstance(o))throw new Error("Assert fail: argument "+"rgsLinkAndImageTooltips"+" is not of type "+"Array");while(0);OwaEditor.UIControls.Editor.constructBase(this);this._oResizeMenuElement=at;this._oFormatBarElement=ct;this._oEditor=lt;this._oPopupCustom=null;this._oPopupForeColorPicker=null;this._oPopupBackColorPicker=null;this._rgButtonGroups=null;this._rgCustomButtons=null;this._rgMruFonts=[];this._oDialogHelper=l?l:null;this._oBookmark=null;this._fBookmarkExpanded=!1;this._sMruFontList="";this._rgFontList=null;this._sInitialHtml=a;this._rgsBIU=r;this._rgsButtonTooltips=u;this._rgsCustomizeTooltips=f;this._sNoneButtonString=e;this._rgsLinkAndImageTooltips=o;this._rgsResizeImageMenuItems=s;this._composeFontFlags=et;this._rgsMruFnts=ot;this._fnOnready=k;this._fnUpdateClientCache=d;this._fnUpdateButtonState=it;this._fnUpdateFontsMru=rt;this._onShiftTabOnRteCallback=st;this._openUrlCallback=ht;this._fnGetImagePath=h;this._fnButtonStateUpdateDisplayed=ut;this._iButtonState=c?c:g;this._sDefaultFont=v?v:nt;this._iDefaultFontSize=y?y:tt;this._sDefaultCss=this._generateCss(this._sDefaultFont,y,p);this._sStartBodyReplace=ft+this._sDefaultCss+'">';this._iUpdateCounter=0;this._fIsEnabled=!0;this._fInitSelection=0;this._iTimerId=null;this._fIsNonEditable=w?w:0;this._fRdy=0;this._initialize();if(OwaEditor.Utility.isIE()){this._redoUndoManager=new OwaEditor.RedoUndoManager;this._fStartDeleteSequence=!0}};var n=OwaEditor.UIControls.Editor.prototype;n.getHtml=function(n,t){if(!this._oEditor.get_Body())return"";var i;var u=this._fAppliedDefaultFonts;if(n){var o=this.removeStyleSheet("owaTempEditStyle");var s=this.removeStyleSheet("owaPrintStyle");i=this._oEditor.get_DocumentElement().get_OuterHtml();o&&this._applyDefaultFonts();s&&this.applyNoPrintStyles();var r=this._oEditor.get_Body().getChildrenSnapshot();var f=this._getDefaultFontDiv(r,this._sDefaultCss);!t&&u&&null!=f?i=i.replace(rt,this._sStartBodyReplace).replace(ut,et):null==f&&r.length==1&&r[0]&&this._applyCssToDomNode(r[0]._get_DomNode(),this._sDefaultCss)}else if(u&&!t){var h=this._wrapBodyChildrenWithDefaultFont(this._sDefaultCss,this._oEditor.get_Body().clone(1));i=h.get_InnerHtml()}else{var e=this._oEditor.get_Body().getChildrenSnapshot();var c=this._getDefaultFontDiv(e,this._sDefaultCss);i=t&&c==null?e[0].get_InnerHtml():this._oEditor.get_Body().get_InnerHtml()}return ot(i)};function ot(n){for(var f=n.toUpperCase(),r=0;r<STYLETAGS.length;++r){sTag=STYLETAGS[r].toUpperCase();var u=sTag.length;var t=f.indexOf(sTag);if(t!=-1){var i=f.indexOf("</STYLE>",t);if(i!=-1){n=n.substr(0,t+u)+"<!--"+n.substr(t+u,i-t-u)+"-->"+n.substr(i,n.length-i);return n}}}return n}n.setHtml=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+348+"]: argument "+"sHtml"+" can't be null or undefined");while(0);if(OwaEditor.Utility.isFirefox()&&this._oEditor.get_IsDesignMode()){this._getIframeContentWindow().detachAllEvents();this._initDocument(n);this._getIframe().get_ContentDocument().set_IsRtl(g_fRtl);this._attachContentWindowEvents()}else this._oEditor.get_Body().set_InnerHtml(n)};n.getTextContent=function(){var n=this._oEditor.get_Body().get_TextContent();return n==undefined?null:n};n.insertMarkupAtCursor=function(n,t){t?this.internalInsertMarkupAtCursor(n):this.focus(OwaEditor.Utility.createContextDelegate(this,this.internalInsertMarkupAtCursor,n))};n.internalInsertMarkupAtCursor=function(n){if(n==null||n===undefined)throw new Error("Assert fail: argument sHtml can't be null or undefined");var t=createSelectionRange(this._oEditor._get_DomDocument());if(t){t.pasteHtml(n);this._setDirty()}};n.removePStyles=function(n){var t=/(<style[^>]*>)[\s]*p[\s]*{[^}]*}/i;var i=/}[\s]*p[\s]*{[^}]*/gi;return n.replace(t,"$1").replace(i,"")};n._internalFocus=function(){var n=this._oEditor;n&&n.get_ContainerWindow()._domWindow.focus()};n.focus=function(n,t,i,r){setTimeout(function(u){return function(){u._internalFocus();n&&n(t,i,r)}}(this),100)};n.getFormatBarState=function(){var n=this._getFontNameComboBox();var t=this._getFontSizeComboBox();var i=n.get_SelectedValue();var r=parseInt(t.get_SelectedValue());var u=this._oFormatBarElement.getDescendantById("divBoldBtn").getBoolAttribute("_pushed");var f=this._oFormatBarElement.getDescendantById("divItalicsBtn").getBoolAttribute("_pushed");var e=this._oFormatBarElement.getDescendantById("divUnderlineBtn").getBoolAttribute("_pushed");var o=this._getForeColorPicker().sColorValue;var s=this._getBackColorPicker().sColorValue;return new this.FormatBarState(i,r,u,f,e,o,s)};n.setFormatBarState=function(n){do if(n==null||n===undefined)throw new Error("Assert fail ["+".\\uicontrols/editor.js"+":"+462+"]: argument "+"oFormatBarState"+" can't be null or undefined");while(0);var t=this._getFontNameComboBox();var i=this._getFontSizeComboBox();if(n.sFontName){t.get_DropDownList().hasValue(n.sFontName)||this._addFont(n.sFontName,t.get_DropDownList());t.set_SelectedValue(n.sFontName)}n.iFontSize&&i.get_DropDownList().hasValue(n.iFontSize)&&i.set_SelectedValue(n.iFontSize);var r=this._oFormatBarElement.getDescendantById("divBoldBtn");if(!!n.fBold!=r.getBoolAttribute("_pushed")){this._pushButton(r,!!n.fBold);this._execCommand("bold")}var u=this._oFormatBarElement.getDescendantById("divItalicsBtn");if(!!n.fItalics!=u.getBoolAttribute("_pushed")){this._pushButton(u,!!n.fItalics);this._execCommand("italic")}var f=this._oFormatBarElement.getDescendantById("divUnderlineBtn");if(!!n.fUnderline!=f.getBoolAttribute("_pushed")){this._pushButton(f,!!n.fUnderline);this._execCommand("underline")}if(n.sTextColor){this._getForeColorPicker().sColorValue=n.sTextColor;this._execCommand("forecolor",0,n.sTextColor)}if(n.sHighlightColor){this._getBackColorPicker().sColorValue=n.sHighlightColor;this._execCommand("backcolor",0,n.sHighlightColor)}};n.FormatBarState=function(n,t,i,r,u,f,e){this.sFontName=n;this.iFontSize=t;this.fBold=i;this.fItalics=r;this.fUnderline=u;this.sTextColor=f;this.sHighlightColor=e};n.dispose=function(){this._oEditor.detachAllEvents();this._hideCustomTooltip();if(this._oResizeImageMenu){this._closeResizeImageMenu();this._oResizeImageMenu.oImage&&(this._oResizeImageMenu.oImage=null);this._oResizeImageMenu.dispose()}this.deactivateFormatBar();for(var r=this._oFormatBarElement.getChildrenSnapshot(),i=0;i<r.length;i++){var u=r[i];if(u.hasCssClass("fbBtnGrp"))for(var t=u.getChildrenSnapshot(),n=0;n<t.length;n++){var s=t[n].hasChildNodes()?t[n].get_FirstChild():t[n];s.detachAllEvents()}}this._oFormatBarElement.detachAllEvents();this._oFormatBarElement.setExpando("formatBar",null);var f=this._getFontNameComboBox();var e=this._getFontSizeComboBox();f&&f.dispose();e&&e.dispose();this._fnOnready=null;if(this._getIframe()){var o=this._getIframeContentWindow();o&&o.detachAllEvents()}this._setFormatBar(this._oEditor,null);this._oPopupForeColorPicker&&this._oPopupForeColorPicker.dispose();this._oPopupBackColorPicker&&this._oPopupBackColorPicker.dispose();this._redoUndoManager&&this._redoUndoManager.Dispose();this._oPopupCustom=null;this._oPopupForeColorPicker=null;this._oPopupBackColorPicker=null;this._rgButtonGroups=this._rgCustomButtons=this._oEditor=null;this._redoUndoManager=this._execCommand=this._updateMRUFonts=this._insertMRUFonts=null;this._initCustomizePane=this._updateButtonsShown=this._saveButtonsShown=this._displayButtons=null;this._initFontComboBoxes=this._initFonts=this._updateButton=this._enableFormatbar=null;OwaEditor.UIControls.Editor.callBase(this,"dispose")};n.enableFormatbar=function(n,t){if(this._fRdy&&this._fIsEnabled!=n){this._iUpdateCounter=n?this._iUpdateCounter-1:this._iUpdateCounter+1;if(t){n?this._getIframe().removeCssClass("editorDisabled"):this._getIframe().addCssClass("editorDisabled");OwaEditor.Utility.isIE()?this._oEditor.get_Body()._oDomNode.disabled=!n:this._changeDesignMode(n)}n||this.deactivateFormatBar();if(this._rgButtonGroups)for(var i=0;i<this._rgButtonGroups.length;i++)if(this._rgButtonGroups[i].get_IsShown())for(var u=this._rgButtonGroups[i].getChildrenSnapshot(),r=0;r<u.length;r++){var f=u[r];this._enableButton(f,n)}var e=this._getFontNameComboBox();var o=this._getFontSizeComboBox();e.set_IsEnabled(n);o.set_IsEnabled(n);this._fIsEnabled=n}};n.activateFormatBar=function(){if(!this._iTimerId&&this._oFormatBarElement.get_IsShown()){var n='OwaEditor.UIControls.Editor.prototype._updateFormatbarHelper("'+this._oFormatBarElement.get_Id()+'")';this._iTimerId=window.setTimeout(n,500)}};n.deactivateFormatBar=function(){if(this._iTimerId!=null){window.clearTimeout(this._iTimerId);this._iTimerId=null}};n._initialize=function(){OwaEditor.UIControls.Editor.callBase(this,"initialize");this._fIsNonEditable||this._getIframe().get_ContentDocument().set_DesignMode(1);this._oFormatBarElement.setExpando("formatBar",this);if(!this._oEditor._get_DomDocument().body||this._sInitialHtml){var n="<!DOCTYPE html>";var i="IE=10";var t='<meta http-equiv="X-UA-Compatible" content="'+i+'">';var f='<meta content="'+i+'" http-equiv="X-UA-Compatible">';var r;if(this._sInitialHtml){(OwaEditor.Utility.isIE()||OwaEditor.Utility.isFirefox())&&this._sInitialHtml.indexOf(n)<0&&(this._sInitialHtml=n+this._sInitialHtml);var u=/(<head\s+[^>]*>|<head>)/i;OwaEditor.Utility.isIE()&&u.test(this._sInitialHtml)&&this._sInitialHtml.indexOf(t)<0&&this._sInitialHtml.indexOf(f)<0&&(this._sInitialHtml=this._sInitialHtml.replace(u,"$1"+t))}else r=OwaEditor.Utility.isIE()?n+"<html><head>"+t+"</head><body><p></p></body></html>":OwaEditor.Utility.isFirefox()?n+"<html><head></head><body></body></html>":"<html><head></head><body></body></html>";this._initDocument(this._sInitialHtml?this._sInitialHtml:r);OwaEditor.Utility.isFirefox()&&this._focusAfterReplyDiv()}this._getIframe().get_ContentDocument().set_IsRtl(g_fRtl);this._buildSingleFormatbar();this._isResizeMenuSupported()&&this._buildImageResizeMenu();if(!this._fIsNonEditable){this._applyEditorStyles();this._attachContentWindowEvents()}this._fRdy=1;this._fnOnready&&this._fnOnready()};n._applyEditorStyles=function(){this._applyDefaultFonts();applyParagraphStylesToDocument(this._oEditor,0)};n._initDocument=function(n){var t=this._oEditor._oDomNode;t.open();t.write(n);t.close()};n._attachContentWindowEvents=function(){var n=this._getIframeContentWindow();if(OwaEditor.Utility.isIE()){this._oEditor.attachEvent("mousedown",this._createCallback(this._onMouseDownBody));this._oEditor.attachEvent("activate",this._createCallback(this._onFocus));this._oEditor.attachEvent("beforedeactivate",this._createCallback(this._onBlur))}else{n.attachEvent("mousedown",this._createCallback(this._onMouseDownBody));n.attachEvent("focus",this._createCallback(this._onFocus));n.attachEvent("blur",this._createCallback(this._onBlur))}this._oEditor.attachEvent("keydown",this._createCallback(this._onKeyDownBody));this._oEditor.attachEvent("click",this._createCallback(this._onClick));this._oEditor.attachEvent("mousemove",this._createCallback(this._onMouseMove));this._oEditor.attachEvent("mouseover",this._createCallback(this._onMouseOver));this._oEditor.attachEvent("mouseup",this._createCallback(this.onMouseUp))};n._buildImageResizeMenu=function(){if(!this._rgsResizeImageMenuItems)throw new Error("Assert fail. this._rgsResizeImageMenuItems shouldn't be null or undefined. ");var t=[b,k,c,d,s];if(this._rgsResizeImageMenuItems.length!=t.length+1)throw new Error("Assert fail. rgsResizeImageMenuItems passed to OwaEditor$UIControls$Editor has incorrect length.");var n="<DIV id=cmpane></DIV>";n+="<DIV class=rszHd noWrap>"+this._rgsResizeImageMenuItems[this._rgsResizeImageMenuItems.length-1]+"</DIV>";for(var r=t.length-1,i=0;i<r;i++)n+=this._generateResizeMenuItemMarkup(t[i],this._rgsResizeImageMenuItems[i]);n+='<DIV class=cmDvdr _isMnuDvdr="1"><SPAN>&nbsp;</SPAN></DIV>';n+=this._generateResizeMenuItemMarkup(t[r],this._rgsResizeImageMenuItems[r]);this._fnGetImagePath("clear1x1.gif");this._oResizeMenuElement.set_InnerHtml(n)};n._buildSingleFormatbar=function(){this._oFormatBarElement.set_InnerHtml(this._generateFormatBarMarkup());var u=this._oFormatBarElement.getDescendantsByTagName("div");this._rgButtonGroups=[];for(var n=0;n<u.length;n++)u[n].hasCssClass("fbBtnGrp")&&this._rgButtonGroups.push(u[n]);this._oFormatBarElement.attachEvent("click",this._createCallback(this._onClickFormatbar));var h=this._getFontNameComboBoxElement();var c=this._getFontSizeComboBoxElement();h.getDescendantById("divCmbDd")._get_DomNode().tabIndex=c.getDescendantById("divCmbDd")._get_DomNode().tabIndex=-1;this._setFormatBar(this._oEditor,this);if(g_fRtl&&this._rgsButtonTooltips.length==24){var f=this._rgsButtonTooltips[4];this._rgsButtonTooltips[4]=this._rgsButtonTooltips[6];this._rgsButtonTooltips[6]=f;f=this._rgsButtonTooltips[21];this._rgsButtonTooltips[21]=this._rgsButtonTooltips[22];this._rgsButtonTooltips[22]=f}for(var e=0,o=this._oFormatBarElement.getChildrenSnapshot(),n=0;n<o.length;n++){var s=o[n];if(s.hasCssClass("fbBtnGrp"))for(var r=s.getChildrenSnapshot(),i=0;i<r.length;i++){var t=r[i].hasChildNodes()?r[i].get_FirstChild():r[i];t.setAttribute("alt",this._rgsButtonTooltips[e]);t.set_Title(this._rgsButtonTooltips[e]);e++;t.setExpando("_pushed",!1);t.attachEvent("mouseover",this._onMouseFormatbar);t.attachEvent("mousedown",this._onMouseDownUpFormatbar);t.attachEvent("mouseup",this._onMouseDownUpFormatbar);t.attachEvent("mouseout",this._onMouseDownUpFormatbar)}}this._oPopupForeColorPicker=null;this._oPopupBackColorPicker=null;this._initFontComboBoxes();this.fDelayFonts?this._setTimeout(this._createCallback(this._initFonts),10):this._initFonts();this._displayButtons()};n._initFonts=function(){var t=this._getFontNameComboBox().get_DropDownList();if(typeof this._rgsMruFnts!="undefined"&&this._rgsMruFnts&&this._rgsMruFnts!="")for(var n=0;n<this._rgMruFonts.length;n++)this._addFont(this._rgMruFonts[n],t,1);if(!this._rgFontList||!this._rgFontList.length){var i=0;if(this._oDialogHelper&&this._oDialogHelper.fonts){this._rgFontList=new Array(this._oDialogHelper.fonts.count);for(var n=0;n<this._rgFontList.length;n++){this._rgFontList[n]=this._oDialogHelper.fonts(n+1);this._rgFontList[n]==this._sDefaultFont&&(i=1)}}else{this._rgFontList=[];for(var r=0;r<DEFAULT_FONT_TABLE.length;++r){var u=DEFAULT_FONT_TABLE[r][FONTNAME_COLUMN];this._rgFontList.push(u);u==this._sDefaultFont&&(i=1)}}i||this._rgFontList.push(this._sDefaultFont);this._rgFontList.sort();this._fnUpdateClientCache&&this._fnUpdateClientCache(CC_FNTLST,this._rgFontList)}for(var n=0;n<this._rgFontList.length;n++)this._addFont(this._rgFontList[n],t);t._remove(0);t.selectValue(this._sDefaultFont,1)};n._addFont=function(n,t,i){var r;r=i?this._generateFontEntryMarkup(n,!0):this._generateFontEntryMarkup(n,!1);this._addFontEntryToComboBox(n,r,t)};n._addFontSizeEntries=function(){var n=this._getFontSizeComboBox().get_DropDownList();this._addFontSize(1,8,n);this._addFontSize(2,10,n);this._addFontSize(3,12,n);this._addFontSize(4,14,n);this._addFontSize(5,18,n);this._addFontSize(6,24,n);this._addFontSize(7,36,n)};n._addFontSize=function(n,t,i){var r=this._generateFontSizeEntryMarkup(n,t);this._addFontEntryToComboBox(n,r,i)};n._addFontEntryToComboBox=function(n,t,i){var r=OwaEditor.Dom.Document.get_Current().createElement("div");r.set_InnerHtml(t);r=r.get_FirstChild();i._get_Element().insertAdjacentElement(OwaEditor.ElementInsertionPoint.BeforeEnd,r);OwaEditor.Utility.isIE()&&(r=r.get_FirstChild());i._addDomItem(r,n)};n._initFontComboBoxes=function(){var i=this._getFontNameComboBoxElement();var r=this._getFontSizeComboBoxElement();var u=OwaEditor.Utility.isIE()&&!this._fIsNonEditable;var n=new OwaEditor.UIControls.ComboBox(i,null,u,1);var t=new OwaEditor.UIControls.ComboBox(r,null,u,1);n.initialize();t.initialize();i.setExpando("oComboBox",n);r.setExpando("oComboBox",t);n.get_OnChange().add(this._createCallback(this._onChangeFont));t.get_OnChange().add(this._createCallback(this._onChangeFont));this._addFont(this._sDefaultFont,n.get_DropDownList());n.set_SelectedValue(this._sDefaultFont,1);this._addFontSizeEntries();t.set_SelectedValue(this._iDefaultFontSize,1)};n._initCustomizePane=function(n){var i=n.createElement("DIV");i.set_IsShown(!1);i.set_InnerHtml(this._generateCustomButtonsPaneMarkup());this._rgCustomButtons=[i.getDescendantById("chkBiu"),i.getDescendantById("chkStrkThr"),i.getDescendantById("chkJstfy"),i.getDescendantById("chkLsts"),i.getDescendantById("chkIndntg"),i.getDescendantById("chkBkClr"),i.getDescendantById("chkFrClr"),i.getDescendantById("chkRmvFmt"),i.getDescendantById("chkInsRl"),i.getDescendantById("chkUndng"),i.getDescendantById("chkHLkng"),i.getDescendantById("chkSprSb"),i.getDescendantById("chkDir")];for(var r=0;r<this._rgCustomButtons.length;r++){this._rgCustomButtons[r].set_IsChecked(t[r][1]&this._iButtonState);this._rgCustomButtons[r].attachEvent("click",this._createCallback(this._updateButtonsShown));this._rgCustomButtons[r].set_Title(r<this._rgsCustomizeTooltips.length?this._rgsCustomizeTooltips[r]:"")}var u=i.get_FirstChild();this._oFormatBarElement.appendChild(u);u._oDomNode.style.zIndex=10;return u};n._onChangeFont=function(n){var t=this;var i=n._get_Element().getAttribute("_cmd");t._iUpdateCounter++;i!="fontname"||this._fIsNonEditable||t._updateMRUFonts();t._execCommand(i,!1,this._getFontFamily(n.get_SelectedValue()));t._iUpdateCounter--};n._onMouseFormatbar=function(t){t.cancelBubble();var i=t.get_Target();var e="fbBiu";var u=0;if(i.hasCssClass(e)){i=i.get_ParentElement();u=1}if(n._isButton(i)){var f=i.getAncestorByTag("div");var o=f&&!u?f:i;o.hasCssClass(r)}};n._onMouseDownUpFormatbar=function(t){t.cancelBubble();var i=t.get_Target();i=i.getAncestorByTag("div");if(i!=null&&i!==undefined&&n._isButton(i)&&!i.hasCssClass(r))if("mousedown"==t.get_Type())i.hasCssClass(h)||i.addCssClass(h);else if("mouseup"==t.get_Type()||"mouseout"==t.get_Type())i.hasCssClass(h)&&i.removeCssClass(h);else throw new Error("Assert fail. OwaEditor$UIControls$Editor$_onMouseDownUpFormatbar should be called"+" only on mousedown and mouseup. ");};n._onClickFormatbar=function(n){var t=this;t._iUpdateCounter++;for(var i=n.get_Target();!i.getAttribute("_cmd")&&i.get_TagName()!=BODY_TAGNAME;)i=i.get_ParentElement();if(i.hasCssClass(r)){t._iUpdateCounter--;return}var u=i.getAttribute("_cmd");t._closePopups(u);if(!u||i._get_DomNode().disabled){t._iUpdateCounter--;return}n.preventDefault();n.cancelBubble();t._setDirty();switch(u){case"backcolor":try{t._getBackColorPicker().showUnderParent()}catch(s){}break;case"createlink":if(OwaEditor.Utility.isIE())t._execCommand(u,!0,e);else{var f=createSelectionRange(this._oEditor._get_DomDocument());if(!f)break;var e=f.expandSelectionAroundAnchors();t._execCommand(u,!1,e)}break;case"chevrons_down":if(!t._oPopupCustom){var o=t._initCustomizePane(i.get_OwnerDocument());t._oPopupCustom=new OwaEditor.UIControls.Popup(o);t._oPopupCustom.initialize()}t._oPopupCustom.showUnder(i);break;case"forecolor":try{t._getForeColorPicker().showUnderParent()}catch(s){}break;case"fontname":case"fontsize":break;case"subscript":t._execCommand(u);t._oEditor._oDomNode.queryCommandState("superscript")&&t._execCommand("superscript");break;case"superscript":t._execCommand(u);t._oEditor._oDomNode.queryCommandState("subscript")&&t._execCommand("subscript");break;default:t._execCommand(u);break}t._fIsNonEditable&&(u=="bold"||u=="italic"||u=="underline")&&t._pushButton(i,!i.getBoolAttribute("_pushed"));t._iUpdateCounter--};n._onBlur=function(n){if(n._oEvent.toElement==null){this._storeSelection();this.deactivateFormatBar()}};n._onFocus=function(n){this._restoreSelection();var t=this;t._closePopups();t.activateFormatBar()};n._onMouseDownBody=function(n){this._redoUndoManager&&(this._fStartDeleteSequence=!0);this._oBookmark=null;var t=this._getEventTargetAnchorElement(n);n.isCtrlKeyDown()&&t&&!OwaEditor.Utility.isFirefox()&&(this._openUrlCallback?this._openUrlCallback(t.getAttribute("href"),"_blank"):OwaEditor.Dom.Window.get_Current().open(t.getAttribute("href"),"_blank"))};n._isMovementKeyDownBody=function(n){return n==OwaEditor.KeyCodes.DOWN||n==OwaEditor.KeyCodes.END||n==OwaEditor.KeyCodes.HOME||n==OwaEditor.KeyCodes.LEFT||n==OwaEditor.KeyCodes.PAGE_DOWN||n==OwaEditor.KeyCodes.PAGE_UP||n==OwaEditor.KeyCodes.RIGHT||n==OwaEditor.KeyCodes.UP};n._onKeyDownBody=function(n){if(this._oEditor.get_IsDesignMode()&&n){this._applyBIUStyles(this._oEditor);var t=n.get_KeyCodeForKeyUpDown();this._redoUndoManager&&this._isMovementKeyDownBody(t)&&(this._fStartDeleteSequence=!0);if(this._redoUndoManager&&n.isCtrlKeyDown()&&!n.isAltKeyDown())switch(t){case OwaEditor.KeyCodes.Y:if(this._redoUndoManager){this._execCommand("redo");n.preventDefault();n.cancelBubble()}break;case OwaEditor.KeyCodes.Z:if(this._redoUndoManager){this._execCommand("undo");n.preventDefault();n.cancelBubble()}break}else{this._redoUndoManager&&(this._isMovementKeyDownBody(t)||this._redoUndoManager.ClearRedoStack());switch(t){case OwaEditor.KeyCodes.ENTER:case OwaEditor.KeyCodes.SPACEBAR:this._captureState();try{this._checkAndLinkPreviousWord()}catch(e){}break;case OwaEditor.KeyCodes.BACK_SPACE:this._captureState(!0);var r=createSelectionRange(this._oEditor._oDomNode);if(!r)break;var u=r.duplicate();u.collapse(!0);var f=OwaEditor.Dom.Node.wrapDomNode(u.parentElement());if(f.get_TextContent()==""){var i=this._getOfficeList(f);if(i){i.set_Margin(OwaEditor.Style.Side.Left,0);i.set_textIndent(0);n.preventDefault();n.cancelBubble()}}break;case OwaEditor.KeyCodes.TAB:this._handleTab(n);break;case OwaEditor.KeyCodes.DELETE:this._captureState(!0);break}}}};n._onClick=function(n){this._closeResizeImageMenu();this._hideCustomTooltip()};n.onMouseUp=function(n){var t=n.get_Target();if(n.isLeftButtonDown()&&t.get_TagName&&t.get_TagName()&&t.get_TagName().toUpperCase()=="IMG"&&this._isResizeMenuSupported()){if(t.getIntAttribute("fIsPlaceHolder"))return;if(!t.getIntAttribute("fSetResizeHandler")&&OwaEditor.Utility.isIE()){t.attachEvent("resizestart",this._createCallback(this.onImageResize));t.setIntAttribute("fSetResizeHandler",1)}var i=this._getResizeImageMenu(t);if(i.fIsOpen||this._fIsResizeEvent)this._closeResizeImageMenu();else{this._checkExistingSelection(i);i.show(this._getCursorPositionX(n),this._getCursorPositionY(n));this._hideCustomTooltip()}}else this._closeResizeImageMenu();this._fIsResizeEvent=0};n._onMouseOver=function(n){var t=n.get_Target();if(!t.get_TagName()){this._hideCustomTooltip();return}switch(t.get_TagName().toUpperCase()){case"A":this._handleMouseoverLink(n);break;case"IMG":this._handleMouseoverImage(n);break;default:this._hideCustomTooltip();break}};n._onMouseMove=function(n){var t=n.get_Target();if(t.get_TagName&&t.get_TagName())switch(t.get_TagName().toUpperCase()){case"IMG":this._handleMousemoveImage(n);break}};n.onImageResize=function(n){var t=n.get_Target();this._fIsResizeEvent=1;this._closeResizeImageMenu();t.setAttribute("rszImgCmd","clear")};n._handleMouseoverLink=function(n){var t=n.get_Target();var i=t.getAttribute("href");if(i&&i.startsWith){if(i.startsWith("javascript:")){var u=OwaEditor.Dom.Node.wrapDomNode(this._oEditor._oDomNode.createTextNode(t.get_TextContent()));t.get_ParentElement().replaceChild(u,t)}if(this._rgsLinkAndImageTooltips){var r=(OwaEditor.Utility.isMac()?this._rgsLinkAndImageTooltips[0]:this._rgsLinkAndImageTooltips[1])+this._rgsLinkAndImageTooltips[2];var f=OwaEditor.Utility.isSafari()?"\r\n":"<br>";r=htmlEnc(i)+f+r;this._showCustomTooltip(n,r)}}};n._handleMouseoverImage=function(n){if(OwaEditor.Utility.isIE()){var t=n.get_Target();t.setIntAttribute("enterTime",(new Date).getTime());t.setIntAttribute("showedTooltip",0)}};n._handleMousemoveImage=function(n){var t=n.get_Target();if(this._rgsLinkAndImageTooltips&&this._isResizeMenuSupported()&&(!this._oResizeImageMenu||!this._oResizeImageMenu.fIsOpen))if(OwaEditor.Utility.isIE()){if(!t.getIntAttribute("showedTooltip")&&t.getIntAttribute("enterTime")&&(new Date).getTime()-t.getIntAttribute("enterTime")>2e3){this._showCustomTooltip(n,this._rgsLinkAndImageTooltips[3],1);t.setIntAttribute("showedTooltip",1)}}else this._showCustomTooltip(n,this._rgsLinkAndImageTooltips[3],1)};n._showCustomTooltip=function(n,t,i){var r=n.get_Target();if(OwaEditor.Utility.isSafari()||OwaEditor.Utility.isFirefox()&&i){r.set_Title(t);this._rgElementsWithTooltips||(this._rgElementsWithTooltips=[]);this._rgElementsWithTooltips.indexOf(r)<0&&this._rgElementsWithTooltips.add(r)}else{if(!this._oDivTooltip){this._oDivTooltip=OwaEditor.Dom.Document.get_Current().createElement("div");OwaEditor.Dom.Document.get_Current().appendChild(this._oDivTooltip);this._oDivTooltip.addCssClass("tooltip")}this._oDivTooltip.moveToTop();this._oDivTooltip._oDomNode.style.width="";this._oDivTooltip._oDomNode.style.visibility="hidden";this._oDivTooltip._oDomNode.style.whiteSpace="nowrap";this._oDivTooltip.set_InnerHtml(t);this._oDivTooltip.set_IsShown(1);var u=this._oDivTooltip.get_OffsetWidth();var e=this._oDivTooltip.get_OffsetHeight();var f=this._getIframe().get_OffsetWidth();n.get_ClientY()+e+20>this._getIframe().get_OffsetHeight()?this._oDivTooltip.set_Top(this._getCursorPositionY(n)-e-15):this._oDivTooltip.set_Top(this._getCursorPositionY(n)+15);if(n.get_ClientX()+u<f)this._oDivTooltip.set_Left(this._getCursorPositionX(n));else if(u>f){this._oDivTooltip.set_Left(this._getCursorPositionX(n)-n.get_ClientX());this._oDivTooltip._oDomNode.style.width=this._getIframe().get_OffsetWidth()-20+"px"}else this._oDivTooltip.set_Left(this._getCursorPositionX(n)-(n.get_ClientX()+u-f));this._oDivTooltip._oDomNode.style.overflow="hidden";this._oDivTooltip._oDomNode.style.textOverflow="ellipsis";this._oDivTooltip._oDomNode.style.visibility="visible"}};n._hideCustomTooltip=function(){this._oDivTooltip&&this._oDivTooltip.get_IsShown()&&this._oDivTooltip.set_IsShown(0)};n._cleanupTooltips=function(){if(this._rgElementsWithTooltips){for(var n=0;n<this._rgElementsWithTooltips.length;n++)this._rgElementsWithTooltips[n]&&this._rgElementsWithTooltips[n].get_Title()&&this._rgElementsWithTooltips[n].removeAttribute("title");this._rgElementsWithTooltips=null}};n._handleTab=function(n){var u="&nbsp;&nbsp;&nbsp;&nbsp;";var t=createSelectionRange(this._oEditor._oDomNode);if(t){var i=t.duplicate();i.collapse(!0);var f=i.parentElement();if(this._isList(f)){var e=this.get_SubPage();n.isShiftKeyDown()?this._execCommand("outdent"):this._execCommand("indent");n.preventDefault()}else if(n.isShiftKeyDown())if(this._onShiftTabOnRteCallback){n.preventDefault();n.cancelBubble();this._onShiftTabOnRteCallback()}else try{n.get_Target().get_OwnerDocument().get_ContainerWindow().get_FrameElement().focus(0)}catch(o){}else{var r=OwaEditor.Dom.Document.get_Current().createElement("div");r.set_InnerHtml(t.htmlText());if(t.getText()==""||r.get_FirstChild()&&r.get_FirstChild().get_NodeType()==3){OwaEditor.Utility.isIE()||i.select();i.pasteHtml(u);OwaEditor.Utility.isIE()&&i.select()}else{t.pasteHtml(this._tabText(r,u));t.select()}n.preventDefault();n.cancelBubble()}}};n._tabText=function(n,t){for(var u=n.getDescendantsByTagName("DIV"),f=n.getDescendantsByTagName(P_TAGNAME),i=0;i<u.length;i++){var r=u[i];r.set_InnerHtml(t+r.get_InnerHtml())}for(var i=0;i<f.length;i++){var r=f[i];r.set_InnerHtml(t+r.get_InnerHtml())}return n.get_InnerHtml()};n._isList=function(n){while(n&&n.tagName!="LI"&&n.tagName!=BODY_TAGNAME)n=n.parentNode;return n&&n.tagName=="LI"};n._getOfficeList=function(n){for(var t=0;n&&n.get_TagName()!=BODY_TAGNAME;){if(n.get_TagName()==P_TAGNAME&&n._oDomNode.className.contains("MsoListParagraph")){t=n;break}n=n.get_ParentElement()}return t};n._getCursorPositionY=function(n){return n.get_ClientY()+this._getIframe().get_DocumentTop()};n._getCursorPositionX=function(n){return n.get_ClientX()+this._getIframe().get_DocumentLeft()};n._closePopups=function(n){var r=this._getFontNameComboBox().get_DropDownList();var u=this._getFontSizeComboBox().get_DropDownList();var t=this._oPopupForeColorPicker;var i=this._oPopupBackColorPicker;r.fIsOpen&&n!="fontname"&&r.close();u.fIsOpen&&n!="fontsize"&&u.close();t&&t.fIsOpen&&n!="forecolor"&&t.close();i&&i.fIsOpen&&n!="backcolor"&&i.close()};n._applyBIUStyles=function(n){if(!this._fAppliedBIUStyles){this._composeFontFlags&FNTFLG_BOLD&&OwaEditor.ExecCommand.execute(n._oDomNode,"bold");this._composeFontFlags&FNTFLG_ITALIC&&OwaEditor.ExecCommand.execute(n._oDomNode,"italic");this._composeFontFlags&FNTFLG_UNDERLINE&&OwaEditor.ExecCommand.execute(n._oDomNode,"underline");this._fAppliedBIUStyles=1}};n._execCommandInternal=function(n,t,i){var r;if(this._fIsNonEditable)if(OwaEditor.Utility.isIE())if(OwaEditor.Utility.get_IEDocumentMode()>8){r=this._oEditor._oDomNode;OwaEditor.ExecCommand.execute(r,"selectall");OwaEditor.ExecCommand.execute(r,n,t,i);OwaEditor.ExecCommand.execute(r,"unselect")}else{var u=createTextRange(this._oEditor._get_DomDocument());r=u.range;OwaEditor.ExecCommand.execute(r,n,t,i)}else{r=this._oEditor._oDomNode;this._changeDesignMode(1);OwaEditor.ExecCommand.execute(r,"selectall");OwaEditor.ExecCommand.execute(r,n,t,i);OwaEditor.Utility.isFirefox()?r.getSelection().removeAllRanges():OwaEditor.ExecCommand.execute(r,"unselect");this._changeDesignMode(0)}else{if(this._redoUndoManager)if(n=="undo"){if(this._redoUndoManager.CanUndo()){this.setHtml(this._redoUndoManager.Undo(this._getStateHtml()));this._focusOnFocusMark();this._fStartDeleteSequence=!0}return}else if(n=="redo"){if(this._redoUndoManager.CanRedo()){this.setHtml(this._redoUndoManager.Redo());this._focusOnFocusMark();this._fStartDeleteSequence=!0}return}else this._captureState();r=this._oEditor._oDomNode;try{OwaEditor.ExecCommand.execute(r,n,t,i,this)}catch(f){}}this._postExecCommand(this,n)};n._execCommand=function(n,t,i){this.focus(OwaEditor.Utility.createContextDelegate(this,this._execCommandInternal,n,t,i))};n._postExecCommand=function(n,t){switch(t){case"insertorderedlist":case"insertunorderedlist":var u=createSelectionRange(n._oEditor._oDomNode);if(!u)break;var r=OwaEditor.Utility.getParentOlUl(u.parentElement());if(r){var o=n._getFontNameComboBox();var s=n._getFontSizeComboBox();var f=o.get_SelectedValue();var e=s.get_SelectedValue();r.style.fontFamily=f?f:this._sDefaultFont;r.style.fontSize=i[e?e:this._iDefaultFontSize];r.style.marginTop="0px";r.style.marginBottom="0px"}break}};n._updateFormatbarHelper=function(t){var r=OwaEditor.Dom.GetElement(t);if(r){var i=r.getExpando("formatBar");n._updateFormatbar(i);if(i){var u='OwaEditor.UIControls.Editor.prototype._updateFormatbarHelper("'+t+'")';i._iTimerId=window.setTimeout(u,500)}}};n._getLocalizedFontName=function(n){for(var t=0;t<LOCALIZED_FONTNAME_TABLE.length;++t)if(LOCALIZED_FONTNAME_TABLE[t][ENGLISHFONTNAME_COLUMN].toLowerCase()==n.toLowerCase())return LOCALIZED_FONTNAME_TABLE[t][LOCALIZEDFONTNAME_COLUMN];return n};n._doesHaveFontName=function(n){return n.tagName==FONT_TAGNAME&&n.face.length>0};n._getChildFontName=function(n){for(var t=null,i=0;i<n.childNodes.length;++i){var r=n.childNodes[i];t=this._doesHaveFontName(r)?r.face:this._getChildFontName(r);if(t)break}return t};n._updateFormatbar=function(n){try{var ft=n._oEditor.get_IsDesignMode()}catch(lt){this.deactivateFormatBar();return}if(n!=null&&n._fRdy&&!n._iUpdateCounter&&ft){n._iUpdateCounter++;for(var i=0;i<n._rgButtonGroups.length;i++)if(n._rgButtonGroups[i].get_IsShown()){if(n._rgButtonGroups[i].get_Id()=="divCstmz")continue;for(var w=n._rgButtonGroups[i].getChildrenSnapshot(),a=0;a<w.length;a++){var et=w[a];n._updateButton(et)}}try{var v=n._oEditor._oDomNode.queryCommandEnabled("fontname")}catch(lt){return}var ot=n._getFontNameComboBoxElement();var st=n._getFontSizeComboBoxElement();var o=n._getFontNameComboBox();var u=n._getFontSizeComboBox();o.set_IsEnabled(v);u.set_IsEnabled(v);ot.getDescendantById("divCmbDd")._get_DomNode().tabIndex=st.getDescendantById("divCmbDd")._get_DomNode().tabIndex=-1;if(v){try{var s=n._oEditor._oDomNode.queryCommandValue("fontname");var t=n._oEditor._oDomNode.queryCommandValue("fontsize");t&&(t=t.toString())}catch(lt){return}var ht=o.get_SelectedValue();var ct=u.get_SelectedValue();var r=createSelectionRange(n._oEditor._oDomNode);if(!r)return;var b=r.getText().length==0;var k=!1;if(!s&&r.range){if(r.range.htmlText){var d=/[\s\S]*<FONT[\s\S]*face=\"([\s\S]*)\"[\s\S]*>[\s\S]*/i;d.test(r.range.htmlText)&&(s=r.range.htmlText.replace(d,"$1"))}else if(r.range.cloneContents){var g=r.range.cloneContents();s=this._getChildFontName(g);g=null}if(!s){for(var h=r.parentElement();h;){if(this._doesHaveFontName(h))break;h=h.parentElement}h&&this._doesHaveFontName(h)?s=h.face:k=!0}}if(s){for(var y=!1,nt=s.split(","),p,c,i=0;i<nt.length;++i){var tt=this._trimQuotes(nt[i]).trim();i==0&&(p=this._getLocalizedFontName(tt));if(!y){var it=this._getLocalizedFontName(tt);if(o.get_DropDownList().hasValue(it)){y=!0;c=it}}}p&&!y&&this._addFont(p,o.get_DropDownList());c&&c!=ht&&o.set_SelectedValue(c,1)}else(b||k)&&n._fAppliedDefaultFonts?o.set_SelectedValue(n._sDefaultFont,1):o.renderValue("");t&&t.length>2&&t.substr(t.length-2,2)=="px"&&(t=this._convertPixelSizeToBrowserSize(t));if(t)t!=ct&&u.get_DropDownList().hasValue(t)&&u.set_SelectedValue(t,1);else{var rt=r.duplicate();rt.collapse(!0);for(var f=OwaEditor.Dom.Node.wrapDomNode(rt.parentElement());f&&(f.get_NodeType()==OwaEditor.NodeType.Text||!f.get_FontSize()&&f.get_TagName()!=BODY_TAGNAME);)f=f.get_ParentElement();var e=null;f&&(e=f.get_FontSize());if(e){var ut=e.substring(e.length-2).toLowerCase();var l=0;switch(ut){case OwaEditor.Style.Unit.Pixels:l=n._convertPixelSizeToBrowserSize(e);break;case OwaEditor.Style.Unit.Points:l=n._convertPointSizeToBrowserSize(e);break}l?u.set_SelectedValue(l,1):ut==OwaEditor.Style.Unit.Points?u.renderValue(e.substr(0,e.length-2)):u.renderValue("")}else b&&n._fAppliedDefaultFonts?u.set_SelectedValue(n._iDefaultFontSize,1):u.renderValue("")}}n._iUpdateCounter--}};n._applyDefaultFonts=function(){var n=getSS(this._oEditor,"owaTempEditStyle");n||(n=insertSS(this._oEditor,"owaTempEditStyle"));try{n.addRule(BODY_TAGNAME,this._sDefaultCss);this._fAppliedDefaultFonts=1}catch(t){}};n.applyNoPrintStyles=function(){var n=getSS(this._oEditor,"owaPrintStyle");if(!n){n=insertSS(this._oEditor,"owaPrintStyle","print");n.get_Id()=="owaPrintStyle"&&n.addRule(BODY_TAGNAME,"display:none;visibility:hidden;")}};n.removeStyleSheet=function(n){var t=getSS(this._oEditor,n);if(t){t.remove();return!0}return!1};n._getDefaultFontDiv=function(n,t){if(n.length==1&&n[0].get_NodeType()==OwaEditor.NodeType.Element&&n[0].get_TagName().toLowerCase()=="div"&&n[0].getAttribute("name")&&n[0].getAttribute("name").toLowerCase()==o)return null;else{var i=this._oEditor.createElement("div");i.setAttribute("name",o);this._applyCssToDomNode(i._get_DomNode(),t);return i}};n._wrapBodyChildrenWithDefaultFont=function(n,t){var i=t.getChildrenSnapshot();var r=this._getDefaultFontDiv(i,n);if(r){for(var u=0;u<i.length;u++)r.appendChild(i[u]);t.appendChild(r)}else i.length==1&&i[0]&&this._applyCssToDomNode(i[0]._get_DomNode(),n);return t};n._applyCssToDomNode=function(n,t){OwaEditor.Utility.isIE()?n.style.setAttribute("cssText",t):n.setAttribute("style",t)};n._removeStyleSheetRulesFromEditor=function(){var n=getSS(this._oEditor,"owaTempEditStyle");n&&n.remove();this._fAppliedDefaultFonts=0};n._checkAndLinkPreviousWord=function(){if(!OwaEditor.Utility.isIE()){var r=-1;var u=-1;var e=null;var o=!1;var i;var n=createSelectionRange(this._oEditor._get_DomDocument());if(n){var f=n.getStartContainerText();if(f){for(var c=n.getStartOffset()-1,t=c;t>=0;t--){var i=f.charAt(t);if(u<0){if(this._isBracket(i,!0)){e=i;continue}this._isEmptySpace(i)||(u=t)}else if(u>=0&&(this._isEmptySpace(i)||t==0)){r=this._isEmptySpace(i)?t+1:t;if(e!=null)if(this._doesBracketsMatch(f.charAt(r),e)){r++;o=!0}else return;break}}var s=f.substring(r,u+1);if(this._isKnownLinkFormat(s)){var l=this._applyLink(s);n.setStart(n.getStartContainer(),r);n.setEnd(n.getStartContainer(),u+1);n.select();n.pasteHtml(l);if(o){n=createSelectionRange(this._oEditor._get_DomDocument());if(!n)return;if(OwaEditor.Utility.isSafari()){var h=n.getStartContainer().parentNode.nextSibling;n.setStart(h,1);n.setEnd(h,1)}else{n.setStart(n.getStartContainer(),n.getStartOffset()+1);n.setEnd(n.getStartContainer(),n.getStartOffset()+1)}n.select()}}}}}};n._isKnownLinkFormat=function(n){if(!n)return!1;for(var t=0;t<v.length;t++)if(n.toLowerCase().startsWith(v[t])&&n.length>v[t].length)return!0;return!1};n._isEmptySpace=function(n){return n==" "||n==" "};n._isBracket=function(n,t){for(var r=t?1:0,i=0;i<e.length;i++)if(n==e[i][r])return!0;return!1};n._doesBracketsMatch=function(n,t){for(var i=0;i<e.length;i++)if(n==e[i][0])return t==e[i][1];return!1};n._applyLink=function(n){return'<a href="'+(n.toLowerCase().startsWith("www.")?"http://":"")+n+'" target="_blank'+'">'+n+"</a>"};n._getFormatBar=function(n){return n.get_ContainerWindow().getGlobalVariable("formatBar")};n._setFormatBar=function(n,t){n.get_ContainerWindow().setGlobalVariable("formatBar",t)};n._changeDesignMode=function(n){if(this._oEditor.get_IsDesignMode()!=n){this._getIframe().get_ContentDocument().set_DesignMode(n);if(n){this._attachContentWindowEvents();OwaEditor.Utility.isSafari()&&this._applyEditorStyles()}else this._getIframeContentWindow().detachAllEvents()}};n._storeSelection=function(){if(OwaEditor.Utility.isIE())try{var n=createSelectionRange(this._oEditor._oDomNode);if(!n)return;var t=OwaEditor.Dom.Node.wrapDomNode(n.parentElement());if(!t.get_OwnerDocument||!t.get_OwnerDocument().get_IsDesignMode())return;if((OwaEditor.Utility.isIE7()||OwaEditor.Utility.isIE8())&&!n.selectionExists()){n.moveEnd(1);this._fBookmarkExpanded=!0}else this._fBookmarkExpanded=!1;this._oBookmark=n.duplicate()}catch(i){this._oBookmark=null}};n._restoreSelection=function(){if(OwaEditor.Utility.isIE()&&this._oBookmark){if(this._fBookmarkExpanded){this._oBookmark.collapse(1);this._fBookmarkExpanded=!1}this._oBookmark.select();this._oBookmark=null}};n._isButton=function(n){return!n._oDomNode.disabled&&n.getAttribute("_cmd")};n._updateButtonsShown=function(){var n=this;n._saveButtonsShown();n._displayButtons()};n._saveButtonsShown=function(){for(var n=0,i=0;i<this._rgCustomButtons.length;i++)this._rgCustomButtons[i].get_IsChecked()&&(n|=t[i][1]);this.oldBtnSt=n;this._iButtonState=n;this._fnUpdateButtonState&&this._fnUpdateButtonState(n);this._fnUpdateClientCache&&this._fnUpdateClientCache(CC_FBST,n)};n._displayButtons=function(){for(var n=0;n<t.length;n++){var i=t[n][0].toString();var r=this._oFormatBarElement.getDescendantById(i);r.set_IsShown(t[n][1]&this._iButtonState)}this._fnButtonStateUpdateDisplayed&&this._fnButtonStateUpdateDisplayed();OwaEditor.Dom.GetElement("divHdrMessage")&&this.get_SubPage().safeResizeBodies()};n._updateButton=function(n){var t=n.getAttribute("_cmd");var i=0;var r=0;try{if(this._redoUndoManager&&(t=="undo"||t=="redo"))switch(t){case"undo":i=this._redoUndoManager.CanUndo();break;case"redo":i=this._redoUndoManager.CanRedo();break}else if(OwaEditor.Utility.isFirefox())switch(t){case"outdent":case"indent":case"backcolor":case"forecolor":case"removeformat":case"inserthorizontalrule":case"undo":case"redo":case"createlink":i=1;r=0;break;default:i=this._oEditor._oDomNode.queryCommandEnabled(t);r=this._oEditor._oDomNode.queryCommandState(t);break}else{i=this._oEditor._oDomNode.queryCommandSupported(t);(t=="createlink"||t=="unlink")&&(i=this._oEditor._oDomNode.queryCommandEnabled(t)&&i);i&&(r=this._oEditor._oDomNode.queryCommandState(t))}}catch(u){i=0}this._pushButton(n,i&&r);this._enableButton(n,i)};n._enableButton=function(n,t){if(t)n.removeCssClass(r);else{n.addCssClass(r);n.removeCssClass(a)}};n._pushButton=function(n,t){if(t!=n.getBoolAttribute("_pushed")){t?n.addCssClass(a):n.removeCssClass(a);n.setBoolAttribute("_pushed",t)}};n._updateMRUFonts=function(){var t=this._getFontNameComboBox();if(!t.get_DropDownList().fIsOpen&&!(t.get_DropDownList()._rgListItems.length<l)){var r=t.get_SelectedValue();var i=[];i.push(r);for(var n=0;n<this._rgMruFonts.length;n++)this._rgMruFonts[n]&&this._rgMruFonts[n]!=r&&n<l-1&&i.push(this._rgMruFonts[n]);this._rgMruFonts=i;for(var u=t.get_DropDownList()._rgListItems,n=0;n<u.length;n++)u[n].oDomItem.getAttribute("_mru")==""&&t.get_DropDownList()._remove(n);this._insertMRUFonts(this._rgMruFonts);this._fnUpdateFontsMru&&this._fnUpdateFontsMru(this._rgMruFonts);this._fnUpdateClientCache&&this._fnUpdateClientCache(CC_MRUFNTS,this._rgMruFonts.join(";"))}};n._insertMRUFonts=function(n){for(var i=l-1;i>=0;i--)if(n[i]){var t=OwaEditor.Dom.Document.get_Current().createElement("DIV");var u=this._generateFontEntryMarkup(n[i],!0);t.set_InnerHtml(u);t=t.get_FirstChild();var r=this._getFontNameComboBox().get_DropDownList();r._get_Element().insertAdjacentElement(OwaEditor.ElementInsertionPoint.AfterBegin,t);OwaEditor.Utility.isIE()&&(t=t.get_FirstChild());r._addDomItem(t,n[i])}};n._generateResizeMenuItemMarkup=function(n,t){var i="<DIV class=cmLnk cmd="+n+' _lnk="1">';i+='<SPAN id=spnImg class=cmIco><IMG id=imgI style="WIDTH: 16px; vertical-align:middle" src="'+this._fnGetImagePath("clear1x1.gif")+'"></SPAN>';i+='<IMG style="WIDTH: 12px; HEIGHT: 1px" src="'+this._fnGetImagePath("clear1x1.gif")+'">';i+="<SPAN id=spnT>"+t+"</SPAN>";i+="</DIV>";return i};n._generateFormatBarMarkup=function(){var n=this._generateFontComboBoxMarkup();n+=this._generateFontSizeComboBoxMarkup();n+=this._generateBIUButtonGroupMarkup();n+=this._generateButtonsMarkup(this._generateButtonGroupMarkup);BTN_CUSTOMIZE&this._iButtonState&&(n+=this._generateButtonGroupMarkup("Cstmz",new Array(new this._imageData("imgCstmz","chevrons_down")),this._fnGetImagePath));return n};n._generateFontComboBoxMarkup=function(){var n="";n+=OwaEditor.Utility.isIE()?u:"";n+='<div id="divFntNm" class="cmb" _cmd="fontname" fEnbld="1" fd="1">';n+=this._generateComboBoxImageMarkup();n+='<span id="spanCmbSel" class="nowrap">&nbsp;</span><img class="cmbVASp"/>';n+='<div id="divCmbList" class="pu" oV="0" style="display:none" ';n+="></div>";n+="</div>";n+=OwaEditor.Utility.isIE()?f:"";return n};n._getFontFamily=function(n){for(var t=0;t<DEFAULT_FONT_TABLE.length;++t)if(DEFAULT_FONT_TABLE[t][FONTNAME_COLUMN]==n)return DEFAULT_FONT_TABLE[t][FONTFAMILY_COLUMN];return n};n._generateFontEntryMarkup=function(n,t){var i="";i+=OwaEditor.Utility.isIE()?u:"";i+=t?'<span style="display:block;" class="mruFont listItm" tabIndex="0" oV="':'<span style="display:block;" class="listItm" tabIndex="0" oV="';i+=htmlEnc(n);i+=t?'" _mru>':'">';if(n!="Wingdings"&&n!="Symbol"){i+='<font face="'+htmlEnc(this._getFontFamily(n))+'">';i+=htmlEnc(n);i+="</font>"}else i+=htmlEnc(n);i+="</span>";i+=OwaEditor.Utility.isIE()?f:"";return i};n._generateFontSizeComboBoxMarkup=function(){var n="";n+=OwaEditor.Utility.isIE()?u:"";n+=g_fRtl?'<div id="divFntSz" class="cmb" _cmd="fontsize" fEnbld="1" fd="1" style="margin-right: 5px;">':'<div id="divFntSz" class="cmb" _cmd="fontsize" fEnbld="1" fd="1" style="margin-left: 5px;">';n+=this._generateComboBoxImageMarkup();n+='<span id="spanCmbSel">&nbsp;</span><img class="cmbVASp"/>';n+='<div id="divCmbList" class="pu" oV="0" style="display:none" ';n+=">";n+="</div>";n+="</div>";n+=OwaEditor.Utility.isIE()?f:"";return n};n._generateFontSizeEntryMarkup=function(n,t){var i="";i+=OwaEditor.Utility.isIE()?u:"";i+='<span style="display:block;" class="listItm" tabIndex="0" oV="';i+=htmlEnc(n);i+='">';i+=htmlEnc(t);i+="</span>";i+=OwaEditor.Utility.isIE()?f:"";return i};n._generateComboBoxImageMarkup=function(){return OwaEditor.Components.CssSprites.getImageMarkup("triangle_down_small.png",'id="divCmbDd"',null,this._fnGetImagePath)};n._generateBIUButtonsMarkup=function(n,t,i,r,e){var o='<div id="'+n;o+='" unselectable="on" ';o+=e?'class="fbBiuBtn fbBiuBtnInCustomMenu"':'class="fbBiuBtn"';if(r){o+=' _cmd="';o+=r;o+='"'}o+=">";o+=OwaEditor.Utility.isIE()?u:"";o+='<span class="fbBiu';i!=null&&(o+=" "+i);o+='" >';o+=t;o+="</span>";o+=OwaEditor.Utility.isIE()?f:"";o+="</div>";return o};n._generateBIUButtonGroupMarkup=function(){var n;n=g_fRtl?'<div id="divBiu" class="fbBtnGrp" style="margin-right: 2px;">':'<div id="divBiu" class="fbBtnGrp" style="margin-left: 2px;">';var t=this._generateBIUButtonsMarkup("divBoldBtn",this._rgsBIU[0],null,"bold");t+=this._generateBIUButtonsMarkup("divItalicsBtn",this._rgsBIU[1],"iT","italic");t+=this._generateBIUButtonsMarkup("divUnderlineBtn",this._rgsBIU[2],"uT","underline");n+=t;n+="</div>";return n};n._generateCustomButtonGroupMarkup=function(){var n='<div id="divBiu" class="fbCustomBtnGrp tablerow">';n+='<div class="fbBtnGrpChk">';n+='<input type="checkbox" id="chkBiu" tabIndex="0" hidefocus="true"/>';n+="</div>";var t=this._generateBIUButtonsMarkup("divBoldBtn",this._rgsBIU[0],null,null,!0);t+=this._generateBIUButtonsMarkup("divItalicsBtn",this._rgsBIU[1],"iT",null,!0);t+=this._generateBIUButtonsMarkup("divUnderlineBtn",this._rgsBIU[2],"uT",null,!0);n+=t;n+="</div>";return n};n._generateCustomButtonsPaneMarkup=function(){var n='<div id="divCstPn" class="pu fbPopup table contextMenuDropShadow" style="display:none">';n+=this._generateCustomButtonGroupMarkup();n+=this._generateButtonsMarkup(this._generateCustomButtonsGroupMarkup);n+="</div>";return n};n._generateCustomButtonsGroupMarkup=function(t,i,r){var u='<div class="fbCustomBtnGrp tablerow">';u+='<div class="fbBtnGrpChk tablecell">';u+='<input type="checkbox" id="chk'+t+'">';u+="</div>";for(var f=0;f<i.length;f++)u+=n._generateSingleButtonMarkup(i[f],r);u+="</div>";return u};n._generateButtonsMarkup=function(n){var t=g_fRtl;return n("StrkThr",new Array(new this._imageData("imgStrkThr","strikethrough")),this._fnGetImagePath)+n("Jstfy",[new this._imageData(t?"imgJstfyRt":"imgJstfyLft",t?"justifyright":"justifyleft"),new this._imageData("imgJstfyCtr","justifycenter"),new this._imageData(t?"imgJstfyLft":"imgJstfyRt",t?"justifyleft":"justifyright")],this._fnGetImagePath)+n("Lsts",[new this._imageData("imgLstNm","insertunorderedlist"),new this._imageData("imgLstBl","insertorderedlist")],this._fnGetImagePath)+n("Indntg",[new this._imageData("imgOutdnt","outdent"),new this._imageData("imgIndnt","indent")],this._fnGetImagePath)+n("BkClr",new Array(new this._imageData("imgBkClr","backcolor",1)),this._fnGetImagePath)+n("FrClr",new Array(new this._imageData("imgFrClr","forecolor",1)),this._fnGetImagePath)+n("RmvFmt",new Array(new this._imageData("imgRmvFmt","removeformat")),this._fnGetImagePath)+n("InsRl",new Array(new this._imageData("imgInsRl","inserthorizontalrule")),this._fnGetImagePath)+n("Undng",[new this._imageData("imgUndo","undo"),new this._imageData("imgRedo","redo")],this._fnGetImagePath)+n("HLkng",[new this._imageData("imgCrtLnk","createlink"),new this._imageData("imgUnlnk","unlink")],this._fnGetImagePath)+n("SprSb",[new this._imageData("imgSprScr","superscript"),new this._imageData("imgSbScr","subscript")],this._fnGetImagePath)+n("Dir",[new this._imageData(t?"imgBlkDrRtl":"imgblkdrltr",t?"blockdirrtl":"blockdirltr"),new this._imageData(t?"imgBlkDrLtr":"imgblkdrrtl",t?"blockdirltr":"blockdirrtl")],this._fnGetImagePath)};n._generateButtonGroupMarkup=function(t,i,r){for(var u='<div id="div'+t+'" class="fbBtnGrp">',f=0;f<i.length;f++){u+='<div class="fbBtn" id="div';u+=i[f].cmd;u+='" unselectable=on tabIndex=-1'+" _cmd="+i[f].cmd+">";u+=n._generateSingleButtonMarkup(i[f],r);u+="</div>"}u+="</div>";return u};n._generateSingleButtonMarkup=function(n,t){var i=n.cmd;if(g_fRtl)switch(n.cmd.toLowerCase()){case"outdent":case"indent":case"insertorderedlist":case"insertunorderedlist":i+="rtl";break;default:break}i+=".png";return OwaEditor.Components.CssSprites.getImageMarkup(i,null,null,t)};n._getForeColorPicker=function(){if(!this._oPopupForeColorPicker){this._oPopupForeColorPicker=new OwaEditor.UIControls.ColorPickerPopup(this.get_SubPage(),this._oFormatBarElement.getDescendantById("divforecolor"),"divFbFrClrPckr",5,8,n._getColorProperties,n._onClickColorPicker,this._sNoneButtonString,"000000",1,this._oDialogHelper,!1);this._oPopupForeColorPicker.oFb=this;this._oPopupForeColorPicker.sCmd="forecolor"}return this._oPopupForeColorPicker};n._getBackColorPicker=function(){if(!this._oPopupBackColorPicker){this._oPopupBackColorPicker=new OwaEditor.UIControls.ColorPickerPopup(this.get_SubPage(),this._oFormatBarElement.getDescendantById("divbackcolor"),"divFbBkClrPckr",5,8,n._getColorProperties,n._onClickColorPicker,this._sNoneButtonString,"FFFFFF",1,this._oDialogHelper,!1);this._oPopupBackColorPicker.oFb=this;this._oPopupBackColorPicker.sCmd="backcolor"}return this._oPopupBackColorPicker};n._getColorProperties=function(n,t){var r=it[n][t];var i={};i.sStyle="background-color:#"+r;i.sValue=r;return i};n._onClickColorPicker=function(n){n.oFb._execCommand(n.sCmd,!1,n.sColorValue)};n._imageData=function(n,t,i){this.id=n;this.cmd=t;this.isColor=!!i};n._setDirty=function(){typeof g_fDrty!="undefined"&&(g_fDrty=1)};n._getIframe=function(){return this._oEditor.get_ContainerWindow().get_FrameElement()};n._getFontNameComboBoxElement=function(){return this._oFormatBarElement.getDescendantById("divFntNm")};n._getFontSizeComboBoxElement=function(){return this._oFormatBarElement.getDescendantById("divFntSz")};n._getFontNameComboBox=function(){return this._getFontNameComboBoxElement().getExpando("oComboBox")};n._getFontSizeComboBox=function(){return this._getFontSizeComboBoxElement().getExpando("oComboBox")};n._getIframeContentWindow=function(){return this._getIframe().get_ContentWindow()};n._generateCss=function(n,t,i){var r="font-family: "+htmlEnc(this._getFontFamily(n))+"; font-size: "+this._convertBrowserSizeToPointSize(t)+";";i&&(r+=" color: "+i+";");r+=" margin: 0";return r};n._trimQuotes=function(n){(n.startsWith("'")&&n.endsWith("'")||n.startsWith('"')&&n.endsWith('"'))&&(n=n.substr(1,n.length-2));return n};n._convertPixelSizeToBrowserSize=function(n){for(var i=n.toLowerCase(),t=0;t<w.length;t++)if(i==w[t])return t;return null};n._convertBrowserSizeToPointSize=function(n){(n>i.length+1||n<0)&&(n=this._iDefaultFontSize);return i[n]};n._convertPointSizeToBrowserSize=function(n){for(var r=n.toLowerCase(),t=0;t<i.length;t++)if(r==i[t])return t;return null};n._getEventTargetAnchorElement=function(n){for(var t=n.get_Target(),i=0;i<4;){if(!t||!t.get_TagName||!t.get_TagName())return null;if(t.get_TagName().toUpperCase()=="A")return t;else{t=t.get_ParentElement();i++}}return null};n._insertPlaceholderImage=function(n,t){var i=OwaEditor.Utility.isIE()?"<br>":"<br><p/><br>";var r='<p><div id="divContainer" style="float:'+'"><div><img name="'+n+'" title="'+t+'" fIsPlaceHolder=1'+' originalSrc=""'+' src="'+this._fnGetImagePath("inlineimageplaceholder.png")+'" /></div><div style="font-family: '+"'Segoe UI', 'Segoe WP', 'Segoe UI WPC', Tahoma, Arial, sans-serif"+"; font-size: 12px"+"; color: #333333"+';">'+t+"</div></div></p>"+i;this.insertMarkupAtCursor(r)};n._getPlaceholderImageContainer=function(n){return n.get_ParentElement().get_ParentElement()};n._replacePlaceholderImage=function(n,t,i){for(var e=this._oEditor.getElementsByName(n),u=0;u<e.length;u++){var r=e[u];r.setAttribute("name",null);r.setAttribute("src",t);r.setAttribute("originalSrc","cid:"+i);var o=this._generateImageId();r.set_Id(o);r.removeAttribute("fIsPlaceHolder");r.removeAttribute("width");r.removeAttribute("height");var s=r.clone(1);var f=this._getPlaceholderImageContainer(r);f.get_Id()=="divContainer"&&f.get_ParentElement().replaceChild(s,f);this._timeoutResizeNewImage(o)}};n._replaceInlineImageWithPlaceholder=function(n,t){for(var u=this._oEditor._get_DomDocument().querySelectorAll('img[originalSrc="cid:'+n+'"]'),r=0;r<u.length;r++){var i=u[r];i.setAttribute("name",t);i.setAttribute("fIsPlaceHolder",1);i.setAttribute("originalSrc","");i.setAttribute("src",this._fnGetImagePath("inlineimageplaceholder.png"));i.removeAttribute("id");i.removeAttribute("width");i.removeAttribute("height");i.removeAttribute("enterTime");i.removeAttribute("showedTooltip");i.removeAttribute("originalWidth");i.removeAttribute("originalHeight");i.removeAttribute("rszImgCmd");i.removeAttribute("onload");i.removeAttribute("data-custom")}};n._deletePlaceholderImage=function(n){for(var i=this._oEditor.getElementsByName(n),t=0;t<i.length;t++){var r=this._getPlaceholderImageContainer(i[t]);r.get_Id()=="divContainer"?r.remove(!0):i[t].remove(!0)}};n._isResizeMenuSupported=function(){return!this._fIsInECP&&!OwaEditor.Utility.isIE()};n._getResizeImageMenu=function(n){if(!this._oResizeImageMenu){this._oResizeImageMenu=OwaEditor.UIControls.ContextMenu.create(this._oResizeMenuElement);this._oResizeImageMenu.get_OnSelect().add(this._createCallback(this._onClickImageResize));this._oResizeImageMenu._fDisableOffscreenBox=!0}this._oResizeImageMenu.oImage=n;return this._oResizeImageMenu};n._closeResizeImageMenu=function(){this._isResizeMenuSupported()&&this._oResizeImageMenu&&this._oResizeImageMenu.fIsOpen&&this._oResizeImageMenu.close()};n._onClickImageResize=function(n){this._resizeImage(n.oMenu.oImage,n.sCommand)};n._resizeImage=function(n,t,i){var r;var u;var f;var e;if(n.getIntAttribute("originalWidth")){r=n.getIntAttribute("originalWidth");u=n.getIntAttribute("originalHeight")}else{var r=n.get_ClientWidth();var u=n.get_ClientHeight();n.setIntAttribute("originalWidth",r);n.setIntAttribute("originalHeight",u)}if(t==s){var h=this._getScaleToWindowWidth();var l=this._getScaleToWindowHeight();var a;a=p?h<l?1:0:1;var v=a?n.get_ClientWidth()<h:n.get_ClientHeight()<l;if(i&&v){n.setAttribute("rszImgCmd",c);return}else{var o;if(a){f=h;o=f/r;e=o*u}else{e=l;o=e/u;f=o*r}}}else{f=parseInt(r*t/100);e=parseInt(u*t/100);if(isNaN(f)||isNaN(e))return}n.setIntAttribute("width",f);n.setIntAttribute("height",e);n.setAttribute("rszImgCmd",t);this._setDirty()};n._getStateHtml=function(){this._markFocus();var n=this.getHtml(!1,!0);this._removeFocusMark();return n};n._captureState=function(n){if(this._redoUndoManager)if(n){if(this._fStartDeleteSequence){this._redoUndoManager.SaveCurrentState(this._getStateHtml());this._fStartDeleteSequence=!1}}else{this._fStartDeleteSequence=!0;this._redoUndoManager.SaveCurrentState(this._getStateHtml())}};n._createMark=function(n){var t=this._oEditor.createElement("SPAN");t.set_Id(n);t.setAttribute("style","display:none");return t};n._markFocus=function(){var t=createSelectionRange(this._oEditor._oDomNode);if(t){var n=t.duplicate().range;if(n){var i=this._createMark(OWACURSORSTARTMARKID);var r=this._createMark(OWACURSORENDMARKID);if(n.insertNode&&n.setStart){n.insertNode(i._get_DomNode());n.setStart(n.endContainer,n.endOffset);n.insertNode(r._get_DomNode())}else if(n.setEndPoint&&n.pasteHTML){n.setEndPoint("EndToStart",t.range);n.pasteHTML(i.get_OuterHtml());n=t.duplicate().range;n.setEndPoint("StartToEnd",t.range);n.pasteHTML(r.get_OuterHtml())}}}};n._removeFocusMark=function(){var n=this._oEditor.getElementById(OWACURSORSTARTMARKID);n&&OwaEditor.Dom.NonSingletonNode._removeDomNode(n._get_DomNode(),!0);n=this._oEditor.getElementById(OWACURSORENDMARKID);n&&OwaEditor.Dom.NonSingletonNode._removeDomNode(n._get_DomNode(),!0)};n._focusOnFocusMark=function(){var i=this._oEditor.getElementById(OWACURSORSTARTMARKID);var r=this._oEditor.getElementById(OWACURSORENDMARKID);if(i&&r){var u=createSelectionRange(this._oEditor._oDomNode);if(!u)return;var n=u.range;if(n){if(n.setStartAfter&&n.setEndBefore){n.setStartAfter(i._get_DomNode());n.setEndBefore(r._get_DomNode())}else if(n.moveToElementText&&n.setEndPoint){var t=u.duplicate().range;t.moveToElementText(i._get_DomNode());n.setEndPoint("EndToEnd",t);n.setEndPoint("StartToEnd",t);t.moveToElementText(r._get_DomNode());n.setEndPoint("EndToStart",t)}u.select()}OwaEditor.Dom.NonSingletonNode._removeDomNode(i._get_DomNode(),!0);OwaEditor.Dom.NonSingletonNode._removeDomNode(r._get_DomNode(),!0)}};n._focusAfterReplyDiv=function(){var n=this._oEditor.getElementById(o);if(n){var t=createSelectionRange(this._oEditor._oDomNode);if(!t)return;var i=t.range;if(i&&i.setStartBefore&&n.get_FirstChild()){i.setStartBefore(n.get_FirstChild()._get_DomNode());t.select()}}};n._resizeNewlyInsertedImage=function(n){var t=this._oEditor.get_Body().getDescendantById(n);if(t&&t.get_TagName()&&t.get_TagName().toUpperCase()=="IMG"){if(OwaEditor.Utility.isIE()&&t._oDomNode.readyState!="complete"||OwaEditor.Utility.isChrome()&&t._oDomNode.complete!=!0||OwaEditor.Utility.isEdge()&&t._oDomNode.complete!=!0||OwaEditor.Utility.isSafari()&&t._oDomNode.complete!=!0||OwaEditor.Utility.isFirefox()&&t._oDomNode.complete!=!0){this._setTimeout(this._createCallback(this._resizeNewlyInsertedImage),500,n);return}this._resizeImage(t,s,1);t.removeAttribute("id")}};n._timeoutResizeNewImage=function(n){this._closeResizeImageMenu();this._setTimeout(this._createCallback(this._resizeNewlyInsertedImage),500,n)};n._isImageScaledToOriginal=function(n,t){var i=t.getIntAttribute("originalWidth");var r=t.getIntAttribute("originalHeight");if(!i||!r)return!1;var u=parseInt(i*n/100);var f=parseInt(r*n/100);return isNaN(u)||isNaN(f)?!1:u==t.get_ClientWidth()&&f==t.get_ClientHeight()};n._isImageScaledToWindow=function(n){var f=this._getScaleToWindowWidth();var e=this._getScaleToWindowHeight();var t=n.get_ClientWidth();var i=n.get_ClientHeight();var r=n.getIntAttribute("originalWidth");var u=n.getIntAttribute("originalHeight");return!r||!u?!1:f<e||!p?t==f&&i==parseInt(u*t/r):i==e&&t==parseInt(r*i/u)};n._generateImageId=function(){return"img"+new String(Math.round(Math.random()*1e6))};OwaEditor.UIControls.Editor.createClass("OwaEditor.UIControls.Editor",OwaEditor.UIControls.UIControl);n._getScaleToWindowWidth=function(){return parseInt(this._getIframe().get_OffsetWidth()*y/100)};n._getScaleToWindowHeight=function(){return parseInt(this._getIframe().get_OffsetHeight()*y/100)};n._checkExistingSelection=function(n){var t=n.oImage.getAttribute("rszImgCmd");if(!t){t=c;n.oImage.setIntAttribute("originalWidth",n.oImage.get_ClientWidth());n.oImage.setIntAttribute("originalHeight",n.oImage.get_ClientHeight())}for(var r=this._oResizeImageMenu.getAllMenuItems(),i=0;i<r.length;i++){var u=0;var f=r[i];var e=f.getDescendantById("imgI");if(e){u=t&&t==f.getAttribute("cmd")?t==s?this._isImageScaledToWindow(n.oImage)?1:0:OwaEditor.Utility.isIE()?1:this._isImageScaledToOriginal(t,n.oImage):0;this._checkMenuItemImage(e,u)}}};n._checkMenuItemImage=function(n,t){t?OwaEditor.Components.CssSprites.updateImage(n,"checkmark_small.png"):OwaEditor.Components.CssSprites.updateImage(n,"clear1x1.gif")}}();g_fModuleLoaded[".\\uicontrols/editor.js".toLowerCase()]=1;function GetNewStandaloneEditor(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){return new OwaEditor.UIControls.Editor(OwaEditor.Dom.GetElement(n)._get_DomNode(),OwaEditor.Dom.GetElement(t)._get_DomNode(),null,i,r,u,f,null,null,e,o,s,h,c,l,a,v,!0,y,p,w,b,k)}