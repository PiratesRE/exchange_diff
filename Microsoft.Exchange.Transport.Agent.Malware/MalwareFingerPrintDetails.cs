using System;
using System.Collections.Generic;

namespace Microsoft.Exchange.Transport.Agent.Malware
{
	internal class MalwareFingerPrintDetails
	{
		public string Name { get; set; }

		public string[] Detections { get; set; }

		public long Size { get; set; }

		public MalwareFingerPrint LowFidelitySHA256Hash { get; set; }

		public MalwareFingerPrint HighFidelitySHA256Hash { get; set; }

		public bool IsLowFidelityMatch(MalwareFingerPrintDetails matchWith)
		{
			return this.Size == matchWith.Size && this.LowFidelitySHA256Hash.Equals(matchWith.LowFidelitySHA256Hash);
		}

		public bool IsHighFidelityMatch(MalwareFingerPrintDetails matchWith)
		{
			return this.Size == matchWith.Size && this.HighFidelitySHA256Hash.Equals(matchWith.HighFidelitySHA256Hash);
		}

		public List<KeyValuePair<string, string>> GetVerdictInfo()
		{
			return new List<KeyValuePair<string, string>>
			{
				new KeyValuePair<string, string>("file", this.Name),
				new KeyValuePair<string, string>("names", string.Join(",", this.Detections))
			};
		}

		private class KeyNames
		{
			public const string FileName = "file";

			public const string Detections = "names";
		}
	}
}
