using System;
using System.IO;

namespace Microsoft.Exchange.Transport.Agent.Malware.SoftDelete
{
	internal class SoftDeleteQueue
	{
		public SoftDeleteQueue(IStorage storage)
		{
			this.storage = storage;
		}

		public IStorage Storage
		{
			get
			{
				return this.storage;
			}
		}

		public void Add(string messageId, Stream stream)
		{
			if (string.IsNullOrEmpty(messageId))
			{
				throw new ArgumentException("Data cannot be added to the store using a null/empty value.");
			}
			if (stream == null)
			{
				throw new ArgumentException("Data cannot be added to the store using a null value.");
			}
			this.Storage.AddToStorage(stream, messageId);
		}

		private IStorage storage;
	}
}
