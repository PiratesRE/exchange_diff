using System;
using Microsoft.Exchange.Data.Transport.Routing;
using Microsoft.Exchange.Diagnostics.Components.MalwareAgent;

namespace Microsoft.Exchange.Transport.Agent.Malware.Actions
{
	internal class ActionRecover : ActionDeferForever
	{
		public ActionRecover(RecoveryDelegate recoveryDelegate)
		{
			this.recoveryDelegate = recoveryDelegate;
		}

		public override void Execute(ScanContext context, SubmittedMessageEventSource source, QueuedMessageEventArgs args)
		{
			ExTraceGlobals.ActionsTracer.TraceDebug((long)this.GetHashCode(), "Begin ActionRecover.Execute.");
			this.recoveryDelegate();
			base.Execute(context, source, args);
		}

		private RecoveryDelegate recoveryDelegate;
	}
}
