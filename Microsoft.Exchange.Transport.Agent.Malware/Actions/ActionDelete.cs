using System;
using Microsoft.Exchange.Data.Transport.Routing;
using Microsoft.Exchange.Diagnostics.Components.MalwareAgent;

namespace Microsoft.Exchange.Transport.Agent.Malware.Actions
{
	internal class ActionDelete : Action
	{
		public override void Execute(ScanContext context, SubmittedMessageEventSource source, QueuedMessageEventArgs args)
		{
			ExTraceGlobals.ActionsTracer.TraceDebug((long)this.GetHashCode(), "Begin ActionDelete.Execute.");
			base.SendSenderNotifications(context, args, ScanAction.Blocked);
			context.ScanActionExecuted = ScanAction.Blocked;
			base.TrackMalwareAgentInfo(context, source);
			source.Delete();
		}

		public static readonly string[] DiagnosticHeaders = new string[]
		{
			"Subject"
		};
	}
}
