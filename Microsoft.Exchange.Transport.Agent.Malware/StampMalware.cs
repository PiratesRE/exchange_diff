using System;
using Microsoft.Exchange.Data.Mime;

namespace Microsoft.Exchange.Transport.Agent.Malware
{
	internal abstract class StampMalware
	{
		public StampMalware()
		{
		}

		public abstract string Name { get; }

		public abstract bool IsServiceStamp { get; }

		public static StampMalware Create(bool inService)
		{
			if (inService)
			{
				return new StampMalwareService();
			}
			return new StampMalwareEnterprise();
		}

		public static StampMalware Find(HeaderList headers)
		{
			Header header = headers.FindFirst("X-MS-Exchange-Organization-AVStamp-Service");
			if (header != null)
			{
				return StampMalware.Create(true);
			}
			header = headers.FindFirst("X-MS-Exchange-Organization-AVStamp-Enterprise");
			if (header != null)
			{
				return StampMalware.Create(false);
			}
			return null;
		}

		public const string ServiceHeaderName = "X-MS-Exchange-Organization-AVStamp-Service";

		public const string EnterpriseHeaderName = "X-MS-Exchange-Organization-AVStamp-Enterprise";

		public const string StampVersion = "1.0";
	}
}
