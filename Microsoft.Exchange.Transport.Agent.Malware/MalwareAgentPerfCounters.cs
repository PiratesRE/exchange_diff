using System;
using System.Xml;
using System.Xml.Linq;
using Microsoft.Exchange.Diagnostics;

namespace Microsoft.Exchange.Transport.Agent.Malware
{
	internal static class MalwareAgentPerfCounters
	{
		public static void GetPerfCounterInfo(XElement element)
		{
			if (MalwareAgentPerfCounters.AllCounters == null)
			{
				return;
			}
			foreach (ExPerformanceCounter exPerformanceCounter in MalwareAgentPerfCounters.AllCounters)
			{
				try
				{
					element.Add(new XElement(ExPerformanceCounter.GetEncodedName(exPerformanceCounter.CounterName), exPerformanceCounter.NextValue()));
				}
				catch (XmlException ex)
				{
					XElement content = new XElement("Error", ex.Message);
					element.Add(content);
				}
			}
		}

		public const string CategoryName = "MSExchange Anti-Malware Agent";

		public static readonly ExPerformanceCounter MessagesScanned = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Scanned", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesScannedPerSecond = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Scanned per Second", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter ScanTimePerMessage90Percentile = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Scan Time per Message - 90th Percentile", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter ScanTimePerMessage99Percentile = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Scan Time per Message - 99th Percentile", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MBytesScannedPerSecond = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "MB Scanned per Second", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MBytesScannedPerSecond_Base = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "MB Scanned per Second (Base Counter)", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter ScanTimePerMBytes90Percentile = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Scan Time per MB - 90th Percentile", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter ScanTimePerMBytes99Percentile = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Scan Time per MB - 99th Percentile", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesWithMalware = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Containing Malware", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentMessagesWithMalware = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Containing Malware Percentage", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesDeferred = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Deferred", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentMessagesDeferred = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Deferred Percentage", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesWithScanErrors = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages with Scan Error", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentMessagesWithScanErrors = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages with Scan Error Percentage", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesWithPolicyViolations = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages with Policy violations", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesBlocked = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Blocked", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentMessagesBlocked = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Blocked Percentage", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesReplaced = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Containing Malware - Replaced", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentMessagesReplaced = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Containing Malware - Replaced (%)", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesBypassed = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Bypassed", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentMessagesBypassed = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Bypassing Malware Scanning Percentage", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesTimedOut = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages that Timed Out", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentMessagesTimedOut = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages that Timed Out Percentage", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentRecoveryStoreFull = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Recovery Store Percentage Full", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter RecoveryStoreMBInUse = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "MB Used by Recovery Store", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter RecoveryStoreMessagesWritten = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Written to Recovery Store", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesBelowInternalSLA = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages with Fewer Engine Scans than Expected", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentMessagesBelowInternalSLA = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages with Fewer Engine Scans than Expected Percentage", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesBelowPublishedSLA = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages with Fewer Engine Scans than Minimum Threshold", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter PercentMessagesBelowPublishedSLA = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages with Fewer Engine Scans than Minimum Threshold Percentage", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesRejectedDueToFips = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Rejected due to internal errors", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter MessagesRejectedDueToExternalErrors = new ExPerformanceCounter("MSExchange Anti-Malware Agent", "Messages Rejected due to external errors", string.Empty, null, new ExPerformanceCounter[0]);

		public static readonly ExPerformanceCounter[] AllCounters = new ExPerformanceCounter[]
		{
			MalwareAgentPerfCounters.MessagesScanned,
			MalwareAgentPerfCounters.MessagesScannedPerSecond,
			MalwareAgentPerfCounters.ScanTimePerMessage90Percentile,
			MalwareAgentPerfCounters.ScanTimePerMessage99Percentile,
			MalwareAgentPerfCounters.MBytesScannedPerSecond,
			MalwareAgentPerfCounters.MBytesScannedPerSecond_Base,
			MalwareAgentPerfCounters.ScanTimePerMBytes90Percentile,
			MalwareAgentPerfCounters.ScanTimePerMBytes99Percentile,
			MalwareAgentPerfCounters.MessagesWithMalware,
			MalwareAgentPerfCounters.PercentMessagesWithMalware,
			MalwareAgentPerfCounters.MessagesDeferred,
			MalwareAgentPerfCounters.PercentMessagesDeferred,
			MalwareAgentPerfCounters.MessagesWithScanErrors,
			MalwareAgentPerfCounters.PercentMessagesWithScanErrors,
			MalwareAgentPerfCounters.MessagesWithPolicyViolations,
			MalwareAgentPerfCounters.MessagesBlocked,
			MalwareAgentPerfCounters.PercentMessagesBlocked,
			MalwareAgentPerfCounters.MessagesReplaced,
			MalwareAgentPerfCounters.PercentMessagesReplaced,
			MalwareAgentPerfCounters.MessagesBypassed,
			MalwareAgentPerfCounters.PercentMessagesBypassed,
			MalwareAgentPerfCounters.MessagesTimedOut,
			MalwareAgentPerfCounters.PercentMessagesTimedOut,
			MalwareAgentPerfCounters.PercentRecoveryStoreFull,
			MalwareAgentPerfCounters.RecoveryStoreMBInUse,
			MalwareAgentPerfCounters.RecoveryStoreMessagesWritten,
			MalwareAgentPerfCounters.MessagesBelowInternalSLA,
			MalwareAgentPerfCounters.PercentMessagesBelowInternalSLA,
			MalwareAgentPerfCounters.MessagesBelowPublishedSLA,
			MalwareAgentPerfCounters.PercentMessagesBelowPublishedSLA,
			MalwareAgentPerfCounters.MessagesRejectedDueToFips,
			MalwareAgentPerfCounters.MessagesRejectedDueToExternalErrors
		};
	}
}
