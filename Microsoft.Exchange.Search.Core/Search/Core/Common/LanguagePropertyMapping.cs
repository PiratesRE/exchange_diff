using System;
using System.Collections.Generic;

namespace Microsoft.Exchange.Search.Core.Common
{
	internal class LanguagePropertyMapping
	{
		internal static Dictionary<int, string> MessageCPID
		{
			get
			{
				return LanguagePropertyMapping.messageCPID;
			}
		}

		internal static Dictionary<int, string> MessageLCID
		{
			get
			{
				return LanguagePropertyMapping.messageLCID;
			}
		}

		internal static Dictionary<int, string> InternetCPID
		{
			get
			{
				return LanguagePropertyMapping.internetCPID;
			}
		}

		internal static string GetDesiredLanguage(string detectedLanguage, int messageCodepage, int messageLocaleID, int internetCPID, string regionDefaultLanguage)
		{
			string text;
			if (!LanguagePropertyMapping.messageCPID.TryGetValue(messageCodepage, out text))
			{
				text = "Unknown";
			}
			string item;
			if (!LanguagePropertyMapping.messageLCID.TryGetValue(messageLocaleID, out item))
			{
				item = "Unknown";
			}
			string text2;
			if (!LanguagePropertyMapping.internetCPID.TryGetValue(internetCPID, out text2))
			{
				text2 = "Unknown";
			}
			if (text == "ASCII" || text2 == "ASCII")
			{
				if (!string.IsNullOrEmpty(detectedLanguage))
				{
					return detectedLanguage;
				}
				return regionDefaultLanguage;
			}
			else
			{
				List<string> list = new List<string>();
				list.Add(string.IsNullOrEmpty(detectedLanguage) ? "Unknown" : detectedLanguage);
				list.Add(item);
				list.Add(text);
				list.Add(text2);
				string text3;
				bool flag = LanguagePropertyMapping.IsCJKPossible(list, out text3);
				if (flag && !string.IsNullOrEmpty(text3))
				{
					return text3;
				}
				string text4 = LanguagePropertyMapping.ChooseLanguageByOrder(list, flag);
				if (!(text4 == "Unknown"))
				{
					return text4;
				}
				return regionDefaultLanguage;
			}
		}

		private static bool IsCJKPossible(List<string> values, out string majorityLanguage)
		{
			Dictionary<string, int> dictionary = new Dictionary<string, int>();
			foreach (string text in values)
			{
				if (text == "zh-cn" || text == "zh-tw" || text == "ja" || text == "ko")
				{
					int num;
					dictionary.TryGetValue(text, out num);
					num++;
					dictionary[text] = num;
				}
			}
			majorityLanguage = string.Empty;
			int num2 = 0;
			foreach (KeyValuePair<string, int> keyValuePair in dictionary)
			{
				if (keyValuePair.Value > num2)
				{
					num2 = keyValuePair.Value;
					majorityLanguage = keyValuePair.Key;
				}
				else if (keyValuePair.Value == num2)
				{
					majorityLanguage = string.Empty;
				}
			}
			return dictionary.Count > 0;
		}

		private static string ChooseLanguageByOrder(List<string> propertyValues, bool isCJK)
		{
			if (isCJK && propertyValues.Count > 1)
			{
				propertyValues.Reverse(1, propertyValues.Count - 1);
				propertyValues.Reverse(0, propertyValues.Count);
			}
			foreach (string text in propertyValues)
			{
				if (text != "Unknown")
				{
					return text;
				}
			}
			return "Unknown";
		}

		private const string ASCII = "ASCII";

		private const string Unknown = "Unknown";

		private static Dictionary<int, string> messageCPID = new Dictionary<int, string>
		{
			{
				37,
				"en"
			},
			{
				437,
				"en"
			},
			{
				500,
				"en"
			},
			{
				708,
				"ar"
			},
			{
				720,
				"ar"
			},
			{
				737,
				"el"
			},
			{
				775,
				"en"
			},
			{
				850,
				"en"
			},
			{
				852,
				"en"
			},
			{
				855,
				"sr"
			},
			{
				857,
				"tr"
			},
			{
				858,
				"en"
			},
			{
				860,
				"pt"
			},
			{
				861,
				"is"
			},
			{
				862,
				"he"
			},
			{
				863,
				"fr"
			},
			{
				864,
				"ar"
			},
			{
				865,
				"no"
			},
			{
				866,
				"sr"
			},
			{
				869,
				"el"
			},
			{
				870,
				"en"
			},
			{
				874,
				"th"
			},
			{
				875,
				"el"
			},
			{
				932,
				"ja"
			},
			{
				936,
				"zh-cn"
			},
			{
				949,
				"ko"
			},
			{
				950,
				"zh-tw"
			},
			{
				1026,
				"tr"
			},
			{
				1047,
				"en"
			},
			{
				1140,
				"en"
			},
			{
				1141,
				"de"
			},
			{
				1142,
				"no"
			},
			{
				1143,
				"sv"
			},
			{
				1144,
				"it"
			},
			{
				1145,
				"es"
			},
			{
				1146,
				"en"
			},
			{
				1147,
				"fr"
			},
			{
				1148,
				"en"
			},
			{
				1149,
				"is"
			},
			{
				1200,
				"en"
			},
			{
				1201,
				"en"
			},
			{
				1250,
				"en"
			},
			{
				1251,
				"sr"
			},
			{
				1252,
				"en"
			},
			{
				1253,
				"el"
			},
			{
				1254,
				"tr"
			},
			{
				1255,
				"he"
			},
			{
				1256,
				"ar"
			},
			{
				1257,
				"en"
			},
			{
				1258,
				"vi"
			},
			{
				1361,
				"ko"
			},
			{
				10000,
				"en"
			},
			{
				10001,
				"ja"
			},
			{
				10002,
				"zh-tw"
			},
			{
				10003,
				"ko"
			},
			{
				10004,
				"ar"
			},
			{
				10005,
				"he"
			},
			{
				10006,
				"el"
			},
			{
				10007,
				"sr"
			},
			{
				10008,
				"zh-cn"
			},
			{
				10010,
				"ro"
			},
			{
				10017,
				"uk"
			},
			{
				10021,
				"th"
			},
			{
				10029,
				"en"
			},
			{
				10079,
				"is"
			},
			{
				10081,
				"tr"
			},
			{
				10082,
				"hr"
			},
			{
				12000,
				"en"
			},
			{
				12001,
				"en"
			},
			{
				20000,
				"zh-tw"
			},
			{
				20001,
				"zh-tw"
			},
			{
				20002,
				"zh-tw"
			},
			{
				20003,
				"zh-tw"
			},
			{
				20004,
				"zh-tw"
			},
			{
				20005,
				"zh-tw"
			},
			{
				20105,
				"en"
			},
			{
				20106,
				"de"
			},
			{
				20107,
				"sv"
			},
			{
				20108,
				"no"
			},
			{
				20127,
				"ASCII"
			},
			{
				20261,
				"en"
			},
			{
				20269,
				"en"
			},
			{
				20273,
				"de"
			},
			{
				20277,
				"da"
			},
			{
				20278,
				"fi"
			},
			{
				20280,
				"it"
			},
			{
				20284,
				"es"
			},
			{
				20285,
				"en"
			},
			{
				20290,
				"ja"
			},
			{
				20297,
				"fr"
			},
			{
				20420,
				"ar"
			},
			{
				20423,
				"el"
			},
			{
				20424,
				"he"
			},
			{
				20833,
				"ko"
			},
			{
				20838,
				"th"
			},
			{
				20866,
				"sr"
			},
			{
				20871,
				"is"
			},
			{
				20880,
				"sr"
			},
			{
				20905,
				"tr"
			},
			{
				20924,
				"en"
			},
			{
				20932,
				"ja"
			},
			{
				20936,
				"zh-cn"
			},
			{
				20949,
				"ko"
			},
			{
				21025,
				"sr"
			},
			{
				21866,
				"sr"
			},
			{
				28591,
				"en"
			},
			{
				28592,
				"en"
			},
			{
				28593,
				"en"
			},
			{
				28594,
				"en"
			},
			{
				28595,
				"sr"
			},
			{
				28596,
				"ar"
			},
			{
				28597,
				"el"
			},
			{
				28598,
				"he"
			},
			{
				28599,
				"tr"
			},
			{
				28603,
				"et"
			},
			{
				28605,
				"en"
			},
			{
				29001,
				"en"
			},
			{
				38598,
				"he"
			},
			{
				50220,
				"ja"
			},
			{
				50221,
				"ja"
			},
			{
				50225,
				"ko"
			},
			{
				50227,
				"zh-cn"
			},
			{
				51932,
				"ja"
			},
			{
				51936,
				"zh-cn"
			},
			{
				51949,
				"ko"
			},
			{
				52936,
				"zh-cn"
			},
			{
				54936,
				"zh-cn"
			},
			{
				57002,
				"en"
			},
			{
				57003,
				"en"
			},
			{
				57004,
				"en"
			},
			{
				57005,
				"en"
			},
			{
				57006,
				"en"
			},
			{
				57007,
				"en"
			},
			{
				57008,
				"en"
			},
			{
				57009,
				"en"
			},
			{
				57010,
				"en"
			},
			{
				57011,
				"en"
			},
			{
				65000,
				"en"
			},
			{
				65001,
				"en"
			}
		};

		private static Dictionary<int, string> messageLCID = new Dictionary<int, string>
		{
			{
				0,
				"en"
			},
			{
				1025,
				"ar"
			},
			{
				2049,
				"ar"
			},
			{
				3073,
				"ar"
			},
			{
				4097,
				"ar"
			},
			{
				5121,
				"ar"
			},
			{
				6145,
				"ar"
			},
			{
				7169,
				"ar"
			},
			{
				8193,
				"ar"
			},
			{
				9217,
				"ar"
			},
			{
				10241,
				"ar"
			},
			{
				11265,
				"ar"
			},
			{
				12289,
				"ar"
			},
			{
				13313,
				"ar"
			},
			{
				14337,
				"ar"
			},
			{
				15361,
				"ar"
			},
			{
				16385,
				"ar"
			},
			{
				1069,
				"eu"
			},
			{
				1026,
				"bg"
			},
			{
				1027,
				"ca"
			},
			{
				4,
				"zh-cn"
			},
			{
				5124,
				"zh-tw"
			},
			{
				1028,
				"zh-tw"
			},
			{
				2052,
				"zh-cn"
			},
			{
				3076,
				"zh-tw"
			},
			{
				4100,
				"zh-tw"
			},
			{
				1050,
				"hr"
			},
			{
				1029,
				"cs"
			},
			{
				1030,
				"da"
			},
			{
				1043,
				"nl"
			},
			{
				2067,
				"nl"
			},
			{
				9225,
				"en"
			},
			{
				1033,
				"en"
			},
			{
				2057,
				"en"
			},
			{
				3081,
				"en"
			},
			{
				4105,
				"en"
			},
			{
				5129,
				"en"
			},
			{
				6153,
				"en"
			},
			{
				7177,
				"en"
			},
			{
				12297,
				"en"
			},
			{
				8201,
				"en"
			},
			{
				10249,
				"en"
			},
			{
				11273,
				"en"
			},
			{
				13321,
				"en"
			},
			{
				1061,
				"et"
			},
			{
				1124,
				"fil"
			},
			{
				1035,
				"fi"
			},
			{
				1036,
				"fr"
			},
			{
				2060,
				"fr"
			},
			{
				3084,
				"fr"
			},
			{
				4108,
				"fr"
			},
			{
				5132,
				"fr"
			},
			{
				6156,
				"fr"
			},
			{
				1031,
				"de"
			},
			{
				2055,
				"de"
			},
			{
				3079,
				"de"
			},
			{
				4103,
				"de"
			},
			{
				5127,
				"de"
			},
			{
				1032,
				"el"
			},
			{
				13,
				"he"
			},
			{
				1037,
				"he"
			},
			{
				1081,
				"hi"
			},
			{
				1038,
				"hu"
			},
			{
				1039,
				"is"
			},
			{
				1040,
				"it"
			},
			{
				2064,
				"it"
			},
			{
				1041,
				"ja"
			},
			{
				1087,
				"kk"
			},
			{
				1042,
				"ko"
			},
			{
				1062,
				"lv"
			},
			{
				1063,
				"lt"
			},
			{
				1086,
				"ml"
			},
			{
				1044,
				"no"
			},
			{
				2068,
				"nm"
			},
			{
				1065,
				"fa"
			},
			{
				1045,
				"pl"
			},
			{
				1046,
				"pt"
			},
			{
				2070,
				"pt"
			},
			{
				1048,
				"ro"
			},
			{
				2072,
				"ro"
			},
			{
				1049,
				"ru"
			},
			{
				2073,
				"ru"
			},
			{
				3098,
				"sr"
			},
			{
				2074,
				"sr"
			},
			{
				1051,
				"sk"
			},
			{
				1060,
				"sl"
			},
			{
				1034,
				"es"
			},
			{
				2058,
				"es"
			},
			{
				3082,
				"es"
			},
			{
				21514,
				"es"
			},
			{
				4106,
				"es"
			},
			{
				5130,
				"es"
			},
			{
				6154,
				"es"
			},
			{
				7178,
				"es"
			},
			{
				8202,
				"es"
			},
			{
				9226,
				"es"
			},
			{
				10250,
				"es"
			},
			{
				11274,
				"es"
			},
			{
				11298,
				"es"
			},
			{
				13322,
				"es"
			},
			{
				14346,
				"es"
			},
			{
				15370,
				"es"
			},
			{
				16349,
				"es"
			},
			{
				17418,
				"es"
			},
			{
				18442,
				"es"
			},
			{
				19466,
				"es"
			},
			{
				20490,
				"es"
			},
			{
				1053,
				"sv"
			},
			{
				2077,
				"sv"
			},
			{
				1054,
				"th"
			},
			{
				1055,
				"tr"
			},
			{
				1058,
				"uk"
			},
			{
				1056,
				"ur"
			},
			{
				1066,
				"vi"
			}
		};

		private static Dictionary<int, string> internetCPID = new Dictionary<int, string>
		{
			{
				0,
				"en"
			},
			{
				932,
				"ja"
			},
			{
				936,
				"zh-cn"
			},
			{
				949,
				"ko"
			},
			{
				950,
				"zh-tw"
			},
			{
				1200,
				"en"
			},
			{
				1201,
				"en"
			},
			{
				1252,
				"en"
			},
			{
				20127,
				"ASCII"
			},
			{
				28591,
				"en"
			},
			{
				28596,
				"ar"
			},
			{
				28605,
				"en"
			},
			{
				50220,
				"ja"
			},
			{
				50221,
				"ja"
			},
			{
				50222,
				"ja"
			},
			{
				50225,
				"ko"
			},
			{
				50227,
				"zh-cn"
			},
			{
				50229,
				"zh-tw"
			},
			{
				50932,
				"ja"
			},
			{
				50936,
				"zh-cn"
			},
			{
				50949,
				"ko"
			},
			{
				50950,
				"zh-tw"
			},
			{
				51256,
				"ar"
			},
			{
				51932,
				"ja"
			},
			{
				51936,
				"zh-cn"
			},
			{
				51949,
				"ko"
			},
			{
				51950,
				"ko"
			},
			{
				52936,
				"zh-cn"
			},
			{
				54936,
				"zh-cn"
			},
			{
				65000,
				"en"
			},
			{
				65001,
				"en"
			}
		};
	}
}
