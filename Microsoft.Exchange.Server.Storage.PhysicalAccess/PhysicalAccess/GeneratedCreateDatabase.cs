using System;
using Microsoft.Isam.Esent.Interop;
using Microsoft.Isam.Esent.Interop.Windows8;

namespace Microsoft.Exchange.Server.Storage.PhysicalAccess
{
	internal class GeneratedCreateDatabase
	{
		internal static void CreateDatabase(JET_SESID session, JET_DBID database)
		{
			GeneratedCreateDatabase.CreateTablePseudoIndexControl(session, database);
			GeneratedCreateDatabase.CreateTablePseudoIndexDefinition(session, database);
			GeneratedCreateDatabase.CreateTablePseudoIndexMaintenance(session, database);
			GeneratedCreateDatabase.CreateTableDeliveredTo(session, database);
			GeneratedCreateDatabase.CreateTableEvents(session, database);
			GeneratedCreateDatabase.CreateTableAttachment(session, database);
			GeneratedCreateDatabase.CreateTableFolder(session, database);
			GeneratedCreateDatabase.CreateTableInferenceLog(session, database);
			GeneratedCreateDatabase.CreateTableMessage(session, database);
			GeneratedCreateDatabase.CreateTablePerUser(session, database);
			GeneratedCreateDatabase.CreateTableReceiveFolder(session, database);
			GeneratedCreateDatabase.CreateTableSearchQueue(session, database);
			GeneratedCreateDatabase.CreateTableTombstone(session, database);
			GeneratedCreateDatabase.CreateTableWatermarks(session, database);
			GeneratedCreateDatabase.CreateTableExtendedPropertyNameMapping(session, database);
			GeneratedCreateDatabase.CreateTableGlobals(session, database);
			GeneratedCreateDatabase.CreateTableMailboxIdentity(session, database);
			GeneratedCreateDatabase.CreateTableMailbox(session, database);
			GeneratedCreateDatabase.CreateTableReplidGuidMap(session, database);
			GeneratedCreateDatabase.CreateTableTimedEvents(session, database);
		}

		private static void CreateTablePseudoIndexControl(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[14];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailboxNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "FolderId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].grbit |= ColumndefGrbit.ColumnAutoincrement;
			array[num].szColumnName = "LogicalIndexNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "IndexType";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "PhysicalIndexNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "FirstUpdateRecord";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastReferenceDate";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ColumnMappings";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ConditionalIndex";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 512;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "TableName";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "CategorizationInfo";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LogicalIndexVersion";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "IndexSignature";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "PseudoIndexControlPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+MailboxNumber\0+FolderId\0+LogicalIndexNumber\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 90;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 524288;
			jet_SPACEHINTS.cbMaxExtent = 1048576;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "PseudoIndexControl";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTablePseudoIndexDefinition(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[3];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].grbit |= ColumndefGrbit.ColumnAutoincrement;
			array[num].szColumnName = "PhysicalIndexNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ColumnBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "PseudoIndexDefinitionPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+PhysicalIndexNumber\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 100;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 32768;
			jet_SPACEHINTS.cbMaxExtent = 32768;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintAppendSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "PseudoIndexDefinition";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTablePseudoIndexMaintenance(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[5];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].grbit |= ColumndefGrbit.ColumnAutoincrement;
			array[num].szColumnName = "UpdateRecordNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LogicalIndexNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2;
			array[num].coltyp = JET_coltyp.Short;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LogicalOperation";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "UpdatedPropertiesBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "PseudoIndexMaintenancePK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+UpdateRecordNumber\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 100;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 131072;
			jet_SPACEHINTS.cbMaxExtent = 1048576;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintAppendSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.DeleteHintTableSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "PseudoIndexMaintenance";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			jet_TABLECREATE.grbit = CreateTableColumnIndexGrbit.TemplateTable;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableDeliveredTo(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[4];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailboxNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "SubmitTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageIdHash";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "DeliveredToPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+SubmitTime\0+MailboxNumber\0+MessageIdHash\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 98;
			jet_SPACEHINTS.cbInitial = 1048576;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 1048576;
			jet_SPACEHINTS.cbMaxExtent = 1048576;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintAppendSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.DeleteHintTableSequential;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "DeliveredTo";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableEvents(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[20];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].grbit |= ColumndefGrbit.ColumnAutoincrement;
			array[num].szColumnName = "EventCounter";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "CreateTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "TransactionId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "EventType";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailboxNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ClientType";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Flags";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 118;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ObjectClass";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 24;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "Fid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 24;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "Mid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 24;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "OldFid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 24;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "OldMid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 24;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "OldParentFid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ItemCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "UnreadCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 68;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "Sid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DocumentId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtendedFlags";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 24;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ParentFid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "EventsPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+EventCounter\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 100;
			jet_SPACEHINTS.cbInitial = 1048576;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 1048576;
			jet_SPACEHINTS.cbMaxExtent = 10485760;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintAppendSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.DeleteHintTableSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "Events";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableAttachment(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[21];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].grbit |= ColumndefGrbit.ColumnAutoincrement;
			array[num].szColumnName = "Inid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "AttachmentId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "AttachmentMethod";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "RenderingPosition";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "CreationTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastModificationTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Size";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1024;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "Name";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ContentId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ContentType";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit &= (ColumndefGrbit)(-524289);
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "Content";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "MessageFlagsActual";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2;
			array[num].coltyp = JET_coltyp.Short;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailFlags";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "RecipientList";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "SubobjectsBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "PropertyBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "LargePropertyValueBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1;
			array[num].coltyp = JET_coltyp.Bit;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "IsEmbeddedMessage";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2;
			array[num].coltyp = JET_coltyp.Short;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "FullTextType";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "Language";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "AttachmentPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+Inid\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 95;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 524288;
			jet_SPACEHINTS.cbMaxExtent = 1048576;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintAppendSequential;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_SPACEHINTS jet_SPACEHINTS2 = new JET_SPACEHINTS();
			jet_SPACEHINTS2.ulInitialDensity = 100;
			jet_SPACEHINTS2.ulGrowth = 100;
			jet_SPACEHINTS2.cbMinExtent = 131072;
			jet_SPACEHINTS2.cbMaxExtent = 33554432;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "Attachment";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			jet_TABLECREATE.grbit = CreateTableColumnIndexGrbit.TemplateTable;
			jet_TABLECREATE.pLVSpacehints = jet_SPACEHINTS2;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableFolder(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[52];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "FolderId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LcnCurrent";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1048576;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "VersionHistory";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ParentFolderId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "CreationTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 512;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "CreatorSid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastModificationTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "SourceKey";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ChangeKey";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LocalCommitTimeMax";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 512;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastModifierSid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1024;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DisplayName";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1024;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "Comment";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ContainerClass";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "TotalDeletedCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "UnreadMessageCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageSize";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageAttachCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageHasAttachCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "HiddenItemCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "UnreadHiddenItemCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "HiddenItemSize";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "HiddenItemHasAttachCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "HiddenItemAttachCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DisplayType";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ConversationCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "FolderCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2;
			array[num].coltyp = JET_coltyp.Short;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "SpecialFolderNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ReservedMessageIdGlobCntCurrent";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ReservedMessageIdGlobCntMax";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ReservedMessageCnGlobCntCurrent";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ReservedMessageCnGlobCntMax";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "NextArticleNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "MidsetDeleted";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "NormalItemPromotedColumns";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "HiddenItemPromotedColumns";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "PromotionTimestamp";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "PromotionUseHistory";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "QueryCriteria";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "SearchState";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "SetSearchCriteriaFlags";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ScopeFolders";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "NonRecursiveSearchBacklinks";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "RecursiveSearchBacklinks";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "LogicalIndexNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "PropertyBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "LargePropertyValueBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "AclTableAndSecurityDescriptor";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ReservedDocumentIdCurrent";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ReservedDocumentIdMax";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[3];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "FolderPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+FolderId\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 95;
			jet_SPACEHINTS.cbInitial = 98304;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 131072;
			jet_SPACEHINTS.cbMaxExtent = 1048576;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintHotpointSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "FolderChangeNumber";
			array2[num2].grbit = (CreateIndexGrbit)262145;
			array2[num2].szKey = "+LcnCurrent\0+FolderId\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 95;
			jet_SPACEHINTS.cbInitial = 98304;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 131072;
			jet_SPACEHINTS.cbMaxExtent = 1048576;
			spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintHotpointSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "FolderByParent";
			array2[num2].grbit = (CreateIndexGrbit)262145;
			array2[num2].szKey = "+ParentFolderId\0+FolderId\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 95;
			jet_SPACEHINTS.cbInitial = 98304;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 131072;
			jet_SPACEHINTS.cbMaxExtent = 1048576;
			spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintHotpointSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "Folder";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			jet_TABLECREATE.grbit = CreateTableColumnIndexGrbit.TemplateTable;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableInferenceLog(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[3];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].grbit |= ColumndefGrbit.ColumnAutoincrement;
			array[num].szColumnName = "RowId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "CreateTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4096;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "PropertyBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "InferenceLogPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+RowId\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 100;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 131072;
			jet_SPACEHINTS.cbMaxExtent = 262144;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintAppendSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.DeleteHintTableSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "InferenceLog";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			jet_TABLECREATE.grbit = CreateTableColumnIndexGrbit.TemplateTable;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableMessage(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[45];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageDocumentId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "MessageId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "FolderId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LcnCurrent";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1048576;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "VersionHistory";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "GroupCns";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastModificationTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "LcnReadUnread";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "SourceKey";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ChangeKey";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Size";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "RecipientList";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "PropertyBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "OffPagePropertyBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "LargePropertyValueBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "SubobjectsBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1;
			array[num].coltyp = JET_coltyp.Bit;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "IsHidden";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1;
			array[num].coltyp = JET_coltyp.Bit;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "IsRead";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1;
			array[num].coltyp = JET_coltyp.Bit;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "HasAttachments";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1;
			array[num].coltyp = JET_coltyp.Bit;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ConversationIndexTracking";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageFlagsActual";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2;
			array[num].coltyp = JET_coltyp.Short;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailFlags";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Status";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 510;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "MessageClass";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Importance";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Sensitivity";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Priority";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4096;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ConversationIndex";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ConversationMembers";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2048;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "SubjectPrefix";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ArticleNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "IMAPId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 61440;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DisplayTo";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ConversationDocumentId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2;
			array[num].coltyp = JET_coltyp.Short;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "BodyType";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DateCreated";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "CodePage";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DateReceived";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DateSent";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "NativeBody";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "AnnotationToken";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "UserConfigurationXmlStream";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "UserConfigurationStream";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ConversationId";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[3];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "MessagePK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+MessageDocumentId\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 95;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 524288;
			jet_SPACEHINTS.cbMaxExtent = 1048576;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintHotpointSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_SPACEHINTS jet_SPACEHINTS2 = new JET_SPACEHINTS();
			jet_SPACEHINTS2.ulInitialDensity = 100;
			jet_SPACEHINTS2.ulGrowth = 100;
			jet_SPACEHINTS2.cbMinExtent = 131072;
			jet_SPACEHINTS2.cbMaxExtent = 33554432;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "MessageUnique";
			array2[num2].grbit = (CreateIndexGrbit)262145;
			array2[num2].szKey = "+FolderId\0+IsHidden\0+MessageId\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 80;
			jet_SPACEHINTS.cbInitial = 524288;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 131072;
			jet_SPACEHINTS.cbMaxExtent = 262144;
			spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "ConversationIdUnique";
			array2[num2].grbit = (CreateIndexGrbit)262145;
			array2[num2].szKey = "+ConversationId\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_CONDITIONALCOLUMN[] array3 = new JET_CONDITIONALCOLUMN[1];
			int num3 = 0;
			array3[num3] = new JET_CONDITIONALCOLUMN();
			array3[num3].szColumnName = "ConversationId";
			array3[num3].grbit = ConditionalColumnGrbit.ColumnMustBeNonNull;
			num3++;
			array2[num2].rgconditionalcolumn = array3;
			array2[num2].cConditionalColumn = array3.Length;
			jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 80;
			jet_SPACEHINTS.cbInitial = 524288;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 131072;
			jet_SPACEHINTS.cbMaxExtent = 262144;
			spaceHintsGrbit = SpaceHintsGrbit.None;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "Message";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			jet_TABLECREATE.grbit = CreateTableColumnIndexGrbit.TemplateTable;
			jet_TABLECREATE.pLVSpacehints = jet_SPACEHINTS2;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTablePerUser(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[6];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1;
			array[num].coltyp = JET_coltyp.Bit;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ResidentFolder";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Guid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "FolderId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1048576;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "CnsetRead";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastModificationTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "PerUserPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+ResidentFolder\0+FolderId\0+Guid\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 60;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 32768;
			jet_SPACEHINTS.cbMaxExtent = 131072;
			SpaceHintsGrbit grbit = SpaceHintsGrbit.None;
			jet_SPACEHINTS.grbit = grbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_SPACEHINTS jet_SPACEHINTS2 = new JET_SPACEHINTS();
			jet_SPACEHINTS2.ulInitialDensity = 100;
			jet_SPACEHINTS2.ulGrowth = 200;
			jet_SPACEHINTS2.cbMinExtent = 32768;
			jet_SPACEHINTS2.cbMaxExtent = 131072;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "PerUser";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			jet_TABLECREATE.grbit = CreateTableColumnIndexGrbit.TemplateTable;
			jet_TABLECREATE.pLVSpacehints = jet_SPACEHINTS2;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableReceiveFolder(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[4];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageClass";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "FolderId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastModificationTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "ReceiveFolderPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+MessageClass\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 95;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 32768;
			jet_SPACEHINTS.cbMaxExtent = 32768;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "ReceiveFolder";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			jet_TABLECREATE.grbit = CreateTableColumnIndexGrbit.TemplateTable;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableSearchQueue(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[9];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailboxNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnFixed;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "SearchFolderId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 512;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "UserSid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ClientType";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LCID";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 26;
			array[num].coltyp = JET_coltyp.Binary;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "IncrementalScopeFolderId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "CreationTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "PopulationAttempts";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "SearchQueuePK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+MailboxNumber\0+SearchFolderId\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 95;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 32768;
			jet_SPACEHINTS.cbMaxExtent = 32768;
			SpaceHintsGrbit grbit = SpaceHintsGrbit.None;
			jet_SPACEHINTS.grbit = grbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "SearchQueue";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableTombstone(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[3];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailboxNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Inid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "TombstonePK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+MailboxNumber\0+Inid\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 80;
			jet_SPACEHINTS.cbInitial = 524288;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 131072;
			jet_SPACEHINTS.cbMaxExtent = 262144;
			SpaceHintsGrbit grbit = SpaceHintsGrbit.None;
			jet_SPACEHINTS.grbit = grbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "Tombstone";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableWatermarks(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[4];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ConsumerGuid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailboxNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "EventCounter";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "WatermarksPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+ConsumerGuid\0+MailboxNumber\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 80;
			jet_SPACEHINTS.cbInitial = 524288;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 131072;
			jet_SPACEHINTS.cbMaxExtent = 262144;
			SpaceHintsGrbit grbit = SpaceHintsGrbit.None;
			jet_SPACEHINTS.grbit = grbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "Watermarks";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableExtendedPropertyNameMapping(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[5];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "PropNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "PropGuid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 512;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "PropName";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "PropDispId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "ExtendedPropertyNameMappingPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+PropNumber\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 100;
			jet_SPACEHINTS.cbInitial = 65536;
			jet_SPACEHINTS.ulGrowth = 100;
			jet_SPACEHINTS.cbMinExtent = 65536;
			jet_SPACEHINTS.cbMaxExtent = 65536;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintAppendSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "ExtendedPropertyNameMapping";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			jet_TABLECREATE.grbit = CreateTableColumnIndexGrbit.TemplateTable;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableGlobals(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[5];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 128;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "VersionName";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "DatabaseVersion";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Inid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastMaintenanceTask";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "GlobalsPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+VersionName\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 100;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 100;
			jet_SPACEHINTS.cbMinExtent = 32768;
			jet_SPACEHINTS.cbMaxExtent = 32768;
			SpaceHintsGrbit grbit = SpaceHintsGrbit.None;
			jet_SPACEHINTS.grbit = grbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "Globals";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableMailboxIdentity(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[6];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailboxNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LocalIdGuid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "IdCounter";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "CnCounter";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastCounterPatchingTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "MailboxIdentityPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+MailboxNumber\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 100;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 32768;
			jet_SPACEHINTS.cbMaxExtent = 32768;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintAppendSequential;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "MailboxIdentity";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableMailbox(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[35];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailboxNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "MailboxGuid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "OwnerADGuid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2048;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "OwnerLegacyDN";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "MailboxInstanceGuid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MappingSignatureGuid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2048;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "MailboxOwnerDisplayName";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2048;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DisplayName";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 256;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "SimpleDisplayName";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2048;
			array[num].coltyp = JET_coltyp.LongText;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "Comment";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1;
			array[num].coltyp = JET_coltyp.Bit;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "OofState";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DeletedOn";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2;
			array[num].coltyp = JET_coltyp.Short;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Status";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Lcid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "PropertyBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "LargePropertyValueBlob";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageSize";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "HiddenMessageCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "HiddenMessageSize";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageDeletedCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MessageDeletedSize";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "HiddenMessageDeletedCount";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "HiddenMessageDeletedSize";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "LastLogonTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "LastLogoffTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1;
			array[num].coltyp = JET_coltyp.Bit;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "ConversationEnabled";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "MailboxDatabaseVersion";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "LastQuotaNotificationTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1;
			array[num].coltyp = JET_coltyp.Bit;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "PreservingMailboxSignature";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 128;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "TenantHint";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "NextMessageDocumentId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "DefaultPromotedMessagePropertyIds";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "AlwaysPromotedMessagePropertyIds";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[2];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "MailboxTablePK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+MailboxNumber\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 95;
			jet_SPACEHINTS.cbInitial = 131072;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 262144;
			jet_SPACEHINTS.cbMaxExtent = 262144;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.CreateHintAppendSequential;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "MailboxGuidIndex";
			array2[num2].grbit = (CreateIndexGrbit)262145;
			array2[num2].szKey = "+MailboxGuid\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_CONDITIONALCOLUMN[] array3 = new JET_CONDITIONALCOLUMN[1];
			int num3 = 0;
			array3[num3] = new JET_CONDITIONALCOLUMN();
			array3[num3].szColumnName = "MailboxGuid";
			array3[num3].grbit = ConditionalColumnGrbit.ColumnMustBeNonNull;
			num3++;
			array2[num2].rgconditionalcolumn = array3;
			array2[num2].cConditionalColumn = array3.Length;
			jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 80;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 110;
			jet_SPACEHINTS.cbMinExtent = 32768;
			jet_SPACEHINTS.cbMaxExtent = 32768;
			spaceHintsGrbit = SpaceHintsGrbit.None;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "Mailbox";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableReplidGuidMap(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[3];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Guid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 2;
			array[num].coltyp = JET_coltyp.Short;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "Replid";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "ReplidGuidMapPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+Guid\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 98;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 100;
			jet_SPACEHINTS.cbMinExtent = 32768;
			jet_SPACEHINTS.cbMaxExtent = 32768;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "ReplidGuidMap";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			jet_TABLECREATE.grbit = CreateTableColumnIndexGrbit.TemplateTable;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private static void CreateTableTimedEvents(JET_SESID session, JET_DBID database)
		{
			JET_COLUMNCREATE[] array = new JET_COLUMNCREATE[8];
			int num = 0;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = JET_coltyp.DateTime;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "EventTime";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 8;
			array[num].coltyp = (JET_coltyp)15;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].grbit |= ColumndefGrbit.ColumnAutoincrement;
			array[num].szColumnName = "UniqueId";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "MailboxNumber";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 16;
			array[num].coltyp = (JET_coltyp)16;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "EventSource";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "EventType";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 4;
			array[num].coltyp = JET_coltyp.Long;
			array[num].grbit |= ColumndefGrbit.ColumnNotNULL;
			array[num].szColumnName = "QoS";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "EventData";
			num++;
			array[num] = new JET_COLUMNCREATE();
			array[num].cp = JET_CP.Unicode;
			array[num].cbMax = 1073741824;
			array[num].coltyp = JET_coltyp.LongBinary;
			array[num].grbit |= (ColumndefGrbit)524288;
			array[num].grbit |= ColumndefGrbit.ColumnTagged;
			array[num].grbit |= ColumndefGrbit.ColumnMaybeNull;
			array[num].szColumnName = "ExtensionBlob";
			num++;
			JET_INDEXCREATE[] array2 = new JET_INDEXCREATE[1];
			int num2 = 0;
			array2[num2] = new JET_INDEXCREATE();
			array2[num2].szIndexName = "TimedEventsPK";
			array2[num2].grbit = (CreateIndexGrbit)262147;
			array2[num2].szKey = "+EventTime\0+UniqueId\0\0";
			array2[num2].cbKey = array2[num2].szKey.Length;
			JET_SPACEHINTS jet_SPACEHINTS = new JET_SPACEHINTS();
			jet_SPACEHINTS.ulInitialDensity = 100;
			jet_SPACEHINTS.cbInitial = 32768;
			jet_SPACEHINTS.ulGrowth = 200;
			jet_SPACEHINTS.cbMinExtent = 524288;
			jet_SPACEHINTS.cbMaxExtent = 1048576;
			SpaceHintsGrbit spaceHintsGrbit = SpaceHintsGrbit.None;
			spaceHintsGrbit |= SpaceHintsGrbit.RetrieveHintTableScanForward;
			jet_SPACEHINTS.grbit = spaceHintsGrbit;
			array2[num2].pSpaceHints = jet_SPACEHINTS;
			num2++;
			JET_TABLECREATE jet_TABLECREATE = new JET_TABLECREATE();
			jet_TABLECREATE.szTableName = "TimedEvents";
			jet_TABLECREATE.rgcolumncreate = array;
			jet_TABLECREATE.cColumns = array.Length;
			jet_TABLECREATE.rgindexcreate = array2;
			jet_TABLECREATE.cIndexes = array2.Length;
			Windows8Api.JetCreateTableColumnIndex4(session, database, jet_TABLECREATE);
			Api.JetCloseTable(session, jet_TABLECREATE.tableid);
		}

		private const int DefaultGrowthRate = 110;

		private const int DefaultInitialPages = 16;

		private const int DefaultInitialDensity = 80;

		private const int DefaultMinimumExtentSize = 4;

		private const int DefaultMaximumExtentSize = 8;
	}
}
